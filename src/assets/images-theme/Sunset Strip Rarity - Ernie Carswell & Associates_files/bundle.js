setInterval(function(){Array.from(document.querySelectorAll(".chosen-drop .chosen-search input")).forEach(function(e){e.setAttribute("aria-hidden","true")}),Array.from(document.querySelectorAll(".chosen-choices .search-field input")).forEach(function(e){e.setAttribute("aria-label","Search This Field")}),Array.from(document.querySelectorAll("img")).filter(function(e){return!e.alt||!e.alt.trim()}).forEach(function(e){e.alt="IDX Image"})},200);
if(!jQuery)throw new Error("Bootstrap requires jQuery");!function(o){"use strict";o.fn.emulateTransitionEnd=function(t){var e=!1,i=this;o(this).one(o.support.transition.end,function(){e=!0});return setTimeout(function(){e||o(i).trigger(o.support.transition.end)},t),this},o(function(){o.support.transition=function(){var t=document.createElement("bootstrap"),e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var i in e)if(void 0!==t.style[i])return{end:e[i]}}()})}(window.jQuery),function(s){"use strict";var e='[data-dismiss="alert"]',o=function(t){s(t).on("click",e,this.close)};o.prototype.close=function(t){var e=s(this),i=e.attr("data-target");i||(i=(i=e.attr("href"))&&i.replace(/.*(?=#[^\s]*$)/,""));var o=s(i);function n(){o.trigger("closed.bs.alert").remove()}t&&t.preventDefault(),o.length||(o=e.hasClass("alert")?e:e.parent()),o.trigger(t=s.Event("close.bs.alert")),t.isDefaultPrevented()||(o.removeClass("in"),s.support.transition&&o.hasClass("fade")?o.one(s.support.transition.end,n).emulateTransitionEnd(150):n())};var t=s.fn.alert;s.fn.alert=function(i){return this.each(function(){var t=s(this),e=t.data("bs.alert");e||t.data("bs.alert",e=new o(this)),"string"==typeof i&&e[i].call(t)})},s.fn.alert.Constructor=o,s.fn.alert.noConflict=function(){return s.fn.alert=t,this},s(document).on("click.bs.alert.data-api",e,o.prototype.close)}(window.jQuery),function(n){"use strict";var s=function(t,e){this.$element=n(t),this.options=n.extend({},s.DEFAULTS,e)};s.DEFAULTS={loadingText:"loading..."},s.prototype.setState=function(t){var e="disabled",i=this.$element,o=i.is("input")?"val":"html",n=i.data();t+="Text",n.resetText||i.data("resetText",i[o]()),i[o](n[t]||this.options[t]),setTimeout(function(){"loadingText"==t?i.addClass(e).attr(e,e):i.removeClass(e).removeAttr(e)},0)},s.prototype.toggle=function(){var t=this.$element.closest('[data-toggle="buttons"]');t.length&&("radio"===this.$element.find("input").prop("checked",!this.$element.hasClass("active")).trigger("change").prop("type")&&t.find(".active").removeClass("active"));this.$element.toggleClass("active")};var t=n.fn.button;n.fn.button=function(o){return this.each(function(){var t=n(this),e=t.data("bs.button"),i="object"==typeof o&&o;e||t.data("bs.button",e=new s(this,i)),"toggle"==o?e.toggle():o&&e.setState(o)})},n.fn.button.Constructor=s,n.fn.button.noConflict=function(){return n.fn.button=t,this},n(document).on("click.bs.button.data-api","[data-toggle^=button]",function(t){var e=n(t.target);e.hasClass("btn")||(e=e.closest(".btn")),e.button("toggle"),t.preventDefault()})}(window.jQuery),function(h){"use strict";var s=function(t,e){this.$element=h(t),this.$indicators=this.$element.find(".carousel-indicators"),this.options=e,this.paused=this.sliding=this.interval=this.$active=this.$items=null,"hover"==this.options.pause&&this.$element.on("mouseenter",h.proxy(this.pause,this)).on("mouseleave",h.proxy(this.cycle,this))};s.DEFAULTS={interval:5e3,pause:"hover",wrap:!0},s.prototype.cycle=function(t){return t||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(h.proxy(this.next,this),this.options.interval)),this},s.prototype.getActiveIndex=function(){return this.$active=this.$element.find(".item.active"),this.$items=this.$active.parent().children(),this.$items.index(this.$active)},s.prototype.to=function(t){var e=this,i=this.getActiveIndex();if(!(t>this.$items.length-1||t<0))return this.sliding?this.$element.one("slid",function(){e.to(t)}):i==t?this.pause().cycle():this.slide(i<t?"next":"prev",h(this.$items[t]))},s.prototype.pause=function(t){return t||(this.paused=!0),this.$element.find(".next, .prev").length&&h.support.transition.end&&(this.$element.trigger(h.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},s.prototype.next=function(){if(!this.sliding)return this.slide("next")},s.prototype.prev=function(){if(!this.sliding)return this.slide("prev")},s.prototype.slide=function(t,e){var i=this.$element.find(".item.active"),o=e||i[t](),n=this.interval,s="next"==t?"left":"right",a="next"==t?"first":"last",r=this;if(!o.length){if(!this.options.wrap)return;o=this.$element.find(".item")[a]()}this.sliding=!0,n&&this.pause();var l=h.Event("slide.bs.carousel",{relatedTarget:o[0],direction:s});if(!o.hasClass("active")){if(this.$indicators.length&&(this.$indicators.find(".active").removeClass("active"),this.$element.one("slid",function(){var t=h(r.$indicators.children()[r.getActiveIndex()]);t&&t.addClass("active")})),h.support.transition&&this.$element.hasClass("slide")){if(this.$element.trigger(l),l.isDefaultPrevented())return;o.addClass(t),o[0].offsetWidth,i.addClass(s),o.addClass(s),i.one(h.support.transition.end,function(){o.removeClass([t,s].join(" ")).addClass("active"),i.removeClass(["active",s].join(" ")),r.sliding=!1,setTimeout(function(){r.$element.trigger("slid")},0)}).emulateTransitionEnd(600)}else{if(this.$element.trigger(l),l.isDefaultPrevented())return;i.removeClass("active"),o.addClass("active"),this.sliding=!1,this.$element.trigger("slid")}return n&&this.cycle(),this}};var t=h.fn.carousel;h.fn.carousel=function(n){return this.each(function(){var t=h(this),e=t.data("bs.carousel"),i=h.extend({},s.DEFAULTS,t.data(),"object"==typeof n&&n),o="string"==typeof n?n:i.slide;e||t.data("bs.carousel",e=new s(this,i)),"number"==typeof n?e.to(n):o?e[o]():i.interval&&e.pause().cycle()})},h.fn.carousel.Constructor=s,h.fn.carousel.noConflict=function(){return h.fn.carousel=t,this},h(document).on("click.bs.carousel.data-api","[data-slide], [data-slide-to]",function(t){var e,i=h(this),o=h(i.attr("data-target")||(e=i.attr("href"))&&e.replace(/.*(?=#[^\s]+$)/,"")),n=h.extend({},o.data(),i.data()),s=i.attr("data-slide-to");s&&(n.interval=!1),o.carousel(n),(s=i.attr("data-slide-to"))&&o.data("bs.carousel").to(s),t.preventDefault()}),h(window).on("load",function(){h('[data-ride="carousel"]').each(function(){var t=h(this);t.carousel(t.data())})})}(window.jQuery),function(h){"use strict";var n=function(t,e){this.$element=h(t),this.options=h.extend({},n.DEFAULTS,e),this.transitioning=null,this.options.parent&&(this.$parent=h(this.options.parent)),this.options.toggle&&this.toggle()};n.DEFAULTS={toggle:!0},n.prototype.dimension=function(){return this.$element.hasClass("width")?"width":"height"},n.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var t=h.Event("show.bs.collapse");if(this.$element.trigger(t),!t.isDefaultPrevented()){var e=this.$parent&&this.$parent.find("> .panel > .in");if(e&&e.length){var i=e.data("bs.collapse");if(i&&i.transitioning)return;e.collapse("hide"),i||e.data("bs.collapse",null)}var o=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[o](0),this.transitioning=1;var n=function(){this.$element.removeClass("collapsing").addClass("in")[o]("auto"),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!h.support.transition)return n.call(this);var s=h.camelCase(["scroll",o].join("-"));this.$element.one(h.support.transition.end,h.proxy(n,this)).emulateTransitionEnd(350)[o](this.$element[0][s])}}},n.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var t=h.Event("hide.bs.collapse");if(this.$element.trigger(t),!t.isDefaultPrevented()){var e=this.dimension();this.$element[e](this.$element[e]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse").removeClass("in"),this.transitioning=1;var i=function(){this.transitioning=0,this.$element.trigger("hidden.bs.collapse").removeClass("collapsing").addClass("collapse")};if(!h.support.transition)return i.call(this);this.$element[e](0).one(h.support.transition.end,h.proxy(i,this)).emulateTransitionEnd(350)}}},n.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()};var t=h.fn.collapse;h.fn.collapse=function(o){return this.each(function(){var t=h(this),e=t.data("bs.collapse"),i=h.extend({},n.DEFAULTS,t.data(),"object"==typeof o&&o);e||t.data("bs.collapse",e=new n(this,i)),"string"==typeof o&&e[o]()})},h.fn.collapse.Constructor=n,h.fn.collapse.noConflict=function(){return h.fn.collapse=t,this},h(document).on("click.bs.collapse.data-api","[data-toggle=collapse]",function(t){var e,i=h(this),o=i.attr("data-target")||t.preventDefault()||(e=i.attr("href"))&&e.replace(/.*(?=#[^\s]+$)/,""),n=h(o),s=n.data("bs.collapse"),a=s?"toggle":i.data(),r=i.attr("data-parent"),l=r&&h(r);s&&s.transitioning||(l&&l.find('[data-toggle=collapse][data-parent="'+r+'"]').not(i).addClass("collapsed"),i[n.hasClass("in")?"addClass":"removeClass"]("collapsed")),n.collapse(a)})}(window.jQuery),function(a){"use strict";var r="[data-toggle=dropdown]",o=function(t){a(t).on("click.bs.dropdown",this.toggle)};function n(){a(".dropdown-backdrop").remove(),a(r).each(function(t){var e=l(a(this));e.hasClass("open")&&(e.trigger(t=a.Event("hide.bs.dropdown")),t.isDefaultPrevented()||e.removeClass("open").trigger("hidden.bs.dropdown"))})}function l(t){var e=t.attr("data-target");e||(e=(e=t.attr("href"))&&/#/.test(e)&&e.replace(/.*(?=#[^\s]*$)/,""));var i=e&&a(e);return i&&i.length?i:t.parent()}o.prototype.toggle=function(t){var e=a(this);if(!e.is(".disabled, :disabled")){var i=l(e),o=i.hasClass("open");if(n(),!o){if("ontouchstart"in document.documentElement&&!i.closest(".navbar-nav").length&&a('<div class="dropdown-backdrop"/>').insertAfter(a(this)).on("click",n),i.trigger(t=a.Event("show.bs.dropdown")),t.isDefaultPrevented())return;i.toggleClass("open").trigger("shown.bs.dropdown"),e.focus()}return!1}},o.prototype.keydown=function(t){if(/(38|40|27)/.test(t.keyCode)){var e=a(this);if(t.preventDefault(),t.stopPropagation(),!e.is(".disabled, :disabled")){var i=l(e),o=i.hasClass("open");if(!o||o&&27==t.keyCode)return 27==t.which&&i.find(r).focus(),e.click();var n=a("[role=menu] li:not(.divider):visible a",i);if(n.length){var s=n.index(n.filter(":focus"));38==t.keyCode&&0<s&&s--,40==t.keyCode&&s<n.length-1&&s++,~s||(s=0),n.eq(s).focus()}}}};var t=a.fn.dropdown;a.fn.dropdown=function(i){return this.each(function(){var t=a(this),e=t.data("dropdown");e||t.data("dropdown",e=new o(this)),"string"==typeof i&&e[i].call(t)})},a.fn.dropdown.Constructor=o,a.fn.dropdown.noConflict=function(){return a.fn.dropdown=t,this},a(document).on("click.bs.dropdown.data-api",n).on("click.bs.dropdown.data-api",".dropdown form",function(t){t.stopPropagation()}).on("click.bs.dropdown.data-api",r,o.prototype.toggle).on("keydown.bs.dropdown.data-api",r+", [role=menu]",o.prototype.keydown)}(window.jQuery),function(s){"use strict";var a=function(t,e){this.options=e,this.$element=s(t),this.$backdrop=this.isShown=null,this.options.remote&&this.$element.load(this.options.remote)};a.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},a.prototype.toggle=function(t){return this[this.isShown?"hide":"show"](t)},a.prototype.show=function(i){var o=this,t=s.Event("show.bs.modal",{relatedTarget:i});this.$element.trigger(t),this.isShown||t.isDefaultPrevented()||(this.isShown=!0,this.escape(),this.$element.on("click.dismiss.modal",'[data-dismiss="modal"]',s.proxy(this.hide,this)),this.backdrop(function(){var t=s.support.transition&&o.$element.hasClass("fade");o.$element.parent().length||o.$element.appendTo(document.body),o.$element.show(),t&&o.$element[0].offsetWidth,o.$element.addClass("in").attr("aria-hidden",!1),o.enforceFocus();var e=s.Event("shown.bs.modal",{relatedTarget:i});t?o.$element.find(".modal-dialog").one(s.support.transition.end,function(){o.$element.focus().trigger(e)}).emulateTransitionEnd(300):o.$element.focus().trigger(e)}))},a.prototype.hide=function(t){t&&t.preventDefault(),t=s.Event("hide.bs.modal"),this.$element.trigger(t),this.isShown&&!t.isDefaultPrevented()&&(this.isShown=!1,this.escape(),s(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.modal"),s.support.transition&&this.$element.hasClass("fade")?this.$element.one(s.support.transition.end,s.proxy(this.hideModal,this)).emulateTransitionEnd(300):this.hideModal())},a.prototype.enforceFocus=function(){s(document).off("focusin.bs.modal").on("focusin.bs.modal",s.proxy(function(t){this.$element[0]===t.target||this.$element.has(t.target).length||this.$element.focus()},this))},a.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.bs.modal",s.proxy(function(t){27==t.which&&this.hide()},this)):this.isShown||this.$element.off("keyup.dismiss.bs.modal")},a.prototype.hideModal=function(){var t=this;this.$element.hide(),this.backdrop(function(){t.removeBackdrop(),t.$element.trigger("hidden.bs.modal")})},a.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},a.prototype.backdrop=function(t){var e=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var i=s.support.transition&&e;if(this.$backdrop=s('<div class="modal-backdrop '+e+'" />').appendTo(document.body),this.$element.on("click.dismiss.modal",s.proxy(function(t){t.target===t.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus.call(this.$element[0]):this.hide.call(this))},this)),i&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!t)return;i?this.$backdrop.one(s.support.transition.end,t).emulateTransitionEnd(150):t()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),s.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(s.support.transition.end,t).emulateTransitionEnd(150):t()):t&&t()};var t=s.fn.modal;s.fn.modal=function(o,n){return this.each(function(){var t=s(this),e=t.data("bs.modal"),i=s.extend({},a.DEFAULTS,t.data(),"object"==typeof o&&o);e||t.data("bs.modal",e=new a(this,i)),"string"==typeof o?e[o](n):i.show&&e.show(n)})},s.fn.modal.Constructor=a,s.fn.modal.noConflict=function(){return s.fn.modal=t,this},s(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(t){var e=s(this),i=e.attr("href"),o=s(e.attr("data-target")||i&&i.replace(/.*(?=#[^\s]+$)/,"")),n=o.data("modal")?"toggle":s.extend({remote:!/#/.test(i)&&i},o.data(),e.data());t.preventDefault(),o.modal(n,this).one("hide",function(){e.is(":visible")&&e.focus()})}),s(document).on("show.bs.modal",".modal",function(){s(document.body).addClass("modal-open")}).on("hidden.bs.modal",".modal",function(){s(document.body).removeClass("modal-open")})}(window.jQuery),function(m){"use strict";var n=function(t,e){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",t,e)};n.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},n.prototype.init=function(t,e,i){this.enabled=!0,this.type=t,this.$element=m(e),this.options=this.getOptions(i);for(var o=this.options.trigger.split(" "),n=o.length;n--;){var s=o[n];if("click"==s)this.$element.on("click."+this.type,this.options.selector,m.proxy(this.toggle,this));else if("manual"!=s){var a="hover"==s?"mouseenter":"focus",r="hover"==s?"mouseleave":"blur";this.$element.on(a+"."+this.type,this.options.selector,m.proxy(this.enter,this)),this.$element.on(r+"."+this.type,this.options.selector,m.proxy(this.leave,this))}}this.options.selector?this._options=m.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},n.prototype.getDefaults=function(){return n.DEFAULTS},n.prototype.getOptions=function(t){return(t=m.extend({},this.getDefaults(),this.$element.data(),t)).delay&&"number"==typeof t.delay&&(t.delay={show:t.delay,hide:t.delay}),t},n.prototype.getDelegateOptions=function(){var i={},o=this.getDefaults();return this._options&&m.each(this._options,function(t,e){o[t]!=e&&(i[t]=e)}),i},n.prototype.enter=function(t){var e=t instanceof this.constructor?t:m(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);if(clearTimeout(e.timeout),e.hoverState="in",!e.options.delay||!e.options.delay.show)return e.show();e.timeout=setTimeout(function(){"in"==e.hoverState&&e.show()},e.options.delay.show)},n.prototype.leave=function(t){var e=t instanceof this.constructor?t:m(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);if(clearTimeout(e.timeout),e.hoverState="out",!e.options.delay||!e.options.delay.hide)return e.hide();e.timeout=setTimeout(function(){"out"==e.hoverState&&e.hide()},e.options.delay.hide)},n.prototype.show=function(){var t=m.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){if(this.$element.trigger(t),t.isDefaultPrevented())return;var e=this.tip();this.setContent(),this.options.animation&&e.addClass("fade");var i="function"==typeof this.options.placement?this.options.placement.call(this,e[0],this.$element[0]):this.options.placement,o=/\s?auto?\s?/i,n=o.test(i);n&&(i=i.replace(o,"")||"top"),e.detach().css({top:0,left:0,display:"block"}).addClass(i),this.options.container?e.appendTo(this.options.container):e.insertAfter(this.$element);var s=this.getPosition(),a=e[0].offsetWidth,r=e[0].offsetHeight;if(n){var l=this.$element.parent(),h=i,p=document.documentElement.scrollTop||document.body.scrollTop,d="body"==this.options.container?window.innerWidth:l.outerWidth(),c="body"==this.options.container?window.innerHeight:l.outerHeight(),f="body"==this.options.container?0:l.offset().left;i="bottom"==i&&s.top+s.height+r-p>c?"top":"top"==i&&s.top-p-r<0?"bottom":"right"==i&&s.right+a>d?"left":"left"==i&&s.left-a<f?"right":i,e.removeClass(h).addClass(i)}var u=this.getCalculatedOffset(i,s,a,r);this.applyPlacement(u,i),this.$element.trigger("shown.bs."+this.type)}},n.prototype.applyPlacement=function(t,e){var i,o=this.tip(),n=o[0].offsetWidth,s=o[0].offsetHeight,a=parseInt(o.css("margin-top"),10),r=parseInt(o.css("margin-left"),10);isNaN(a)&&(a=0),isNaN(r)&&(r=0),t.top=t.top+a,t.left=t.left+r,o.offset(t).addClass("in");var l=o[0].offsetWidth,h=o[0].offsetHeight;if("top"==e&&h!=s&&(i=!0,t.top=t.top+s-h),/bottom|top/.test(e)){var p=0;t.left<0&&(p=-2*t.left,t.left=0,o.offset(t),l=o[0].offsetWidth,h=o[0].offsetHeight),this.replaceArrow(p-n+l,l,"left")}else this.replaceArrow(h-s,h,"top");i&&o.offset(t)},n.prototype.replaceArrow=function(t,e,i){this.arrow().css(i,t?50*(1-t/e)+"%":"")},n.prototype.setContent=function(){var t=this.tip(),e=this.getTitle();t.find(".tooltip-inner")[this.options.html?"html":"text"](e),t.removeClass("fade in top bottom left right")},n.prototype.hide=function(){var t=this,e=this.tip(),i=m.Event("hide.bs."+this.type);function o(){"in"!=t.hoverState&&e.detach()}if(this.$element.trigger(i),!i.isDefaultPrevented())return e.removeClass("in"),m.support.transition&&this.$tip.hasClass("fade")?e.one(m.support.transition.end,o).emulateTransitionEnd(150):o(),this.$element.trigger("hidden.bs."+this.type),this},n.prototype.fixTitle=function(){var t=this.$element;(t.attr("title")||"string"!=typeof t.attr("data-original-title"))&&t.attr("data-original-title",t.attr("title")||"").attr("title","")},n.prototype.hasContent=function(){return this.getTitle()},n.prototype.getPosition=function(){var t=this.$element[0];return m.extend({},"function"==typeof t.getBoundingClientRect?t.getBoundingClientRect():{width:t.offsetWidth,height:t.offsetHeight},this.$element.offset())},n.prototype.getCalculatedOffset=function(t,e,i,o){return"bottom"==t?{top:e.top+e.height,left:e.left+e.width/2-i/2}:"top"==t?{top:e.top-o,left:e.left+e.width/2-i/2}:"left"==t?{top:e.top+e.height/2-o/2,left:e.left-i}:{top:e.top+e.height/2-o/2,left:e.left+e.width}},n.prototype.getTitle=function(){var t=this.$element,e=this.options;return t.attr("data-original-title")||("function"==typeof e.title?e.title.call(t[0]):e.title)},n.prototype.tip=function(){return this.$tip=this.$tip||m(this.options.template)},n.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},n.prototype.validate=function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},n.prototype.enable=function(){this.enabled=!0},n.prototype.disable=function(){this.enabled=!1},n.prototype.toggleEnabled=function(){this.enabled=!this.enabled},n.prototype.toggle=function(t){var e=t?m(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type):this;e.tip().hasClass("in")?e.leave(e):e.enter(e)},n.prototype.destroy=function(){this.hide().$element.off("."+this.type).removeData("bs."+this.type)};var t=m.fn.tooltip;m.fn.tooltip=function(o){return this.each(function(){var t=m(this),e=t.data("bs.tooltip"),i="object"==typeof o&&o;e||t.data("bs.tooltip",e=new n(this,i)),"string"==typeof o&&e[o]()})},m.fn.tooltip.Constructor=n,m.fn.tooltip.noConflict=function(){return m.fn.tooltip=t,this}}(window.jQuery),function(n){"use strict";var s=function(t,e){this.init("popover",t,e)};if(!n.fn.tooltip)throw new Error("Popover requires tooltip.js");s.DEFAULTS=n.extend({},n.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),((s.prototype=n.extend({},n.fn.tooltip.Constructor.prototype)).constructor=s).prototype.getDefaults=function(){return s.DEFAULTS},s.prototype.setContent=function(){var t=this.tip(),e=this.getTitle(),i=this.getContent();t.find(".popover-title")[this.options.html?"html":"text"](e),t.find(".popover-content")[this.options.html?"html":"text"](i),t.removeClass("fade top bottom left right in"),t.find(".popover-title").html()||t.find(".popover-title").hide()},s.prototype.hasContent=function(){return this.getTitle()||this.getContent()},s.prototype.getContent=function(){var t=this.$element,e=this.options;return t.attr("data-content")||("function"==typeof e.content?e.content.call(t[0]):e.content)},s.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")},s.prototype.tip=function(){return this.$tip||(this.$tip=n(this.options.template)),this.$tip};var t=n.fn.popover;n.fn.popover=function(o){return this.each(function(){var t=n(this),e=t.data("bs.popover"),i="object"==typeof o&&o;e||t.data("bs.popover",e=new s(this,i)),"string"==typeof o&&e[o]()})},n.fn.popover.Constructor=s,n.fn.popover.noConflict=function(){return n.fn.popover=t,this}}(window.jQuery),function(s){"use strict";function n(t,e){var i,o=s.proxy(this.process,this);this.$element=s(t).is("body")?s(window):s(t),this.$body=s("body"),this.$scrollElement=this.$element.on("scroll.bs.scroll-spy.data-api",o),this.options=s.extend({},n.DEFAULTS,e),this.selector=(this.options.target||(i=s(t).attr("href"))&&i.replace(/.*(?=#[^\s]+$)/,"")||"")+" .nav li > a",this.offsets=s([]),this.targets=s([]),this.activeTarget=null,this.refresh(),this.process()}n.DEFAULTS={offset:10},n.prototype.refresh=function(){var o=this.$element[0]==window?"offset":"position";this.offsets=s([]),this.targets=s([]);var n=this;this.$body.find(this.selector).map(function(){var t=s(this),e=t.data("target")||t.attr("href"),i=/^#\w/.test(e)&&s(e);return i&&i.length&&[[i[o]().top+(!s.isWindow(n.$scrollElement.get(0))&&n.$scrollElement.scrollTop()),e]]||null}).sort(function(t,e){return t[0]-e[0]}).each(function(){n.offsets.push(this[0]),n.targets.push(this[1])})},n.prototype.process=function(){var t,e=this.$scrollElement.scrollTop()+this.options.offset,i=(this.$scrollElement[0].scrollHeight||this.$body[0].scrollHeight)-this.$scrollElement.height(),o=this.offsets,n=this.targets,s=this.activeTarget;if(i<=e)return s!=(t=n.last()[0])&&this.activate(t);for(t=o.length;t--;)s!=n[t]&&e>=o[t]&&(!o[t+1]||e<=o[t+1])&&this.activate(n[t])},n.prototype.activate=function(t){this.activeTarget=t,s(this.selector).parents(".active").removeClass("active");var e=this.selector+'[data-target="'+t+'"],'+this.selector+'[href="'+t+'"]',i=s(e).parents("li").addClass("active");i.parent(".dropdown-menu").length&&(i=i.closest("li.dropdown").addClass("active")),i.trigger("activate")};var t=s.fn.scrollspy;s.fn.scrollspy=function(o){return this.each(function(){var t=s(this),e=t.data("bs.scrollspy"),i="object"==typeof o&&o;e||t.data("bs.scrollspy",e=new n(this,i)),"string"==typeof o&&e[o]()})},s.fn.scrollspy.Constructor=n,s.fn.scrollspy.noConflict=function(){return s.fn.scrollspy=t,this},s(window).on("load",function(){s('[data-spy="scroll"]').each(function(){var t=s(this);t.scrollspy(t.data())})})}(window.jQuery),function(a){"use strict";var o=function(t){this.element=a(t)};o.prototype.show=function(){var t=this.element,e=t.closest("ul:not(.dropdown-menu)"),i=t.attr("data-target");if(i||(i=(i=t.attr("href"))&&i.replace(/.*(?=#[^\s]*$)/,"")),!t.parent("li").hasClass("active")){var o=e.find(".active:last a")[0],n=a.Event("show.bs.tab",{relatedTarget:o});if(t.trigger(n),!n.isDefaultPrevented()){var s=a(i);this.activate(t.parent("li"),e),this.activate(s,s.parent(),function(){t.trigger({type:"shown.bs.tab",relatedTarget:o})})}}},o.prototype.activate=function(t,e,i){var o=e.find("> .active"),n=i&&a.support.transition&&o.hasClass("fade");function s(){o.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),t.addClass("active"),n?(t[0].offsetWidth,t.addClass("in")):t.removeClass("fade"),t.parent(".dropdown-menu")&&t.closest("li.dropdown").addClass("active"),i&&i()}n?o.one(a.support.transition.end,s).emulateTransitionEnd(150):s(),o.removeClass("in")};var t=a.fn.tab;a.fn.tab=function(i){return this.each(function(){var t=a(this),e=t.data("bs.tab");e||t.data("bs.tab",e=new o(this)),"string"==typeof i&&e[i]()})},a.fn.tab.Constructor=o,a.fn.tab.noConflict=function(){return a.fn.tab=t,this},a(document).on("click.bs.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(t){t.preventDefault(),a(this).tab("show")})}(window.jQuery),function(r){"use strict";var l=function(t,e){this.options=r.extend({},l.DEFAULTS,e),this.$window=r(window).on("scroll.bs.affix.data-api",r.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",r.proxy(this.checkPositionWithEventLoop,this)),this.$element=r(t),this.affixed=this.unpin=null,this.checkPosition()};l.RESET="affix affix-top affix-bottom",l.DEFAULTS={offset:0},l.prototype.checkPositionWithEventLoop=function(){setTimeout(r.proxy(this.checkPosition,this),1)},l.prototype.checkPosition=function(){if(this.$element.is(":visible")){var t=r(document).height(),e=this.$window.scrollTop(),i=this.$element.offset(),o=this.options.offset,n=o.top,s=o.bottom;"object"!=typeof o&&(s=n=o),"function"==typeof n&&(n=o.top()),"function"==typeof s&&(s=o.bottom());var a=!(null!=this.unpin&&e+this.unpin<=i.top)&&(null!=s&&i.top+this.$element.height()>=t-s?"bottom":null!=n&&e<=n&&"top");this.affixed!==a&&(this.unpin&&this.$element.css("top",""),this.affixed=a,this.unpin="bottom"==a?i.top-e:null,this.$element.removeClass(l.RESET).addClass("affix"+(a?"-"+a:"")),"bottom"==a&&this.$element.offset({top:document.body.offsetHeight-s-this.$element.height()}))}};var t=r.fn.affix;r.fn.affix=function(o){return this.each(function(){var t=r(this),e=t.data("bs.affix"),i="object"==typeof o&&o;e||t.data("bs.affix",e=new l(this,i)),"string"==typeof o&&e[o]()})},r.fn.affix.Constructor=l,r.fn.affix.noConflict=function(){return r.fn.affix=t,this},r(window).on("load",function(){r('[data-spy="affix"]').each(function(){var t=r(this),e=t.data();e.offset=e.offset||{},e.offsetBottom&&(e.offset.bottom=e.offsetBottom),e.offsetTop&&(e.offset.top=e.offsetTop),t.affix(e)})})}(window.jQuery);
!function(ne){jQuery.fn.areaPicker=function(e){var te=jQuery.extend({source:null,preSelectedItems:null,enabledItems:null,selectedItemsContainer:jQuery("#selectedAreas"),selectedItemsLabel:jQuery("#selectedAreasLabel"),autoCompleteMatchValues:jQuery("#autoCompleteMatchValues"),areaPickerExpandAllButtonClass:".areaPickerExpandAllButtonClass",areaPickerExpandAll:jQuery("#areaPickerExpandAll"),areaPickerExpandAllContainer:jQuery("#areaPickerExpandAllContainer"),numberOfColumnsExpandedMode:null,outerContainer:jQuery("#areaPickerContainer"),omitAreaTypesInExpandedMode:"",expandSubAreasButton:"&nbsp;+&nbsp;",closeSubAreasButton:"&nbsp;&minus;&nbsp;",defaultAutocompleteValue:"City / Neighborhood / Zip",autocompleteTextLength:3,autocompleteMessage:"Enter a city, neighborhood or zip.",customAreaListToggle:jQuery("#areaPickerCustomListToggle"),customAreaListToggleMoreAreasText:"&nbsp;More Areas",customAreaListToggleLessAreasText:"&nbsp;Limit Areas",areaPickerClearAll:jQuery("#areaPickerClearAll"),isPhpStyle:"false",autocompleteRequestUrl:null,searchType:"basic",restrictCitySearchToCustomList:"false"},e);return this.each(function(){var l=jQuery(this),e=te.source,t=te.preSelectedItems,n=te.enabledItems,s=!0,d=te.selectedItemsContainer,r=te.selectedItemsLabel,f=te.autoCompleteMatchValues,a=te.areaPickerExpandAllButtonClass,c=te.areaPickerExpandAll,u=te.areaPickerExpandAllContainer,b=te.omitAreaTypesInExpandedMode,i=te.defaultAutocompleteValue,o=te.autocompleteMessage,p=te.autocompleteTextLength,v=te.outerContainer,A=te.numberOfColumnsExpandedMode,m=te.customAreaListToggle,h=te.customAreaListToggleMoreAreasText,y=te.customAreaListToggleLessAreasText,C=te.areaPickerClearAll,j=!1;"true"===te.isPhpStyle.toLowerCase()&&(j=!0);var g,Q=te.autocompleteRequestUrl,k=te.searchType,x=!1;"true"===te.restrictCitySearchToCustomList.toLowerCase()&&(x=!0),x&&(m.hide(),y=h=""),null!==n&&void 0!==n.areas&&(s=!1);var P,E,L={},T={},_=-1,S=!0;m.html(h),null!=e&&void 0!==e.allAreas&&(P=e.allAreas.values),null!=e&&void 0!==e.customAreas&&(E=e.customAreas.values);var I=function(){g.is(":visible")?m.html(y):m.html(h)},w=function(e){if(e)for(var a=0;a<e.length;a++){var r=e[a];W(r),K(r)}},N=function(e){if(e)for(var a=0;a<e.length;a++){var r=e[a];X(r)}},M=function(e){if(s)return!0;var a=ee(e),r=T[a];return null!=r},O=function(e,a,r){for(var l=0,t=0;t<e.length;t++){var n=e[t];if(""!==n.label||""!==n.fieldName||""===n.groupLabel){if(-1==b.indexOf(n.fieldName)){null!=A&&l%A==0&&a.append("<div class='areaPickerExpandAllRow' style='clear:both'></div>"),l++;var s=r(n),u="areaPickerExpandAllElement";M(n)||(u="areaPickerExpandAllElementDisabled");var i=jQuery("<div/>",{class:u}),o=jQuery("<div/>",{id:s,class:"areaUnselected"});if(o.append(n.label),i.append(o),a.append(i),null!=n.subAreas&&null!=n.subAreas.values&&0<n.subAreas.values.length){var d=r(n)+"_expand_all_sub_areas",c=jQuery("<span/>");c.html(te.expandSubAreasButton);var p=jQuery("<div/>",{id:d,class:"areaPickerExpandAllSubAreaContainer"}),v=jQuery("<div/>",{style:"float:left"});v.append(c),o.css("float","left"),o.addClass("areaPickerElementHasSubAreas"),o.parent().append(v),p.append(jQuery("<div/>",{style:"clear:both"})),a.append(p);for(var f=n.subAreas.values,m=0;m<f.length;m++){var h=f[m];h.parentLabel=n.label;var y=r(h);y=y.replace(" ","_"),p.append("<div id='"+y+"' class='areaPickerExpandAllSubAreaElement'>"+h.label+"</div>"),$(h,y)}p.append("<div style='clear:both;'></div>"),p.hide(),z(c,d)}$(n,s)}}else a.append("<div style='clear:both'></div>"),a.append("<div class='areaPickerExpandAllGroup'>"+n.groupLabel+"</div>"),l=0}},D=function(e){return e.fieldName+"_expand_all_areas_"+e.uniqueId},U=function(e){return e.fieldName+"_expand_custom_areas_"+e.uniqueId},B=function(e){var a=e.fieldName+"_autocomplete_"+e.uniqueId;return a.replace(" ","_"),a},R=function(a){var e={fieldName:"cityId",maxResults:0},r=Q;S||(e.onlyCustomAreasIfAvailable=!1),jQuery("body *").css("cursor","progress"),jQuery.ajax({type:"GET",url:r,data:e,traditional:!0,dataType:"jsonp"}).done(function(e){jQuery("body *").css("cursor",""),jQuery("#areaPickerCustomListToggle").css("cursor","pointer"),jQuery("#areaPickerClearAll").css("cursor","pointer"),jQuery("#ihf-main-search-form-submit").css("cursor","pointer"),jQuery(".ihf-advanced-search-launch").css("cursor","pointer"),P=e,jQuery("#areaPickerExpandAllResults").empty(),O(P,g,D),H(!1),re(!0),a&&c.toggle(),S?(S=!1,m.html(h)):(S=!0,m.html(y)),q()})},q=function(){x?m.hide():(m.show(),m.unbind("click"),m.click(function(e){R(!1)}))},V=function(e,a){if(null!==e&&e.length>=p){var r={term:e,onlyCustomAreasIfAvailable:x},l=jQuery("[name='propertyType']").val();(void 0!==l&&-1===l.search(/SFR|CND/)||"advanced"===k)&&(r.fieldName=["cityId","zip"]);var t=Q;jQuery.ajax({type:"GET",url:t,data:r,traditional:!0,dataType:"jsonp"}).done(function(e){a(e)})}},G=function(e,a){var r=jQuery("#"+a);r.click(function(){J(e)}),r.mouseover(function(){r.addClass("autocompleteMouseOver")}),r.mouseout(function(){r.removeClass("autocompleteMouseOver")})},$=function(e,a){if(M(e)){var r=jQuery("#"+a);r.click(function(){K(e),f.html(o)}),r.mouseenter(function(){r.addClass("autocompleteMouseOver")}),r.mouseout(function(){r.removeClass("autocompleteMouseOver")})}},z=function(e,a){e.click(function(){!function(e,a){var r=jQuery("#"+e);r.toggle(),r.is(":visible")?(ne(a).removeClass(),ne(a).html(te.closeSubAreasButton)):(ne(a).removeClass(),ne(a).html(te.expandSubAreasButton))}(a,this)})},H=function(e){F(),re(e)},F=function(){f.parent().hide(),_=-1},Z=function(){for(var e in L){var a=L[e];J(a)}},J=function(n){d.find("input:hidden").each(function(e){if($hidden=jQuery(this),$hidden.val()==n.value){$hidden.parent().remove();var a=D(n),r=jQuery("#"+a);r.removeClass("areaSelected"),r.addClass("areaUnselected"),$(n,a);var l=U(n),t=jQuery("#"+l);t.removeClass("areaSelected"),t.addClass("areaUnselected"),$(n,l),H(!0),Y(n),re(!0)}})},K=function(e){var a=jQuery("<div/>");a.addClass("ihf-one-selectedArea");var r=e.fieldName;j&&(r+="[]");var l=jQuery("<input type='hidden' data-ihf-location-field='true' value='"+e.value+"' name='"+r+"'/>"),t=e.label;null!=e.parentLabel&&(t+="&nbsp;("+e.parentLabel+")"),null!=e.fieldLabel&&(t+="&nbsp;("+e.fieldLabel+")");var n=jQuery("<button class='btn' type='button'> &times;&nbsp;"+t+"</button>");n.click(function(){J(e)}),a.append(l),a.append(n),d.append(a),H(!0),W(e);var s=D(e),u=jQuery("#"+s);u.addClass("areaSelected"),u.removeClass("areaUnselected"),u.unbind("click"),G(e,s);var i=U(e),o=jQuery("#"+i);o.addClass("areaSelected"),o.removeClass("areaUnselected"),o.unbind("click"),G(e,i),re(!0)},W=function(e){var a=ee(e);L[a]=e,r.show()},X=function(e){var a=ee(e);T[a]=e},Y=function(e){var a=ee(e);delete L[a],jQuery.isEmptyObject(L)&&r.hide()},ee=function(e){return e.fieldName+e.value},ae=function(e){var a=ee(e);return void 0!==L[a]},re=function(e){l.val(""),l.blur(),e&&l.focus()},le=function(e,d){if(13!=d.which){var a=e.value;a.length>=p?V(a,function(e){if(38==d.which?0<_&&_--:40==d.which?_<e.length&&_++:(f.text(""),f.parent().show(),c.hide(),function(e){for(var a=0;a<e.length;a++){var r=e[a];matchDivId=B(r);var l=jQuery("<div/>",{id:matchDivId}),t="areaPickerElement";if(M(r)||(t="areaPickerElementDisabled"),l.addClass(t),l.addClass("areaUnselected"),l.append(r.label),M(r)||l.append(" (None)"),null!=r.parentLabel&&l.append("&nbsp;("+r.parentLabel+")"),null!=r.fieldLabel&&l.append("&nbsp;("+r.fieldLabel+")"),f.append(l),null!=r.subAreas&&null!=r.subAreas.values&&0<r.subAreas.values.length){var n=r.fieldName+"_auto_complete_sub_areas_"+r.uniqueId,s=jQuery("<span/>");s.html(te.expandSubAreasButton);var u=ne("<div/>",{id:n}),i=jQuery("<div/>",{style:"float:left"});i.append(s),l.css("float","left"),f.append(i).append(jQuery("<div/>",{style:"clear:both"})),l.addClass("areaPickerElementHasSubAreas"),f.append(u);for(var o=r.subAreas.values,d=0;d<o.length;d++){var c=o[d],p=c.fieldName+"_expand_all_"+c.uniqueId;c.parentLabel=r.label,p=p.replace(" ","_");var v=jQuery("<div/>",{id:p,class:"areaPickerAutoCompleteSubAreaElement"});v.text(c.label),u.append(v),ae(c)?(v.addClass("areaSelected"),v.removeClass("areaUnselected")):$(c,p)}u.hide(),z(s,n)}ae(r)?(l.removeClass("areaUnselected"),l.addClass("areaSelected")):$(r,matchDivId)}}(e)),0<e.length&&_>e.length?_=0:0<e.length&&-1==_?_=0:0==e.length&&(_=-1),-1<_){var a=e[_],r=B(a),l="autocompleteArrowOver";M(a)||(l="autocompleteArrowOverDisabled"),jQuery("#"+r).addClass(l);var t=_-1;if(-1<t){var n=e[t],s=B(n);l="autocompleteArrowOver";M(n)||(l="autocompleteArrowOverDisabled"),jQuery("#"+s).removeClass(l)}var u=_+1;if(u<e.length){var i=e[u],o=B(i);l="autocompleteArrowOver";M(i)||(l="autocompleteArrowOverDisabled"),jQuery("#"+o).removeClass(l)}!function(e,a){var r=e*a,l=f.css("height");if(-1<l.indexOf("px")){var t=l.length-2;l=l.slice(0,t)}var n=f.scrollTop(),s=n+new Number(l);(r<n||s<r)&&f.scrollTop(r)}(_,15)}}):F()}};l.keyup(function(e){le(this,e)}),l.keydown(function(e){if(13==e.which){e.preventDefault();var a=this.value;V(a,function(e){var a=e[_];M(a)&&void 0!==a&&(ae(a)||K(a),H(!0))})}}),l.click(function(e){l.val(""),l.removeClass("areaPickerDefaultText"),l.addClass("areaPickerActive");var a=jQuery("<div/>",{style:"padding: 2px"}).html(o);f.html(a);l.val();le(this,e)}),jQuery(a).each(function(){jQuery(this).click(function(){void 0===P?R(!0):(H(!1),re(!0),c.toggle())})}),c.mouseleave(function(){}),jQuery(document).click(function(e){if("image "==e.target.type&&e.target.form&&"INPUT"==e.target.nodeName){var a=jQuery(l).val();V(a,function(e){e&&1==e.length&&K(e[0])})}jQuery(e.target).hasClass("expand-sub-areas")||jQuery(e.target).hasClass("close-sub-areas")||-1==jQuery(e.target).parents().index(v)&&(c.hide(),H(!1))}),function(){if(l.attr("autocomplete","off"),re(!1),l.val(i),l.addClass("areaPickerDefaultText"),v.click(function(e){re(!0)}),!s){var e=n.areas.values;N(e)}if(C.click(function(e){Z()}),g=jQuery("<div/>",{id:"areaPickerExpandAllResults"}),u.append(g),null!=P&&O(P,g,D),void 0!==E){var a=jQuery("<div/>",{id:"areaPickerExpandCustomResults"});u.append(a),O(E,a,U),g.hide(),I(),m.click(function(e){g.toggle(),a.toggle(),I()})}else m.hide();if(void 0!==t&&null!=t&&void 0!==t.areas&&null!=t.areas){var r=t.areas.values;w(r)}}()})}}(jQuery);
(function(){var l,i,r,n,o={}.hasOwnProperty;(n=function(){function t(){this.options_index=0,this.parsed=[]}return t.prototype.add_node=function(t){return"OPTGROUP"===t.nodeName.toUpperCase()?this.add_group(t):this.add_option(t)},t.prototype.add_group=function(t){var e,s,i,r,o,n;for(e=this.parsed.length,this.parsed.push({array_index:e,group:!0,label:this.escapeExpression(t.label),children:0,disabled:t.disabled,classes:t.className}),n=[],i=0,r=(o=t.childNodes).length;i<r;i++)s=o[i],n.push(this.add_option(s,e,t.disabled));return n},t.prototype.add_option=function(t,e,s){return"OPTION"===t.nodeName.toUpperCase()?(""!==t.text?(null!=e&&(this.parsed[e].children+=1),this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,value:t.value,text:t.text,html:t.innerHTML,selected:t.selected,disabled:!0===s?s:t.disabled,group_array_index:e,classes:t.className,style:t.style.cssText})):this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,empty:!0}),this.options_index+=1):void 0},t.prototype.escapeExpression=function(t){var e,s;return null==t||!1===t?"":/[\&\<\>\"\'\`]/.test(t)?(e={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},s=/&(?!\w+;)|[\<\>\"\'\`]/g,t.replace(s,function(t){return e[t]||"&amp;"})):t},t}()).select_to_array=function(t){var e,s,i,r,o;for(s=new n,i=0,r=(o=t.childNodes).length;i<r;i++)e=o[i],s.add_node(e);return s.parsed},i=function(){function s(t,e){this.form_field=t,this.options=null!=e?e:{},s.browser_is_supported()&&(this.is_multiple=this.form_field.multiple,this.set_default_text(),this.set_default_values(),this.setup(),this.set_up_html(),this.register_observers(),this.on_ready())}return s.prototype.set_default_values=function(){var e=this;return this.click_test_action=function(t){return e.test_active_click(t)},this.activate_action=function(t){return e.activate_field(t)},this.active_field=!1,this.mouse_on_container=!1,this.results_showing=!1,this.result_highlighted=null,this.allow_single_deselect=null!=this.options.allow_single_deselect&&null!=this.form_field.options[0]&&""===this.form_field.options[0].text&&this.options.allow_single_deselect,this.disable_search_threshold=this.options.disable_search_threshold||0,this.disable_search=this.options.disable_search||!1,this.enable_split_word_search=null==this.options.enable_split_word_search||this.options.enable_split_word_search,this.group_search=null==this.options.group_search||this.options.group_search,this.search_contains=this.options.search_contains||!1,this.single_backstroke_delete=null==this.options.single_backstroke_delete||this.options.single_backstroke_delete,this.max_selected_options=this.options.max_selected_options||1/0,this.inherit_select_classes=this.options.inherit_select_classes||!1,this.display_selected_options=null==this.options.display_selected_options||this.options.display_selected_options,this.display_disabled_options=null==this.options.display_disabled_options||this.options.display_disabled_options},s.prototype.set_default_text=function(){return this.default_text=this.form_field.getAttribute("data-placeholder")?this.form_field.getAttribute("data-placeholder"):this.is_multiple?this.options.placeholder_text_multiple||this.options.placeholder_text||s.default_multiple_text:this.options.placeholder_text_single||this.options.placeholder_text||s.default_single_text,this.results_none_found=this.form_field.getAttribute("data-no_results_text")||this.options.no_results_text||s.default_no_result_text},s.prototype.mouse_enter=function(){return this.mouse_on_container=!0},s.prototype.mouse_leave=function(){return this.mouse_on_container=!1},s.prototype.input_focus=function(){var t=this;if(this.is_multiple){if(!this.active_field)return setTimeout(function(){return t.container_mousedown()},50)}else if(!this.active_field)return this.activate_field()},s.prototype.input_blur=function(){var t=this;return this.mouse_on_container?void 0:(this.active_field=!1,setTimeout(function(){return t.blur_test()},100))},s.prototype.results_option_build=function(t){var e,s,i,r,o;for(e="",i=0,r=(o=this.results_data).length;i<r;i++)e+=(s=o[i]).group?this.result_add_group(s):this.result_add_option(s),(null!=t?t.first:void 0)&&(s.selected&&this.is_multiple?this.choice_build(s):s.selected&&!this.is_multiple&&this.single_set_selected_text(s.text));return e},s.prototype.result_add_option=function(t){var e,s;return t.search_match&&this.include_option_in_results(t)?(e=[],t.disabled||t.selected&&this.is_multiple||e.push("active-result"),!t.disabled||t.selected&&this.is_multiple||e.push("disabled-result"),t.selected&&e.push("result-selected"),null!=t.group_array_index&&e.push("group-option"),""!==t.classes&&e.push(t.classes),(s=document.createElement("li")).className=e.join(" "),s.style.cssText=t.style,s.setAttribute("data-option-array-index",t.array_index),s.innerHTML=t.search_text,this.outerHTML(s)):""},s.prototype.result_add_group=function(t){var e,s;return(t.search_match||t.group_match)&&0<t.active_options?((e=[]).push("group-result"),t.classes&&e.push(t.classes),(s=document.createElement("li")).className=e.join(" "),s.innerHTML=t.search_text,this.outerHTML(s)):""},s.prototype.results_update_field=function(){return this.set_default_text(),this.is_multiple||this.results_reset_cleanup(),this.result_clear_highlight(),this.results_build(),this.results_showing?this.winnow_results():void 0},s.prototype.reset_single_select_options=function(){var t,e,s,i,r;for(r=[],e=0,s=(i=this.results_data).length;e<s;e++)(t=i[e]).selected?r.push(t.selected=!1):r.push(void 0);return r},s.prototype.results_toggle=function(){return this.results_showing?this.results_hide():this.results_show()},s.prototype.results_search=function(){return this.results_showing?this.winnow_results():this.results_show()},s.prototype.winnow_results=function(){var t,e,s,i,r,o,n,h,l,c,a,_;for(this.no_results_clear(),i=0,t=(o=this.get_search_text()).replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),l=new RegExp(t,"i"),s=this.get_search_regex(t),c=0,a=(_=this.results_data).length;c<a;c++)(e=_[c]).search_match=!1,r=null,this.include_option_in_results(e)&&(e.group&&(e.group_match=!1,e.active_options=0),null!=e.group_array_index&&this.results_data[e.group_array_index]&&(0===(r=this.results_data[e.group_array_index]).active_options&&r.search_match&&(i+=1),r.active_options+=1),(!e.group||this.group_search)&&(e.search_text=e.group?e.label:e.text,e.search_match=this.search_string_match(e.search_text,s),e.search_match&&!e.group&&(i+=1),e.search_match?(o.length&&(n=e.search_text.search(l),h=e.search_text.substr(0,n+o.length)+"</em>"+e.search_text.substr(n+o.length),e.search_text=h.substr(0,n)+"<em>"+h.substr(n)),null!=r&&(r.group_match=!0)):null!=e.group_array_index&&this.results_data[e.group_array_index].search_match&&(e.search_match=!0)));return this.result_clear_highlight(),i<1&&o.length?(this.update_results_content(""),this.no_results(o)):(this.update_results_content(this.results_option_build()),this.winnow_results_set_highlight())},s.prototype.get_search_regex=function(t){var e;return e=this.search_contains?"":"^",new RegExp(e+t,"i")},s.prototype.search_string_match=function(t,e){var s,i,r,o;if(e.test(t))return!0;if(this.enable_split_word_search&&(0<=t.indexOf(" ")||0===t.indexOf("["))&&(i=t.replace(/\[|\]/g,"").split(" ")).length)for(r=0,o=i.length;r<o;r++)if(s=i[r],e.test(s))return!0},s.prototype.choices_count=function(){var t,e,s;if(null!=this.selected_option_count)return this.selected_option_count;for(t=this.selected_option_count=0,e=(s=this.form_field.options).length;t<e;t++)s[t].selected&&(this.selected_option_count+=1);return this.selected_option_count},s.prototype.choices_click=function(t){return t.preventDefault(),this.results_showing||this.is_disabled?void 0:this.results_show()},s.prototype.keyup_checker=function(t){var e,s;switch(e=null!=(s=t.which)?s:t.keyCode,this.search_field_scale(),e){case 8:if(this.is_multiple&&this.backstroke_length<1&&0<this.choices_count())return this.keydown_backstroke();if(!this.pending_backstroke)return this.result_clear_highlight(),this.results_search();break;case 13:if(t.preventDefault(),this.results_showing)return this.result_select(t);break;case 27:return this.results_showing&&this.results_hide(),!0;case 9:case 38:case 40:case 16:case 91:case 17:break;default:return this.results_search()}},s.prototype.clipboard_event_checker=function(){var t=this;return setTimeout(function(){return t.results_search()},50)},s.prototype.container_width=function(){return null!=this.options.width?this.options.width:this.form_field.offsetWidth+"px"},s.prototype.include_option_in_results=function(t){return!(this.is_multiple&&!this.display_selected_options&&t.selected)&&(!(!this.display_disabled_options&&t.disabled)&&!t.empty)},s.prototype.search_results_touchstart=function(t){return this.touch_started=!0,this.search_results_mouseover(t)},s.prototype.search_results_touchmove=function(t){return this.touch_started=!1,this.search_results_mouseout(t)},s.prototype.search_results_touchend=function(t){return this.touch_started?this.search_results_mouseup(t):void 0},s.prototype.outerHTML=function(t){var e;return t.outerHTML?t.outerHTML:((e=document.createElement("div")).appendChild(t),e.innerHTML)},s.browser_is_supported=function(){return"Microsoft Internet Explorer"===window.navigator.appName?8<=document.documentMode:!/iP(od|hone)/i.test(window.navigator.userAgent)&&(!/Android/i.test(window.navigator.userAgent)||!/Mobile/i.test(window.navigator.userAgent))},s.default_multiple_text="Select Some Options",s.default_single_text="Select an Option",s.default_no_result_text="No results match",s}(),(l=jQuery).fn.extend({chosen:function(s){return i.browser_is_supported()?this.each(function(){var t,e;e=(t=l(this)).data("chosen"),"destroy"===s&&e instanceof r?e.destroy():e instanceof r||t.data("chosen",new r(this,s))}):this}}),r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return function(t,e){function s(){this.constructor=t}for(var i in e)o.call(e,i)&&(t[i]=e[i]);s.prototype=e.prototype,t.prototype=new s,t.__super__=e.prototype}(e,i),e.prototype.setup=function(){return this.form_field_jq=l(this.form_field),this.current_selectedIndex=this.form_field.selectedIndex,this.is_rtl=this.form_field_jq.hasClass("chosen-rtl")},e.prototype.set_up_html=function(){var t,e;return(t=["chosen-container"]).push("chosen-container-"+(this.is_multiple?"multi":"single")),this.inherit_select_classes&&this.form_field.className&&t.push(this.form_field.className),this.is_rtl&&t.push("chosen-rtl"),e={class:t.join(" "),style:"width: "+this.container_width()+";",title:this.form_field.title},this.form_field.id.length&&(e.id=this.form_field.id.replace(/[^\w]/g,"_")+"_chosen"),this.container=l("<div />",e),this.is_multiple?this.container.html('<ul class="chosen-choices"><li class="search-field"><input type="text" value="'+this.default_text+'" class="default" autocomplete="off" style="width:25px;" /></li></ul><div class="chosen-drop"><ul class="chosen-results"></ul></div>'):this.container.html('<a class="chosen-single chosen-default" tabindex="-1"><span>'+this.default_text+'</span><div><b></b></div></a><div class="chosen-drop"><div class="chosen-search"><input type="text" autocomplete="off" /></div><ul class="chosen-results"></ul></div>'),this.form_field_jq.hide().after(this.container),this.dropdown=this.container.find("div.chosen-drop").first(),this.search_field=this.container.find("input").first(),this.search_results=this.container.find("ul.chosen-results").first(),this.search_field_scale(),this.search_no_results=this.container.find("li.no-results").first(),this.is_multiple?(this.search_choices=this.container.find("ul.chosen-choices").first(),this.search_container=this.container.find("li.search-field").first()):(this.search_container=this.container.find("div.chosen-search").first(),this.selected_item=this.container.find(".chosen-single").first()),this.results_build(),this.set_tab_index(),this.set_label_behavior()},e.prototype.on_ready=function(){return this.form_field_jq.trigger("chosen:ready",{chosen:this})},e.prototype.register_observers=function(){var e=this;return this.container.bind("touchstart.chosen",function(t){e.container_mousedown(t)}),this.container.bind("touchend.chosen",function(t){e.container_mouseup(t)}),this.container.bind("mousedown.chosen",function(t){e.container_mousedown(t)}),this.container.bind("mouseup.chosen",function(t){e.container_mouseup(t)}),this.container.bind("mouseenter.chosen",function(t){e.mouse_enter(t)}),this.container.bind("mouseleave.chosen",function(t){e.mouse_leave(t)}),this.search_results.bind("mouseup.chosen",function(t){e.search_results_mouseup(t)}),this.search_results.bind("mouseover.chosen",function(t){e.search_results_mouseover(t)}),this.search_results.bind("mouseout.chosen",function(t){e.search_results_mouseout(t)}),this.search_results.bind("mousewheel.chosen DOMMouseScroll.chosen",function(t){e.search_results_mousewheel(t)}),this.search_results.bind("touchstart.chosen",function(t){e.search_results_touchstart(t)}),this.search_results.bind("touchmove.chosen",function(t){e.search_results_touchmove(t)}),this.search_results.bind("touchend.chosen",function(t){e.search_results_touchend(t)}),this.form_field_jq.bind("chosen:updated.chosen",function(t){e.results_update_field(t)}),this.form_field_jq.bind("chosen:activate.chosen",function(t){e.activate_field(t)}),this.form_field_jq.bind("chosen:open.chosen",function(t){e.container_mousedown(t)}),this.form_field_jq.bind("chosen:close.chosen",function(t){e.input_blur(t)}),this.search_field.bind("blur.chosen",function(t){e.input_blur(t)}),this.search_field.bind("keyup.chosen",function(t){e.keyup_checker(t)}),this.search_field.bind("keydown.chosen",function(t){e.keydown_checker(t)}),this.search_field.bind("focus.chosen",function(t){e.input_focus(t)}),this.search_field.bind("cut.chosen",function(t){e.clipboard_event_checker(t)}),this.search_field.bind("paste.chosen",function(t){e.clipboard_event_checker(t)}),this.is_multiple?this.search_choices.bind("click.chosen",function(t){e.choices_click(t)}):this.container.bind("click.chosen",function(t){t.preventDefault()})},e.prototype.destroy=function(){return l(this.container[0].ownerDocument).unbind("click.chosen",this.click_test_action),this.search_field[0].tabIndex&&(this.form_field_jq[0].tabIndex=this.search_field[0].tabIndex),this.container.remove(),this.form_field_jq.removeData("chosen"),this.form_field_jq.show()},e.prototype.search_field_disabled=function(){return this.is_disabled=this.form_field_jq[0].disabled,this.is_disabled?(this.container.addClass("chosen-disabled"),this.search_field[0].disabled=!0,this.is_multiple||this.selected_item.unbind("focus.chosen",this.activate_action),this.close_field()):(this.container.removeClass("chosen-disabled"),this.search_field[0].disabled=!1,this.is_multiple?void 0:this.selected_item.bind("focus.chosen",this.activate_action))},e.prototype.container_mousedown=function(t){return this.is_disabled||(t&&"mousedown"===t.type&&!this.results_showing&&t.preventDefault(),null!=t&&l(t.target).hasClass("search-choice-close"))?void 0:(this.active_field?this.is_multiple||!t||l(t.target)[0]!==this.selected_item[0]&&!l(t.target).parents("a.chosen-single").length||(t.preventDefault(),this.results_toggle()):(this.is_multiple&&this.search_field.val(""),l(this.container[0].ownerDocument).bind("click.chosen",this.click_test_action),this.results_show()),this.activate_field())},e.prototype.container_mouseup=function(t){return"ABBR"!==t.target.nodeName||this.is_disabled?void 0:this.results_reset(t)},e.prototype.search_results_mousewheel=function(t){var e;return t.originalEvent&&(e=t.originalEvent.deltaY||-t.originalEvent.wheelDelta||t.originalEvent.detail),null!=e?(t.preventDefault(),"DOMMouseScroll"===t.type&&(e*=40),this.search_results.scrollTop(e+this.search_results.scrollTop())):void 0},e.prototype.blur_test=function(){return!this.active_field&&this.container.hasClass("chosen-container-active")?this.close_field():void 0},e.prototype.close_field=function(){return l(this.container[0].ownerDocument).unbind("click.chosen",this.click_test_action),this.active_field=!1,this.results_hide(),this.container.removeClass("chosen-container-active"),this.clear_backstroke(),this.show_search_field_default(),this.search_field_scale()},e.prototype.activate_field=function(){return this.container.addClass("chosen-container-active"),this.active_field=!0,this.search_field.val(this.search_field.val()),this.search_field.focus()},e.prototype.test_active_click=function(t){var e;return(e=l(t.target).closest(".chosen-container")).length&&this.container[0]===e[0]?this.active_field=!0:this.close_field()},e.prototype.results_build=function(){return this.parsing=!0,this.selected_option_count=null,this.results_data=n.select_to_array(this.form_field),this.is_multiple?this.search_choices.find("li.search-choice").remove():this.is_multiple||(this.single_set_selected_text(),this.disable_search||this.form_field.options.length<=this.disable_search_threshold?(this.search_field[0].readOnly=!0,this.container.addClass("chosen-container-single-nosearch")):(this.search_field[0].readOnly=!1,this.container.removeClass("chosen-container-single-nosearch"))),this.update_results_content(this.results_option_build({first:!0})),this.search_field_disabled(),this.show_search_field_default(),this.search_field_scale(),this.parsing=!1},e.prototype.result_do_highlight=function(t){var e,s,i,r;if(t.length){if(this.result_clear_highlight(),this.result_highlight=t,this.result_highlight.addClass("highlighted"),(i=parseInt(this.search_results.css("maxHeight"),10))+(r=this.search_results.scrollTop())<=(e=(s=this.result_highlight.position().top+this.search_results.scrollTop())+this.result_highlight.outerHeight()))return this.search_results.scrollTop(0<e-i?e-i:0);if(s<r)return this.search_results.scrollTop(s)}},e.prototype.result_clear_highlight=function(){return this.result_highlight&&this.result_highlight.removeClass("highlighted"),this.result_highlight=null},e.prototype.results_show=function(){return this.is_multiple&&this.max_selected_options<=this.choices_count()?(this.form_field_jq.trigger("chosen:maxselected",{chosen:this}),!1):(this.container.addClass("chosen-with-drop"),this.results_showing=!0,this.search_field.focus(),this.search_field.val(this.search_field.val()),this.winnow_results(),this.form_field_jq.trigger("chosen:showing_dropdown",{chosen:this}))},e.prototype.update_results_content=function(t){return this.search_results.html(t)},e.prototype.results_hide=function(){return this.results_showing&&(this.result_clear_highlight(),this.container.removeClass("chosen-with-drop"),this.form_field_jq.trigger("chosen:hiding_dropdown",{chosen:this})),this.results_showing=!1},e.prototype.set_tab_index=function(){var t;return this.form_field.tabIndex?(t=this.form_field.tabIndex,this.form_field.tabIndex=-1,this.search_field[0].tabIndex=t):void 0},e.prototype.set_label_behavior=function(){var e=this;return this.form_field_label=this.form_field_jq.parents("label"),!this.form_field_label.length&&this.form_field.id.length&&(this.form_field_label=l("label[for='"+this.form_field.id+"']")),0<this.form_field_label.length?this.form_field_label.bind("click.chosen",function(t){return e.is_multiple?e.container_mousedown(t):e.activate_field()}):void 0},e.prototype.show_search_field_default=function(){return this.is_multiple&&this.choices_count()<1&&!this.active_field?(this.search_field.val(this.default_text),this.search_field.addClass("default")):(this.search_field.val(""),this.search_field.removeClass("default"))},e.prototype.search_results_mouseup=function(t){var e;return(e=l(t.target).hasClass("active-result")?l(t.target):l(t.target).parents(".active-result").first()).length?(this.result_highlight=e,this.result_select(t),this.search_field.focus()):void 0},e.prototype.search_results_mouseover=function(t){var e;return(e=l(t.target).hasClass("active-result")?l(t.target):l(t.target).parents(".active-result").first())?this.result_do_highlight(e):void 0},e.prototype.search_results_mouseout=function(t){return l(t.target).hasClass("active-result")?this.result_clear_highlight():void 0},e.prototype.choice_build=function(t){var e,s,i=this;return e=l("<li />",{class:"search-choice"}).html("<span>"+t.html+"</span>"),t.disabled?e.addClass("search-choice-disabled"):((s=l("<a />",{class:"search-choice-close","data-option-array-index":t.array_index})).bind("click.chosen",function(t){return i.choice_destroy_link_click(t)}),e.append(s)),this.search_container.before(e)},e.prototype.choice_destroy_link_click=function(t){return t.preventDefault(),t.stopPropagation(),this.is_disabled?void 0:this.choice_destroy(l(t.target))},e.prototype.choice_destroy=function(t){return this.result_deselect(t[0].getAttribute("data-option-array-index"))?(this.show_search_field_default(),this.is_multiple&&0<this.choices_count()&&this.search_field.val().length<1&&this.results_hide(),t.parents("li").first().remove(),this.search_field_scale()):void 0},e.prototype.results_reset=function(){return this.reset_single_select_options(),this.form_field.options[0].selected=!0,this.single_set_selected_text(),this.show_search_field_default(),this.results_reset_cleanup(),this.form_field_jq.trigger("change"),this.active_field?this.results_hide():void 0},e.prototype.results_reset_cleanup=function(){return this.current_selectedIndex=this.form_field.selectedIndex,this.selected_item.find("abbr").remove()},e.prototype.result_select=function(t){var e,s;return this.result_highlight?(e=this.result_highlight,this.result_clear_highlight(),this.is_multiple&&this.max_selected_options<=this.choices_count()?(this.form_field_jq.trigger("chosen:maxselected",{chosen:this}),!1):(this.is_multiple?e.removeClass("active-result"):this.reset_single_select_options(),(s=this.results_data[e[0].getAttribute("data-option-array-index")]).selected=!0,this.form_field.options[s.options_index].selected=!0,this.selected_option_count=null,this.is_multiple?this.choice_build(s):this.single_set_selected_text(s.text),(t.metaKey||t.ctrlKey)&&this.is_multiple||this.results_hide(),this.search_field.val(""),(this.is_multiple||this.form_field.selectedIndex!==this.current_selectedIndex)&&this.form_field_jq.trigger("change",{selected:this.form_field.options[s.options_index].value}),this.current_selectedIndex=this.form_field.selectedIndex,this.search_field_scale())):void 0},e.prototype.single_set_selected_text=function(t){return null==t&&(t=this.default_text),t===this.default_text?this.selected_item.addClass("chosen-default"):(this.single_deselect_control_build(),this.selected_item.removeClass("chosen-default")),this.selected_item.find("span").text(t)},e.prototype.result_deselect=function(t){var e;return e=this.results_data[t],!this.form_field.options[e.options_index].disabled&&(e.selected=!1,this.form_field.options[e.options_index].selected=!1,this.selected_option_count=null,this.result_clear_highlight(),this.results_showing&&this.winnow_results(),this.form_field_jq.trigger("change",{deselected:this.form_field.options[e.options_index].value}),this.search_field_scale(),!0)},e.prototype.single_deselect_control_build=function(){return this.allow_single_deselect?(this.selected_item.find("abbr").length||this.selected_item.find("span").first().after('<abbr class="search-choice-close"></abbr>'),this.selected_item.addClass("chosen-single-with-deselect")):void 0},e.prototype.get_search_text=function(){return this.search_field.val()===this.default_text?"":l("<div/>").text(l.trim(this.search_field.val())).html()},e.prototype.winnow_results_set_highlight=function(){var t,e;return null!=(t=(e=this.is_multiple?[]:this.search_results.find(".result-selected.active-result")).length?e.first():this.search_results.find(".active-result").first())?this.result_do_highlight(t):void 0},e.prototype.no_results=function(t){var e;return(e=l('<li class="no-results">'+this.results_none_found+' "<span></span>"</li>')).find("span").first().html(t),this.search_results.append(e),this.form_field_jq.trigger("chosen:no_results",{chosen:this})},e.prototype.no_results_clear=function(){return this.search_results.find(".no-results").remove()},e.prototype.keydown_arrow=function(){var t;return this.results_showing&&this.result_highlight?(t=this.result_highlight.nextAll("li.active-result").first())?this.result_do_highlight(t):void 0:this.results_show()},e.prototype.keyup_arrow=function(){var t;return this.results_showing||this.is_multiple?this.result_highlight?(t=this.result_highlight.prevAll("li.active-result")).length?this.result_do_highlight(t.first()):(0<this.choices_count()&&this.results_hide(),this.result_clear_highlight()):void 0:this.results_show()},e.prototype.keydown_backstroke=function(){var t;return this.pending_backstroke?(this.choice_destroy(this.pending_backstroke.find("a").first()),this.clear_backstroke()):(t=this.search_container.siblings("li.search-choice").last()).length&&!t.hasClass("search-choice-disabled")?(this.pending_backstroke=t,this.single_backstroke_delete?this.keydown_backstroke():this.pending_backstroke.addClass("search-choice-focus")):void 0},e.prototype.clear_backstroke=function(){return this.pending_backstroke&&this.pending_backstroke.removeClass("search-choice-focus"),this.pending_backstroke=null},e.prototype.keydown_checker=function(t){var e,s;switch(e=null!=(s=t.which)?s:t.keyCode,this.search_field_scale(),8!==e&&this.pending_backstroke&&this.clear_backstroke(),e){case 8:this.backstroke_length=this.search_field.val().length;break;case 9:this.results_showing&&!this.is_multiple&&this.result_select(t),this.mouse_on_container=!1;break;case 13:this.results_showing&&t.preventDefault();break;case 32:this.disable_search&&t.preventDefault();break;case 38:t.preventDefault(),this.keyup_arrow();break;case 40:t.preventDefault(),this.keydown_arrow()}},e.prototype.search_field_scale=function(){var t,e,s,i,r,o,n,h;if(this.is_multiple){for(i="position:absolute; left: -1000px; top: -1000px; display:none;",n=o=0,h=(r=["font-size","font-style","font-weight","font-family","line-height","text-transform","letter-spacing"]).length;n<h;n++)i+=(s=r[n])+":"+this.search_field.css(s)+";";return(t=l("<div />",{style:i})).text(this.search_field.val()),l("body").append(t),o=t.width()+25,t.remove(),(e=this.container.outerWidth())-10<o&&(o=e-10),this.search_field.css({width:o+"px"})}},e}()}).call(this);
jQuery(document).ready(function(){var e={".ihf-chosen-select":{},".ihf-chosen-select-deselect":{allow_single_deselect:!0},".ihf-chosen-select-no-single":{disable_search_threshold:10},".ihf-chosen-select-no-results":{no_results_text:"Oops, nothing found!"},".ihf-chosen-select-width":{width:"100%",disable_search_threshold:10,placeholder_text_multiple:" ",placeholder_text_single:" "}};for(var s in e)jQuery(s).chosen(e[s])});
!function(l){l.extend(l.fn,{validate:function(t){if(this.length){var i=l.data(this[0],"validator");return i||(this.attr("novalidate","novalidate"),i=new l.validator(t,this[0]),l.data(this[0],"validator",i),i.settings.onsubmit&&(this.validateDelegate(":submit","click",function(t){i.settings.submitHandler&&(i.submitButton=t.target),l(t.target).hasClass("cancel")&&(i.cancelSubmit=!0),void 0!==l(t.target).attr("formnovalidate")&&(i.cancelSubmit=!0)}),this.submit(function(e){function t(){var t;return!i.settings.submitHandler||(i.submitButton&&(t=l("<input type='hidden'/>").attr("name",i.submitButton.name).val(l(i.submitButton).val()).appendTo(i.currentForm)),i.settings.submitHandler.call(i,i.currentForm,e),i.submitButton&&t.remove(),!1)}return i.settings.debug&&e.preventDefault(),i.cancelSubmit?(i.cancelSubmit=!1,t()):i.form()?i.pendingRequest?!(i.formSubmitted=!0):t():(i.focusInvalid(),!1)})),i)}t&&t.debug&&window.console&&console.warn("Nothing selected, can't validate, returning nothing.")},valid:function(){if(l(this[0]).is("form"))return this.validate().form();var t=!0,e=l(this[0].form).validate();return this.each(function(){t=t&&e.element(this)}),t},removeAttrs:function(t){var i={},s=this;return l.each(t.split(/\s/),function(t,e){i[e]=s.attr(e),s.removeAttr(e)}),i},rules:function(t,e){var i=this[0];if(t){var s=l.data(i.form,"validator").settings,r=s.rules,n=l.validator.staticRules(i);switch(t){case"add":l.extend(n,l.validator.normalizeRule(e)),delete n.messages,r[i.name]=n,e.messages&&(s.messages[i.name]=l.extend(s.messages[i.name],e.messages));break;case"remove":if(!e)return delete r[i.name],n;var a={};return l.each(e.split(/\s/),function(t,e){a[e]=n[e],delete n[e]}),a}}var u=l.validator.normalizeRules(l.extend({},l.validator.classRules(i),l.validator.attributeRules(i),l.validator.dataRules(i),l.validator.staticRules(i)),i);if(u.required){var o=u.required;delete u.required,u=l.extend({required:o},u)}return u}}),l.extend(l.expr[":"],{blank:function(t){return!l.trim(""+l(t).val())},filled:function(t){return!!l.trim(""+l(t).val())},unchecked:function(t){return!l(t).prop("checked")}}),l.validator=function(t,e){this.settings=l.extend(!0,{},l.validator.defaults,t),this.currentForm=e,this.init()},l.validator.format=function(i,t){return 1===arguments.length?function(){var t=l.makeArray(arguments);return t.unshift(i),l.validator.format.apply(this,t)}:(2<arguments.length&&t.constructor!==Array&&(t=l.makeArray(arguments).slice(1)),t.constructor!==Array&&(t=[t]),l.each(t,function(t,e){i=i.replace(new RegExp("\\{"+t+"\\}","g"),function(){return e})}),i)},l.extend(l.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"error",validClass:"valid",errorElement:"label",focusInvalid:!0,errorContainer:l([]),errorLabelContainer:l([]),onsubmit:!0,ignore:":hidden",ignoreTitle:!1,onfocusin:function(t,e){this.lastActive=t,this.settings.focusCleanup&&!this.blockFocusCleanup&&(this.settings.unhighlight&&this.settings.unhighlight.call(this,t,this.settings.errorClass,this.settings.validClass),this.addWrapper(this.errorsFor(t)).hide())},onfocusout:function(t,e){this.checkable(t)||!(t.name in this.submitted)&&this.optional(t)||this.element(t)},onkeyup:function(t,e){9===e.which&&""===this.elementValue(t)||(t.name in this.submitted||t===this.lastElement)&&this.element(t)},onclick:function(t,e){t.name in this.submitted?this.element(t):t.parentNode.name in this.submitted&&this.element(t.parentNode)},highlight:function(t,e,i){"radio"===t.type?this.findByName(t.name).addClass(e).removeClass(i):l(t).addClass(e).removeClass(i)},unhighlight:function(t,e,i){"radio"===t.type?this.findByName(t.name).removeClass(e).addClass(i):l(t).removeClass(e).addClass(i)}},setDefaults:function(t){l.extend(l.validator.defaults,t)},messages:{required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date (ISO).",number:"Please enter a valid number.",digits:"Please enter only digits.",creditcard:"Please enter a valid credit card number.",equalTo:"Please enter the same value again.",maxlength:l.validator.format("Please enter no more than {0} characters."),minlength:l.validator.format("Please enter at least {0} characters."),rangelength:l.validator.format("Please enter a value between {0} and {1} characters long."),range:l.validator.format("Please enter a value between {0} and {1}."),max:l.validator.format("Please enter a value less than or equal to {0}."),min:l.validator.format("Please enter a value greater than or equal to {0}.")},autoCreateRanges:!1,prototype:{init:function(){this.labelContainer=l(this.settings.errorLabelContainer),this.errorContext=this.labelContainer.length&&this.labelContainer||l(this.currentForm),this.containers=l(this.settings.errorContainer).add(this.settings.errorLabelContainer),this.submitted={},this.valueCache={},this.pendingRequest=0,this.pending={},this.invalid={},this.reset();var s=this.groups={};l.each(this.settings.groups,function(i,t){"string"==typeof t&&(t=t.split(/\s/)),l.each(t,function(t,e){s[e]=i})});var i=this.settings.rules;function t(t){var e=l.data(this[0].form,"validator"),i="on"+t.type.replace(/^validate/,"");e.settings[i]&&e.settings[i].call(e,this[0],t)}l.each(i,function(t,e){i[t]=l.validator.normalizeRule(e)}),l(this.currentForm).validateDelegate(":text, [type='password'], [type='file'], select, textarea, [type='number'], [type='search'] ,[type='tel'], [type='url'], [type='email'], [type='datetime'], [type='date'], [type='month'], [type='week'], [type='time'], [type='datetime-local'], [type='range'], [type='color'] ","focusin focusout keyup",t).validateDelegate("[type='radio'], [type='checkbox'], select, option","click",t),this.settings.invalidHandler&&l(this.currentForm).bind("invalid-form.validate",this.settings.invalidHandler)},form:function(){return this.checkForm(),l.extend(this.submitted,this.errorMap),this.invalid=l.extend({},this.errorMap),this.valid()||l(this.currentForm).triggerHandler("invalid-form",[this]),this.showErrors(),this.valid()},checkForm:function(){this.prepareForm();for(var t=0,e=this.currentElements=this.elements();e[t];t++)this.check(e[t]);return this.valid()},element:function(t){t=this.validationTargetFor(this.clean(t)),this.lastElement=t,this.prepareElement(t),this.currentElements=l(t);var e=!1!==this.check(t);return e?delete this.invalid[t.name]:this.invalid[t.name]=!0,this.numberOfInvalids()||(this.toHide=this.toHide.add(this.containers)),this.showErrors(),e},showErrors:function(e){if(e){for(var t in l.extend(this.errorMap,e),this.errorList=[],e)this.errorList.push({message:e[t],element:this.findByName(t)[0]});this.successList=l.grep(this.successList,function(t){return!(t.name in e)})}this.settings.showErrors?this.settings.showErrors.call(this,this.errorMap,this.errorList):this.defaultShowErrors()},resetForm:function(){l.fn.resetForm&&l(this.currentForm).resetForm(),this.submitted={},this.lastElement=null,this.prepareForm(),this.hideErrors(),this.elements().removeClass(this.settings.errorClass).removeData("previousValue")},numberOfInvalids:function(){return this.objectLength(this.invalid)},objectLength:function(t){var e=0;for(var i in t)e++;return e},hideErrors:function(){this.addWrapper(this.toHide).hide()},valid:function(){return 0===this.size()},size:function(){return this.errorList.length},focusInvalid:function(){if(this.settings.focusInvalid)try{l(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").focus().trigger("focusin")}catch(t){}},findLastActive:function(){var e=this.lastActive;return e&&1===l.grep(this.errorList,function(t){return t.element.name===e.name}).length&&e},elements:function(){var t=this,e={};return l(this.currentForm).find("input, select, textarea").not(":submit, :reset, :image, [disabled]").not(this.settings.ignore).filter(function(){return!this.name&&t.settings.debug&&window.console&&console.error("%o has no name assigned",this),!(this.name in e||!t.objectLength(l(this).rules()))&&(e[this.name]=!0)})},clean:function(t){return l(t)[0]},errors:function(){var t=this.settings.errorClass.replace(" ",".");return l(this.settings.errorElement+"."+t,this.errorContext)},reset:function(){this.successList=[],this.errorList=[],this.errorMap={},this.toShow=l([]),this.toHide=l([]),this.currentElements=l([])},prepareForm:function(){this.reset(),this.toHide=this.errors().add(this.containers)},prepareElement:function(t){this.reset(),this.toHide=this.errorsFor(t)},elementValue:function(t){var e=l(t).attr("type"),i=l(t).val();return"radio"===e||"checkbox"===e?l("input[name='"+l(t).attr("name")+"']:checked").val():"string"==typeof i?i.replace(/\r/g,""):i},check:function(e){e=this.validationTargetFor(this.clean(e));var t,i=l(e).rules(),s=!1,r=this.elementValue(e);for(var n in i){var a={method:n,parameters:i[n]};try{if("dependency-mismatch"===(t=l.validator.methods[n].call(this,r,e,a.parameters))){s=!0;continue}if(s=!1,"pending"===t)return void(this.toHide=this.toHide.not(this.errorsFor(e)));if(!t)return this.formatAndAdd(e,a),!1}catch(t){throw this.settings.debug&&window.console&&console.log("Exception occurred when checking element "+e.id+", check the '"+a.method+"' method.",t),t}}if(!s)return this.objectLength(i)&&this.successList.push(e),!0},customDataMessage:function(t,e){return l(t).data("msg-"+e.toLowerCase())||t.attributes&&l(t).attr("data-msg-"+e.toLowerCase())},customMessage:function(t,e){var i=this.settings.messages[t];return i&&(i.constructor===String?i:i[e])},findDefined:function(){for(var t=0;t<arguments.length;t++)if(void 0!==arguments[t])return arguments[t]},defaultMessage:function(t,e){return this.findDefined(this.customMessage(t.name,e),this.customDataMessage(t,e),!this.settings.ignoreTitle&&t.title||void 0,l.validator.messages[e],"<strong>Warning: No message defined for "+t.name+"</strong>")},formatAndAdd:function(t,e){var i=this.defaultMessage(t,e.method),s=/\$?\{(\d+)\}/g;"function"==typeof i?i=i.call(this,e.parameters,t):s.test(i)&&(i=l.validator.format(i.replace(s,"{$1}"),e.parameters)),this.errorList.push({message:i,element:t}),this.errorMap[t.name]=i,this.submitted[t.name]=i},addWrapper:function(t){return this.settings.wrapper&&(t=t.add(t.parent(this.settings.wrapper))),t},defaultShowErrors:function(){var t,e;for(t=0;this.errorList[t];t++){var i=this.errorList[t];this.settings.highlight&&this.settings.highlight.call(this,i.element,this.settings.errorClass,this.settings.validClass),this.showLabel(i.element,i.message)}if(this.errorList.length&&(this.toShow=this.toShow.add(this.containers)),this.settings.success)for(t=0;this.successList[t];t++)this.showLabel(this.successList[t]);if(this.settings.unhighlight)for(t=0,e=this.validElements();e[t];t++)this.settings.unhighlight.call(this,e[t],this.settings.errorClass,this.settings.validClass);this.toHide=this.toHide.not(this.toShow),this.hideErrors(),this.addWrapper(this.toShow).show()},validElements:function(){return this.currentElements.not(this.invalidElements())},invalidElements:function(){return l(this.errorList).map(function(){return this.element})},showLabel:function(t,e){var i=this.errorsFor(t);i.length?(i.removeClass(this.settings.validClass).addClass(this.settings.errorClass),i.html(e)):(i=l("<"+this.settings.errorElement+">").attr("for",this.idOrName(t)).addClass(this.settings.errorClass).html(e||""),this.settings.wrapper&&(i=i.hide().show().wrap("<"+this.settings.wrapper+"/>").parent()),this.labelContainer.append(i).length||(this.settings.errorPlacement?this.settings.errorPlacement(i,l(t)):i.insertAfter(t))),!e&&this.settings.success&&(i.text(""),"string"==typeof this.settings.success?i.addClass(this.settings.success):this.settings.success(i,t)),this.toShow=this.toShow.add(i)},errorsFor:function(t){var e=this.idOrName(t);return this.errors().filter(function(){return l(this).attr("for")===e})},idOrName:function(t){return this.groups[t.name]||(this.checkable(t)?t.name:t.id||t.name)},validationTargetFor:function(t){return this.checkable(t)&&(t=this.findByName(t.name).not(this.settings.ignore)[0]),t},checkable:function(t){return/radio|checkbox/i.test(t.type)},findByName:function(t){return l(this.currentForm).find("[name='"+t+"']")},getLength:function(t,e){switch(e.nodeName.toLowerCase()){case"select":return l("option:selected",e).length;case"input":if(this.checkable(e))return this.findByName(e.name).filter(":checked").length}return t.length},depend:function(t,e){return!this.dependTypes[typeof t]||this.dependTypes[typeof t](t,e)},dependTypes:{boolean:function(t,e){return t},string:function(t,e){return!!l(t,e.form).length},function:function(t,e){return t(e)}},optional:function(t){var e=this.elementValue(t);return!l.validator.methods.required.call(this,e,t)&&"dependency-mismatch"},startRequest:function(t){this.pending[t.name]||(this.pendingRequest++,this.pending[t.name]=!0)},stopRequest:function(t,e){this.pendingRequest--,this.pendingRequest<0&&(this.pendingRequest=0),delete this.pending[t.name],e&&0===this.pendingRequest&&this.formSubmitted&&this.form()?(l(this.currentForm).submit(),this.formSubmitted=!1):!e&&0===this.pendingRequest&&this.formSubmitted&&(l(this.currentForm).triggerHandler("invalid-form",[this]),this.formSubmitted=!1)},previousValue:function(t){return l.data(t,"previousValue")||l.data(t,"previousValue",{old:null,valid:!0,message:this.defaultMessage(t,"remote")})}},classRuleSettings:{required:{required:!0},email:{email:!0},url:{url:!0},date:{date:!0},dateISO:{dateISO:!0},number:{number:!0},digits:{digits:!0},creditcard:{creditcard:!0}},addClassRules:function(t,e){t.constructor===String?this.classRuleSettings[t]=e:l.extend(this.classRuleSettings,t)},classRules:function(t){var e={},i=l(t).attr("class");return i&&l.each(i.split(" "),function(){this in l.validator.classRuleSettings&&l.extend(e,l.validator.classRuleSettings[this])}),e},attributeRules:function(t){var e={},i=l(t),s=i[0].getAttribute("type");for(var r in l.validator.methods){var n;n="required"===r?(""===(n=i.get(0).getAttribute(r))&&(n=!0),!!n):i.attr(r),/min|max/.test(r)&&(null===s||/number|range|text/.test(s))&&(n=Number(n)),n?e[r]=n:s===r&&"range"!==s&&(e[r]=!0)}return e.maxlength&&/-1|2147483647|524288/.test(e.maxlength)&&delete e.maxlength,e},dataRules:function(t){var e,i,s={},r=l(t);for(e in l.validator.methods)void 0!==(i=r.data("rule-"+e.toLowerCase()))&&(s[e]=i);return s},staticRules:function(t){var e={},i=l.data(t.form,"validator");return i.settings.rules&&(e=l.validator.normalizeRule(i.settings.rules[t.name])||{}),e},normalizeRules:function(s,r){return l.each(s,function(t,e){if(!1!==e){if(e.param||e.depends){var i=!0;switch(typeof e.depends){case"string":i=!!l(e.depends,r.form).length;break;case"function":i=e.depends.call(r,r)}i?s[t]=void 0===e.param||e.param:delete s[t]}}else delete s[t]}),l.each(s,function(t,e){s[t]=l.isFunction(e)?e(r):e}),l.each(["minlength","maxlength"],function(){s[this]&&(s[this]=Number(s[this]))}),l.each(["rangelength","range"],function(){var t;s[this]&&(l.isArray(s[this])?s[this]=[Number(s[this][0]),Number(s[this][1])]:"string"==typeof s[this]&&(t=s[this].split(/[\s,]+/),s[this]=[Number(t[0]),Number(t[1])]))}),l.validator.autoCreateRanges&&(s.min&&s.max&&(s.range=[s.min,s.max],delete s.min,delete s.max),s.minlength&&s.maxlength&&(s.rangelength=[s.minlength,s.maxlength],delete s.minlength,delete s.maxlength)),s},normalizeRule:function(t){if("string"==typeof t){var e={};l.each(t.split(/\s/),function(){e[this]=!0}),t=e}return t},addMethod:function(t,e,i){l.validator.methods[t]=e,l.validator.messages[t]=void 0!==i?i:l.validator.messages[t],e.length<3&&l.validator.addClassRules(t,l.validator.normalizeRule(t))},methods:{required:function(t,e,i){if(!this.depend(i,e))return"dependency-mismatch";if("select"!==e.nodeName.toLowerCase())return this.checkable(e)?0<this.getLength(t,e):0<l.trim(t).length;var s=l(e).val();return s&&0<s.length},email:function(t,e){return this.optional(e)||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(t)},url:function(t,e){return this.optional(e)||/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(t)},date:function(t,e){return this.optional(e)||!/Invalid|NaN/.test(new Date(t).toString())},dateISO:function(t,e){return this.optional(e)||/^\d{4}[\/\-]\d{1,2}[\/\-]\d{1,2}$/.test(t)},number:function(t,e){return this.optional(e)||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(t)},digits:function(t,e){return this.optional(e)||/^\d+$/.test(t)},creditcard:function(t,e){if(this.optional(e))return"dependency-mismatch";if(/[^0-9 \-]+/.test(t))return!1;for(var i=0,s=0,r=!1,n=(t=t.replace(/\D/g,"")).length-1;0<=n;n--){var a=t.charAt(n);s=parseInt(a,10),r&&9<(s*=2)&&(s-=9),i+=s,r=!r}return i%10==0},minlength:function(t,e,i){var s=l.isArray(t)?t.length:this.getLength(l.trim(t),e);return this.optional(e)||i<=s},maxlength:function(t,e,i){var s=l.isArray(t)?t.length:this.getLength(l.trim(t),e);return this.optional(e)||s<=i},rangelength:function(t,e,i){var s=l.isArray(t)?t.length:this.getLength(l.trim(t),e);return this.optional(e)||s>=i[0]&&s<=i[1]},min:function(t,e,i){return this.optional(e)||i<=t},max:function(t,e,i){return this.optional(e)||t<=i},range:function(t,e,i){return this.optional(e)||t>=i[0]&&t<=i[1]},equalTo:function(t,e,i){var s=l(i);return this.settings.onfocusout&&s.unbind(".validate-equalTo").bind("blur.validate-equalTo",function(){l(e).valid()}),t===s.val()},remote:function(n,a,t){if(this.optional(a))return"dependency-mismatch";var u=this.previousValue(a);if(this.settings.messages[a.name]||(this.settings.messages[a.name]={}),u.originalMessage=this.settings.messages[a.name].remote,this.settings.messages[a.name].remote=u.message,t="string"==typeof t&&{url:t}||t,u.old===n)return u.valid;u.old=n;var o=this;this.startRequest(a);var e={};return e[a.name]=n,l.ajax(l.extend(!0,{url:t,mode:"abort",port:"validate"+a.name,dataType:"json",data:e,success:function(t){o.settings.messages[a.name].remote=u.originalMessage;var e=!0===t||"true"===t;if(e){var i=o.formSubmitted;o.prepareElement(a),o.formSubmitted=i,o.successList.push(a),delete o.invalid[a.name],o.showErrors()}else{var s={},r=t||o.defaultMessage(a,"remote");s[a.name]=u.message=l.isFunction(r)?r(n):r,o.invalid[a.name]=!0,o.showErrors(s)}u.valid=e,o.stopRequest(a,e)}},t)),"pending"}}}),l.format=l.validator.format}(jQuery),function(s){var r={};if(s.ajaxPrefilter)s.ajaxPrefilter(function(t,e,i){var s=t.port;"abort"===t.mode&&(r[s]&&r[s].abort(),r[s]=i)});else{var n=s.ajax;s.ajax=function(t){var e=("mode"in t?t:s.ajaxSettings).mode,i=("port"in t?t:s.ajaxSettings).port;return"abort"===e?(r[i]&&r[i].abort(),r[i]=n.apply(this,arguments),r[i]):n.apply(this,arguments)}}}(jQuery),function(r){r.extend(r.fn,{validateDelegate:function(i,t,s){return this.bind(t,function(t){var e=r(t.target);if(e.is(i))return s.apply(e,arguments)})}})}(jQuery);
!function(re){var le="left",ue="right",ae="up",oe="down",se="in",ce="out",he="none",pe="auto",fe="swipe",ge="pinch",de="tap",we="doubletap",ve="longtap",Te="horizontal",be="vertical",Se="all",Ee=10,Oe="start",xe="move",ye="end",me="cancel",Le="ontouchstart"in window,Me="TouchSwipe";function i(e,u){var t=Le||!u.fallbackToMouseEvents,n=t?"touchstart":"mousedown",i=t?"touchmove":"mousemove",r=t?"touchend":"mouseup",l=t?null:"mouseleave",a="touchcancel",o=0,s=null,c=0,h=0,p=0,f=1,g=0,d=0,w=null,v=re(e),T="start",b=0,S=null,E=0,O=0,x=0,y=0,m=0,L=null;try{v.bind(n,M),v.bind(a,R)}catch(e){re.error("events not supported "+n+","+a+" on jQuery.swipe")}function M(e){if(!0!==v.data(Me+"_intouch")&&!(0<re(e.target).closest(u.excludedElements,v).length)){var t,n=e.originalEvent?e.originalEvent:e,i=Le?n.touches[0]:n;if(T=Oe,Le?b=n.touches.length:e.preventDefault(),d=s=null,f=1,g=p=h=c=o=0,S=function(){for(var e=[],t=0;t<=5;t++)e.push({start:{x:0,y:0},end:{x:0,y:0},identifier:0});return e}(),w=function(){var e={};return e[le]=ee(le),e[ue]=ee(ue),e[ae]=ee(ae),e[oe]=ee(oe),e}(),G(),!Le||b===u.fingers||u.fingers===Se||X()?(J(0,i),E=ie(),2==b&&(J(1,n.touches[1]),h=p=ne(S[0].start,S[1].start)),(u.swipeStatus||u.pinchStatus)&&(t=N(n,T))):t=!1,!1===t)return N(n,T=me),t;B(!0)}}function D(e){var t=e.originalEvent?e.originalEvent:e;if(T!==ye&&T!==me&&!Z()){var n,i=K(Le?t.touches[0]:t);if(O=ie(),Le&&(b=t.touches.length),T=xe,2==b&&(0==h?(J(1,t.touches[1]),h=p=ne(S[0].start,S[1].start)):(K(t.touches[1]),p=ne(S[0].end,S[1].end),S[0].end,S[1].end,d=f<1?ce:se),f=function(e,t){return(t/e*1).toFixed(2)}(h,p),g=Math.abs(h-p)),b===u.fingers||u.fingers===Se||!Le||X()){if(function(e,t){if(u.allowPageScroll===he||X())e.preventDefault();else{var n=u.allowPageScroll===pe;switch(t){case le:(u.swipeLeft&&n||!n&&u.allowPageScroll!=Te)&&e.preventDefault();break;case ue:(u.swipeRight&&n||!n&&u.allowPageScroll!=Te)&&e.preventDefault();break;case ae:(u.swipeUp&&n||!n&&u.allowPageScroll!=be)&&e.preventDefault();break;case oe:(u.swipeDown&&n||!n&&u.allowPageScroll!=be)&&e.preventDefault()}}}(e,s=function(e,t){var n=function(e,t){var n=e.x-t.x,i=t.y-e.y,r=Math.atan2(i,n),l=Math.round(180*r/Math.PI);l<0&&(l=360-Math.abs(l));return l}(e,t);return n<=45&&0<=n?le:n<=360&&315<=n?le:135<=n&&n<=225?ue:45<n&&n<135?oe:ae}(i.start,i.end)),o=function(e,t){return Math.round(Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)))}(i.start,i.end),c=te(),function(e,t){t=Math.max(t,$(e)),w[e].distance=t}(s,o),(u.swipeStatus||u.pinchStatus)&&(n=N(t,T)),!u.triggerOnTouchEnd||u.triggerOnTouchLeave){var r=!0;if(u.triggerOnTouchLeave){var l=function(e){var t=(e=re(e)).offset();return{left:t.left,right:t.left+e.outerWidth(),top:t.top,bottom:t.top+e.outerHeight()}}(this);r=function(e,t){return e.x>t.left&&e.x<t.right&&e.y>t.top&&e.y<t.bottom}(i.end,l)}!u.triggerOnTouchEnd&&r?T=I(xe):u.triggerOnTouchLeave&&!r&&(T=I(ye)),T!=me&&T!=ye||N(t,T)}}else N(t,T=me);!1===n&&N(t,T=me)}}function P(e){var t=e.originalEvent;if(Le&&0<t.touches.length)return x=ie(),y=event.touches.length+1,!0;Z()&&(b=y),e.preventDefault(),O=ie(),c=te(),_()?N(t,T=me):u.triggerOnTouchEnd||0==u.triggerOnTouchEnd&&T===xe?N(t,T=ye):!u.triggerOnTouchEnd&&F()?U(t,T=ye,de):T===xe&&N(t,T=me),B(!1)}function R(){p=h=E=O=b=0,f=1,G(),B(!1)}function k(e){var t=e.originalEvent;u.triggerOnTouchLeave&&N(t,T=I(ye))}function A(){v.unbind(n,M),v.unbind(a,R),v.unbind(i,D),v.unbind(r,P),l&&v.unbind(l,k),B(!1)}function I(e){var t=e,n=j(),i=H(),r=_();return!n||r?t=me:!i||e!=xe||u.triggerOnTouchEnd&&!u.triggerOnTouchLeave?!i&&e==ye&&u.triggerOnTouchLeave&&(t=me):t=ye,t}function N(e,t){var n=void 0;return Y()&&C()||C()?n=U(e,t,fe):(Q()&&X()||X())&&!1!==n&&(n=U(e,t,ge)),z()&&V()&&!1!==n?n=U(e,t,we):c>u.longTapThreshold&&o<Ee&&u.longTap&&!1!==n?n=U(e,t,ve):1!==b&&Le||!isNaN(o)&&0!==o||!F()||!1===n||(n=U(e,t,de)),t===me&&R(),t===ye&&(Le?0==e.touches.length&&R():R()),n}function U(e,t,n){var i=void 0;if(n==fe){if(v.trigger("swipeStatus",[t,s||null,o||0,c||0,b]),u.swipeStatus&&!1===(i=u.swipeStatus.call(v,e,t,s||null,o||0,c||0,b)))return!1;if(t==ye&&Y()){if(v.trigger("swipe",[s,o,c,b]),u.swipe&&!1===(i=u.swipe.call(v,e,s,o,c,b)))return!1;switch(s){case le:v.trigger("swipeLeft",[s,o,c,b]),u.swipeLeft&&(i=u.swipeLeft.call(v,e,s,o,c,b));break;case ue:v.trigger("swipeRight",[s,o,c,b]),u.swipeRight&&(i=u.swipeRight.call(v,e,s,o,c,b));break;case ae:v.trigger("swipeUp",[s,o,c,b]),u.swipeUp&&(i=u.swipeUp.call(v,e,s,o,c,b));break;case oe:v.trigger("swipeDown",[s,o,c,b]),u.swipeDown&&(i=u.swipeDown.call(v,e,s,o,c,b))}}}if(n==ge){if(v.trigger("pinchStatus",[t,d||null,g||0,c||0,b,f]),u.pinchStatus&&!1===(i=u.pinchStatus.call(v,e,t,d||null,g||0,c||0,b,f)))return!1;if(t==ye&&Q())switch(d){case se:v.trigger("pinchIn",[d||null,g||0,c||0,b,f]),u.pinchIn&&(i=u.pinchIn.call(v,e,d||null,g||0,c||0,b,f));break;case ce:v.trigger("pinchOut",[d||null,g||0,c||0,b,f]),u.pinchOut&&(i=u.pinchOut.call(v,e,d||null,g||0,c||0,b,f))}}return n==de?t!==me&&t!==ye||(clearTimeout(L),V()&&!z()?(m=ie(),L=setTimeout(re.proxy(function(){m=null,v.trigger("tap",[e.target]),u.tap&&(i=u.tap.call(v,e,e.target))},this),u.doubleTapThreshold)):(m=null,v.trigger("tap",[e.target]),u.tap&&(i=u.tap.call(v,e,e.target)))):n==we?t!==me&&t!==ye||(clearTimeout(L),m=null,v.trigger("doubletap",[e.target]),u.doubleTap&&(i=u.doubleTap.call(v,e,e.target))):n==ve&&(t!==me&&t!==ye||(clearTimeout(L),m=null,v.trigger("longtap",[e.target]),u.longTap&&(i=u.longTap.call(v,e,e.target)))),i}function H(){var e=!0;return null!==u.threshold&&(e=o>=u.threshold),e}function _(){var e=!1;return null!==u.cancelThreshold&&null!==s&&(e=$(s)-o>=u.cancelThreshold),e}function j(){return!u.maxTimeThreshold||!(c>=u.maxTimeThreshold)}function Q(){var e=W(),t=q(),n=null===u.pinchThreshold||g>=u.pinchThreshold;return e&&t&&n}function X(){return!!(u.pinchStatus||u.pinchIn||u.pinchOut)}function Y(){var e=j(),t=H(),n=W(),i=q();return!_()&&i&&n&&t&&e}function C(){return!!(u.swipe||u.swipeStatus||u.swipeLeft||u.swipeRight||u.swipeUp||u.swipeDown)}function W(){return b===u.fingers||u.fingers===Se||!Le}function q(){return 0!==S[0].end.x}function F(){return!!u.tap}function V(){return!!u.doubleTap}function z(){if(null==m)return!1;var e=ie();return V()&&e-m<=u.doubleTapThreshold}function G(){y=x=0}function Z(){var e=!1;x&&(ie()-x<=u.fingerReleaseThreshold&&(e=!0));return e}function B(e){!0===e?(v.bind(i,D),v.bind(r,P),l&&v.bind(l,k)):(v.unbind(i,D,!1),v.unbind(r,P,!1),l&&v.unbind(l,k,!1)),v.data(Me+"_intouch",!0===e)}function J(e,t){var n=void 0!==t.identifier?t.identifier:0;return S[e].identifier=n,S[e].start.x=S[e].end.x=t.pageX||t.clientX,S[e].start.y=S[e].end.y=t.pageY||t.clientY,S[e]}function K(e){var t=function(e){for(var t=0;t<S.length;t++)if(S[t].identifier==e)return S[t]}(void 0!==e.identifier?e.identifier:0);return t.end.x=e.pageX||e.clientX,t.end.y=e.pageY||e.clientY,t}function $(e){return w[e].distance}function ee(e){return{direction:e,distance:0}}function te(){return O-E}function ne(e,t){var n=Math.abs(e.x-t.x),i=Math.abs(e.y-t.y);return Math.round(Math.sqrt(n*n+i*i))}function ie(){return(new Date).getTime()}this.enable=function(){return v.bind(n,M),v.bind(a,R),v},this.disable=function(){return A(),v},this.destroy=function(){return A(),v.data(Me,null),v},this.option=function(e,t){if(void 0!==u[e]){if(void 0===t)return u[e];u[e]=t}else re.error("Option "+e+" does not exist on jQuery.swipe.options")}}re.fn.swipe=function(e){var t=re(this),n=t.data(Me);if(n&&"string"==typeof e){if(n[e])return n[e].apply(this,Array.prototype.slice.call(arguments,1));re.error("Method "+e+" does not exist on jQuery.swipe")}else if(!(n||"object"!=typeof e&&e))return function(n){!n||void 0!==n.allowPageScroll||void 0===n.swipe&&void 0===n.swipeStatus||(n.allowPageScroll=he);void 0!==n.click&&void 0===n.tap&&(n.tap=n.click);n||(n={});return n=re.extend({},re.fn.swipe.defaults,n),this.each(function(){var e=re(this),t=e.data(Me);t||(t=new i(this,n),e.data(Me,t))})}.apply(this,arguments);return t},re.fn.swipe.defaults={fingers:1,threshold:75,cancelThreshold:null,pinchThreshold:20,maxTimeThreshold:null,fingerReleaseThreshold:250,longTapThreshold:500,doubleTapThreshold:200,swipe:null,swipeLeft:null,swipeRight:null,swipeUp:null,swipeDown:null,swipeStatus:null,pinchIn:null,pinchOut:null,pinchStatus:null,click:null,tap:null,doubleTap:null,longTap:null,triggerOnTouchEnd:!0,triggerOnTouchLeave:!1,allowPageScroll:"auto",fallbackToMouseEvents:!0,excludedElements:"button, input, select, textarea, a, .noSwipe"},re.fn.swipe.phases={PHASE_START:Oe,PHASE_MOVE:xe,PHASE_END:ye,PHASE_CANCEL:me},re.fn.swipe.directions={LEFT:le,RIGHT:ue,UP:ae,DOWN:oe,IN:se,OUT:ce},re.fn.swipe.pageScroll={NONE:he,HORIZONTAL:Te,VERTICAL:be,AUTO:pe},re.fn.swipe.fingers={ONE:1,TWO:2,THREE:3,ALL:Se}}(jQuery);
(function(a){function l(){window.console&&console.log&&console.log("[cycle2] "+Array.prototype.join.call(arguments," "))}function r(e){return(e||"").toLowerCase()}a.fn.cycle=function(o){var e;return 0!==this.length||a.isReady?this.each(function(){var e,i,t,n,s=a(this);if(!s.data("cycle.opts")){for(var c in(!1===s.data("cycle-log")||o&&!1===o.log||i&&!1===i.log)&&(l=a.noop),l("--c2 init--"),e=s.data())e.hasOwnProperty(c)&&/^cycle[A-Z]+/.test(c)&&(n=e[c],l((t=c.match(/^cycle(.*)/)[1].replace(/^[A-Z]/,r))+":",n,"("+typeof n+")"),e[t]=n);(i=a.extend({},a.fn.cycle.defaults,e,o||{})).timeoutId=0,i.paused=0,i.container=s,i._maxZ=i.maxZ,i.API=a.extend({_container:s},a.fn.cycle.API),i.API.log=l,i.API.trigger=function(e,t){return i.container.trigger(e,t),i.API},s.data("cycle.opts",i),s.data("cycle.API",i.API),i.API.trigger("cycle-bootstrap",[i,i.API]),i.API.addInitialSlides(),i.API.preInitSlideshow(),i.slides.length&&i.API.initSlideshow()}}):(e={s:this.selector,c:this.context},l("requeuing slideshow (dom not ready)"),a(function(){a(e.s,e.c).cycle(o)}),this)},a.fn.cycle.API={opts:function(){return this._container.data("cycle.opts")},addInitialSlides:function(){var e=this.opts(),t=e.slides;e.slideCount=0,e.slides=a(),t=t.jquery?t:e.container.find(t),e.random&&t.sort(function(){return Math.random()-.5}),e.API.add(t)},preInitSlideshow:function(){var e=this.opts();e.API.trigger("cycle-pre-initialize",[e]);var t=a.fn.cycle.transitions[e.fx];t&&a.isFunction(t.preInit)&&t.preInit(e),e._preInitialized=!0},postInitSlideshow:function(){var e=this.opts();e.API.trigger("cycle-post-initialize",[e]);var t=a.fn.cycle.transitions[e.fx];t&&a.isFunction(t.postInit)&&t.postInit(e)},initSlideshow:function(){var t=this.opts(),e=t.container;t.API.calcFirstSlide(),"static"==t.container.css("position")&&t.container.css("position","relative"),a(t.slides[t.currSlide]).css("opacity",1).show(),t.API.stackSlides(t.slides[t.currSlide],t.slides[t.nextSlide],!t.reverse),t.pauseOnHover&&(!0!==t.pauseOnHover&&(e=a(t.pauseOnHover)),e.hover(function(){t.paused=1,t.API.trigger("cycle-paused",[t])},function(){t.paused=0,t.API.trigger("cycle-resumed",[t])})),t.timeout&&(t.timeoutId=setTimeout(function(){t.API.prepareTx(!1,!t.reverse)},t.timeout+t.delay)),t._initialized=!0,t.API.updateView(!0),t.container.on("cycle-paused cycle-resumed",function(e){t.container["cycle-paused"===e.type?"addClass":"removeClass"]("cycle-paused")}),t.API.trigger("cycle-initialized",[t]),t.API.postInitSlideshow()},add:function(e,n){var t,s=this.opts(),i=s.slideCount;a(e).each(function(e){var t,i=a(this);n?s.container.prepend(i):s.container.append(i),s.slideCount++,t=s.API.buildSlideOpts(i),s.slides=n?a(i).add(s.slides):s.slides.add(i),s.API.initSlide(t,i,--s._maxZ),i.data("cycle.opts",t),s.API.trigger("cycle-slide-added",[s,t,i])}),s.API.updateView(!0),s._preInitialized&&i<2&&1<=s.slideCount&&(s._initialized?s.timeout&&(t=s.slides.length,s.nextSlide=s.reverse?t-1:1):s.API.initSlideshow())},calcFirstSlide:function(){var e,t=this.opts();((e=parseInt(t.startingSlide||0,10))>=t.slides.length||e<0)&&(e=0),t.currSlide=e,t.reverse?(t.nextSlide=e-1,t.nextSlide<0&&(t.nextSlide=t.slides.length-1)):(t.nextSlide=e+1,t.nextSlide==t.slides.length&&(t.nextSlide=0))},calcNextSlide:function(){var e,t=this.opts();t.reverse?(e=t.nextSlide-1<0,t.nextSlide=e?t.slideCount-1:t.nextSlide-1,t.currSlide=e?0:t.nextSlide+1):(e=t.nextSlide+1==t.slides.length,t.nextSlide=e?0:t.nextSlide+1,t.currSlide=e?t.slides.length-1:t.nextSlide-1)},calcTx:function(e,t){var i,n=e;return t&&n.manualFx&&(i=a.fn.cycle.transitions[n.manualFx]),i||(i=a.fn.cycle.transitions[n.fx]),i||(i=a.fn.cycle.transitions.fade,l('Transition "'+n.fx+'" not found.  Using fade.')),i},prepareTx:function(e,t){var i,n,s,c,o,l=this.opts();l.slideCount<2?l.timeoutId=0:(e&&(l.API.stopTransition(),l.busy=!1,clearTimeout(l.timeoutId),l.timeoutId=0),l.busy||(0!==l.timeoutId||e)&&(n=l.slides[l.currSlide],s=l.slides[l.nextSlide],c=l.API.getSlideOpts(l.nextSlide),o=l.API.calcTx(c,e),l._tx=o,e&&void 0!==c.manualSpeed&&(c.speed=c.manualSpeed),l.nextSlide!=l.currSlide&&(e||!l.paused&&l.timeout)?(l.API.trigger("cycle-before",[c,n,s,t]),o.before&&o.before(c,n,s,t),i=function(){l.busy=!1,o.after&&o.after(c,n,s,t),l.API.trigger("cycle-after",[c,n,s,t]),l.API.queueTransition(c),l.API.updateView(!0)},l.busy=!0,o.transition?o.transition(c,n,s,t,i):l.API.doTransition(c,n,s,t,i),l.API.calcNextSlide(),l.updateView<0&&l.API.updateView()):l.API.queueTransition(c)))},doTransition:function(e,t,i,n,s){var c=e,o=a(t),l=a(i),r=function(){l.animate(c.animIn||{opacity:1},c.speed,c.easeIn||c.easing,s)};l.css(c.cssBefore||{}),o.animate(c.animOut||{},c.speed,c.easeOut||c.easing,function(){o.css(c.cssAfter||{}),c.sync||r()}),c.sync&&r()},queueTransition:function(e){var t=this.opts();if(0===t.nextSlide&&0==--t.loop)return t.API.log("terminating; loop=0"),t.timeout=0,t.API.trigger("cycle-finished",[t]),void(t.nextSlide=t.currSlide);e.timeout&&(t.timeoutId=setTimeout(function(){t.API.prepareTx(!1,!t.reverse)},e.timeout))},stopTransition:function(){var e=this.opts();e.slides.filter(":animated").length&&(e.slides.stop(!1,!0),e.API.trigger("cycle-transition-stopped",[e])),e._tx&&e._tx.stopTransition&&e._tx.stopTransition(e)},advanceSlide:function(e){var t=this.opts();return clearTimeout(t.timeoutId),t.timeoutId=0,t.nextSlide=t.currSlide+e,t.nextSlide<0?t.nextSlide=t.slides.length-1:t.nextSlide>=t.slides.length&&(t.nextSlide=0),t.API.prepareTx(!0,0<=e),!1},buildSlideOpts:function(e){var t,i,n=this.opts(),s=e.data()||{};for(var c in s)s.hasOwnProperty(c)&&/^cycle[A-Z]+/.test(c)&&(t=s[c],i=c.match(/^cycle(.*)/)[1].replace(/^[A-Z]/,r),l("["+(n.slideCount-1)+"]",i+":",t,"("+typeof t+")"),s[i]=t);(s=a.extend({},a.fn.cycle.defaults,n,s)).slideNum=n.slideCount;try{delete s.API,delete s.slideCount,delete s.currSlide,delete s.nextSlide,delete s.slides}catch(e){}return s},getSlideOpts:function(e){var t=this.opts();void 0===e&&(e=t.currSlide);var i=t.slides[e],n=a(i).data("cycle.opts");return a.extend({},t,n)},initSlide:function(e,t,i){var n=this.opts();t.css(e.slideCss||{}),0<i&&t.css("zIndex",i),isNaN(e.speed)&&(e.speed=a.fx.speeds[e.speed]||a.fx.speeds._default),e.sync||(e.speed=e.speed/2),t.addClass(n.slideClass)},updateView:function(e){var t=this.opts();if(t._initialized){var i=t.API.getSlideOpts(),n=t.slides[t.currSlide];t.slideActiveClass&&t.slides.removeClass(t.slideActiveClass).eq(t.currSlide).addClass(t.slideActiveClass),e&&t.hideNonActive&&t.slides.filter(":not(."+t.slideActiveClass+")").hide(),t.API.trigger("cycle-update-view",[t,i,n])}},getComponent:function(e){var t=this.opts(),i=t[e];return"string"==typeof i?/^\s*\>/.test(i)?t.container.find(i):a(i):i.jquery?i:a(i)},stackSlides:function(e,t,i){var n=this.opts();e||(e=n.slides[n.currSlide],t=n.slides[n.nextSlide],i=!n.reverse),a(e).css("zIndex",n.maxZ);var s,c=n.maxZ-2,o=n.slideCount;if(i){for(s=n.currSlide+1;s<o;s++)a(n.slides[s]).css("zIndex",c--);for(s=0;s<n.currSlide;s++)a(n.slides[s]).css("zIndex",c--)}else{for(s=n.currSlide-1;0<=s;s--)a(n.slides[s]).css("zIndex",c--);for(s=o-1;s>n.currSlide;s--)a(n.slides[s]).css("zIndex",c--)}a(t).css("zIndex",n.maxZ-1)},getSlideIndex:function(e){return this.opts().slides.index(e)}},a.fn.cycle.log=l,a.fn.cycle.version=function(){return"Cycle2: 20121125.2"},a.fn.cycle.transitions={custom:{},none:{before:function(e,t,i,n){e.API.stackSlides(i,t,n),e.cssBefore={opacity:1,display:"block"}}},fade:{before:function(e,t,i,n){var s=e.API.getSlideOpts(e.nextSlide).slideCss||{};e.API.stackSlides(t,i,n),e.cssBefore=a.extend(s,{opacity:0,display:"block"}),e.animIn={opacity:1},e.animOut={opacity:0}}},fadeout:{before:function(e,t,i,n){var s=e.API.getSlideOpts(e.nextSlide).slideCss||{};e.API.stackSlides(t,i,n),e.cssBefore=a.extend(s,{opacity:1,display:"block"}),e.animOut={opacity:0}}},scrollHorz:{before:function(e,t,i,n){e.API.stackSlides(t,i,n);var s=e.container.css("overflow","hidden").width();e.cssBefore={left:n?s:-s,top:0,opacity:1,display:"block"},e.cssAfter={zIndex:e._maxZ-2},e.animIn={left:0},e.animOut={left:n?-s:s}}}},a.fn.cycle.defaults={allowWrap:!0,autoSelector:".cycle-slideshow[data-cycle-auto-init!=false]",delay:0,easing:null,fx:"fade",hideNonActive:!0,loop:0,manualFx:void 0,manualSpeed:void 0,maxZ:100,pauseOnHover:!1,reverse:!1,slideActiveClass:"cycle-slide-active",slideClass:"cycle-slide",slideCss:{position:"absolute",top:0,left:0},slides:"> img",speed:500,startingSlide:0,sync:!0,timeout:4e3,updateView:-1},a(document).ready(function(){a(a.fn.cycle.defaults.autoSelector).cycle()})})(jQuery),function(l){l.extend(l.fn.cycle.defaults,{autoHeight:0}),l(document).on("cycle-initialized",function(e,t){function i(){t.container.height(t.container.width()/s)}var n,s,c=t.autoHeight,o=-1;"calc"===c||"number"==l.type(c)&&0<=c?("calc"===c?t.slides.each(function(e){var t=l(this).height();o<t&&(o=t,c=e)}):c>=t.slides.length&&(c=0),(n=l(t.slides[c]).clone()).removeAttr("id").find("[id]").removeAttr("id"),n.removeAttr("name").find("[name]").removeAttr("name"),n.css({position:"static",visibility:"hidden",display:"block"}).prependTo(t.container).removeClass().addClass("cycle-sentinel cycle-slide"),t._sentinel=n):"string"==l.type(c)&&/\d+\:\d+/.test(c)&&(s=(s=c.match(/(\d+)\:(\d+)/))[1]/s[2],l(window).on("resize",i),t._autoHeightOnResize=i,setTimeout(function(){l(window).triggerHandler("resize")},15))}),l(document).on("cycle-destroyed",function(e,t){t._sentinel&&t._sentinel.remove(),t._autoHeightOnResize&&l(window).off("resize",t._autoHeightOnResize)})}(jQuery),function(c){c.extend(c.fn.cycle.defaults,{caption:"> .cycle-caption",captionTemplate:"{{slideNum}} / {{slideCount}}",overlay:"> .cycle-overlay",overlayTemplate:"<div>{{title}}</div><div>{{desc}}</div>"}),c(document).on("cycle-update-view",function(e,i,n,s){c.each(["caption","overlay"],function(){var e=n[this+"Template"],t=i.API.getComponent(this);t.length&&e?(t.html(i.API.tmpl(e,n,i,s)),t.show()):t.hide()})}),c(document).on("cycle-destroyed",function(e,t){c.each(["caption","overlay"],function(){var e=t[this+"Template"];t[this]&&e&&t.API.getComponent("caption").empty()})})}(jQuery),function(l){"use strict";var o=l.fn.cycle;l.fn.cycle=function(t){var i,n,s,c=l.makeArray(arguments);return"number"==l.type(t)?this.cycle("goto",t):"string"==l.type(t)?this.each(function(){var e;if(i=t,void 0!==(s=l(this).data("cycle.opts"))){if(i="goto"==i?"jump":i,n=s.API[i],l.isFunction(n))return(e=l.makeArray(c)).shift(),n.apply(s.API,e);o.log("unknown command: ",i)}else o.log('slideshow must be initialized before sending commands; "'+i+'" ignored')}):o.apply(this,arguments)},l.extend(l.fn.cycle,o),l.extend(o.API,{next:function(){var e=this.opts(),t=e.reverse?-1:1;!1===e.allowWrap&&e.currSlide+t>=e.slideCount||(e.API.advanceSlide(t),e.API.trigger("cycle-next",[e]).log("cycle-next"))},prev:function(){var e=this.opts(),t=e.reverse?1:-1;!1===e.allowWrap&&e.currSlide+t<0||(e.API.advanceSlide(t),e.API.trigger("cycle-prev",[e]).log("cycle-prev"))},destroy:function(){var e=this.opts();clearTimeout(e.timeoutId),e.timeoutId=0,e.API.stop(),e.API.trigger("cycle-destroyed",[e]).log("cycle-destroyed"),e.container.removeData("cycle.opts")},jump:function(e){var t,i=this.opts(),n=parseInt(e,10);isNaN(n)||n<0||n>=i.slides.length?i.API.log("goto: invalid slide index: "+n):n!=i.currSlide?(i.nextSlide=n,clearTimeout(i.timeoutId),i.timeoutId=0,i.API.log("goto: ",n," (zero-index)"),t=i.currSlide<i.nextSlide,i.API.prepareTx(!0,t)):i.API.log("goto: skipping, already on slide",n)},stop:function(){var e=this.opts(),t=e.container;clearTimeout(e.timeoutId),e.timeoutId=0,e.API.stopTransition(),e.pauseOnHover&&(!0!==e.pauseOnHover&&(t=l(e.pauseOnHover)),t.off("mouseenter mouseleave")),e.API.trigger("cycle-stopped",[e]).log("cycle-stopped")},pause:function(){var e=this.opts();e.paused=!0,e.API.trigger("cycle-paused",[e]).log("cycle-paused")},resume:function(){var e=this.opts();e.paused=!1,e.API.trigger("cycle-resumed",[e]).log("cycle-resumed")},reinit:function(){var e=this.opts();e.API.destroy(),e.container.cycle()},remove:function(e){for(var t,i,n=this.opts(),s=[],c=1,o=0;o<n.slides.length;o++)t=n.slides[o],o==e?i=t:(s.push(t),l(t).data("cycle.opts").slideNum=c,c++);i&&(n.slides=l(s),n.slideCount--,l(i).remove(),e==n.currSlide&&n.API.advanceSlide(1),n.API.trigger("cycle-slide-removed",[n,e,i]).log("cycle-slide-removed"),n.API.updateView())}}),l(document).on("click.cycle","[data-cycle-cmd]",function(e){e.preventDefault();var t=l(this),i=t.data("cycle-cmd"),n=t.data("cycle-context")||".cycle-slideshow";l(n).cycle(i,t.data("cycle-arg"))})}(jQuery),function(s){function i(t,i){var n;t._hashFence?t._hashFence=!1:(n=window.location.hash.substring(1),t.slides.each(function(e){if(s(this).data("cycle-hash")==n)return!0===i?t.startingSlide=e:(t.nextSlide=e,t.API.prepareTx(!0,!1)),!1}))}s(document).on("cycle-pre-initialize",function(e,t){i(t,!0),t._onHashChange=function(){i(t,!1)},s(window).on("hashchange",t._onHashChange)}),s(document).on("cycle-update-view",function(e,t,i){i.hash&&(t._hashFence=!0,window.location.hash=i.hash)}),s(document).on("cycle-destroyed",function(e,t){t._onHashChange&&s(window).off("hashchange",t._onHashChange)})}(jQuery),function(a){a.extend(a.fn.cycle.defaults,{loader:!1}),a(document).on("cycle-bootstrap",function(e,l){var r;l.loader&&(r=l.API.add,l.API.add=function(e,s){var c=[],o=(e=a(e)).length;e.hide().each(function(){function e(){0==--t&&(--o,function(e){var t;"wait"==l.loader?(c.push(e),0===o&&(r.apply(l.API,[c,s]),l.container.removeClass("cycle-loading"))):(t=a(l.slides[l.currSlide]),r.apply(l.API,[e,s]),t.show(),l.container.removeClass("cycle-loading"))}(i))}var t=0,i=a(this),n=i.is("img")?i:i.find("img");if(!(n=n.filter(":not(.cycle-loader-ignore)")).length)return--o,void c.push(i);t=n.length,n.each(function(){this.complete?e():a(this).load(function(){e()}).error(function(){0==--t&&(l.API.log("slide skipped; img not loaded:",this.src),0==--o&&"wait"==l.loader&&r.apply(l.API,[c,s]))})})}),o&&l.container.addClass("cycle-loading")})})}(jQuery),function(o){function n(i,n,s){var c;i.API.getComponent("pager").each(function(){var t=o(this);if(n.pagerTemplate){var e=i.API.tmpl(n.pagerTemplate,n,i,s[0]);c=o(e).appendTo(t)}else c=t.children().eq(i.slideCount-1);c.on(i.pagerEvent,function(e){e.preventDefault(),i.API.page(t,e.currentTarget)})})}function s(e,t){var i=this.opts(),n=e.children().index(t),s=i.currSlide<n;i.currSlide!=n&&(i.nextSlide=n,i.API.prepareTx(!0,s),i.API.trigger("cycle-pager-activated",[i,e,t]))}o.extend(o.fn.cycle.defaults,{pager:"> .cycle-pager",pagerActiveClass:"cycle-pager-active",pagerEvent:"click.cycle",pagerTemplate:"<span>&bull;</span>"}),o(document).on("cycle-bootstrap",function(e,t,i){i.buildPagerLink=n}),o(document).on("cycle-slide-added",function(e,t,i,n){t.pager&&(t.API.buildPagerLink(t,i,n),t.API.page=s)}),o(document).on("cycle-slide-removed",function(e,t,i,n){t.pager&&t.API.getComponent("pager").each(function(){var e=o(this);o(e.children()[i]).remove()})}),o(document).on("cycle-update-view",function(e,t,i){t.pager&&t.API.getComponent("pager").each(function(){o(this).children().removeClass(t.pagerActiveClass).eq(t.currSlide).addClass(t.pagerActiveClass)})}),o(document).on("cycle-destroyed",function(e,t){t.pager&&t.pagerTemplate&&t.API.getComponent("pager").empty()})}(jQuery),function(i){i.extend(i.fn.cycle.defaults,{next:"> .cycle-next",nextEvent:"click.cycle",disabledClass:"disabled",prev:"> .cycle-prev",prevEvent:"click.cycle",swipe:!1}),i(document).on("cycle-initialized",function(e,t){if(t.API.getComponent("next").off(t.nextEvent).on(t.nextEvent,function(e){e.preventDefault(),t.API.next()}),t.API.getComponent("prev").off(t.prevEvent).on(t.prevEvent,function(e){e.preventDefault(),t.API.prev()}),t.swipe){var i=t.swipeVert?"swipeUp.cycle":"swipeLeft.cycle swipeleft.cycle",n=t.swipeVert?"swipeDown.cycle":"swipeRight.cycle swiperight.cycle";t.container.on(i,function(e){t.API.next()}),t.container.on(n,function(){t.API.prev()})}}),i(document).on("cycle-update-view",function(e,t,i,n){if(!t.allowWrap){var s=t.disabledClass,c=t.API.getComponent("next"),o=t.API.getComponent("prev"),l=t._prevBoundry||0,r=t._nextBoundry||t.slideCount-1;t.currSlide==r?c.addClass(s).prop("disabled",!0):c.removeClass(s).prop("disabled",!1),t.currSlide===l?o.addClass(s).prop("disabled",!0):o.removeClass(s).prop("disabled",!1)}}),i(document).on("cycle-destroyed",function(e,t){i(t.next).off(t.nextEvent),i(t.prev).off(t.prevEvent),t.container.off("swipeleft.cycle swiperight.cycle swipeLeft.cycle swipeRight.cycle swipeUp.cycle swipeDown.cycle")})}(jQuery),function(r){r.extend(r.fn.cycle.defaults,{progressive:!1}),r(document).on("cycle-pre-initialize",function(e,s){if(s.progressive){var c,t=s.API,i=t.next,n=t.prev,o=t.prepareTx,l=r.type(s.progressive);if("array"==l)c=s.progressive;else if(r.isFunction(s.progressive))c=s.progressive(s);else if("string"==l){if(c=r(s.progressive).html(),!r.trim(c))return;try{c=r.parseJSON(c)}catch(e){return void t.log("error parsing progressive slides",e)}}o&&(t.prepareTx=function(e,t){var i,n;e||0===c.length?o.apply(s.API,[e,t]):t&&s.currSlide==s.slideCount-1?(n=c[0],c=c.slice(1),s.container.one("cycle-slide-added",function(e,t){t.API.advanceSlide(1)}),s.API.add(n)):t||0!==s.currSlide?o.apply(s.API,[e,t]):(i=c.length-1,n=c[i],c=c.slice(0,i),s.container.one("cycle-slide-added",function(e,t){t.currSlide=1,t.API.advanceSlide(-1)}),s.API.add(n,!0))}),i&&(t.next=function(){var e=this.opts();if(c.length&&e.currSlide==e.slideCount-1){var t=c[0];c=c.slice(1),e.container.one("cycle-slide-added",function(e,t){i.apply(t.API),t.container.removeClass("cycle-loading")}),e.container.addClass("cycle-loading"),e.API.add(t)}else i.apply(e.API)}),n&&(t.prev=function(){var e=this.opts();if(c.length&&0===e.currSlide){var t=c.length-1,i=c[t];c=c.slice(0,t),e.container.one("cycle-slide-added",function(e,t){t.currSlide=1,t.API.advanceSlide(-1),t.container.removeClass("cycle-loading")}),e.container.addClass("cycle-loading"),e.API.add(i,!0)}else n.apply(e.API)})}})}(jQuery),function(r){r.extend(r.fn.cycle.defaults,{tmplRegex:"{{((.)?.*?)}}"}),r.extend(r.fn.cycle.API,{tmpl:function(e,t){var i=new RegExp(t.tmplRegex||r.fn.cycle.defaults.tmplRegex,"g"),l=r.makeArray(arguments);return l.shift(),e.replace(i,function(e,t){var i,n,s,c,o=t.split(".");for(i=0;i<l.length;i++){if(s=l[i],1<o.length)for(c=s,n=0;n<o.length;n++)c=(s=c)[o[n]]||t;else c=s[t];if(r.isFunction(c))return c.apply(s,l);if(null!=c&&c!=t)return c}return t})}})}(jQuery);
!function(a,p,r){var e,i,t=a.L,_={};_.version="0.7.3","object"==typeof module&&"object"==typeof module.exports?module.exports=_:"function"==typeof define&&define.amd&&define(_),_.noConflict=function(){return a.L=t,this},(a.L=_).Util={extend:function(t){var e,i,n,o,s=Array.prototype.slice.call(arguments,1);for(i=0,n=s.length;i<n;i++)for(e in o=s[i]||{})o.hasOwnProperty(e)&&(t[e]=o[e]);return t},bind:function(t,e){var i=2<arguments.length?Array.prototype.slice.call(arguments,2):null;return function(){return t.apply(e,i||arguments)}},stamp:(e=0,i="_leaflet_id",function(t){return t[i]=t[i]||++e,t[i]}),invokeEach:function(t,e,i){var n,o;if("object"!=typeof t)return!1;for(n in o=Array.prototype.slice.call(arguments,3),t)e.apply(i,[n,t[n]].concat(o));return!0},limitExecByInterval:function(i,n,o){var s,a;return function t(){var e=arguments;return s?void(a=!0):(s=!0,setTimeout(function(){s=!1,a&&(t.apply(o,e),a=!1)},n),void i.apply(o,e))}},falseFn:function(){return!1},formatNum:function(t,e){var i=Math.pow(10,e||5);return Math.round(t*i)/i},trim:function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},splitWords:function(t){return _.Util.trim(t).split(/\s+/)},setOptions:function(t,e){return t.options=_.extend({},t.options,e),t.options},getParamString:function(t,e,i){var n=[];for(var o in t)n.push(encodeURIComponent(i?o.toUpperCase():o)+"="+encodeURIComponent(t[o]));return(e&&-1!==e.indexOf("?")?"&":"?")+n.join("&")},template:function(t,n){return t.replace(/\{ *([\w_]+) *\}/g,function(t,e){var i=n[e];if(i===r)throw new Error("No value provided for variable "+t);return"function"==typeof i&&(i=i(n)),i})},isArray:Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},emptyImageUrl:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="},function(){function t(t){var e,i,n=["webkit","moz","o","ms"];for(e=0;e<n.length&&!i;e++)i=a[n[e]+t];return i}function o(t){var e=+new Date,i=Math.max(0,16-(e-n));return n=e+i,a.setTimeout(t,i)}var n=0,s=a.requestAnimationFrame||t("RequestAnimationFrame")||o,e=a.cancelAnimationFrame||t("CancelAnimationFrame")||t("CancelRequestAnimationFrame")||function(t){a.clearTimeout(t)};_.Util.requestAnimFrame=function(t,e,i,n){return t=_.bind(t,e),i&&s===o?void t():s.call(a,t,n)},_.Util.cancelAnimFrame=function(t){t&&e.call(a,t)}}(),_.extend=_.Util.extend,_.bind=_.Util.bind,_.stamp=_.Util.stamp,_.setOptions=_.Util.setOptions,_.Class=function(){},_.Class.extend=function(t){var e=function(){this.initialize&&this.initialize.apply(this,arguments),this._initHooks&&this.callInitHooks()},i=function(){};i.prototype=this.prototype;var n=new i;for(var o in(n.constructor=e).prototype=n,this)this.hasOwnProperty(o)&&"prototype"!==o&&(e[o]=this[o]);t.statics&&(_.extend(e,t.statics),delete t.statics),t.includes&&(_.Util.extend.apply(null,[n].concat(t.includes)),delete t.includes),t.options&&n.options&&(t.options=_.extend({},n.options,t.options)),_.extend(n,t),n._initHooks=[];var s=this;return e.__super__=s.prototype,n.callInitHooks=function(){if(!this._initHooksCalled){s.prototype.callInitHooks&&s.prototype.callInitHooks.call(this),this._initHooksCalled=!0;for(var t=0,e=n._initHooks.length;t<e;t++)n._initHooks[t].call(this)}},e},_.Class.include=function(t){_.extend(this.prototype,t)},_.Class.mergeOptions=function(t){_.extend(this.prototype.options,t)},_.Class.addInitHook=function(t){var e=Array.prototype.slice.call(arguments,1),i="function"==typeof t?t:function(){this[t].apply(this,e)};this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(i)};var n,o,s,h,l,u,c,d,m,f,g,v,y,P,L,x,w,T,b,D,E,C,M,S="_leaflet_events";_.Mixin={},_.Mixin.Events={addEventListener:function(t,e,i){if(_.Util.invokeEach(t,this.addEventListener,this,e,i))return this;var n,o,s,a,r,h,l,u=this[S]=this[S]||{},c=i&&i!==this&&_.stamp(i);for(n=0,o=(t=_.Util.splitWords(t)).length;n<o;n++)s={action:e,context:i||this},a=t[n],c?(h=(r=a+"_idx")+"_len",(l=u[r]=u[r]||{})[c]||(l[c]=[],u[h]=(u[h]||0)+1),l[c].push(s)):(u[a]=u[a]||[],u[a].push(s));return this},hasEventListeners:function(t){var e=this[S];return!!e&&(t in e&&0<e[t].length||t+"_idx"in e&&0<e[t+"_idx_len"])},removeEventListener:function(t,e,i){if(!this[S])return this;if(!t)return this.clearAllEventListeners();if(_.Util.invokeEach(t,this.removeEventListener,this,e,i))return this;var n,o,s,a,r,h,l,u,c=this[S],d=i&&i!==this&&_.stamp(i);for(n=0,o=(t=_.Util.splitWords(t)).length;n<o;n++)if(l=(h=(s=t[n])+"_idx")+"_len",u=c[h],e){if(a=d&&u?u[d]:c[s]){for(r=a.length-1;0<=r;r--)a[r].action!==e||i&&a[r].context!==i||(a.splice(r,1)[0].action=_.Util.falseFn);i&&u&&0===a.length&&(delete u[d],c[l]--)}}else delete c[s],delete c[h],delete c[l];return this},clearAllEventListeners:function(){return delete this[S],this},fireEvent:function(t,e){if(!this.hasEventListeners(t))return this;var i,n,o,s,a,r=_.Util.extend({},e,{type:t,target:this}),h=this[S];if(h[t])for(n=0,o=(i=h[t].slice()).length;n<o;n++)i[n].action.call(i[n].context,r);for(a in s=h[t+"_idx"])if(i=s[a].slice())for(n=0,o=i.length;n<o;n++)i[n].action.call(i[n].context,r);return this},addOneTimeEventListener:function(t,e,i){if(_.Util.invokeEach(t,this.addOneTimeEventListener,this,e,i))return this;var n=_.bind(function(){this.removeEventListener(t,e,i).removeEventListener(t,n,i)},this);return this.addEventListener(t,e,i).addEventListener(t,n,i)}},_.Mixin.Events.on=_.Mixin.Events.addEventListener,_.Mixin.Events.off=_.Mixin.Events.removeEventListener,_.Mixin.Events.once=_.Mixin.Events.addOneTimeEventListener,_.Mixin.Events.fire=_.Mixin.Events.fireEvent,l=(h="ActiveXObject"in a)&&!p.addEventListener,u=navigator.userAgent.toLowerCase(),c=-1!==u.indexOf("webkit"),d=-1!==u.indexOf("chrome"),m=-1!==u.indexOf("phantom"),f=-1!==u.indexOf("android"),g=-1!==u.search("android [23]"),v=-1!==u.indexOf("gecko"),y=typeof orientation!=r+"",P=a.navigator&&a.navigator.msPointerEnabled&&a.navigator.msMaxTouchPoints&&!a.PointerEvent,L=a.PointerEvent&&a.navigator.pointerEnabled&&a.navigator.maxTouchPoints||P,x="devicePixelRatio"in a&&1<a.devicePixelRatio||"matchMedia"in a&&a.matchMedia("(min-resolution:144dpi)")&&a.matchMedia("(min-resolution:144dpi)").matches,w=p.documentElement,T=h&&"transition"in w.style,b="WebKitCSSMatrix"in a&&"m11"in new a.WebKitCSSMatrix&&!g,D="MozPerspective"in w.style,E="OTransition"in w.style,C=!a.L_DISABLE_3D&&(T||b||D||E)&&!m,M=!a.L_NO_TOUCH&&!m&&function(){var t="ontouchstart";if(L||t in w)return!0;var e=p.createElement("div"),i=!1;return!!e.setAttribute&&(e.setAttribute(t,"return;"),"function"==typeof e[t]&&(i=!0),e.removeAttribute(t),e=null,i)}(),_.Browser={ie:h,ielt9:l,webkit:c,gecko:v&&!c&&!a.opera&&!h,android:f,android23:g,chrome:d,ie3d:T,webkit3d:b,gecko3d:D,opera3d:E,any3d:C,mobile:y,mobileWebkit:y&&c,mobileWebkit3d:y&&b,mobileOpera:y&&a.opera,touch:M,msPointer:P,pointer:L,retina:x},_.Point=function(t,e,i){this.x=i?Math.round(t):t,this.y=i?Math.round(e):e},_.Point.prototype={clone:function(){return new _.Point(this.x,this.y)},add:function(t){return this.clone()._add(_.point(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(_.point(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},distanceTo:function(t){var e=(t=_.point(t)).x-this.x,i=t.y-this.y;return Math.sqrt(e*e+i*i)},equals:function(t){return(t=_.point(t)).x===this.x&&t.y===this.y},contains:function(t){return t=_.point(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+_.Util.formatNum(this.x)+", "+_.Util.formatNum(this.y)+")"}},_.point=function(t,e,i){return t instanceof _.Point?t:_.Util.isArray(t)?new _.Point(t[0],t[1]):t===r||null===t?t:new _.Point(t,e,i)},_.Bounds=function(t,e){if(t)for(var i=e?[t,e]:t,n=0,o=i.length;n<o;n++)this.extend(i[n])},_.Bounds.prototype={extend:function(t){return t=_.point(t),this.min||this.max?(this.min.x=Math.min(t.x,this.min.x),this.max.x=Math.max(t.x,this.max.x),this.min.y=Math.min(t.y,this.min.y),this.max.y=Math.max(t.y,this.max.y)):(this.min=t.clone(),this.max=t.clone()),this},getCenter:function(t){return new _.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return new _.Point(this.min.x,this.max.y)},getTopRight:function(){return new _.Point(this.max.x,this.min.y)},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var e,i;return(t="number"==typeof t[0]||t instanceof _.Point?_.point(t):_.bounds(t))instanceof _.Bounds?(e=t.min,i=t.max):e=i=t,e.x>=this.min.x&&i.x<=this.max.x&&e.y>=this.min.y&&i.y<=this.max.y},intersects:function(t){t=_.bounds(t);var e=this.min,i=this.max,n=t.min,o=t.max,s=o.x>=e.x&&n.x<=i.x,a=o.y>=e.y&&n.y<=i.y;return s&&a},isValid:function(){return!(!this.min||!this.max)}},_.bounds=function(t,e){return!t||t instanceof _.Bounds?t:new _.Bounds(t,e)},_.Transformation=function(t,e,i,n){this._a=t,this._b=e,this._c=i,this._d=n},_.Transformation.prototype={transform:function(t,e){return this._transform(t.clone(),e)},_transform:function(t,e){return e=e||1,t.x=e*(this._a*t.x+this._b),t.y=e*(this._c*t.y+this._d),t},untransform:function(t,e){return e=e||1,new _.Point((t.x/e-this._b)/this._a,(t.y/e-this._d)/this._c)}},_.DomUtil={get:function(t){return"string"==typeof t?p.getElementById(t):t},getStyle:function(t,e){var i=t.style[e];if(!i&&t.currentStyle&&(i=t.currentStyle[e]),(!i||"auto"===i)&&p.defaultView){var n=p.defaultView.getComputedStyle(t,null);i=n?n[e]:null}return"auto"===i?null:i},getViewportOffset:function(t){var e,i=0,n=0,o=t,s=p.body,a=p.documentElement;do{if(i+=o.offsetTop||0,n+=o.offsetLeft||0,i+=parseInt(_.DomUtil.getStyle(o,"borderTopWidth"),10)||0,n+=parseInt(_.DomUtil.getStyle(o,"borderLeftWidth"),10)||0,e=_.DomUtil.getStyle(o,"position"),o.offsetParent===s&&"absolute"===e)break;if("fixed"===e){i+=s.scrollTop||a.scrollTop||0,n+=s.scrollLeft||a.scrollLeft||0;break}if("relative"===e&&!o.offsetLeft){var r=_.DomUtil.getStyle(o,"width"),h=_.DomUtil.getStyle(o,"max-width"),l=o.getBoundingClientRect();("none"!==r||"none"!==h)&&(n+=l.left+o.clientLeft),i+=l.top+(s.scrollTop||a.scrollTop||0);break}o=o.offsetParent}while(o);o=t;do{if(o===s)break;i-=o.scrollTop||0,n-=o.scrollLeft||0,o=o.parentNode}while(o);return new _.Point(n,i)},documentIsLtr:function(){return _.DomUtil._docIsLtrCached||(_.DomUtil._docIsLtrCached=!0,_.DomUtil._docIsLtr="ltr"===_.DomUtil.getStyle(p.body,"direction")),_.DomUtil._docIsLtr},create:function(t,e,i){var n=p.createElement(t);return n.className=e,i&&i.appendChild(n),n},hasClass:function(t,e){if(t.classList!==r)return t.classList.contains(e);var i=_.DomUtil._getClass(t);return 0<i.length&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(i)},addClass:function(t,e){if(t.classList!==r)for(var i=_.Util.splitWords(e),n=0,o=i.length;n<o;n++)t.classList.add(i[n]);else if(!_.DomUtil.hasClass(t,e)){var s=_.DomUtil._getClass(t);_.DomUtil._setClass(t,(s?s+" ":"")+e)}},removeClass:function(t,e){t.classList!==r?t.classList.remove(e):_.DomUtil._setClass(t,_.Util.trim((" "+_.DomUtil._getClass(t)+" ").replace(" "+e+" "," ")))},_setClass:function(t,e){t.className.baseVal===r?t.className=e:t.className.baseVal=e},_getClass:function(t){return t.className.baseVal===r?t.className:t.className.baseVal},setOpacity:function(t,e){if("opacity"in t.style)t.style.opacity=e;else if("filter"in t.style){var i=!1,n="DXImageTransform.Microsoft.Alpha";try{i=t.filters.item(n)}catch(t){if(1===e)return}e=Math.round(100*e),i?(i.Enabled=100!==e,i.Opacity=e):t.style.filter+=" progid:"+n+"(opacity="+e+")"}},testProp:function(t){for(var e=p.documentElement.style,i=0;i<t.length;i++)if(t[i]in e)return t[i];return!1},getTranslateString:function(t){var e=_.Browser.webkit3d,i=(e?",0":"")+")";return"translate"+(e?"3d":"")+"("+t.x+"px,"+t.y+"px"+i},getScaleString:function(t,e){return _.DomUtil.getTranslateString(e.add(e.multiplyBy(-1*t)))+(" scale("+t+") ")},setPosition:function(t,e,i){t._leaflet_pos=e,!i&&_.Browser.any3d?t.style[_.DomUtil.TRANSFORM]=_.DomUtil.getTranslateString(e):(t.style.left=e.x+"px",t.style.top=e.y+"px")},getPosition:function(t){return t._leaflet_pos}},_.DomUtil.TRANSFORM=_.DomUtil.testProp(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]),_.DomUtil.TRANSITION=_.DomUtil.testProp(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),_.DomUtil.TRANSITION_END="webkitTransition"===_.DomUtil.TRANSITION||"OTransition"===_.DomUtil.TRANSITION?_.DomUtil.TRANSITION+"End":"transitionend",function(){if("onselectstart"in p)_.extend(_.DomUtil,{disableTextSelection:function(){_.DomEvent.on(a,"selectstart",_.DomEvent.preventDefault)},enableTextSelection:function(){_.DomEvent.off(a,"selectstart",_.DomEvent.preventDefault)}});else{var e=_.DomUtil.testProp(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);_.extend(_.DomUtil,{disableTextSelection:function(){if(e){var t=p.documentElement.style;this._userSelect=t[e],t[e]="none"}},enableTextSelection:function(){e&&(p.documentElement.style[e]=this._userSelect,delete this._userSelect)}})}_.extend(_.DomUtil,{disableImageDrag:function(){_.DomEvent.on(a,"dragstart",_.DomEvent.preventDefault)},enableImageDrag:function(){_.DomEvent.off(a,"dragstart",_.DomEvent.preventDefault)}})}(),_.LatLng=function(t,e,i){if(t=parseFloat(t),e=parseFloat(e),isNaN(t)||isNaN(e))throw new Error("Invalid LatLng object: ("+t+", "+e+")");this.lat=t,this.lng=e,i!==r&&(this.alt=parseFloat(i))},_.extend(_.LatLng,{DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,MAX_MARGIN:1e-9}),_.LatLng.prototype={equals:function(t){return!!t&&(t=_.latLng(t),Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng))<=_.LatLng.MAX_MARGIN)},toString:function(t){return"LatLng("+_.Util.formatNum(this.lat,t)+", "+_.Util.formatNum(this.lng,t)+")"},distanceTo:function(t){t=_.latLng(t);var e=_.LatLng.DEG_TO_RAD,i=(t.lat-this.lat)*e,n=(t.lng-this.lng)*e,o=this.lat*e,s=t.lat*e,a=Math.sin(i/2),r=Math.sin(n/2),h=a*a+r*r*Math.cos(o)*Math.cos(s);return 12756274*Math.atan2(Math.sqrt(h),Math.sqrt(1-h))},wrap:function(t,e){var i=this.lng;return i=(i+(e=e||180))%(e-(t=t||-180))+(i<t||i===e?e:t),new _.LatLng(this.lat,i)}},_.latLng=function(t,e){return t instanceof _.LatLng?t:_.Util.isArray(t)?"number"==typeof t[0]||"string"==typeof t[0]?new _.LatLng(t[0],t[1],t[2]):null:t===r||null===t?t:"object"==typeof t&&"lat"in t?new _.LatLng(t.lat,"lng"in t?t.lng:t.lon):e===r?null:new _.LatLng(t,e)},_.LatLngBounds=function(t,e){if(t)for(var i=e?[t,e]:t,n=0,o=i.length;n<o;n++)this.extend(i[n])},_.LatLngBounds.prototype={extend:function(t){if(!t)return this;var e=_.latLng(t);return(t=null!==e?e:_.latLngBounds(t))instanceof _.LatLng?this._southWest||this._northEast?(this._southWest.lat=Math.min(t.lat,this._southWest.lat),this._southWest.lng=Math.min(t.lng,this._southWest.lng),this._northEast.lat=Math.max(t.lat,this._northEast.lat),this._northEast.lng=Math.max(t.lng,this._northEast.lng)):(this._southWest=new _.LatLng(t.lat,t.lng),this._northEast=new _.LatLng(t.lat,t.lng)):t instanceof _.LatLngBounds&&(this.extend(t._southWest),this.extend(t._northEast)),this},pad:function(t){var e=this._southWest,i=this._northEast,n=Math.abs(e.lat-i.lat)*t,o=Math.abs(e.lng-i.lng)*t;return new _.LatLngBounds(new _.LatLng(e.lat-n,e.lng-o),new _.LatLng(i.lat+n,i.lng+o))},getCenter:function(){return new _.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new _.LatLng(this.getNorth(),this.getWest())},getSouthEast:function(){return new _.LatLng(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){t="number"==typeof t[0]||t instanceof _.LatLng?_.latLng(t):_.latLngBounds(t);var e,i,n=this._southWest,o=this._northEast;return t instanceof _.LatLngBounds?(e=t.getSouthWest(),i=t.getNorthEast()):e=i=t,e.lat>=n.lat&&i.lat<=o.lat&&e.lng>=n.lng&&i.lng<=o.lng},intersects:function(t){t=_.latLngBounds(t);var e=this._southWest,i=this._northEast,n=t.getSouthWest(),o=t.getNorthEast(),s=o.lat>=e.lat&&n.lat<=i.lat,a=o.lng>=e.lng&&n.lng<=i.lng;return s&&a},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t){return!!t&&(t=_.latLngBounds(t),this._southWest.equals(t.getSouthWest())&&this._northEast.equals(t.getNorthEast()))},isValid:function(){return!(!this._southWest||!this._northEast)}},_.latLngBounds=function(t,e){return!t||t instanceof _.LatLngBounds?t:new _.LatLngBounds(t,e)},_.Projection={},_.Projection.SphericalMercator={MAX_LATITUDE:85.0511287798,project:function(t){var e=_.LatLng.DEG_TO_RAD,i=this.MAX_LATITUDE,n=Math.max(Math.min(i,t.lat),-i),o=t.lng*e,s=n*e;return s=Math.log(Math.tan(Math.PI/4+s/2)),new _.Point(o,s)},unproject:function(t){var e=_.LatLng.RAD_TO_DEG,i=t.x*e,n=(2*Math.atan(Math.exp(t.y))-Math.PI/2)*e;return new _.LatLng(n,i)}},_.Projection.LonLat={project:function(t){return new _.Point(t.lng,t.lat)},unproject:function(t){return new _.LatLng(t.y,t.x)}},_.CRS={latLngToPoint:function(t,e){var i=this.projection.project(t),n=this.scale(e);return this.transformation._transform(i,n)},pointToLatLng:function(t,e){var i=this.scale(e),n=this.transformation.untransform(t,i);return this.projection.unproject(n)},project:function(t){return this.projection.project(t)},scale:function(t){return 256*Math.pow(2,t)},getSize:function(t){var e=this.scale(t);return _.point(e,e)}},_.CRS.Simple=_.extend({},_.CRS,{projection:_.Projection.LonLat,transformation:new _.Transformation(1,0,-1,0),scale:function(t){return Math.pow(2,t)}}),_.CRS.EPSG3857=_.extend({},_.CRS,{code:"EPSG:3857",projection:_.Projection.SphericalMercator,transformation:new _.Transformation(.5/Math.PI,.5,-.5/Math.PI,.5),project:function(t){return this.projection.project(t).multiplyBy(6378137)}}),_.CRS.EPSG900913=_.extend({},_.CRS.EPSG3857,{code:"EPSG:900913"}),_.CRS.EPSG4326=_.extend({},_.CRS,{code:"EPSG:4326",projection:_.Projection.LonLat,transformation:new _.Transformation(1/360,.5,-1/360,.5)}),_.Map=_.Class.extend({includes:_.Mixin.Events,options:{crs:_.CRS.EPSG3857,fadeAnimation:_.DomUtil.TRANSITION&&!_.Browser.android23,trackResize:!0,markerZoomAnimation:_.DomUtil.TRANSITION&&_.Browser.any3d},initialize:function(t,e){e=_.setOptions(this,e),this._initContainer(t),this._initLayout(),this._onResize=_.bind(this._onResize,this),this._initEvents(),e.maxBounds&&this.setMaxBounds(e.maxBounds),e.center&&e.zoom!==r&&this.setView(_.latLng(e.center),e.zoom,{reset:!0}),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._tileLayersNum=0,this.callInitHooks(),this._addLayers(e.layers)},setView:function(t,e){return e=e===r?this.getZoom():e,this._resetView(_.latLng(t),this._limitZoom(e)),this},setZoom:function(t,e){return this._loaded?this.setView(this.getCenter(),t,{zoom:e}):(this._zoom=this._limitZoom(t),this)},zoomIn:function(t,e){return this.setZoom(this._zoom+(t||1),e)},zoomOut:function(t,e){return this.setZoom(this._zoom-(t||1),e)},setZoomAround:function(t,e,i){var n=this.getZoomScale(e),o=this.getSize().divideBy(2),s=(t instanceof _.Point?t:this.latLngToContainerPoint(t)).subtract(o).multiplyBy(1-1/n),a=this.containerPointToLatLng(o.add(s));return this.setView(a,e,{zoom:i})},fitBounds:function(t,e){e=e||{},t=t.getBounds?t.getBounds():_.latLngBounds(t);var i=_.point(e.paddingTopLeft||e.padding||[0,0]),n=_.point(e.paddingBottomRight||e.padding||[0,0]),o=this.getBoundsZoom(t,!1,i.add(n)),s=n.subtract(i).divideBy(2),a=this.project(t.getSouthWest(),o),r=this.project(t.getNorthEast(),o),h=this.unproject(a.add(r).divideBy(2).add(s),o);return o=e&&e.maxZoom?Math.min(e.maxZoom,o):o,this.setView(h,o,e)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,e){return this.setView(t,this._zoom,{pan:e})},panBy:function(t){return this.fire("movestart"),this._rawPanBy(_.point(t)),this.fire("move"),this.fire("moveend")},setMaxBounds:function(t){return t=_.latLngBounds(t),(this.options.maxBounds=t)?(this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds,this)):this.off("moveend",this._panInsideMaxBounds,this)},panInsideBounds:function(t,e){var i=this.getCenter(),n=this._limitCenter(i,this._zoom,t);return i.equals(n)?this:this.panTo(n,e)},addLayer:function(t){var e=_.stamp(t);return this._layers[e]||(!(this._layers[e]=t).options||isNaN(t.options.maxZoom)&&isNaN(t.options.minZoom)||(this._zoomBoundLayers[e]=t,this._updateZoomLevels()),this.options.zoomAnimation&&_.TileLayer&&t instanceof _.TileLayer&&(this._tileLayersNum++,this._tileLayersToLoad++,t.on("load",this._onTileLayerLoad,this)),this._loaded&&this._layerAdd(t)),this},removeLayer:function(t){var e=_.stamp(t);return this._layers[e]&&(this._loaded&&t.onRemove(this),delete this._layers[e],this._loaded&&this.fire("layerremove",{layer:t}),this._zoomBoundLayers[e]&&(delete this._zoomBoundLayers[e],this._updateZoomLevels()),this.options.zoomAnimation&&_.TileLayer&&t instanceof _.TileLayer&&(this._tileLayersNum--,this._tileLayersToLoad--,t.off("load",this._onTileLayerLoad,this))),this},hasLayer:function(t){return!!t&&_.stamp(t)in this._layers},eachLayer:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},invalidateSize:function(t){if(!this._loaded)return this;t=_.extend({animate:!1,pan:!0},!0===t?{animate:!0}:t);var e=this.getSize();this._sizeChanged=!0,this._initialCenter=null;var i=this.getSize(),n=e.divideBy(2).round(),o=i.divideBy(2).round(),s=n.subtract(o);return s.x||s.y?(t.animate&&t.pan?this.panBy(s):(t.pan&&this._rawPanBy(s),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(_.bind(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:e,newSize:i})):this},addHandler:function(t,e){if(!e)return this;var i=this[t]=new e(this);return this._handlers.push(i),this.options[t]&&i.enable(),this},remove:function(){this._loaded&&this.fire("unload"),this._initEvents("off");try{delete this._container._leaflet}catch(t){this._container._leaflet=r}return this._clearPanes(),this._clearControlPos&&this._clearControlPos(),this._clearHandlers(),this},getCenter:function(){return this._checkIfLoaded(),this._initialCenter&&!this._moved()?this._initialCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds(),e=this.unproject(t.getBottomLeft()),i=this.unproject(t.getTopRight());return new _.LatLngBounds(e,i)},getMinZoom:function(){return this.options.minZoom===r?this._layersMinZoom===r?0:this._layersMinZoom:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===r?this._layersMaxZoom===r?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,e,i){t=_.latLngBounds(t);var n,o=this.getMinZoom()-(e?1:0),s=this.getMaxZoom(),a=this.getSize(),r=t.getNorthWest(),h=t.getSouthEast(),l=!0;for(i=_.point(i||[0,0]);o++,n=this.project(h,o).subtract(this.project(r,o)).add(i),(l=e?n.x<a.x||n.y<a.y:a.contains(n))&&o<=s;);return l&&e?null:e?o:o-1},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new _.Point(this._container.clientWidth,this._container.clientHeight),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(){var t=this._getTopLeftPoint();return new _.Bounds(t,t.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._initialTopLeftPoint},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t){var e=this.options.crs;return e.scale(t)/e.scale(this._zoom)},getScaleZoom:function(t){return this._zoom+Math.log(t)/Math.LN2},project:function(t,e){return e=e===r?this._zoom:e,this.options.crs.latLngToPoint(_.latLng(t),e)},unproject:function(t,e){return e=e===r?this._zoom:e,this.options.crs.pointToLatLng(_.point(t),e)},layerPointToLatLng:function(t){var e=_.point(t).add(this.getPixelOrigin());return this.unproject(e)},latLngToLayerPoint:function(t){return this.project(_.latLng(t))._round()._subtract(this.getPixelOrigin())},containerPointToLayerPoint:function(t){return _.point(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return _.point(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var e=this.containerPointToLayerPoint(_.point(t));return this.layerPointToLatLng(e)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(_.latLng(t)))},mouseEventToContainerPoint:function(t){return _.DomEvent.getMousePosition(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var e=this._container=_.DomUtil.get(t);if(!e)throw new Error("Map container not found.");if(e._leaflet)throw new Error("Map container is already initialized.");e._leaflet=!0},_initLayout:function(){var t=this._container;_.DomUtil.addClass(t,"leaflet-container"+(_.Browser.touch?" leaflet-touch":"")+(_.Browser.retina?" leaflet-retina":"")+(_.Browser.ielt9?" leaflet-oldie":"")+(this.options.fadeAnimation?" leaflet-fade-anim":""));var e=_.DomUtil.getStyle(t,"position");"absolute"!==e&&"relative"!==e&&"fixed"!==e&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._mapPane=t.mapPane=this._createPane("leaflet-map-pane",this._container),this._tilePane=t.tilePane=this._createPane("leaflet-tile-pane",this._mapPane),t.objectsPane=this._createPane("leaflet-objects-pane",this._mapPane),t.shadowPane=this._createPane("leaflet-shadow-pane"),t.overlayPane=this._createPane("leaflet-overlay-pane"),t.markerPane=this._createPane("leaflet-marker-pane"),t.popupPane=this._createPane("leaflet-popup-pane");var e=" leaflet-zoom-hide";this.options.markerZoomAnimation||(_.DomUtil.addClass(t.markerPane,e),_.DomUtil.addClass(t.shadowPane,e),_.DomUtil.addClass(t.popupPane,e))},_createPane:function(t,e){return _.DomUtil.create("div",t,e||this._panes.objectsPane)},_clearPanes:function(){this._container.removeChild(this._mapPane)},_addLayers:function(t){for(var e=0,i=(t=t?_.Util.isArray(t)?t:[t]:[]).length;e<i;e++)this.addLayer(t[e])},_resetView:function(t,e,i,n){var o=this._zoom!==e;n||(this.fire("movestart"),o&&this.fire("zoomstart")),this._zoom=e,this._initialCenter=t,this._initialTopLeftPoint=this._getNewTopLeftPoint(t),i?this._initialTopLeftPoint._add(this._getMapPanePos()):_.DomUtil.setPosition(this._mapPane,new _.Point(0,0)),this._tileLayersToLoad=this._tileLayersNum;var s=!this._loaded;this._loaded=!0,this.fire("viewreset",{hard:!i}),s&&(this.fire("load"),this.eachLayer(this._layerAdd,this)),this.fire("move"),(o||n)&&this.fire("zoomend"),this.fire("moveend",{hard:!i})},_rawPanBy:function(t){_.DomUtil.setPosition(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_updateZoomLevels:function(){var t,e=1/0,i=-1/0,n=this._getZoomSpan();for(t in this._zoomBoundLayers){var o=this._zoomBoundLayers[t];isNaN(o.options.minZoom)||(e=Math.min(e,o.options.minZoom)),isNaN(o.options.maxZoom)||(i=Math.max(i,o.options.maxZoom))}t===r?this._layersMaxZoom=this._layersMinZoom=r:(this._layersMaxZoom=i,this._layersMinZoom=e),n!==this._getZoomSpan()&&this.fire("zoomlevelschange")},_panInsideMaxBounds:function(){this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){if(_.DomEvent){t=t||"on",_.DomEvent[t](this._container,"click",this._onMouseClick,this);var e,i,n=["dblclick","mousedown","mouseup","mouseenter","mouseleave","mousemove","contextmenu"];for(e=0,i=n.length;e<i;e++)_.DomEvent[t](this._container,n[e],this._fireMouseEvent,this);this.options.trackResize&&_.DomEvent[t](a,"resize",this._onResize,this)}},_onResize:function(){_.Util.cancelAnimFrame(this._resizeRequest),this._resizeRequest=_.Util.requestAnimFrame(function(){this.invalidateSize({debounceMoveend:!0})},this,!1,this._container)},_onMouseClick:function(t){!this._loaded||!t._simulated&&(this.dragging&&this.dragging.moved()||this.boxZoom&&this.boxZoom.moved())||_.DomEvent._skipped(t)||(this.fire("preclick"),this._fireMouseEvent(t))},_fireMouseEvent:function(t){if(this._loaded&&!_.DomEvent._skipped(t)){var e=t.type;if(e="mouseenter"===e?"mouseover":"mouseleave"===e?"mouseout":e,this.hasEventListeners(e)){"contextmenu"===e&&_.DomEvent.preventDefault(t);var i=this.mouseEventToContainerPoint(t),n=this.containerPointToLayerPoint(i),o=this.layerPointToLatLng(n);this.fire(e,{latlng:o,layerPoint:n,containerPoint:i,originalEvent:t})}}},_onTileLayerLoad:function(){this._tileLayersToLoad--,this._tileLayersNum&&!this._tileLayersToLoad&&this.fire("tilelayersload")},_clearHandlers:function(){for(var t=0,e=this._handlers.length;t<e;t++)this._handlers[t].disable()},whenReady:function(t,e){return this._loaded?t.call(e||this,this):this.on("load",t,e),this},_layerAdd:function(t){t.onAdd(this),this.fire("layeradd",{layer:t})},_getMapPanePos:function(){return _.DomUtil.getPosition(this._mapPane)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(){return this.getPixelOrigin().subtract(this._getMapPanePos())},_getNewTopLeftPoint:function(t,e){var i=this.getSize()._divideBy(2);return this.project(t,e)._subtract(i)._round()},_latLngToNewLayerPoint:function(t,e,i){var n=this._getNewTopLeftPoint(i,e).add(this._getMapPanePos());return this.project(t,e)._subtract(n)},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,e,i){if(!i)return t;var n=this.project(t,e),o=this.getSize().divideBy(2),s=new _.Bounds(n.subtract(o),n.add(o)),a=this._getBoundsOffset(s,i,e);return this.unproject(n.add(a),e)},_limitOffset:function(t,e){if(!e)return t;var i=this.getPixelBounds(),n=new _.Bounds(i.min.add(t),i.max.add(t));return t.add(this._getBoundsOffset(n,e))},_getBoundsOffset:function(t,e,i){var n=this.project(e.getNorthWest(),i).subtract(t.min),o=this.project(e.getSouthEast(),i).subtract(t.max),s=this._rebound(n.x,-o.x),a=this._rebound(n.y,-o.y);return new _.Point(s,a)},_rebound:function(t,e){return 0<t+e?Math.round(t-e)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(e))},_limitZoom:function(t){var e=this.getMinZoom(),i=this.getMaxZoom();return Math.max(e,Math.min(i,t))}}),_.map=function(t,e){return new _.Map(t,e)},_.Projection.Mercator={MAX_LATITUDE:85.0840591556,R_MINOR:6356752.314245179,R_MAJOR:6378137,project:function(t){var e=_.LatLng.DEG_TO_RAD,i=this.MAX_LATITUDE,n=Math.max(Math.min(i,t.lat),-i),o=this.R_MAJOR,s=this.R_MINOR,a=t.lng*e*o,r=n*e,h=s/o,l=Math.sqrt(1-h*h),u=l*Math.sin(r);u=Math.pow((1-u)/(1+u),.5*l);var c=Math.tan(.5*(.5*Math.PI-r))/u;return r=-o*Math.log(c),new _.Point(a,r)},unproject:function(t){for(var e,i=_.LatLng.RAD_TO_DEG,n=this.R_MAJOR,o=this.R_MINOR,s=t.x*i/n,a=o/n,r=Math.sqrt(1-a*a),h=Math.exp(-t.y/n),l=Math.PI/2-2*Math.atan(h),u=15,c=.1;1e-7<Math.abs(c)&&0<--u;)e=r*Math.sin(l),l+=c=Math.PI/2-2*Math.atan(h*Math.pow((1-e)/(1+e),.5*r))-l;return new _.LatLng(l*i,s)}},_.CRS.EPSG3395=_.extend({},_.CRS,{code:"EPSG:3395",projection:_.Projection.Mercator,transformation:(o=_.Projection.Mercator.R_MAJOR,s=.5/(Math.PI*o),new _.Transformation(s,.5,-s,.5))}),_.TileLayer=_.Class.extend({includes:_.Mixin.Events,options:{minZoom:0,maxZoom:18,tileSize:256,subdomains:"abc",errorTileUrl:"",attribution:"",zoomOffset:0,opacity:1,unloadInvisibleTiles:_.Browser.mobile,updateWhenIdle:_.Browser.mobile},initialize:function(t,e){(e=_.setOptions(this,e)).detectRetina&&_.Browser.retina&&0<e.maxZoom&&(e.tileSize=Math.floor(e.tileSize/2),e.zoomOffset++,0<e.minZoom&&e.minZoom--,this.options.maxZoom--),e.bounds&&(e.bounds=_.latLngBounds(e.bounds)),this._url=t;var i=this.options.subdomains;"string"==typeof i&&(this.options.subdomains=i.split(""))},onAdd:function(t){this._map=t,this._animated=t._zoomAnimated,this._initContainer(),t.on({viewreset:this._reset,moveend:this._update},this),this._animated&&t.on({zoomanim:this._animateZoom,zoomend:this._endZoomAnim},this),this.options.updateWhenIdle||(this._limitedUpdate=_.Util.limitExecByInterval(this._update,150,this),t.on("move",this._limitedUpdate,this)),this._reset(),this._update()},addTo:function(t){return t.addLayer(this),this},onRemove:function(t){this._container.parentNode.removeChild(this._container),t.off({viewreset:this._reset,moveend:this._update},this),this._animated&&t.off({zoomanim:this._animateZoom,zoomend:this._endZoomAnim},this),this.options.updateWhenIdle||t.off("move",this._limitedUpdate,this),this._container=null,this._map=null},bringToFront:function(){var t=this._map._panes.tilePane;return this._container&&(t.appendChild(this._container),this._setAutoZIndex(t,Math.max)),this},bringToBack:function(){var t=this._map._panes.tilePane;return this._container&&(t.insertBefore(this._container,t.firstChild),this._setAutoZIndex(t,Math.min)),this},getAttribution:function(){return this.options.attribution},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},setUrl:function(t,e){return this._url=t,e||this.redraw(),this},redraw:function(){return this._map&&(this._reset({hard:!0}),this._update()),this},_updateZIndex:function(){this._container&&this.options.zIndex!==r&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t,e){var i,n,o,s=t.children,a=-e(1/0,-1/0);for(n=0,o=s.length;n<o;n++)s[n]!==this._container&&(i=parseInt(s[n].style.zIndex,10),isNaN(i)||(a=e(a,i)));this.options.zIndex=this._container.style.zIndex=(isFinite(a)?a:0)+e(1,-1)},_updateOpacity:function(){var t,e=this._tiles;if(_.Browser.ielt9)for(t in e)_.DomUtil.setOpacity(e[t],this.options.opacity);else _.DomUtil.setOpacity(this._container,this.options.opacity)},_initContainer:function(){var t=this._map._panes.tilePane;if(!this._container){if(this._container=_.DomUtil.create("div","leaflet-layer"),this._updateZIndex(),this._animated){var e="leaflet-tile-container";this._bgBuffer=_.DomUtil.create("div",e,this._container),this._tileContainer=_.DomUtil.create("div",e,this._container)}else this._tileContainer=this._container;t.appendChild(this._container),this.options.opacity<1&&this._updateOpacity()}},_reset:function(t){for(var e in this._tiles)this.fire("tileunload",{tile:this._tiles[e]});this._tiles={},this._tilesToLoad=0,this.options.reuseTiles&&(this._unusedTiles=[]),this._tileContainer.innerHTML="",this._animated&&t&&t.hard&&this._clearBgBuffer(),this._initContainer()},_getTileSize:function(){var t=this._map,e=t.getZoom()+this.options.zoomOffset,i=this.options.maxNativeZoom,n=this.options.tileSize;return i&&i<e&&(n=Math.round(t.getZoomScale(e)/t.getZoomScale(i)*n)),n},_update:function(){if(this._map){var t=this._map,e=t.getPixelBounds(),i=t.getZoom(),n=this._getTileSize();if(!(i>this.options.maxZoom||i<this.options.minZoom)){var o=_.bounds(e.min.divideBy(n)._floor(),e.max.divideBy(n)._floor());this._addTilesFromCenterOut(o),(this.options.unloadInvisibleTiles||this.options.reuseTiles)&&this._removeOtherTiles(o)}}},_addTilesFromCenterOut:function(t){var e,i,n,o=[],s=t.getCenter();for(e=t.min.y;e<=t.max.y;e++)for(i=t.min.x;i<=t.max.x;i++)n=new _.Point(i,e),this._tileShouldBeLoaded(n)&&o.push(n);var a=o.length;if(0!==a){o.sort(function(t,e){return t.distanceTo(s)-e.distanceTo(s)});var r=p.createDocumentFragment();for(this._tilesToLoad||this.fire("loading"),this._tilesToLoad+=a,i=0;i<a;i++)this._addTile(o[i],r);this._tileContainer.appendChild(r)}},_tileShouldBeLoaded:function(t){if(t.x+":"+t.y in this._tiles)return!1;var e=this.options;if(!e.continuousWorld){var i=this._getWrapTileNum();if(e.noWrap&&(t.x<0||t.x>=i.x)||t.y<0||t.y>=i.y)return!1}if(e.bounds){var n=e.tileSize,o=t.multiplyBy(n),s=o.add([n,n]),a=this._map.unproject(o),r=this._map.unproject(s);if(e.continuousWorld||e.noWrap||(a=a.wrap(),r=r.wrap()),!e.bounds.intersects([a,r]))return!1}return!0},_removeOtherTiles:function(t){var e,i,n,o;for(o in this._tiles)e=o.split(":"),i=parseInt(e[0],10),n=parseInt(e[1],10),(i<t.min.x||i>t.max.x||n<t.min.y||n>t.max.y)&&this._removeTile(o)},_removeTile:function(t){var e=this._tiles[t];this.fire("tileunload",{tile:e,url:e.src}),this.options.reuseTiles?(_.DomUtil.removeClass(e,"leaflet-tile-loaded"),this._unusedTiles.push(e)):e.parentNode===this._tileContainer&&this._tileContainer.removeChild(e),_.Browser.android||(e.onload=null,e.src=_.Util.emptyImageUrl),delete this._tiles[t]},_addTile:function(t,e){var i=this._getTilePos(t),n=this._getTile();_.DomUtil.setPosition(n,i,_.Browser.chrome),this._tiles[t.x+":"+t.y]=n,this._loadTile(n,t),n.parentNode!==this._tileContainer&&e.appendChild(n)},_getZoomForUrl:function(){var t=this.options,e=this._map.getZoom();return t.zoomReverse&&(e=t.maxZoom-e),e+=t.zoomOffset,t.maxNativeZoom?Math.min(e,t.maxNativeZoom):e},_getTilePos:function(t){var e=this._map.getPixelOrigin(),i=this._getTileSize();return t.multiplyBy(i).subtract(e)},getTileUrl:function(t){return _.Util.template(this._url,_.extend({s:this._getSubdomain(t),z:t.z,x:t.x,y:t.y},this.options))},_getWrapTileNum:function(){return this._map.options.crs.getSize(this._map.getZoom()).divideBy(this._getTileSize())._floor()},_adjustTilePoint:function(t){var e=this._getWrapTileNum();this.options.continuousWorld||this.options.noWrap||(t.x=(t.x%e.x+e.x)%e.x),this.options.tms&&(t.y=e.y-t.y-1),t.z=this._getZoomForUrl()},_getSubdomain:function(t){var e=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[e]},_getTile:function(){if(this.options.reuseTiles&&0<this._unusedTiles.length){var t=this._unusedTiles.pop();return this._resetTile(t),t}return this._createTile()},_resetTile:function(){},_createTile:function(){var t=_.DomUtil.create("img","leaflet-tile");return t.style.width=t.style.height=this._getTileSize()+"px",t.galleryimg="no",t.onselectstart=t.onmousemove=_.Util.falseFn,_.Browser.ielt9&&this.options.opacity!==r&&_.DomUtil.setOpacity(t,this.options.opacity),_.Browser.mobileWebkit3d&&(t.style.WebkitBackfaceVisibility="hidden"),t},_loadTile:function(t,e){t._layer=this,t.onload=this._tileOnLoad,t.onerror=this._tileOnError,this._adjustTilePoint(e),t.src=this.getTileUrl(e),this.fire("tileloadstart",{tile:t,url:t.src})},_tileLoaded:function(){this._tilesToLoad--,this._animated&&_.DomUtil.addClass(this._tileContainer,"leaflet-zoom-animated"),this._tilesToLoad||(this.fire("load"),this._animated&&(clearTimeout(this._clearBgBufferTimer),this._clearBgBufferTimer=setTimeout(_.bind(this._clearBgBuffer,this),500)))},_tileOnLoad:function(){var t=this._layer;this.src!==_.Util.emptyImageUrl&&(_.DomUtil.addClass(this,"leaflet-tile-loaded"),t.fire("tileload",{tile:this,url:this.src})),t._tileLoaded()},_tileOnError:function(){var t=this._layer;t.fire("tileerror",{tile:this,url:this.src});var e=t.options.errorTileUrl;e&&(this.src=e),t._tileLoaded()}}),_.tileLayer=function(t,e){return new _.TileLayer(t,e)},_.TileLayer.WMS=_.TileLayer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",version:"1.1.1",layers:"",styles:"",format:"image/jpeg",transparent:!1},initialize:function(t,e){this._url=t;var i=_.extend({},this.defaultWmsParams),n=e.tileSize||this.options.tileSize;for(var o in i.width=i.height=e.detectRetina&&_.Browser.retina?2*n:n,e)this.options.hasOwnProperty(o)||"crs"===o||(i[o]=e[o]);this.wmsParams=i,_.setOptions(this,e)},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var e=1.3<=this._wmsVersion?"crs":"srs";this.wmsParams[e]=this._crs.code,_.TileLayer.prototype.onAdd.call(this,t)},getTileUrl:function(t){var e=this._map,i=this.options.tileSize,n=t.multiplyBy(i),o=n.add([i,i]),s=this._crs.project(e.unproject(n,t.z)),a=this._crs.project(e.unproject(o,t.z)),r=1.3<=this._wmsVersion&&this._crs===_.CRS.EPSG4326?[a.y,s.x,s.y,a.x].join(","):[s.x,a.y,a.x,s.y].join(","),h=_.Util.template(this._url,{s:this._getSubdomain(t)});return h+_.Util.getParamString(this.wmsParams,h,!0)+"&BBOX="+r},setParams:function(t,e){return _.extend(this.wmsParams,t),e||this.redraw(),this}}),_.tileLayer.wms=function(t,e){return new _.TileLayer.WMS(t,e)},_.TileLayer.Canvas=_.TileLayer.extend({options:{async:!1},initialize:function(t){_.setOptions(this,t)},redraw:function(){for(var t in this._map&&(this._reset({hard:!0}),this._update()),this._tiles)this._redrawTile(this._tiles[t]);return this},_redrawTile:function(t){this.drawTile(t,t._tilePoint,this._map._zoom)},_createTile:function(){var t=_.DomUtil.create("canvas","leaflet-tile");return t.width=t.height=this.options.tileSize,t.onselectstart=t.onmousemove=_.Util.falseFn,t},_loadTile:function(t,e){t._layer=this,t._tilePoint=e,this._redrawTile(t),this.options.async||this.tileDrawn(t)},drawTile:function(){},tileDrawn:function(t){this._tileOnLoad.call(t)}}),_.tileLayer.canvas=function(t){return new _.TileLayer.Canvas(t)},_.ImageOverlay=_.Class.extend({includes:_.Mixin.Events,options:{opacity:1},initialize:function(t,e,i){this._url=t,this._bounds=_.latLngBounds(e),_.setOptions(this,i)},onAdd:function(t){this._map=t,this._image||this._initImage(),t._panes.overlayPane.appendChild(this._image),t.on("viewreset",this._reset,this),t.options.zoomAnimation&&_.Browser.any3d&&t.on("zoomanim",this._animateZoom,this),this._reset()},onRemove:function(t){t.getPanes().overlayPane.removeChild(this._image),t.off("viewreset",this._reset,this),t.options.zoomAnimation&&t.off("zoomanim",this._animateZoom,this)},addTo:function(t){return t.addLayer(this),this},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},bringToFront:function(){return this._image&&this._map._panes.overlayPane.appendChild(this._image),this},bringToBack:function(){var t=this._map._panes.overlayPane;return this._image&&t.insertBefore(this._image,t.firstChild),this},setUrl:function(t){this._url=t,this._image.src=this._url},getAttribution:function(){return this.options.attribution},_initImage:function(){this._image=_.DomUtil.create("img","leaflet-image-layer"),this._map.options.zoomAnimation&&_.Browser.any3d?_.DomUtil.addClass(this._image,"leaflet-zoom-animated"):_.DomUtil.addClass(this._image,"leaflet-zoom-hide"),this._updateOpacity(),_.extend(this._image,{galleryimg:"no",onselectstart:_.Util.falseFn,onmousemove:_.Util.falseFn,onload:_.bind(this._onImageLoad,this),src:this._url})},_animateZoom:function(t){var e=this._map,i=this._image,n=e.getZoomScale(t.zoom),o=this._bounds.getNorthWest(),s=this._bounds.getSouthEast(),a=e._latLngToNewLayerPoint(o,t.zoom,t.center),r=e._latLngToNewLayerPoint(s,t.zoom,t.center)._subtract(a),h=a._add(r._multiplyBy(.5*(1-1/n)));i.style[_.DomUtil.TRANSFORM]=_.DomUtil.getTranslateString(h)+" scale("+n+") "},_reset:function(){var t=this._image,e=this._map.latLngToLayerPoint(this._bounds.getNorthWest()),i=this._map.latLngToLayerPoint(this._bounds.getSouthEast())._subtract(e);_.DomUtil.setPosition(t,e),t.style.width=i.x+"px",t.style.height=i.y+"px"},_onImageLoad:function(){this.fire("load")},_updateOpacity:function(){_.DomUtil.setOpacity(this._image,this.options.opacity)}}),_.imageOverlay=function(t,e,i){return new _.ImageOverlay(t,e,i)},_.Icon=_.Class.extend({options:{className:""},initialize:function(t){_.setOptions(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,e){var i,n=this._getIconUrl(t);if(n)return i=e&&"IMG"===e.tagName?this._createImg(n,e):this._createImg(n),this._setIconStyles(i,t),i;if("icon"===t)throw new Error("iconUrl not set in Icon options (see the docs).");return null},_setIconStyles:function(t,e){var i,n=this.options,o=_.point(n[e+"Size"]);!(i=_.point("shadow"===e&&n.shadowAnchor||n.iconAnchor))&&o&&(i=o.divideBy(2,!0)),t.className="leaflet-marker-"+e+" "+n.className,i&&(t.style.marginLeft=-i.x+"px",t.style.marginTop=-i.y+"px"),o&&(t.style.width=o.x+"px",t.style.height=o.y+"px")},_createImg:function(t,e){return(e=e||p.createElement("img")).src=t,e},_getIconUrl:function(t){return _.Browser.retina&&this.options[t+"RetinaUrl"]?this.options[t+"RetinaUrl"]:this.options[t+"Url"]}}),_.icon=function(t){return new _.Icon(t)},_.Icon.Default=_.Icon.extend({options:{iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]},_getIconUrl:function(t){var e=t+"Url";if(this.options[e])return this.options[e];_.Browser.retina&&"icon"===t&&(t+="-2x");var i=_.Icon.Default.imagePath;if(!i)throw new Error("Couldn't autodetect L.Icon.Default.imagePath, set it manually.");return i+"/marker-"+t+".png"}}),_.Icon.Default.imagePath=function(){var t,e,i,n,o=p.getElementsByTagName("script"),s=/[\/^]leaflet[\-\._]?([\w\-\._]*)\.js\??/;for(t=0,e=o.length;t<e;t++)if((i=o[t].src).match(s))return((n=i.split(s)[0])?n+"/":"")+"images"}(),_.Marker=_.Class.extend({includes:_.Mixin.Events,options:{icon:new _.Icon.Default,title:"",alt:"",clickable:!0,draggable:!1,keyboard:!0,zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250},initialize:function(t,e){_.setOptions(this,e),this._latlng=_.latLng(t)},onAdd:function(t){(this._map=t).on("viewreset",this.update,this),this._initIcon(),this.update(),this.fire("add"),t.options.zoomAnimation&&t.options.markerZoomAnimation&&t.on("zoomanim",this._animateZoom,this)},addTo:function(t){return t.addLayer(this),this},onRemove:function(t){this.dragging&&this.dragging.disable(),this._removeIcon(),this._removeShadow(),this.fire("remove"),t.off({viewreset:this.update,zoomanim:this._animateZoom},this),this._map=null},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=_.latLng(t),this.update(),this.fire("move",{latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update(),this},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup),this},update:function(){if(this._icon){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var t=this.options,e=this._map,i=e.options.zoomAnimation&&e.options.markerZoomAnimation?"leaflet-zoom-animated":"leaflet-zoom-hide",n=t.icon.createIcon(this._icon),o=!1;n!==this._icon&&(this._icon&&this._removeIcon(),o=!0,t.title&&(n.title=t.title),t.alt&&(n.alt=t.alt)),_.DomUtil.addClass(n,i),t.keyboard&&(n.tabIndex="0"),this._icon=n,this._initInteraction(),t.riseOnHover&&_.DomEvent.on(n,"mouseover",this._bringToFront,this).on(n,"mouseout",this._resetZIndex,this);var s=t.icon.createShadow(this._shadow),a=!1;s!==this._shadow&&(this._removeShadow(),a=!0),s&&_.DomUtil.addClass(s,i),this._shadow=s,t.opacity<1&&this._updateOpacity();var r=this._map._panes;o&&r.markerPane.appendChild(this._icon),s&&a&&r.shadowPane.appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&_.DomEvent.off(this._icon,"mouseover",this._bringToFront).off(this._icon,"mouseout",this._resetZIndex),this._map._panes.markerPane.removeChild(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&this._map._panes.shadowPane.removeChild(this._shadow),this._shadow=null},_setPos:function(t){_.DomUtil.setPosition(this._icon,t),this._shadow&&_.DomUtil.setPosition(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon.style.zIndex=this._zIndex+t},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(e)},_initInteraction:function(){if(this.options.clickable){var t=this._icon,e=["dblclick","mousedown","mouseover","mouseout","contextmenu"];_.DomUtil.addClass(t,"leaflet-clickable"),_.DomEvent.on(t,"click",this._onMouseClick,this),_.DomEvent.on(t,"keypress",this._onKeyPress,this);for(var i=0;i<e.length;i++)_.DomEvent.on(t,e[i],this._fireMouseEvent,this);_.Handler.MarkerDrag&&(this.dragging=new _.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_onMouseClick:function(t){var e=this.dragging&&this.dragging.moved();(this.hasEventListeners(t.type)||e)&&_.DomEvent.stopPropagation(t),e||(this.dragging&&this.dragging._enabled||!this._map.dragging||!this._map.dragging.moved())&&this.fire(t.type,{originalEvent:t,latlng:this._latlng})},_onKeyPress:function(t){13===t.keyCode&&this.fire("click",{originalEvent:t,latlng:this._latlng})},_fireMouseEvent:function(t){this.fire(t.type,{originalEvent:t,latlng:this._latlng}),"contextmenu"===t.type&&this.hasEventListeners(t.type)&&_.DomEvent.preventDefault(t),"mousedown"!==t.type?_.DomEvent.stopPropagation(t):_.DomEvent.preventDefault(t)},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){_.DomUtil.setOpacity(this._icon,this.options.opacity),this._shadow&&_.DomUtil.setOpacity(this._shadow,this.options.opacity)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)}}),_.marker=function(t,e){return new _.Marker(t,e)},_.DivIcon=_.Icon.extend({options:{iconSize:[12,12],className:"leaflet-div-icon",html:!1},createIcon:function(t){var e=t&&"DIV"===t.tagName?t:p.createElement("div"),i=this.options;return e.innerHTML=!1!==i.html?i.html:"",i.bgPos&&(e.style.backgroundPosition=-i.bgPos.x+"px "+-i.bgPos.y+"px"),this._setIconStyles(e,"icon"),e},createShadow:function(){return null}}),_.divIcon=function(t){return new _.DivIcon(t)},_.Map.mergeOptions({closePopupOnClick:!0}),_.Popup=_.Class.extend({includes:_.Mixin.Events,options:{minWidth:50,maxWidth:300,autoPan:!0,closeButton:!0,offset:[0,7],autoPanPadding:[5,5],keepInView:!1,className:"",zoomAnimation:!0},initialize:function(t,e){_.setOptions(this,t),this._source=e,this._animated=_.Browser.any3d&&this.options.zoomAnimation,this._isOpen=!1},onAdd:function(t){this._map=t,this._container||this._initLayout();var e=t.options.fadeAnimation;e&&_.DomUtil.setOpacity(this._container,0),t._panes.popupPane.appendChild(this._container),t.on(this._getEvents(),this),this.update(),e&&_.DomUtil.setOpacity(this._container,1),this.fire("open"),t.fire("popupopen",{popup:this}),this._source&&this._source.fire("popupopen",{popup:this})},addTo:function(t){return t.addLayer(this),this},openOn:function(t){return t.openPopup(this),this},onRemove:function(t){t._panes.popupPane.removeChild(this._container),_.Util.falseFn(this._container.offsetWidth),t.off(this._getEvents(),this),t.options.fadeAnimation&&_.DomUtil.setOpacity(this._container,0),this._map=null,this.fire("close"),t.fire("popupclose",{popup:this}),this._source&&this._source.fire("popupclose",{popup:this})},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=_.latLng(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},_getEvents:function(){var t={viewreset:this._updatePosition};return this._animated&&(t.zoomanim=this._zoomAnimation),("closeOnClick"in this.options?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this._close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var t,e="leaflet-popup",i=e+" "+this.options.className+" leaflet-zoom-"+(this._animated?"animated":"hide"),n=this._container=_.DomUtil.create("div",i);this.options.closeButton&&((t=this._closeButton=_.DomUtil.create("a",e+"-close-button",n)).href="#close",t.innerHTML="&#215;",_.DomEvent.disableClickPropagation(t),_.DomEvent.on(t,"click",this._onCloseButtonClick,this));var o=this._wrapper=_.DomUtil.create("div",e+"-content-wrapper",n);_.DomEvent.disableClickPropagation(o),this._contentNode=_.DomUtil.create("div",e+"-content",o),_.DomEvent.disableScrollPropagation(this._contentNode),_.DomEvent.on(o,"contextmenu",_.DomEvent.stopPropagation),this._tipContainer=_.DomUtil.create("div",e+"-tip-container",n),this._tip=_.DomUtil.create("div",e+"-tip",this._tipContainer)},_updateContent:function(){if(this._content){if("string"==typeof this._content)this._contentNode.innerHTML=this._content;else{for(;this._contentNode.hasChildNodes();)this._contentNode.removeChild(this._contentNode.firstChild);this._contentNode.appendChild(this._content)}this.fire("contentupdate")}},_updateLayout:function(){var t=this._contentNode,e=t.style;e.width="",e.whiteSpace="nowrap";var i=t.offsetWidth;i=Math.min(i,this.options.maxWidth),i=Math.max(i,this.options.minWidth),e.width=i+1+"px",e.whiteSpace="",e.height="";var n=t.offsetHeight,o=this.options.maxHeight,s="leaflet-popup-scrolled";o&&o<n?(e.height=o+"px",_.DomUtil.addClass(t,s)):_.DomUtil.removeClass(t,s),this._containerWidth=this._container.offsetWidth},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),e=this._animated,i=_.point(this.options.offset);e&&_.DomUtil.setPosition(this._container,t),this._containerBottom=-i.y-(e?0:t.y),this._containerLeft=-Math.round(this._containerWidth/2)+i.x+(e?0:t.x),this._container.style.bottom=this._containerBottom+"px",this._container.style.left=this._containerLeft+"px"}},_zoomAnimation:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);_.DomUtil.setPosition(this._container,e)},_adjustPan:function(){if(this.options.autoPan){var t=this._map,e=this._container.offsetHeight,i=this._containerWidth,n=new _.Point(this._containerLeft,-e-this._containerBottom);this._animated&&n._add(_.DomUtil.getPosition(this._container));var o=t.layerPointToContainerPoint(n),s=_.point(this.options.autoPanPadding),a=_.point(this.options.autoPanPaddingTopLeft||s),r=_.point(this.options.autoPanPaddingBottomRight||s),h=t.getSize(),l=0,u=0;o.x+i+r.x>h.x&&(l=o.x+i-h.x+r.x),o.x-l-a.x<0&&(l=o.x-a.x),o.y+e+r.y>h.y&&(u=o.y+e-h.y+r.y),o.y-u-a.y<0&&(u=o.y-a.y),(l||u)&&t.fire("autopanstart").panBy([l,u])}},_onCloseButtonClick:function(t){this._close(),_.DomEvent.stop(t)}}),_.popup=function(t,e){return new _.Popup(t,e)},_.Map.include({openPopup:function(t,e,i){if(this.closePopup(),!(t instanceof _.Popup)){var n=t;t=new _.Popup(i).setLatLng(e).setContent(n)}return t._isOpen=!0,this._popup=t,this.addLayer(t)},closePopup:function(t){return t&&t!==this._popup||(t=this._popup,this._popup=null),t&&(this.removeLayer(t),t._isOpen=!1),this}}),_.Marker.include({openPopup:function(){return this._popup&&this._map&&!this._map.hasLayer(this._popup)&&(this._popup.setLatLng(this._latlng),this._map.openPopup(this._popup)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(){return this._popup&&(this._popup._isOpen?this.closePopup():this.openPopup()),this},bindPopup:function(t,e){var i=_.point(this.options.icon.options.popupAnchor||[0,0]);return i=i.add(_.Popup.prototype.options.offset),e&&e.offset&&(i=i.add(e.offset)),e=_.extend({offset:i},e),this._popupHandlersAdded||(this.on("click",this.togglePopup,this).on("remove",this.closePopup,this).on("move",this._movePopup,this),this._popupHandlersAdded=!0),t instanceof _.Popup?(_.setOptions(t,e),this._popup=t):this._popup=new _.Popup(e,this).setContent(t),this},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},unbindPopup:function(){return this._popup&&(this._popup=null,this.off("click",this.togglePopup,this).off("remove",this.closePopup,this).off("move",this._movePopup,this),this._popupHandlersAdded=!1),this},getPopup:function(){return this._popup},_movePopup:function(t){this._popup.setLatLng(t.latlng)}}),_.LayerGroup=_.Class.extend({initialize:function(t){var e,i;if(this._layers={},t)for(e=0,i=t.length;e<i;e++)this.addLayer(t[e])},addLayer:function(t){var e=this.getLayerId(t);return this._layers[e]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var e=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[e]&&this._map.removeLayer(this._layers[e]),delete this._layers[e],this},hasLayer:function(t){return!!t&&(t in this._layers||this.getLayerId(t)in this._layers)},clearLayers:function(){return this.eachLayer(this.removeLayer,this),this},invoke:function(t){var e,i,n=Array.prototype.slice.call(arguments,1);for(e in this._layers)(i=this._layers[e])[t]&&i[t].apply(i,n);return this},onAdd:function(t){this._map=t,this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t),this._map=null},addTo:function(t){return t.addLayer(this),this},eachLayer:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];for(var e in this._layers)t.push(this._layers[e]);return t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return _.stamp(t)}}),_.layerGroup=function(t){return new _.LayerGroup(t)},_.FeatureGroup=_.LayerGroup.extend({includes:_.Mixin.Events,statics:{EVENTS:"click dblclick mouseover mouseout mousemove contextmenu popupopen popupclose"},addLayer:function(t){return this.hasLayer(t)?this:("on"in t&&t.on(_.FeatureGroup.EVENTS,this._propagateEvent,this),_.LayerGroup.prototype.addLayer.call(this,t),this._popupContent&&t.bindPopup&&t.bindPopup(this._popupContent,this._popupOptions),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.off(_.FeatureGroup.EVENTS,this._propagateEvent,this),_.LayerGroup.prototype.removeLayer.call(this,t),this._popupContent&&this.invoke("unbindPopup"),this.fire("layerremove",{layer:t})):this},bindPopup:function(t,e){return this._popupContent=t,this._popupOptions=e,this.invoke("bindPopup",t,e)},openPopup:function(t){for(var e in this._layers){this._layers[e].openPopup(t);break}return this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var e=new _.LatLngBounds;return this.eachLayer(function(t){e.extend(t instanceof _.Marker?t.getLatLng():t.getBounds())}),e},_propagateEvent:function(t){t=_.extend({layer:t.target,target:this},t),this.fire(t.type,t)}}),_.featureGroup=function(t){return new _.FeatureGroup(t)},_.Path=_.Class.extend({includes:[_.Mixin.Events],statics:{CLIP_PADDING:(n=((_.Browser.mobile?1280:2e3)/Math.max(a.outerWidth,a.outerHeight)-1)/2,Math.max(0,Math.min(.5,n)))},options:{stroke:!0,color:"#0033ff",dashArray:null,lineCap:null,lineJoin:null,weight:5,opacity:.5,fill:!1,fillColor:null,fillOpacity:.2,clickable:!0},initialize:function(t){_.setOptions(this,t)},onAdd:function(t){this._map=t,this._container||(this._initElements(),this._initEvents()),this.projectLatlngs(),this._updatePath(),this._container&&this._map._pathRoot.appendChild(this._container),this.fire("add"),t.on({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},addTo:function(t){return t.addLayer(this),this},onRemove:function(t){t._pathRoot.removeChild(this._container),this.fire("remove"),this._map=null,_.Browser.vml&&(this._container=null,this._stroke=null,this._fill=null),t.off({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},projectLatlngs:function(){},setStyle:function(t){return _.setOptions(this,t),this._container&&this._updateStyle(),this},redraw:function(){return this._map&&(this.projectLatlngs(),this._updatePath()),this}}),_.Map.include({_updatePathViewport:function(){var t=_.Path.CLIP_PADDING,e=this.getSize(),i=_.DomUtil.getPosition(this._mapPane).multiplyBy(-1)._subtract(e.multiplyBy(t)._round()),n=i.add(e.multiplyBy(1+2*t)._round());this._pathViewport=new _.Bounds(i,n)}}),_.Path.SVG_NS="http://www.w3.org/2000/svg",_.Browser.svg=!(!p.createElementNS||!p.createElementNS(_.Path.SVG_NS,"svg").createSVGRect),_.Path=_.Path.extend({statics:{SVG:_.Browser.svg},bringToFront:function(){var t=this._map._pathRoot,e=this._container;return e&&t.lastChild!==e&&t.appendChild(e),this},bringToBack:function(){var t=this._map._pathRoot,e=this._container,i=t.firstChild;return e&&i!==e&&t.insertBefore(e,i),this},getPathString:function(){},_createElement:function(t){return p.createElementNS(_.Path.SVG_NS,t)},_initElements:function(){this._map._initPathRoot(),this._initPath(),this._initStyle()},_initPath:function(){this._container=this._createElement("g"),this._path=this._createElement("path"),this.options.className&&_.DomUtil.addClass(this._path,this.options.className),this._container.appendChild(this._path)},_initStyle:function(){this.options.stroke&&(this._path.setAttribute("stroke-linejoin","round"),this._path.setAttribute("stroke-linecap","round")),this.options.fill&&this._path.setAttribute("fill-rule","evenodd"),this.options.pointerEvents&&this._path.setAttribute("pointer-events",this.options.pointerEvents),this.options.clickable||this.options.pointerEvents||this._path.setAttribute("pointer-events","none"),this._updateStyle()},_updateStyle:function(){this.options.stroke?(this._path.setAttribute("stroke",this.options.color),this._path.setAttribute("stroke-opacity",this.options.opacity),this._path.setAttribute("stroke-width",this.options.weight),this.options.dashArray?this._path.setAttribute("stroke-dasharray",this.options.dashArray):this._path.removeAttribute("stroke-dasharray"),this.options.lineCap&&this._path.setAttribute("stroke-linecap",this.options.lineCap),this.options.lineJoin&&this._path.setAttribute("stroke-linejoin",this.options.lineJoin)):this._path.setAttribute("stroke","none"),this.options.fill?(this._path.setAttribute("fill",this.options.fillColor||this.options.color),this._path.setAttribute("fill-opacity",this.options.fillOpacity)):this._path.setAttribute("fill","none")},_updatePath:function(){var t=this.getPathString();t||(t="M0 0"),this._path.setAttribute("d",t)},_initEvents:function(){if(this.options.clickable){(_.Browser.svg||!_.Browser.vml)&&_.DomUtil.addClass(this._path,"leaflet-clickable"),_.DomEvent.on(this._container,"click",this._onMouseClick,this);for(var t=["dblclick","mousedown","mouseover","mouseout","mousemove","contextmenu"],e=0;e<t.length;e++)_.DomEvent.on(this._container,t[e],this._fireMouseEvent,this)}},_onMouseClick:function(t){this._map.dragging&&this._map.dragging.moved()||this._fireMouseEvent(t)},_fireMouseEvent:function(t){if(this.hasEventListeners(t.type)){var e=this._map,i=e.mouseEventToContainerPoint(t),n=e.containerPointToLayerPoint(i),o=e.layerPointToLatLng(n);this.fire(t.type,{latlng:o,layerPoint:n,containerPoint:i,originalEvent:t}),"contextmenu"===t.type&&_.DomEvent.preventDefault(t),"mousemove"!==t.type&&_.DomEvent.stopPropagation(t)}}}),_.Map.include({_initPathRoot:function(){this._pathRoot||(this._pathRoot=_.Path.prototype._createElement("svg"),this._panes.overlayPane.appendChild(this._pathRoot),this.options.zoomAnimation&&_.Browser.any3d?(_.DomUtil.addClass(this._pathRoot,"leaflet-zoom-animated"),this.on({zoomanim:this._animatePathZoom,zoomend:this._endPathZoom})):_.DomUtil.addClass(this._pathRoot,"leaflet-zoom-hide"),this.on("moveend",this._updateSvgViewport),this._updateSvgViewport())},_animatePathZoom:function(t){var e=this.getZoomScale(t.zoom),i=this._getCenterOffset(t.center)._multiplyBy(-e)._add(this._pathViewport.min);this._pathRoot.style[_.DomUtil.TRANSFORM]=_.DomUtil.getTranslateString(i)+" scale("+e+") ",this._pathZooming=!0},_endPathZoom:function(){this._pathZooming=!1},_updateSvgViewport:function(){if(!this._pathZooming){this._updatePathViewport();var t=this._pathViewport,e=t.min,i=t.max,n=i.x-e.x,o=i.y-e.y,s=this._pathRoot,a=this._panes.overlayPane;_.Browser.mobileWebkit&&a.removeChild(s),_.DomUtil.setPosition(s,e),s.setAttribute("width",n),s.setAttribute("height",o),s.setAttribute("viewBox",[e.x,e.y,n,o].join(" ")),_.Browser.mobileWebkit&&a.appendChild(s)}}}),_.Path.include({bindPopup:function(t,e){return t instanceof _.Popup?this._popup=t:((!this._popup||e)&&(this._popup=new _.Popup(e,this)),this._popup.setContent(t)),this._popupHandlersAdded||(this.on("click",this._openPopup,this).on("remove",this.closePopup,this),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this._popup=null,this.off("click",this._openPopup).off("remove",this.closePopup),this._popupHandlersAdded=!1),this},openPopup:function(t){return this._popup&&(t=t||this._latlng||this._latlngs[Math.floor(this._latlngs.length/2)],this._openPopup({latlng:t})),this},closePopup:function(){return this._popup&&this._popup._close(),this},_openPopup:function(t){this._popup.setLatLng(t.latlng),this._map.openPopup(this._popup)}}),_.Browser.vml=!_.Browser.svg&&function(){try{var t=p.createElement("div");t.innerHTML='<v:shape adj="1"/>';var e=t.firstChild;return e.style.behavior="url(#default#VML)",e&&"object"==typeof e.adj}catch(t){return!1}}(),_.Path=_.Browser.svg||!_.Browser.vml?_.Path:_.Path.extend({statics:{VML:!0,CLIP_PADDING:.02},_createElement:function(){try{return p.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return p.createElement("<lvml:"+t+' class="lvml">')}}catch(t){return function(t){return p.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),_initPath:function(){var t=this._container=this._createElement("shape");_.DomUtil.addClass(t,"leaflet-vml-shape"+(this.options.className?" "+this.options.className:"")),this.options.clickable&&_.DomUtil.addClass(t,"leaflet-clickable"),t.coordsize="1 1",this._path=this._createElement("path"),t.appendChild(this._path),this._map._pathRoot.appendChild(t)},_initStyle:function(){this._updateStyle()},_updateStyle:function(){var t=this._stroke,e=this._fill,i=this.options,n=this._container;n.stroked=i.stroke,n.filled=i.fill,i.stroke?(t||((t=this._stroke=this._createElement("stroke")).endcap="round",n.appendChild(t)),t.weight=i.weight+"px",t.color=i.color,t.opacity=i.opacity,t.dashStyle=i.dashArray?_.Util.isArray(i.dashArray)?i.dashArray.join(" "):i.dashArray.replace(/( *, *)/g," "):"",i.lineCap&&(t.endcap=i.lineCap.replace("butt","flat")),i.lineJoin&&(t.joinstyle=i.lineJoin)):t&&(n.removeChild(t),this._stroke=null),i.fill?(e||(e=this._fill=this._createElement("fill"),n.appendChild(e)),e.color=i.fillColor||i.color,e.opacity=i.fillOpacity):e&&(n.removeChild(e),this._fill=null)},_updatePath:function(){var t=this._container.style;t.display="none",this._path.v=this.getPathString()+" ",t.display=""}}),_.Map.include(_.Browser.svg||!_.Browser.vml?{}:{_initPathRoot:function(){if(!this._pathRoot){var t=this._pathRoot=p.createElement("div");t.className="leaflet-vml-container",this._panes.overlayPane.appendChild(t),this.on("moveend",this._updatePathViewport),this._updatePathViewport()}}}),_.Browser.canvas=!!p.createElement("canvas").getContext,_.Path=_.Path.SVG&&!a.L_PREFER_CANVAS||!_.Browser.canvas?_.Path:_.Path.extend({statics:{CANVAS:!0,SVG:!1},redraw:function(){return this._map&&(this.projectLatlngs(),this._requestUpdate()),this},setStyle:function(t){return _.setOptions(this,t),this._map&&(this._updateStyle(),this._requestUpdate()),this},onRemove:function(t){t.off("viewreset",this.projectLatlngs,this).off("moveend",this._updatePath,this),this.options.clickable&&(this._map.off("click",this._onClick,this),this._map.off("mousemove",this._onMouseMove,this)),this._requestUpdate(),this.fire("remove"),this._map=null},_requestUpdate:function(){this._map&&!_.Path._updateRequest&&(_.Path._updateRequest=_.Util.requestAnimFrame(this._fireMapMoveEnd,this._map))},_fireMapMoveEnd:function(){_.Path._updateRequest=null,this.fire("moveend")},_initElements:function(){this._map._initPathRoot(),this._ctx=this._map._canvasCtx},_updateStyle:function(){var t=this.options;t.stroke&&(this._ctx.lineWidth=t.weight,this._ctx.strokeStyle=t.color),t.fill&&(this._ctx.fillStyle=t.fillColor||t.color)},_drawPath:function(){var t,e,i,n,o,s;for(this._ctx.beginPath(),t=0,i=this._parts.length;t<i;t++){for(e=0,n=this._parts[t].length;e<n;e++)o=this._parts[t][e],s=(0===e?"move":"line")+"To",this._ctx[s](o.x,o.y);this instanceof _.Polygon&&this._ctx.closePath()}},_checkIfEmpty:function(){return!this._parts.length},_updatePath:function(){if(!this._checkIfEmpty()){var t=this._ctx,e=this.options;this._drawPath(),t.save(),this._updateStyle(),e.fill&&(t.globalAlpha=e.fillOpacity,t.fill()),e.stroke&&(t.globalAlpha=e.opacity,t.stroke()),t.restore()}},_initEvents:function(){this.options.clickable&&(this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onClick,this))},_onClick:function(t){this._containsPoint(t.layerPoint)&&this.fire("click",t)},_onMouseMove:function(t){this._map&&!this._map._animatingZoom&&(this._containsPoint(t.layerPoint)?(this._ctx.canvas.style.cursor="pointer",this._mouseInside=!0,this.fire("mouseover",t)):this._mouseInside&&(this._ctx.canvas.style.cursor="",this._mouseInside=!1,this.fire("mouseout",t)))}}),_.Map.include(_.Path.SVG&&!a.L_PREFER_CANVAS||!_.Browser.canvas?{}:{_initPathRoot:function(){var t,e=this._pathRoot;e||((e=this._pathRoot=p.createElement("canvas")).style.position="absolute",(t=this._canvasCtx=e.getContext("2d")).lineCap="round",t.lineJoin="round",this._panes.overlayPane.appendChild(e),this.options.zoomAnimation&&(this._pathRoot.className="leaflet-zoom-animated",this.on("zoomanim",this._animatePathZoom),this.on("zoomend",this._endPathZoom)),this.on("moveend",this._updateCanvasViewport),this._updateCanvasViewport())},_updateCanvasViewport:function(){if(!this._pathZooming){this._updatePathViewport();var t=this._pathViewport,e=t.min,i=t.max.subtract(e),n=this._pathRoot;_.DomUtil.setPosition(n,e),n.width=i.x,n.height=i.y,n.getContext("2d").translate(-e.x,-e.y)}}}),_.LineUtil={simplify:function(t,e){if(!e||!t.length)return t.slice();var i=e*e;return t=this._reducePoints(t,i),this._simplifyDP(t,i)},pointToSegmentDistance:function(t,e,i){return Math.sqrt(this._sqClosestPointOnSegment(t,e,i,!0))},closestPointOnSegment:function(t,e,i){return this._sqClosestPointOnSegment(t,e,i)},_simplifyDP:function(t,e){var i=t.length,n=new(typeof Uint8Array!=r+""?Uint8Array:Array)(i);n[0]=n[i-1]=1,this._simplifyDPStep(t,n,e,0,i-1);var o,s=[];for(o=0;o<i;o++)n[o]&&s.push(t[o]);return s},_simplifyDPStep:function(t,e,i,n,o){var s,a,r,h=0;for(a=n+1;a<=o-1;a++)h<(r=this._sqClosestPointOnSegment(t[a],t[n],t[o],!0))&&(s=a,h=r);i<h&&(e[s]=1,this._simplifyDPStep(t,e,i,n,s),this._simplifyDPStep(t,e,i,s,o))},_reducePoints:function(t,e){for(var i=[t[0]],n=1,o=0,s=t.length;n<s;n++)this._sqDist(t[n],t[o])>e&&(i.push(t[n]),o=n);return o<s-1&&i.push(t[s-1]),i},clipSegment:function(t,e,i,n){var o,s,a,r=n?this._lastCode:this._getBitCode(t,i),h=this._getBitCode(e,i);for(this._lastCode=h;;){if(!(r|h))return[t,e];if(r&h)return!1;o=r||h,s=this._getEdgeIntersection(t,e,o,i),a=this._getBitCode(s,i),o===r?(t=s,r=a):(e=s,h=a)}},_getEdgeIntersection:function(t,e,i,n){var o=e.x-t.x,s=e.y-t.y,a=n.min,r=n.max;return 8&i?new _.Point(t.x+o*(r.y-t.y)/s,r.y):4&i?new _.Point(t.x+o*(a.y-t.y)/s,a.y):2&i?new _.Point(r.x,t.y+s*(r.x-t.x)/o):1&i?new _.Point(a.x,t.y+s*(a.x-t.x)/o):void 0},_getBitCode:function(t,e){var i=0;return t.x<e.min.x?i|=1:t.x>e.max.x&&(i|=2),t.y<e.min.y?i|=4:t.y>e.max.y&&(i|=8),i},_sqDist:function(t,e){var i=e.x-t.x,n=e.y-t.y;return i*i+n*n},_sqClosestPointOnSegment:function(t,e,i,n){var o,s=e.x,a=e.y,r=i.x-s,h=i.y-a,l=r*r+h*h;return 0<l&&(1<(o=((t.x-s)*r+(t.y-a)*h)/l)?(s=i.x,a=i.y):0<o&&(s+=r*o,a+=h*o)),r=t.x-s,h=t.y-a,n?r*r+h*h:new _.Point(s,a)}},_.Polyline=_.Path.extend({initialize:function(t,e){_.Path.prototype.initialize.call(this,e),this._latlngs=this._convertLatLngs(t)},options:{smoothFactor:1,noClip:!1},projectLatlngs:function(){this._originalPoints=[];for(var t=0,e=this._latlngs.length;t<e;t++)this._originalPoints[t]=this._map.latLngToLayerPoint(this._latlngs[t])},getPathString:function(){for(var t=0,e=this._parts.length,i="";t<e;t++)i+=this._getPathPartStr(this._parts[t]);return i},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._latlngs=this._convertLatLngs(t),this.redraw()},addLatLng:function(t){return this._latlngs.push(_.latLng(t)),this.redraw()},spliceLatLngs:function(){var t=[].splice.apply(this._latlngs,arguments);return this._convertLatLngs(this._latlngs,!0),this.redraw(),t},closestLayerPoint:function(t){for(var e,i,n=1/0,o=this._parts,s=null,a=0,r=o.length;a<r;a++)for(var h=o[a],l=1,u=h.length;l<u;l++){e=h[l-1],i=h[l];var c=_.LineUtil._sqClosestPointOnSegment(t,e,i,!0);c<n&&(n=c,s=_.LineUtil._sqClosestPointOnSegment(t,e,i))}return s&&(s.distance=Math.sqrt(n)),s},getBounds:function(){return new _.LatLngBounds(this.getLatLngs())},_convertLatLngs:function(t,e){var i,n,o=e?t:[];for(i=0,n=t.length;i<n;i++){if(_.Util.isArray(t[i])&&"number"!=typeof t[i][0])return;o[i]=_.latLng(t[i])}return o},_initEvents:function(){_.Path.prototype._initEvents.call(this)},_getPathPartStr:function(t){for(var e,i=_.Path.VML,n=0,o=t.length,s="";n<o;n++)e=t[n],i&&e._round(),s+=(n?"L":"M")+e.x+" "+e.y;return s},_clipPoints:function(){var t,e,i,n=this._originalPoints,o=n.length;if(this.options.noClip)this._parts=[n];else{this._parts=[];var s=this._parts,a=this._map._pathViewport,r=_.LineUtil;for(e=t=0;t<o-1;t++)(i=r.clipSegment(n[t],n[t+1],a,t))&&(s[e]=s[e]||[],s[e].push(i[0]),(i[1]!==n[t+1]||t===o-2)&&(s[e].push(i[1]),e++))}},_simplifyPoints:function(){for(var t=this._parts,e=_.LineUtil,i=0,n=t.length;i<n;i++)t[i]=e.simplify(t[i],this.options.smoothFactor)},_updatePath:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),_.Path.prototype._updatePath.call(this))}}),_.polyline=function(t,e){return new _.Polyline(t,e)},_.PolyUtil={},_.PolyUtil.clipPolygon=function(t,e){var i,n,o,s,a,r,h,l,u,c=[1,4,2,8],d=_.LineUtil;for(n=0,h=t.length;n<h;n++)t[n]._code=d._getBitCode(t[n],e);for(s=0;s<4;s++){for(l=c[s],i=[],n=0,o=(h=t.length)-1;n<h;o=n++)a=t[n],r=t[o],a._code&l?r._code&l||((u=d._getEdgeIntersection(r,a,l,e))._code=d._getBitCode(u,e),i.push(u)):(r._code&l&&((u=d._getEdgeIntersection(r,a,l,e))._code=d._getBitCode(u,e),i.push(u)),i.push(a));t=i}return t},_.Polygon=_.Polyline.extend({options:{fill:!0},initialize:function(t,e){_.Polyline.prototype.initialize.call(this,t,e),this._initWithHoles(t)},_initWithHoles:function(t){var e,i,n;if(t&&_.Util.isArray(t[0])&&"number"!=typeof t[0][0])for(this._latlngs=this._convertLatLngs(t[0]),this._holes=t.slice(1),e=0,i=this._holes.length;e<i;e++)(n=this._holes[e]=this._convertLatLngs(this._holes[e]))[0].equals(n[n.length-1])&&n.pop();2<=(t=this._latlngs).length&&t[0].equals(t[t.length-1])&&t.pop()},projectLatlngs:function(){var t,e,i,n;if(_.Polyline.prototype.projectLatlngs.call(this),this._holePoints=[],this._holes)for(t=0,i=this._holes.length;t<i;t++)for(this._holePoints[t]=[],e=0,n=this._holes[t].length;e<n;e++)this._holePoints[t][e]=this._map.latLngToLayerPoint(this._holes[t][e])},setLatLngs:function(t){return t&&_.Util.isArray(t[0])&&"number"!=typeof t[0][0]?(this._initWithHoles(t),this.redraw()):_.Polyline.prototype.setLatLngs.call(this,t)},_clipPoints:function(){var t=this._originalPoints,e=[];if(this._parts=[t].concat(this._holePoints),!this.options.noClip){for(var i=0,n=this._parts.length;i<n;i++){var o=_.PolyUtil.clipPolygon(this._parts[i],this._map._pathViewport);o.length&&e.push(o)}this._parts=e}},_getPathPartStr:function(t){return _.Polyline.prototype._getPathPartStr.call(this,t)+(_.Browser.svg?"z":"x")}}),_.polygon=function(t,e){return new _.Polygon(t,e)},function(){function t(t){return _.FeatureGroup.extend({initialize:function(t,e){this._layers={},this._options=e,this.setLatLngs(t)},setLatLngs:function(e){var i=0,n=e.length;for(this.eachLayer(function(t){i<n?t.setLatLngs(e[i++]):this.removeLayer(t)},this);i<n;)this.addLayer(new t(e[i++],this._options));return this},getLatLngs:function(){var e=[];return this.eachLayer(function(t){e.push(t.getLatLngs())}),e}})}_.MultiPolyline=t(_.Polyline),_.MultiPolygon=t(_.Polygon),_.multiPolyline=function(t,e){return new _.MultiPolyline(t,e)},_.multiPolygon=function(t,e){return new _.MultiPolygon(t,e)}}(),_.Rectangle=_.Polygon.extend({initialize:function(t,e){_.Polygon.prototype.initialize.call(this,this._boundsToLatLngs(t),e)},setBounds:function(t){this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return[(t=_.latLngBounds(t)).getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}}),_.rectangle=function(t,e){return new _.Rectangle(t,e)},_.Circle=_.Path.extend({initialize:function(t,e,i){_.Path.prototype.initialize.call(this,i),this._latlng=_.latLng(t),this._mRadius=e},options:{fill:!0},setLatLng:function(t){return this._latlng=_.latLng(t),this.redraw()},setRadius:function(t){return this._mRadius=t,this.redraw()},projectLatlngs:function(){var t=this._getLngRadius(),e=this._latlng,i=this._map.latLngToLayerPoint([e.lat,e.lng-t]);this._point=this._map.latLngToLayerPoint(e),this._radius=Math.max(this._point.x-i.x,1)},getBounds:function(){var t=this._getLngRadius(),e=this._mRadius/40075017*360,i=this._latlng;return new _.LatLngBounds([i.lat-e,i.lng-t],[i.lat+e,i.lng+t])},getLatLng:function(){return this._latlng},getPathString:function(){var t=this._point,e=this._radius;return this._checkIfEmpty()?"":_.Browser.svg?"M"+t.x+","+(t.y-e)+"A"+e+","+e+",0,1,1,"+(t.x-.1)+","+(t.y-e)+" z":(t._round(),e=Math.round(e),"AL "+t.x+","+t.y+" "+e+","+e+" 0,23592600")},getRadius:function(){return this._mRadius},_getLatRadius:function(){return this._mRadius/40075017*360},_getLngRadius:function(){return this._getLatRadius()/Math.cos(_.LatLng.DEG_TO_RAD*this._latlng.lat)},_checkIfEmpty:function(){if(!this._map)return!1;var t=this._map._pathViewport,e=this._radius,i=this._point;return i.x-e>t.max.x||i.y-e>t.max.y||i.x+e<t.min.x||i.y+e<t.min.y}}),_.circle=function(t,e,i){return new _.Circle(t,e,i)},_.CircleMarker=_.Circle.extend({options:{radius:10,weight:2},initialize:function(t,e){_.Circle.prototype.initialize.call(this,t,null,e),this._radius=this.options.radius},projectLatlngs:function(){this._point=this._map.latLngToLayerPoint(this._latlng)},_updateStyle:function(){_.Circle.prototype._updateStyle.call(this),this.setRadius(this.options.radius)},setLatLng:function(t){return _.Circle.prototype.setLatLng.call(this,t),this._popup&&this._popup._isOpen&&this._popup.setLatLng(t),this},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius}}),_.circleMarker=function(t,e){return new _.CircleMarker(t,e)},_.Polyline.include(_.Path.CANVAS?{_containsPoint:function(t,e){var i,n,o,s,a,r,h=this.options.weight/2;for(_.Browser.touch&&(h+=10),i=0,s=this._parts.length;i<s;i++)for(n=0,o=(a=(r=this._parts[i]).length)-1;n<a;o=n++)if((e||0!==n)&&_.LineUtil.pointToSegmentDistance(t,r[o],r[n])<=h)return!0;return!1}}:{}),_.Polygon.include(_.Path.CANVAS?{_containsPoint:function(t){var e,i,n,o,s,a,r,h,l=!1;if(_.Polyline.prototype._containsPoint.call(this,t,!0))return!0;for(o=0,r=this._parts.length;o<r;o++)for(s=0,a=(h=(e=this._parts[o]).length)-1;s<h;a=s++)i=e[s],n=e[a],i.y>t.y!=n.y>t.y&&t.x<(n.x-i.x)*(t.y-i.y)/(n.y-i.y)+i.x&&(l=!l);return l}}:{}),_.Circle.include(_.Path.CANVAS?{_drawPath:function(){var t=this._point;this._ctx.beginPath(),this._ctx.arc(t.x,t.y,this._radius,0,2*Math.PI,!1)},_containsPoint:function(t){var e=this._point,i=this.options.stroke?this.options.weight/2:0;return t.distanceTo(e)<=this._radius+i}}:{}),_.CircleMarker.include(_.Path.CANVAS?{_updateStyle:function(){_.Path.prototype._updateStyle.call(this)}}:{}),_.GeoJSON=_.FeatureGroup.extend({initialize:function(t,e){_.setOptions(this,e),this._layers={},t&&this.addData(t)},addData:function(t){var e,i,n,o=_.Util.isArray(t)?t:t.features;if(o){for(e=0,i=o.length;e<i;e++)((n=o[e]).geometries||n.geometry||n.features||n.coordinates)&&this.addData(o[e]);return this}var s=this.options;if(!s.filter||s.filter(t)){var a=_.GeoJSON.geometryToLayer(t,s.pointToLayer,s.coordsToLatLng,s);return a.feature=_.GeoJSON.asFeature(t),a.defaultOptions=a.options,this.resetStyle(a),s.onEachFeature&&s.onEachFeature(t,a),this.addLayer(a)}},resetStyle:function(t){var e=this.options.style;e&&(_.Util.extend(t.options,t.defaultOptions),this._setLayerStyle(t,e))},setStyle:function(e){this.eachLayer(function(t){this._setLayerStyle(t,e)},this)},_setLayerStyle:function(t,e){"function"==typeof e&&(e=e(t.feature)),t.setStyle&&t.setStyle(e)}}),_.extend(_.GeoJSON,{geometryToLayer:function(t,e,i,n){var o,s,a,r,h="Feature"===t.type?t.geometry:t,l=h.coordinates,u=[];switch(i=i||this.coordsToLatLng,h.type){case"Point":return o=i(l),e?e(t,o):new _.Marker(o);case"MultiPoint":for(a=0,r=l.length;a<r;a++)o=i(l[a]),u.push(e?e(t,o):new _.Marker(o));return new _.FeatureGroup(u);case"LineString":return s=this.coordsToLatLngs(l,0,i),new _.Polyline(s,n);case"Polygon":if(2===l.length&&!l[1].length)throw new Error("Invalid GeoJSON object.");return s=this.coordsToLatLngs(l,1,i),new _.Polygon(s,n);case"MultiLineString":return s=this.coordsToLatLngs(l,1,i),new _.MultiPolyline(s,n);case"MultiPolygon":return s=this.coordsToLatLngs(l,2,i),new _.MultiPolygon(s,n);case"GeometryCollection":for(a=0,r=h.geometries.length;a<r;a++)u.push(this.geometryToLayer({geometry:h.geometries[a],type:"Feature",properties:t.properties},e,i,n));return new _.FeatureGroup(u);default:throw new Error("Invalid GeoJSON object.")}},coordsToLatLng:function(t){return new _.LatLng(t[1],t[0],t[2])},coordsToLatLngs:function(t,e,i){var n,o,s,a=[];for(o=0,s=t.length;o<s;o++)n=e?this.coordsToLatLngs(t[o],e-1,i):(i||this.coordsToLatLng)(t[o]),a.push(n);return a},latLngToCoords:function(t){var e=[t.lng,t.lat];return t.alt!==r&&e.push(t.alt),e},latLngsToCoords:function(t){for(var e=[],i=0,n=t.length;i<n;i++)e.push(_.GeoJSON.latLngToCoords(t[i]));return e},getFeature:function(t,e){return t.feature?_.extend({},t.feature,{geometry:e}):_.GeoJSON.asFeature(e)},asFeature:function(t){return"Feature"===t.type?t:{type:"Feature",properties:{},geometry:t}}});var k={toGeoJSON:function(){return _.GeoJSON.getFeature(this,{type:"Point",coordinates:_.GeoJSON.latLngToCoords(this.getLatLng())})}};_.Marker.include(k),_.Circle.include(k),_.CircleMarker.include(k),_.Polyline.include({toGeoJSON:function(){return _.GeoJSON.getFeature(this,{type:"LineString",coordinates:_.GeoJSON.latLngsToCoords(this.getLatLngs())})}}),_.Polygon.include({toGeoJSON:function(){var t,e,i,n=[_.GeoJSON.latLngsToCoords(this.getLatLngs())];if(n[0].push(n[0][0]),this._holes)for(t=0,e=this._holes.length;t<e;t++)(i=_.GeoJSON.latLngsToCoords(this._holes[t])).push(i[0]),n.push(i);return _.GeoJSON.getFeature(this,{type:"Polygon",coordinates:n})}}),function(){function o(t){return function(){var e=[];return this.eachLayer(function(t){e.push(t.toGeoJSON().geometry.coordinates)}),_.GeoJSON.getFeature(this,{type:t,coordinates:e})}}_.MultiPolyline.include({toGeoJSON:o("MultiLineString")}),_.MultiPolygon.include({toGeoJSON:o("MultiPolygon")}),_.LayerGroup.include({toGeoJSON:function(){var e,t=this.feature&&this.feature.geometry,i=[];if(t&&"MultiPoint"===t.type)return o("MultiPoint").call(this);var n=t&&"GeometryCollection"===t.type;return this.eachLayer(function(t){t.toGeoJSON&&(e=t.toGeoJSON(),i.push(n?e.geometry:_.GeoJSON.asFeature(e)))}),n?_.GeoJSON.getFeature(this,{geometries:i,type:"GeometryCollection"}):{type:"FeatureCollection",features:i}}})}(),_.geoJson=function(t,e){return new _.GeoJSON(t,e)},_.DomEvent={addListener:function(e,t,i,n){var o,s,a,r=_.stamp(i),h="_leaflet_"+t+r;return e[h]?this:(o=function(t){return i.call(n||e,t||_.DomEvent._getEvent())},_.Browser.pointer&&0===t.indexOf("touch")?this.addPointerListener(e,t,o,r):(_.Browser.touch&&"dblclick"===t&&this.addDoubleTapListener&&this.addDoubleTapListener(e,o,r),"addEventListener"in e?"mousewheel"===t?(e.addEventListener("DOMMouseScroll",o,!1),e.addEventListener(t,o,!1)):"mouseenter"===t||"mouseleave"===t?(s=o,a="mouseenter"===t?"mouseover":"mouseout",o=function(t){return _.DomEvent._checkMouse(e,t)?s(t):void 0},e.addEventListener(a,o,!1)):("click"===t&&_.Browser.android&&(s=o,o=function(t){return _.DomEvent._filterClick(t,s)}),e.addEventListener(t,o,!1)):"attachEvent"in e&&e.attachEvent("on"+t,o),e[h]=o,this))},removeListener:function(t,e,i){var n=_.stamp(i),o="_leaflet_"+e+n,s=t[o];return s&&(_.Browser.pointer&&0===e.indexOf("touch")?this.removePointerListener(t,e,n):_.Browser.touch&&"dblclick"===e&&this.removeDoubleTapListener?this.removeDoubleTapListener(t,n):"removeEventListener"in t?"mousewheel"===e?(t.removeEventListener("DOMMouseScroll",s,!1),t.removeEventListener(e,s,!1)):"mouseenter"===e||"mouseleave"===e?t.removeEventListener("mouseenter"===e?"mouseover":"mouseout",s,!1):t.removeEventListener(e,s,!1):"detachEvent"in t&&t.detachEvent("on"+e,s),t[o]=null),this},stopPropagation:function(t){return t.stopPropagation?t.stopPropagation():t.cancelBubble=!0,_.DomEvent._skipped(t),this},disableScrollPropagation:function(t){var e=_.DomEvent.stopPropagation;return _.DomEvent.on(t,"mousewheel",e).on(t,"MozMousePixelScroll",e)},disableClickPropagation:function(t){for(var e=_.DomEvent.stopPropagation,i=_.Draggable.START.length-1;0<=i;i--)_.DomEvent.on(t,_.Draggable.START[i],e);return _.DomEvent.on(t,"click",_.DomEvent._fakeStop).on(t,"dblclick",e)},preventDefault:function(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this},stop:function(t){return _.DomEvent.preventDefault(t).stopPropagation(t)},getMousePosition:function(t,e){if(!e)return new _.Point(t.clientX,t.clientY);var i=e.getBoundingClientRect();return new _.Point(t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop)},getWheelDelta:function(t){var e=0;return t.wheelDelta&&(e=t.wheelDelta/120),t.detail&&(e=-t.detail/3),e},_skipEvents:{},_fakeStop:function(t){_.DomEvent._skipEvents[t.type]=!0},_skipped:function(t){var e=this._skipEvents[t.type];return this._skipEvents[t.type]=!1,e},_checkMouse:function(t,e){var i=e.relatedTarget;if(!i)return!0;try{for(;i&&i!==t;)i=i.parentNode}catch(t){return!1}return i!==t},_getEvent:function(){var t=a.event;if(!t)for(var e=arguments.callee.caller;e&&(!(t=e.arguments[0])||a.Event!==t.constructor);)e=e.caller;return t},_filterClick:function(t,e){var i=t.timeStamp||t.originalEvent.timeStamp,n=_.DomEvent._lastClick&&i-_.DomEvent._lastClick;return n&&100<n&&n<500||t.target._simulatedClick&&!t._simulated?void _.DomEvent.stop(t):(_.DomEvent._lastClick=i,e(t))}},_.DomEvent.on=_.DomEvent.addListener,_.DomEvent.off=_.DomEvent.removeListener,_.Draggable=_.Class.extend({includes:_.Mixin.Events,statics:{START:_.Browser.touch?["touchstart","mousedown"]:["mousedown"],END:{mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},MOVE:{mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"}},initialize:function(t,e){this._element=t,this._dragStartTarget=e||t},enable:function(){if(!this._enabled){for(var t=_.Draggable.START.length-1;0<=t;t--)_.DomEvent.on(this._dragStartTarget,_.Draggable.START[t],this._onDown,this);this._enabled=!0}},disable:function(){if(this._enabled){for(var t=_.Draggable.START.length-1;0<=t;t--)_.DomEvent.off(this._dragStartTarget,_.Draggable.START[t],this._onDown,this);this._enabled=!1,this._moved=!1}},_onDown:function(t){if(this._moved=!1,!(t.shiftKey||1!==t.which&&1!==t.button&&!t.touches||(_.DomEvent.stopPropagation(t),_.Draggable._disabled||(_.DomUtil.disableImageDrag(),_.DomUtil.disableTextSelection(),this._moving)))){var e=t.touches?t.touches[0]:t;this._startPoint=new _.Point(e.clientX,e.clientY),this._startPos=this._newPos=_.DomUtil.getPosition(this._element),_.DomEvent.on(p,_.Draggable.MOVE[t.type],this._onMove,this).on(p,_.Draggable.END[t.type],this._onUp,this)}},_onMove:function(t){if(t.touches&&1<t.touches.length)this._moved=!0;else{var e=t.touches&&1===t.touches.length?t.touches[0]:t,i=new _.Point(e.clientX,e.clientY).subtract(this._startPoint);(i.x||i.y)&&(_.Browser.touch&&Math.abs(i.x)+Math.abs(i.y)<3||(_.DomEvent.preventDefault(t),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=_.DomUtil.getPosition(this._element).subtract(i),_.DomUtil.addClass(p.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,_.DomUtil.addClass(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(i),this._moving=!0,_.Util.cancelAnimFrame(this._animRequest),this._animRequest=_.Util.requestAnimFrame(this._updatePosition,this,!0,this._dragStartTarget)))}},_updatePosition:function(){this.fire("predrag"),_.DomUtil.setPosition(this._element,this._newPos),this.fire("drag")},_onUp:function(){for(var t in _.DomUtil.removeClass(p.body,"leaflet-dragging"),this._lastTarget&&(_.DomUtil.removeClass(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),_.Draggable.MOVE)_.DomEvent.off(p,_.Draggable.MOVE[t],this._onMove).off(p,_.Draggable.END[t],this._onUp);_.DomUtil.enableImageDrag(),_.DomUtil.enableTextSelection(),this._moved&&this._moving&&(_.Util.cancelAnimFrame(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1}}),_.Handler=_.Class.extend({initialize:function(t){this._map=t},enable:function(){this._enabled||(this._enabled=!0,this.addHooks())},disable:function(){this._enabled&&(this._enabled=!1,this.removeHooks())},enabled:function(){return!!this._enabled}}),_.Map.mergeOptions({dragging:!0,inertia:!_.Browser.android23,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,inertiaThreshold:_.Browser.touch?32:18,easeLinearity:.25,worldCopyJump:!1}),_.Map.Drag=_.Handler.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new _.Draggable(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDrag,this),t.on("viewreset",this._onViewReset,this),t.whenReady(this._onViewReset,this))}this._draggable.enable()},removeHooks:function(){this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){var t=this._map;t._panAnim&&t._panAnim.stop(),t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(){if(this._map.options.inertia){var t=this._lastTime=+new Date,e=this._lastPos=this._draggable._newPos;this._positions.push(e),this._times.push(t),200<t-this._times[0]&&(this._positions.shift(),this._times.shift())}this._map.fire("move").fire("drag")},_onViewReset:function(){var t=this._map.getSize()._divideBy(2),e=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=e.subtract(t).x,this._worldWidth=this._map.project([0,180]).x},_onPreDrag:function(){var t=this._worldWidth,e=Math.round(t/2),i=this._initialWorldOffset,n=this._draggable._newPos.x,o=(n-e+i)%t+e-i,s=(n+e+i)%t-e-i,a=Math.abs(o+i)<Math.abs(s+i)?o:s;this._draggable._newPos.x=a},_onDragEnd:function(t){var e=this._map,i=e.options,n=+new Date-this._lastTime,o=!i.inertia||n>i.inertiaThreshold||!this._positions[0];if(e.fire("dragend",t),o)e.fire("moveend");else{var s=this._lastPos.subtract(this._positions[0]),a=(this._lastTime+n-this._times[0])/1e3,r=i.easeLinearity,h=s.multiplyBy(r/a),l=h.distanceTo([0,0]),u=Math.min(i.inertiaMaxSpeed,l),c=h.multiplyBy(u/l),d=u/(i.inertiaDeceleration*r),p=c.multiplyBy(-d/2).round();p.x&&p.y?(p=e._limitOffset(p,e.options.maxBounds),_.Util.requestAnimFrame(function(){e.panBy(p,{duration:d,easeLinearity:r,noMoveStart:!0})})):e.fire("moveend")}}}),_.Map.addInitHook("addHandler","dragging",_.Map.Drag),_.Map.mergeOptions({doubleClickZoom:!0}),_.Map.DoubleClickZoom=_.Handler.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var e=this._map,i=e.getZoom()+(t.originalEvent.shiftKey?-1:1);"center"===e.options.doubleClickZoom?e.setZoom(i):e.setZoomAround(t.containerPoint,i)}}),_.Map.addInitHook("addHandler","doubleClickZoom",_.Map.DoubleClickZoom),_.Map.mergeOptions({scrollWheelZoom:!0}),_.Map.ScrollWheelZoom=_.Handler.extend({addHooks:function(){_.DomEvent.on(this._map._container,"mousewheel",this._onWheelScroll,this),_.DomEvent.on(this._map._container,"MozMousePixelScroll",_.DomEvent.preventDefault),this._delta=0},removeHooks:function(){_.DomEvent.off(this._map._container,"mousewheel",this._onWheelScroll),_.DomEvent.off(this._map._container,"MozMousePixelScroll",_.DomEvent.preventDefault)},_onWheelScroll:function(t){var e=_.DomEvent.getWheelDelta(t);this._delta+=e,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var i=Math.max(40-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(_.bind(this._performZoom,this),i),_.DomEvent.preventDefault(t),_.DomEvent.stopPropagation(t)},_performZoom:function(){var t=this._map,e=this._delta,i=t.getZoom();e=0<e?Math.ceil(e):Math.floor(e),e=Math.max(Math.min(e,4),-4),e=t._limitZoom(i+e)-i,this._delta=0,this._startTime=null,e&&("center"===t.options.scrollWheelZoom?t.setZoom(i+e):t.setZoomAround(this._lastMousePos,i+e))}}),_.Map.addInitHook("addHandler","scrollWheelZoom",_.Map.ScrollWheelZoom),_.extend(_.DomEvent,{_touchstart:_.Browser.msPointer?"MSPointerDown":_.Browser.pointer?"pointerdown":"touchstart",_touchend:_.Browser.msPointer?"MSPointerUp":_.Browser.pointer?"pointerup":"touchend",addDoubleTapListener:function(t,s,e){function i(t){if(!(1<(_.Browser.pointer?(c.push(t.pointerId),c.length):t.touches.length))){var e=Date.now(),i=e-(a||e);r=t.touches?t.touches[0]:t,h=0<i&&i<=250,a=e}}function n(t){if(_.Browser.pointer){var e=c.indexOf(t.pointerId);if(-1===e)return;c.splice(e,1)}if(h){if(_.Browser.pointer){var i,n={};for(var o in r)i=r[o],n[o]="function"==typeof i?i.bind(r):i;r=n}r.type="dblclick",s(r),a=null}}var a,r,h=!1,o="_leaflet_",l=this._touchstart,u=this._touchend,c=[];t[o+l+e]=i,t[o+u+e]=n;var d=_.Browser.pointer?p.documentElement:t;return t.addEventListener(l,i,!1),d.addEventListener(u,n,!1),_.Browser.pointer&&d.addEventListener(_.DomEvent.POINTER_CANCEL,n,!1),this},removeDoubleTapListener:function(t,e){var i="_leaflet_";return t.removeEventListener(this._touchstart,t[i+this._touchstart+e],!1),(_.Browser.pointer?p.documentElement:t).removeEventListener(this._touchend,t[i+this._touchend+e],!1),_.Browser.pointer&&p.documentElement.removeEventListener(_.DomEvent.POINTER_CANCEL,t[i+this._touchend+e],!1),this}}),_.extend(_.DomEvent,{POINTER_DOWN:_.Browser.msPointer?"MSPointerDown":"pointerdown",POINTER_MOVE:_.Browser.msPointer?"MSPointerMove":"pointermove",POINTER_UP:_.Browser.msPointer?"MSPointerUp":"pointerup",POINTER_CANCEL:_.Browser.msPointer?"MSPointerCancel":"pointercancel",_pointers:[],_pointerDocumentListener:!1,addPointerListener:function(t,e,i,n){switch(e){case"touchstart":return this.addPointerListenerStart(t,e,i,n);case"touchend":return this.addPointerListenerEnd(t,e,i,n);case"touchmove":return this.addPointerListenerMove(t,e,i,n);default:throw"Unknown touch event type"}},addPointerListenerStart:function(t,e,n,i){var o=this._pointers,s=function(t){_.DomEvent.preventDefault(t);for(var e=!1,i=0;i<o.length;i++)if(o[i].pointerId===t.pointerId){e=!0;break}e||o.push(t),t.touches=o.slice(),t.changedTouches=[t],n(t)};if(t["_leaflet_touchstart"+i]=s,t.addEventListener(this.POINTER_DOWN,s,!1),!this._pointerDocumentListener){var a=function(t){for(var e=0;e<o.length;e++)if(o[e].pointerId===t.pointerId){o.splice(e,1);break}};p.documentElement.addEventListener(this.POINTER_UP,a,!1),p.documentElement.addEventListener(this.POINTER_CANCEL,a,!1),this._pointerDocumentListener=!0}return this},addPointerListenerMove:function(t,e,i,n){function o(t){if(t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&"mouse"!==t.pointerType||0!==t.buttons){for(var e=0;e<s.length;e++)if(s[e].pointerId===t.pointerId){s[e]=t;break}t.touches=s.slice(),t.changedTouches=[t],i(t)}}var s=this._pointers;return t["_leaflet_touchmove"+n]=o,t.addEventListener(this.POINTER_MOVE,o,!1),this},addPointerListenerEnd:function(t,e,i,n){var o=this._pointers,s=function(t){for(var e=0;e<o.length;e++)if(o[e].pointerId===t.pointerId){o.splice(e,1);break}t.touches=o.slice(),t.changedTouches=[t],i(t)};return t["_leaflet_touchend"+n]=s,t.addEventListener(this.POINTER_UP,s,!1),t.addEventListener(this.POINTER_CANCEL,s,!1),this},removePointerListener:function(t,e,i){var n=t["_leaflet_"+e+i];switch(e){case"touchstart":t.removeEventListener(this.POINTER_DOWN,n,!1);break;case"touchmove":t.removeEventListener(this.POINTER_MOVE,n,!1);break;case"touchend":t.removeEventListener(this.POINTER_UP,n,!1),t.removeEventListener(this.POINTER_CANCEL,n,!1)}return this}}),_.Map.mergeOptions({touchZoom:_.Browser.touch&&!_.Browser.android23,bounceAtZoomLimits:!0}),_.Map.TouchZoom=_.Handler.extend({addHooks:function(){_.DomEvent.on(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){_.DomEvent.off(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var e=this._map;if(t.touches&&2===t.touches.length&&!e._animatingZoom&&!this._zooming){var i=e.mouseEventToLayerPoint(t.touches[0]),n=e.mouseEventToLayerPoint(t.touches[1]),o=e._getCenterLayerPoint();this._startCenter=i.add(n)._divideBy(2),this._startDist=i.distanceTo(n),this._moved=!1,this._zooming=!0,this._centerOffset=o.subtract(this._startCenter),e._panAnim&&e._panAnim.stop(),_.DomEvent.on(p,"touchmove",this._onTouchMove,this).on(p,"touchend",this._onTouchEnd,this),_.DomEvent.preventDefault(t)}},_onTouchMove:function(t){var e=this._map;if(t.touches&&2===t.touches.length&&this._zooming){var i=e.mouseEventToLayerPoint(t.touches[0]),n=e.mouseEventToLayerPoint(t.touches[1]);this._scale=i.distanceTo(n)/this._startDist,this._delta=i._add(n)._divideBy(2)._subtract(this._startCenter),1!==this._scale&&(e.options.bounceAtZoomLimits||!(e.getZoom()===e.getMinZoom()&&this._scale<1||e.getZoom()===e.getMaxZoom()&&1<this._scale))&&(this._moved||(_.DomUtil.addClass(e._mapPane,"leaflet-touching"),e.fire("movestart").fire("zoomstart"),this._moved=!0),_.Util.cancelAnimFrame(this._animRequest),this._animRequest=_.Util.requestAnimFrame(this._updateOnMove,this,!0,this._map._container),_.DomEvent.preventDefault(t))}},_updateOnMove:function(){var t=this._map,e=this._getScaleOrigin(),i=t.layerPointToLatLng(e),n=t.getScaleZoom(this._scale);t._animateZoom(i,n,this._startCenter,this._scale,this._delta,!1,!0)},_onTouchEnd:function(){if(this._moved&&this._zooming){var t=this._map;this._zooming=!1,_.DomUtil.removeClass(t._mapPane,"leaflet-touching"),_.Util.cancelAnimFrame(this._animRequest),_.DomEvent.off(p,"touchmove",this._onTouchMove).off(p,"touchend",this._onTouchEnd);var e=this._getScaleOrigin(),i=t.layerPointToLatLng(e),n=t.getZoom(),o=t.getScaleZoom(this._scale)-n,s=0<o?Math.ceil(o):Math.floor(o),a=t._limitZoom(n+s),r=t.getZoomScale(a)/this._scale;t._animateZoom(i,a,e,r)}else this._zooming=!1},_getScaleOrigin:function(){var t=this._centerOffset.subtract(this._delta).divideBy(this._scale);return this._startCenter.add(t)}}),_.Map.addInitHook("addHandler","touchZoom",_.Map.TouchZoom),_.Map.mergeOptions({tap:!0,tapTolerance:15}),_.Map.Tap=_.Handler.extend({addHooks:function(){_.DomEvent.on(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){_.DomEvent.off(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(t.touches){if(_.DomEvent.preventDefault(t),this._fireClick=!0,1<t.touches.length)return this._fireClick=!1,void clearTimeout(this._holdTimeout);var e=t.touches[0],i=e.target;this._startPos=this._newPos=new _.Point(e.clientX,e.clientY),i.tagName&&"a"===i.tagName.toLowerCase()&&_.DomUtil.addClass(i,"leaflet-active"),this._holdTimeout=setTimeout(_.bind(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",e))},this),1e3),_.DomEvent.on(p,"touchmove",this._onMove,this).on(p,"touchend",this._onUp,this)}},_onUp:function(t){if(clearTimeout(this._holdTimeout),_.DomEvent.off(p,"touchmove",this._onMove,this).off(p,"touchend",this._onUp,this),this._fireClick&&t&&t.changedTouches){var e=t.changedTouches[0],i=e.target;i&&i.tagName&&"a"===i.tagName.toLowerCase()&&_.DomUtil.removeClass(i,"leaflet-active"),this._isTapValid()&&this._simulateEvent("click",e)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(t){var e=t.touches[0];this._newPos=new _.Point(e.clientX,e.clientY)},_simulateEvent:function(t,e){var i=p.createEvent("MouseEvents");i._simulated=!0,e.target._simulatedClick=!0,i.initMouseEvent(t,!0,!0,a,1,e.screenX,e.screenY,e.clientX,e.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(i)}}),_.Browser.touch&&!_.Browser.pointer&&_.Map.addInitHook("addHandler","tap",_.Map.Tap),_.Map.mergeOptions({boxZoom:!0}),_.Map.BoxZoom=_.Handler.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._moved=!1},addHooks:function(){_.DomEvent.on(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){_.DomEvent.off(this._container,"mousedown",this._onMouseDown),this._moved=!1},moved:function(){return this._moved},_onMouseDown:function(t){return this._moved=!1,!(!t.shiftKey||1!==t.which&&1!==t.button)&&(_.DomUtil.disableTextSelection(),_.DomUtil.disableImageDrag(),this._startLayerPoint=this._map.mouseEventToLayerPoint(t),void _.DomEvent.on(p,"mousemove",this._onMouseMove,this).on(p,"mouseup",this._onMouseUp,this).on(p,"keydown",this._onKeyDown,this))},_onMouseMove:function(t){this._moved||(this._box=_.DomUtil.create("div","leaflet-zoom-box",this._pane),_.DomUtil.setPosition(this._box,this._startLayerPoint),this._container.style.cursor="crosshair",this._map.fire("boxzoomstart"));var e=this._startLayerPoint,i=this._box,n=this._map.mouseEventToLayerPoint(t),o=n.subtract(e),s=new _.Point(Math.min(n.x,e.x),Math.min(n.y,e.y));_.DomUtil.setPosition(i,s),this._moved=!0,i.style.width=Math.max(0,Math.abs(o.x)-4)+"px",i.style.height=Math.max(0,Math.abs(o.y)-4)+"px"},_finish:function(){this._moved&&(this._pane.removeChild(this._box),this._container.style.cursor=""),_.DomUtil.enableTextSelection(),_.DomUtil.enableImageDrag(),_.DomEvent.off(p,"mousemove",this._onMouseMove).off(p,"mouseup",this._onMouseUp).off(p,"keydown",this._onKeyDown)},_onMouseUp:function(t){this._finish();var e=this._map,i=e.mouseEventToLayerPoint(t);if(!this._startLayerPoint.equals(i)){var n=new _.LatLngBounds(e.layerPointToLatLng(this._startLayerPoint),e.layerPointToLatLng(i));e.fitBounds(n),e.fire("boxzoomend",{boxZoomBounds:n})}},_onKeyDown:function(t){27===t.keyCode&&this._finish()}}),_.Map.addInitHook("addHandler","boxZoom",_.Map.BoxZoom),_.Map.mergeOptions({keyboard:!0,keyboardPanOffset:80,keyboardZoomOffset:1}),_.Map.Keyboard=_.Handler.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,173]},initialize:function(t){this._map=t,this._setPanOffset(t.options.keyboardPanOffset),this._setZoomOffset(t.options.keyboardZoomOffset)},addHooks:function(){var t=this._map._container;-1===t.tabIndex&&(t.tabIndex="0"),_.DomEvent.on(t,"focus",this._onFocus,this).on(t,"blur",this._onBlur,this).on(t,"mousedown",this._onMouseDown,this),this._map.on("focus",this._addHooks,this).on("blur",this._removeHooks,this)},removeHooks:function(){this._removeHooks();var t=this._map._container;_.DomEvent.off(t,"focus",this._onFocus,this).off(t,"blur",this._onBlur,this).off(t,"mousedown",this._onMouseDown,this),this._map.off("focus",this._addHooks,this).off("blur",this._removeHooks,this)},_onMouseDown:function(){if(!this._focused){var t=p.body,e=p.documentElement,i=t.scrollTop||e.scrollTop,n=t.scrollLeft||e.scrollLeft;this._map._container.focus(),a.scrollTo(n,i)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanOffset:function(t){var e,i,n=this._panKeys={},o=this.keyCodes;for(e=0,i=o.left.length;e<i;e++)n[o.left[e]]=[-1*t,0];for(e=0,i=o.right.length;e<i;e++)n[o.right[e]]=[t,0];for(e=0,i=o.down.length;e<i;e++)n[o.down[e]]=[0,t];for(e=0,i=o.up.length;e<i;e++)n[o.up[e]]=[0,-1*t]},_setZoomOffset:function(t){var e,i,n=this._zoomKeys={},o=this.keyCodes;for(e=0,i=o.zoomIn.length;e<i;e++)n[o.zoomIn[e]]=t;for(e=0,i=o.zoomOut.length;e<i;e++)n[o.zoomOut[e]]=-t},_addHooks:function(){_.DomEvent.on(p,"keydown",this._onKeyDown,this)},_removeHooks:function(){_.DomEvent.off(p,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){var e=t.keyCode,i=this._map;if(e in this._panKeys){if(i._panAnim&&i._panAnim._inProgress)return;i.panBy(this._panKeys[e]),i.options.maxBounds&&i.panInsideBounds(i.options.maxBounds)}else{if(!(e in this._zoomKeys))return;i.setZoom(i.getZoom()+this._zoomKeys[e])}_.DomEvent.stop(t)}}),_.Map.addInitHook("addHandler","keyboard",_.Map.Keyboard),_.Handler.MarkerDrag=_.Handler.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new _.Draggable(t,t)),this._draggable.on("dragstart",this._onDragStart,this).on("drag",this._onDrag,this).on("dragend",this._onDragEnd,this),this._draggable.enable(),_.DomUtil.addClass(this._marker._icon,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off("dragstart",this._onDragStart,this).off("drag",this._onDrag,this).off("dragend",this._onDragEnd,this),this._draggable.disable(),_.DomUtil.removeClass(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._marker.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(){var t=this._marker,e=t._shadow,i=_.DomUtil.getPosition(t._icon),n=t._map.layerPointToLatLng(i);e&&_.DomUtil.setPosition(e,i),t._latlng=n,t.fire("move",{latlng:n}).fire("drag")},_onDragEnd:function(t){this._marker.fire("moveend").fire("dragend",t)}}),_.Control=_.Class.extend({options:{position:"topright"},initialize:function(t){_.setOptions(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var e=this._map;return e&&e.removeControl(this),this.options.position=t,e&&e.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this._map=t;var e=this._container=this.onAdd(t),i=this.getPosition(),n=t._controlCorners[i];return _.DomUtil.addClass(e,"leaflet-control"),-1!==i.indexOf("bottom")?n.insertBefore(e,n.firstChild):n.appendChild(e),this},removeFrom:function(t){var e=this.getPosition();return t._controlCorners[e].removeChild(this._container),this._map=null,this.onRemove&&this.onRemove(t),this},_refocusOnMap:function(){this._map&&this._map.getContainer().focus()}}),_.control=function(t){return new _.Control(t)},_.Map.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.removeFrom(this),this},_initControlPos:function(){function t(t,e){var i=o+t+" "+o+e;n[t+e]=_.DomUtil.create("div",i,s)}var n=this._controlCorners={},o="leaflet-",s=this._controlContainer=_.DomUtil.create("div",o+"control-container",this._container);t("top","left"),t("top","right"),t("bottom","left"),t("bottom","right")},_clearControlPos:function(){this._container.removeChild(this._controlContainer)}}),_.Control.Zoom=_.Control.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"-",zoomOutTitle:"Zoom out"},onAdd:function(t){var e="leaflet-control-zoom",i=_.DomUtil.create("div",e+" leaflet-bar");return this._map=t,this._zoomInButton=this._createButton(this.options.zoomInText,this.options.zoomInTitle,e+"-in",i,this._zoomIn,this),this._zoomOutButton=this._createButton(this.options.zoomOutText,this.options.zoomOutTitle,e+"-out",i,this._zoomOut,this),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),i},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},_zoomIn:function(t){this._map.zoomIn(t.shiftKey?3:1)},_zoomOut:function(t){this._map.zoomOut(t.shiftKey?3:1)},_createButton:function(t,e,i,n,o,s){var a=_.DomUtil.create("a",i,n);a.innerHTML=t,a.href="#",a.title=e;var r=_.DomEvent.stopPropagation;return _.DomEvent.on(a,"click",r).on(a,"mousedown",r).on(a,"dblclick",r).on(a,"click",_.DomEvent.preventDefault).on(a,"click",o,s).on(a,"click",this._refocusOnMap,s),a},_updateDisabled:function(){var t=this._map,e="leaflet-disabled";_.DomUtil.removeClass(this._zoomInButton,e),_.DomUtil.removeClass(this._zoomOutButton,e),t._zoom===t.getMinZoom()&&_.DomUtil.addClass(this._zoomOutButton,e),t._zoom===t.getMaxZoom()&&_.DomUtil.addClass(this._zoomInButton,e)}}),_.Map.mergeOptions({zoomControl:!0}),_.Map.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new _.Control.Zoom,this.addControl(this.zoomControl))}),_.control.zoom=function(t){return new _.Control.Zoom(t)},_.Control.Attribution=_.Control.extend({options:{position:"bottomright",prefix:'<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(t){_.setOptions(this,t),this._attributions={}},onAdd:function(t){for(var e in this._container=_.DomUtil.create("div","leaflet-control-attribution"),_.DomEvent.disableClickPropagation(this._container),t._layers)t._layers[e].getAttribution&&this.addAttribution(t._layers[e].getAttribution());return t.on("layeradd",this._onLayerAdd,this).on("layerremove",this._onLayerRemove,this),this._update(),this._container},onRemove:function(t){t.off("layeradd",this._onLayerAdd).off("layerremove",this._onLayerRemove)},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):void 0},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):void 0},_update:function(){if(this._map){var t=[];for(var e in this._attributions)this._attributions[e]&&t.push(e);var i=[];this.options.prefix&&i.push(this.options.prefix),t.length&&i.push(t.join(", ")),this._container.innerHTML=i.join(" | ")}},_onLayerAdd:function(t){t.layer.getAttribution&&this.addAttribution(t.layer.getAttribution())},_onLayerRemove:function(t){t.layer.getAttribution&&this.removeAttribution(t.layer.getAttribution())}}),_.Map.mergeOptions({attributionControl:!0}),_.Map.addInitHook(function(){this.options.attributionControl&&(this.attributionControl=(new _.Control.Attribution).addTo(this))}),_.control.attribution=function(t){return new _.Control.Attribution(t)},_.Control.Scale=_.Control.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0,updateWhenIdle:!1},onAdd:function(t){this._map=t;var e="leaflet-control-scale",i=_.DomUtil.create("div",e),n=this.options;return this._addScales(n,e,i),t.on(n.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),i},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,e,i){t.metric&&(this._mScale=_.DomUtil.create("div",e+"-line",i)),t.imperial&&(this._iScale=_.DomUtil.create("div",e+"-line",i))},_update:function(){var t=this._map.getBounds(),e=t.getCenter().lat,i=6378137*Math.PI*Math.cos(e*Math.PI/180)*(t.getNorthEast().lng-t.getSouthWest().lng)/180,n=this._map.getSize(),o=this.options,s=0;0<n.x&&(s=i*(o.maxWidth/n.x)),this._updateScales(o,s)},_updateScales:function(t,e){t.metric&&e&&this._updateMetric(e),t.imperial&&e&&this._updateImperial(e)},_updateMetric:function(t){var e=this._getRoundNum(t);this._mScale.style.width=this._getScaleWidth(e/t)+"px",this._mScale.innerHTML=e<1e3?e+" m":e/1e3+" km"},_updateImperial:function(t){var e,i,n,o=3.2808399*t,s=this._iScale;5280<o?(e=o/5280,i=this._getRoundNum(e),s.style.width=this._getScaleWidth(i/e)+"px",s.innerHTML=i+" mi"):(n=this._getRoundNum(o),s.style.width=this._getScaleWidth(n/o)+"px",s.innerHTML=n+" ft")},_getScaleWidth:function(t){return Math.round(this.options.maxWidth*t)-10},_getRoundNum:function(t){var e=Math.pow(10,(Math.floor(t)+"").length-1),i=t/e;return e*(i=10<=i?10:5<=i?5:3<=i?3:2<=i?2:1)}}),_.control.scale=function(t){return new _.Control.Scale(t)},_.Control.Layers=_.Control.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0},initialize:function(t,e,i){for(var n in _.setOptions(this,i),this._layers={},this._lastZIndex=0,this._handlingClick=!1,t)this._addLayer(t[n],n);for(n in e)this._addLayer(e[n],n,!0)},onAdd:function(t){return this._initLayout(),this._update(),t.on("layeradd",this._onLayerChange,this).on("layerremove",this._onLayerChange,this),this._container},onRemove:function(t){t.off("layeradd",this._onLayerChange,this).off("layerremove",this._onLayerChange,this)},addBaseLayer:function(t,e){return this._addLayer(t,e),this._update(),this},addOverlay:function(t,e){return this._addLayer(t,e,!0),this._update(),this},removeLayer:function(t){var e=_.stamp(t);return delete this._layers[e],this._update(),this},_initLayout:function(){var t="leaflet-control-layers",e=this._container=_.DomUtil.create("div",t);e.setAttribute("aria-haspopup",!0),_.Browser.touch?_.DomEvent.on(e,"click",_.DomEvent.stopPropagation):_.DomEvent.disableClickPropagation(e).disableScrollPropagation(e);var i=this._form=_.DomUtil.create("form",t+"-list");if(this.options.collapsed){_.Browser.android||_.DomEvent.on(e,"mouseover",this._expand,this).on(e,"mouseout",this._collapse,this);var n=this._layersLink=_.DomUtil.create("a",t+"-toggle",e);n.href="#",n.title="Layers",_.Browser.touch?_.DomEvent.on(n,"click",_.DomEvent.stop).on(n,"click",this._expand,this):_.DomEvent.on(n,"focus",this._expand,this),_.DomEvent.on(i,"click",function(){setTimeout(_.bind(this._onInputClick,this),0)},this),this._map.on("click",this._collapse,this)}else this._expand();this._baseLayersList=_.DomUtil.create("div",t+"-base",i),this._separator=_.DomUtil.create("div",t+"-separator",i),this._overlaysList=_.DomUtil.create("div",t+"-overlays",i),e.appendChild(i)},_addLayer:function(t,e,i){var n=_.stamp(t);this._layers[n]={layer:t,name:e,overlay:i},this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex))},_update:function(){if(this._container){this._baseLayersList.innerHTML="",this._overlaysList.innerHTML="";var t,e,i=!1,n=!1;for(t in this._layers)e=this._layers[t],this._addItem(e),n=n||e.overlay,i=i||!e.overlay;this._separator.style.display=n&&i?"":"none"}},_onLayerChange:function(t){var e=this._layers[_.stamp(t.layer)];if(e){this._handlingClick||this._update();var i=e.overlay?"layeradd"===t.type?"overlayadd":"overlayremove":"layeradd"===t.type?"baselayerchange":null;i&&this._map.fire(i,e)}},_createRadioElement:function(t,e){var i='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"';e&&(i+=' checked="checked"'),i+="/>";var n=p.createElement("div");return n.innerHTML=i,n.firstChild},_addItem:function(t){var e,i=p.createElement("label"),n=this._map.hasLayer(t.layer);t.overlay?((e=p.createElement("input")).type="checkbox",e.className="leaflet-control-layers-selector",e.defaultChecked=n):e=this._createRadioElement("leaflet-base-layers",n),e.layerId=_.stamp(t.layer),_.DomEvent.on(e,"click",this._onInputClick,this);var o=p.createElement("span");return o.innerHTML=" "+t.name,i.appendChild(e),i.appendChild(o),(t.overlay?this._overlaysList:this._baseLayersList).appendChild(i),i},_onInputClick:function(){var t,e,i,n=this._form.getElementsByTagName("input"),o=n.length;for(this._handlingClick=!0,t=0;t<o;t++)e=n[t],i=this._layers[e.layerId],e.checked&&!this._map.hasLayer(i.layer)?this._map.addLayer(i.layer):!e.checked&&this._map.hasLayer(i.layer)&&this._map.removeLayer(i.layer);this._handlingClick=!1,this._refocusOnMap()},_expand:function(){_.DomUtil.addClass(this._container,"leaflet-control-layers-expanded")},_collapse:function(){this._container.className=this._container.className.replace(" leaflet-control-layers-expanded","")}}),_.control.layers=function(t,e,i){return new _.Control.Layers(t,e,i)},_.PosAnimation=_.Class.extend({includes:_.Mixin.Events,run:function(t,e,i,n){this.stop(),this._el=t,this._inProgress=!0,this._newPos=e,this.fire("start"),t.style[_.DomUtil.TRANSITION]="all "+(i||.25)+"s cubic-bezier(0,0,"+(n||.5)+",1)",_.DomEvent.on(t,_.DomUtil.TRANSITION_END,this._onTransitionEnd,this),_.DomUtil.setPosition(t,e),_.Util.falseFn(t.offsetWidth),this._stepTimer=setInterval(_.bind(this._onStep,this),50)},stop:function(){this._inProgress&&(_.DomUtil.setPosition(this._el,this._getPos()),this._onTransitionEnd(),_.Util.falseFn(this._el.offsetWidth))},_onStep:function(){var t=this._getPos();return t?(this._el._leaflet_pos=t,void this.fire("step")):void this._onTransitionEnd()},_transformRe:/([-+]?(?:\d*\.)?\d+)\D*, ([-+]?(?:\d*\.)?\d+)\D*\)/,_getPos:function(){var t,e,i,n=this._el,o=a.getComputedStyle(n);if(_.Browser.any3d){if(!(i=o[_.DomUtil.TRANSFORM].match(this._transformRe)))return;t=parseFloat(i[1]),e=parseFloat(i[2])}else t=parseFloat(o.left),e=parseFloat(o.top);return new _.Point(t,e,!0)},_onTransitionEnd:function(){_.DomEvent.off(this._el,_.DomUtil.TRANSITION_END,this._onTransitionEnd,this),this._inProgress&&(this._inProgress=!1,this._el.style[_.DomUtil.TRANSITION]="",this._el._leaflet_pos=this._newPos,clearInterval(this._stepTimer),this.fire("step").fire("end"))}}),_.Map.include({setView:function(t,e,i){if((e=e===r?this._zoom:this._limitZoom(e),t=this._limitCenter(_.latLng(t),e,this.options.maxBounds),i=i||{},this._panAnim&&this._panAnim.stop(),this._loaded&&!i.reset&&!0!==i)&&(i.animate!==r&&(i.zoom=_.extend({animate:i.animate},i.zoom),i.pan=_.extend({animate:i.animate},i.pan)),this._zoom!==e?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,e,i.zoom):this._tryAnimatedPan(t,i.pan)))return clearTimeout(this._sizeTimer),this;return this._resetView(t,e),this},panBy:function(t,e){if(e=e||{},!(t=_.point(t).round()).x&&!t.y)return this;if(this._panAnim||(this._panAnim=new _.PosAnimation,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),e.noMoveStart||this.fire("movestart"),!1!==e.animate){_.DomUtil.addClass(this._mapPane,"leaflet-pan-anim");var i=this._getMapPanePos().subtract(t);this._panAnim.run(this._mapPane,i,e.duration||.25,e.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){_.DomUtil.removeClass(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,e){var i=this._getCenterOffset(t)._floor();return!(!0!==(e&&e.animate)&&!this.getSize().contains(i))&&(this.panBy(i,e),!0)}}),_.PosAnimation=_.DomUtil.TRANSITION?_.PosAnimation:_.PosAnimation.extend({run:function(t,e,i,n){this.stop(),this._el=t,this._inProgress=!0,this._duration=i||.25,this._easeOutPower=1/Math.max(n||.5,.2),this._startPos=_.DomUtil.getPosition(t),this._offset=e.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(),this._complete())},_animate:function(){this._animId=_.Util.requestAnimFrame(this._animate,this),this._step()},_step:function(){var t=+new Date-this._startTime,e=1e3*this._duration;t<e?this._runFrame(this._easeOut(t/e)):(this._runFrame(1),this._complete())},_runFrame:function(t){var e=this._startPos.add(this._offset.multiplyBy(t));_.DomUtil.setPosition(this._el,e),this.fire("step")},_complete:function(){_.Util.cancelAnimFrame(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),_.Map.mergeOptions({zoomAnimation:!0,zoomAnimationThreshold:4}),_.DomUtil.TRANSITION&&_.Map.addInitHook(function(){this._zoomAnimated=this.options.zoomAnimation&&_.DomUtil.TRANSITION&&_.Browser.any3d&&!_.Browser.android23&&!_.Browser.mobileOpera,this._zoomAnimated&&_.DomEvent.on(this._mapPane,_.DomUtil.TRANSITION_END,this._catchTransitionEnd,this)}),_.Map.include(_.DomUtil.TRANSITION?{_catchTransitionEnd:function(t){this._animatingZoom&&0<=t.propertyName.indexOf("transform")&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,e,i){if(this._animatingZoom)return!0;if(i=i||{},!this._zoomAnimated||!1===i.animate||this._nothingToAnimate()||Math.abs(e-this._zoom)>this.options.zoomAnimationThreshold)return!1;var n=this.getZoomScale(e),o=this._getCenterOffset(t)._divideBy(1-1/n),s=this._getCenterLayerPoint()._add(o);return!(!0!==i.animate&&!this.getSize().contains(o))&&(this.fire("movestart").fire("zoomstart"),this._animateZoom(t,e,s,n,null,!0),!0)},_animateZoom:function(t,e,i,n,o,s,a){a||(this._animatingZoom=!0),_.DomUtil.addClass(this._mapPane,"leaflet-zoom-anim"),this._animateToCenter=t,this._animateToZoom=e,_.Draggable&&(_.Draggable._disabled=!0),_.Util.requestAnimFrame(function(){this.fire("zoomanim",{center:t,zoom:e,origin:i,scale:n,delta:o,backwards:s})},this)},_onZoomTransitionEnd:function(){this._animatingZoom=!1,_.DomUtil.removeClass(this._mapPane,"leaflet-zoom-anim"),this._resetView(this._animateToCenter,this._animateToZoom,!0,!0),_.Draggable&&(_.Draggable._disabled=!1)}}:{}),_.TileLayer.include({_animateZoom:function(t){this._animating||(this._animating=!0,this._prepareBgBuffer());var e=this._bgBuffer,i=_.DomUtil.TRANSFORM,n=t.delta?_.DomUtil.getTranslateString(t.delta):e.style[i],o=_.DomUtil.getScaleString(t.scale,t.origin);e.style[i]=t.backwards?o+" "+n:n+" "+o},_endZoomAnim:function(){var t=this._tileContainer,e=this._bgBuffer;t.style.visibility="",t.parentNode.appendChild(t),_.Util.falseFn(e.offsetWidth),this._animating=!1},_clearBgBuffer:function(){var t=this._map;!t||t._animatingZoom||t.touchZoom._zooming||(this._bgBuffer.innerHTML="",this._bgBuffer.style[_.DomUtil.TRANSFORM]="")},_prepareBgBuffer:function(){var t=this._tileContainer,e=this._bgBuffer,i=this._getLoadedTilesPercentage(e),n=this._getLoadedTilesPercentage(t);return e&&.5<i&&n<.5?(t.style.visibility="hidden",void this._stopLoadingImages(t)):(e.style.visibility="hidden",e.style[_.DomUtil.TRANSFORM]="",this._tileContainer=e,e=this._bgBuffer=t,this._stopLoadingImages(e),void clearTimeout(this._clearBgBufferTimer))},_getLoadedTilesPercentage:function(t){var e,i,n=t.getElementsByTagName("img"),o=0;for(e=0,i=n.length;e<i;e++)n[e].complete&&o++;return o/i},_stopLoadingImages:function(t){var e,i,n,o=Array.prototype.slice.call(t.getElementsByTagName("img"));for(e=0,i=o.length;e<i;e++)(n=o[e]).complete||(n.onload=_.Util.falseFn,n.onerror=_.Util.falseFn,n.src=_.Util.emptyImageUrl,n.parentNode.removeChild(n))}}),_.Map.include({_defaultLocateOptions:{watch:!1,setView:!1,maxZoom:1/0,timeout:1e4,maximumAge:0,enableHighAccuracy:!1},locate:function(t){if(t=this._locateOptions=_.extend(this._defaultLocateOptions,t),!navigator.geolocation)return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var e=_.bind(this._handleGeolocationResponse,this),i=_.bind(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(e,i,t):navigator.geolocation.getCurrentPosition(e,i,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){var e=t.code,i=t.message||(1===e?"permission denied":2===e?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:e,message:"Geolocation error: "+i+"."})},_handleGeolocationResponse:function(t){var e=t.coords.latitude,i=t.coords.longitude,n=new _.LatLng(e,i),o=180*t.coords.accuracy/40075017,s=o/Math.cos(_.LatLng.DEG_TO_RAD*e),a=_.latLngBounds([e-o,i-s],[e+o,i+s]),r=this._locateOptions;if(r.setView){var h=Math.min(this.getBoundsZoom(a),r.maxZoom);this.setView(n,h)}var l={latlng:n,bounds:a,timestamp:t.timestamp};for(var u in t.coords)"number"==typeof t.coords[u]&&(l[u]=t.coords[u]);this.fire("locationfound",l)}})}(window,document);
!function(t,c,e){L.MarkerClusterGroup=L.FeatureGroup.extend({options:{maxClusterRadius:80,iconCreateFunction:null,spiderfyOnMaxZoom:!0,showCoverageOnHover:!0,zoomToBoundsOnClick:!0,singleMarkerMode:!1,disableClusteringAtZoom:null,removeOutsideVisibleBounds:!0,animateAddingMarkers:!1,spiderfyDistanceMultiplier:1,chunkedLoading:!1,chunkInterval:200,chunkDelay:50,chunkProgress:null,polygonOptions:{}},initialize:function(t){L.Util.setOptions(this,t),this.options.iconCreateFunction||(this.options.iconCreateFunction=this._defaultIconCreateFunction),this._featureGroup=L.featureGroup(),this._featureGroup.on(L.FeatureGroup.EVENTS,this._propagateEvent,this),this._nonPointGroup=L.featureGroup(),this._nonPointGroup.on(L.FeatureGroup.EVENTS,this._propagateEvent,this),this._inZoomAnimation=0,this._needsClustering=[],this._needsRemoving=[],this._currentShownBounds=null,this._queue=[]},addLayer:function(t){if(t instanceof L.LayerGroup){var e=[];for(var i in t._layers)e.push(t._layers[i]);return this.addLayers(e)}if(!t.getLatLng)return this._nonPointGroup.addLayer(t),this;if(!this._map)return this._needsClustering.push(t),this;if(this.hasLayer(t))return this;this._unspiderfy&&this._unspiderfy(),this._addLayer(t,this._maxZoom);var n=t,s=this._map.getZoom();if(t.__parent)for(;n.__parent._zoom>=s;)n=n.__parent;return this._currentShownBounds.contains(n.getLatLng())&&(this.options.animateAddingMarkers?this._animationAddLayer(t,n):this._animationAddLayerNonAnimated(t,n)),this},removeLayer:function(t){if(t instanceof L.LayerGroup){var e=[];for(var i in t._layers)e.push(t._layers[i]);return this.removeLayers(e)}return t.getLatLng?this._map?t.__parent&&(this._unspiderfy&&(this._unspiderfy(),this._unspiderfyLayer(t)),this._removeLayer(t,!0),this._featureGroup.hasLayer(t)&&(this._featureGroup.removeLayer(t),t.setOpacity&&t.setOpacity(1))):!this._arraySplice(this._needsClustering,t)&&this.hasLayer(t)&&this._needsRemoving.push(t):this._nonPointGroup.removeLayer(t),this},addLayers:function(s){var t,e,i,r,o=this._featureGroup,a=this._nonPointGroup,h=this.options.chunkedLoading,_=this.options.chunkInterval,u=this.options.chunkProgress;if(this._map){var l=0,d=(new Date).getTime(),p=L.bind(function(){for(var t=(new Date).getTime();l<s.length;l++){if(h&&l%200==0){var e=(new Date).getTime()-t;if(_<e)break}if((r=s[l]).getLatLng){if(!this.hasLayer(r)&&(this._addLayer(r,this._maxZoom),r.__parent&&2===r.__parent.getChildCount())){var i=r.__parent.getAllChildMarkers(),n=i[0]===r?i[1]:i[0];o.removeLayer(n)}}else a.addLayer(r)}u&&u(l,s.length,(new Date).getTime()-d),l===s.length?(this._featureGroup.eachLayer(function(t){t instanceof L.MarkerCluster&&t._iconNeedsUpdate&&t._updateIcon()}),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds)):setTimeout(p,this.options.chunkDelay)},this);p()}else{for(t=[],e=0,i=s.length;e<i;e++)(r=s[e]).getLatLng?this.hasLayer(r)||t.push(r):a.addLayer(r);this._needsClustering=this._needsClustering.concat(t)}return this},removeLayers:function(t){var e,i,n,s=this._featureGroup,r=this._nonPointGroup;if(!this._map){for(e=0,i=t.length;e<i;e++)n=t[e],this._arraySplice(this._needsClustering,n),r.removeLayer(n);return this}for(e=0,i=t.length;e<i;e++)(n=t[e]).__parent?(this._removeLayer(n,!0,!0),s.hasLayer(n)&&(s.removeLayer(n),n.setOpacity&&n.setOpacity(1))):r.removeLayer(n);return this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds),s.eachLayer(function(t){t instanceof L.MarkerCluster&&t._updateIcon()}),this},clearLayers:function(){return this._map||(this._needsClustering=[],delete this._gridClusters,delete this._gridUnclustered),this._noanimationUnspiderfy&&this._noanimationUnspiderfy(),this._featureGroup.clearLayers(),this._nonPointGroup.clearLayers(),this.eachLayer(function(t){delete t.__parent}),this._map&&this._generateInitialClusters(),this},getBounds:function(){var t=new L.LatLngBounds;this._topClusterLevel&&t.extend(this._topClusterLevel._bounds);for(var e=this._needsClustering.length-1;0<=e;e--)t.extend(this._needsClustering[e].getLatLng());return t.extend(this._nonPointGroup.getBounds()),t},eachLayer:function(t,e){var i,n=this._needsClustering.slice();for(this._topClusterLevel&&this._topClusterLevel.getAllChildMarkers(n),i=n.length-1;0<=i;i--)t.call(e,n[i]);this._nonPointGroup.eachLayer(t,e)},getLayers:function(){var e=[];return this.eachLayer(function(t){e.push(t)}),e},getLayer:function(e){var i=null;return this.eachLayer(function(t){L.stamp(t)===e&&(i=t)}),i},hasLayer:function(t){if(!t)return!1;var e,i=this._needsClustering;for(e=i.length-1;0<=e;e--)if(i[e]===t)return!0;for(e=(i=this._needsRemoving).length-1;0<=e;e--)if(i[e]===t)return!1;return!(!t.__parent||t.__parent._group!==this)||this._nonPointGroup.hasLayer(t)},zoomToShowLayer:function(e,i){var n=function(){if((e._icon||e.__parent._icon)&&!this._inZoomAnimation)if(this._map.off("moveend",n,this),this.off("animationend",n,this),e._icon)i();else if(e.__parent._icon){var t=function(){this.off("spiderfied",t,this),i()};this.on("spiderfied",t,this),e.__parent.spiderfy()}};if(e._icon&&this._map.getBounds().contains(e.getLatLng()))i();else if(e.__parent._zoom<this._map.getZoom())this._map.on("moveend",n,this),this._map.panTo(e.getLatLng());else{var t=function(){this._map.off("movestart",t,this),t=null};this._map.on("movestart",t,this),this._map.on("moveend",n,this),this.on("animationend",n,this),e.__parent.zoomToBounds(),t&&n.call(this)}},onAdd:function(t){var e,i,n;if(this._map=t,!isFinite(this._map.getMaxZoom()))throw"Map has no maxZoom specified";for(this._featureGroup.onAdd(t),this._nonPointGroup.onAdd(t),this._gridClusters||this._generateInitialClusters(),e=0,i=this._needsRemoving.length;e<i;e++)n=this._needsRemoving[e],this._removeLayer(n,!0);this._needsRemoving=[],this._zoom=this._map.getZoom(),this._currentShownBounds=this._getExpandedVisibleBounds(),this._map.on("zoomend",this._zoomEnd,this),this._map.on("moveend",this._moveEnd,this),this._spiderfierOnAdd&&this._spiderfierOnAdd(),this._bindEvents(),i=this._needsClustering,this._needsClustering=[],this.addLayers(i)},onRemove:function(t){t.off("zoomend",this._zoomEnd,this),t.off("moveend",this._moveEnd,this),this._unbindEvents(),this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim",""),this._spiderfierOnRemove&&this._spiderfierOnRemove(),this._hideCoverage(),this._featureGroup.onRemove(t),this._nonPointGroup.onRemove(t),this._featureGroup.clearLayers(),this._map=null},getVisibleParent:function(t){for(var e=t;e&&!e._icon;)e=e.__parent;return e||null},_arraySplice:function(t,e){for(var i=t.length-1;0<=i;i--)if(t[i]===e)return t.splice(i,1),!0},_removeLayer:function(t,e,i){var n=this._gridClusters,s=this._gridUnclustered,r=this._featureGroup,o=this._map;if(e)for(var a=this._maxZoom;0<=a&&s[a].removeObject(t,o.project(t.getLatLng(),a));a--);var h,_=t.__parent,u=_._markers;for(this._arraySplice(u,t);_&&(_._childCount--,!(_._zoom<0));)e&&_._childCount<=1?(h=_._markers[0]===t?_._markers[1]:_._markers[0],n[_._zoom].removeObject(_,o.project(_._cLatLng,_._zoom)),s[_._zoom].addObject(h,o.project(h.getLatLng(),_._zoom)),this._arraySplice(_.__parent._childClusters,_),_.__parent._markers.push(h),h.__parent=_.__parent,_._icon&&(r.removeLayer(_),i||r.addLayer(h))):(_._recalculateBounds(),i&&_._icon||_._updateIcon()),_=_.__parent;delete t.__parent},_isOrIsParent:function(t,e){for(;e;){if(t===e)return!0;e=e.parentNode}return!1},_propagateEvent:function(t){if(t.layer instanceof L.MarkerCluster){if(t.originalEvent&&this._isOrIsParent(t.layer._icon,t.originalEvent.relatedTarget))return;t.type="cluster"+t.type}this.fire(t.type,t)},_defaultIconCreateFunction:function(t){var e=t.getChildCount(),i=" marker-cluster-";return i+=e<10?"small":e<100?"medium":"large",new L.DivIcon({html:"<div><span>"+e+"</span></div>",className:"marker-cluster"+i,iconSize:new L.Point(40,40)})},_bindEvents:function(){var t=this._map,e=this.options.spiderfyOnMaxZoom,i=this.options.showCoverageOnHover,n=this.options.zoomToBoundsOnClick;(e||n)&&this.on("clusterclick",this._zoomOrSpiderfy,this),i&&(this.on("clustermouseover",this._showCoverage,this),this.on("clustermouseout",this._hideCoverage,this),t.on("zoomend",this._hideCoverage,this))},_zoomOrSpiderfy:function(t){var e=this._map;e.getMaxZoom()===e.getZoom()?this.options.spiderfyOnMaxZoom&&t.layer.spiderfy():this.options.zoomToBoundsOnClick&&t.layer.zoomToBounds(),t.originalEvent&&13===t.originalEvent.keyCode&&e._container.focus()},_showCoverage:function(t){var e=this._map;this._inZoomAnimation||(this._shownPolygon&&e.removeLayer(this._shownPolygon),2<t.layer.getChildCount()&&t.layer!==this._spiderfied&&(this._shownPolygon=new L.Polygon(t.layer.getConvexHull(),this.options.polygonOptions),e.addLayer(this._shownPolygon)))},_hideCoverage:function(){this._shownPolygon&&(this._map.removeLayer(this._shownPolygon),this._shownPolygon=null)},_unbindEvents:function(){var t=this.options.spiderfyOnMaxZoom,e=this.options.showCoverageOnHover,i=this.options.zoomToBoundsOnClick,n=this._map;(t||i)&&this.off("clusterclick",this._zoomOrSpiderfy,this),e&&(this.off("clustermouseover",this._showCoverage,this),this.off("clustermouseout",this._hideCoverage,this),n.off("zoomend",this._hideCoverage,this))},_zoomEnd:function(){this._map&&(this._mergeSplitClusters(),this._zoom=this._map._zoom,this._currentShownBounds=this._getExpandedVisibleBounds())},_moveEnd:function(){if(!this._inZoomAnimation){var t=this._getExpandedVisibleBounds();this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,this._zoom,t),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._map._zoom,t),this._currentShownBounds=t}},_generateInitialClusters:function(){var t=this._map.getMaxZoom(),e=this.options.maxClusterRadius,i=e;"function"!=typeof e&&(i=function(){return e}),this.options.disableClusteringAtZoom&&(t=this.options.disableClusteringAtZoom-1),this._maxZoom=t,this._gridClusters={},this._gridUnclustered={};for(var n=t;0<=n;n--)this._gridClusters[n]=new L.DistanceGrid(i(n)),this._gridUnclustered[n]=new L.DistanceGrid(i(n));this._topClusterLevel=new L.MarkerCluster(this,-1)},_addLayer:function(t,e){var i,n,s=this._gridClusters,r=this._gridUnclustered;for(this.options.singleMarkerMode&&(t.options.icon=this.options.iconCreateFunction({getChildCount:function(){return 1},getAllChildMarkers:function(){return[t]}}));0<=e;e--){i=this._map.project(t.getLatLng(),e);var o=s[e].getNearObject(i);if(o)return o._addChild(t),void(t.__parent=o);if(o=r[e].getNearObject(i)){var a=o.__parent;a&&this._removeLayer(o,!1);var h=new L.MarkerCluster(this,e,o,t);s[e].addObject(h,this._map.project(h._cLatLng,e)),o.__parent=h;var _=t.__parent=h;for(n=e-1;n>a._zoom;n--)_=new L.MarkerCluster(this,n,_),s[n].addObject(_,this._map.project(o.getLatLng(),n));for(a._addChild(_),n=e;0<=n&&r[n].removeObject(o,this._map.project(o.getLatLng(),n));n--);return}r[e].addObject(t,i)}this._topClusterLevel._addChild(t),t.__parent=this._topClusterLevel},_enqueue:function(t){this._queue.push(t),this._queueTimeout||(this._queueTimeout=setTimeout(L.bind(this._processQueue,this),300))},_processQueue:function(){for(var t=0;t<this._queue.length;t++)this._queue[t].call(this);this._queue.length=0,clearTimeout(this._queueTimeout),this._queueTimeout=null},_mergeSplitClusters:function(){this._processQueue(),this._zoom<this._map._zoom&&this._currentShownBounds.intersects(this._getExpandedVisibleBounds())?(this._animationStart(),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,this._zoom,this._getExpandedVisibleBounds()),this._animationZoomIn(this._zoom,this._map._zoom)):this._zoom>this._map._zoom?(this._animationStart(),this._animationZoomOut(this._zoom,this._map._zoom)):this._moveEnd()},_getExpandedVisibleBounds:function(){if(!this.options.removeOutsideVisibleBounds)return this.getBounds();var t=this._map.getBounds(),e=t._southWest,i=t._northEast,n=L.Browser.mobile?0:Math.abs(e.lat-i.lat),s=L.Browser.mobile?0:Math.abs(e.lng-i.lng);return new L.LatLngBounds(new L.LatLng(e.lat-n,e.lng-s,!0),new L.LatLng(i.lat+n,i.lng+s,!0))},_animationAddLayerNonAnimated:function(t,e){if(e===t)this._featureGroup.addLayer(t);else if(2===e._childCount){e._addToMap();var i=e.getAllChildMarkers();this._featureGroup.removeLayer(i[0]),this._featureGroup.removeLayer(i[1])}else e._updateIcon()}}),L.MarkerClusterGroup.include(L.DomUtil.TRANSITION?{_animationStart:function(){this._map._mapPane.className+=" leaflet-cluster-anim",this._inZoomAnimation++},_animationEnd:function(){this._map&&(this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim","")),this._inZoomAnimation--,this.fire("animationend")},_animationZoomIn:function(s,r){var o,a=this._getExpandedVisibleBounds(),h=this._featureGroup;this._topClusterLevel._recursively(a,s,0,function(t){var e,i=t._latlng,n=t._markers;for(a.contains(i)||(i=null),t._isSingleParent()&&s+1===r?(h.removeLayer(t),t._recursivelyAddChildrenToMap(null,r,a)):(t.setOpacity(0),t._recursivelyAddChildrenToMap(i,r,a)),o=n.length-1;0<=o;o--)e=n[o],a.contains(e._latlng)||h.removeLayer(e)}),this._forceLayout(),this._topClusterLevel._recursivelyBecomeVisible(a,r),h.eachLayer(function(t){t instanceof L.MarkerCluster||!t._icon||t.setOpacity(1)}),this._topClusterLevel._recursively(a,s,r,function(t){t._recursivelyRestoreChildPositions(r)}),this._enqueue(function(){this._topClusterLevel._recursively(a,s,0,function(t){h.removeLayer(t),t.setOpacity(1)}),this._animationEnd()})},_animationZoomOut:function(t,e){this._animationZoomOutSingle(this._topClusterLevel,t-1,e),this._topClusterLevel._recursivelyAddChildrenToMap(null,e,this._getExpandedVisibleBounds()),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,t,this._getExpandedVisibleBounds())},_animationZoomOutSingle:function(e,i,n){var s=this._getExpandedVisibleBounds();e._recursivelyAnimateChildrenInAndAddSelfToMap(s,i+1,n);var r=this;this._forceLayout(),e._recursivelyBecomeVisible(s,n),this._enqueue(function(){if(1===e._childCount){var t=e._markers[0];t.setLatLng(t.getLatLng()),t.setOpacity&&t.setOpacity(1)}else e._recursively(s,n,0,function(t){t._recursivelyRemoveChildrenFromMap(s,i+1)});r._animationEnd()})},_animationAddLayer:function(t,e){var i=this,n=this._featureGroup;n.addLayer(t),e!==t&&(2<e._childCount?(e._updateIcon(),this._forceLayout(),this._animationStart(),t._setPos(this._map.latLngToLayerPoint(e.getLatLng())),t.setOpacity(0),this._enqueue(function(){n.removeLayer(t),t.setOpacity(1),i._animationEnd()})):(this._forceLayout(),i._animationStart(),i._animationZoomOutSingle(e,this._map.getMaxZoom(),this._map.getZoom())))},_forceLayout:function(){L.Util.falseFn(c.body.offsetWidth)}}:{_animationStart:function(){},_animationZoomIn:function(t,e){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,t),this._topClusterLevel._recursivelyAddChildrenToMap(null,e,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationZoomOut:function(t,e){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,t),this._topClusterLevel._recursivelyAddChildrenToMap(null,e,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationAddLayer:function(t,e){this._animationAddLayerNonAnimated(t,e)}}),L.markerClusterGroup=function(t){return new L.MarkerClusterGroup(t)},L.MarkerCluster=L.Marker.extend({initialize:function(t,e,i,n){L.Marker.prototype.initialize.call(this,i?i._cLatLng||i.getLatLng():new L.LatLng(0,0),{icon:this}),this._group=t,this._zoom=e,this._markers=[],this._childClusters=[],this._childCount=0,this._iconNeedsUpdate=!0,this._bounds=new L.LatLngBounds,i&&this._addChild(i),n&&this._addChild(n)},getAllChildMarkers:function(t){t=t||[];for(var e=this._childClusters.length-1;0<=e;e--)this._childClusters[e].getAllChildMarkers(t);for(var i=this._markers.length-1;0<=i;i--)t.push(this._markers[i]);return t},getChildCount:function(){return this._childCount},zoomToBounds:function(){for(var t,e=this._childClusters.slice(),i=this._group._map,n=i.getBoundsZoom(this._bounds),s=this._zoom+1,r=i.getZoom();0<e.length&&s<n;){s++;var o=[];for(t=0;t<e.length;t++)o=o.concat(e[t]._childClusters);e=o}s<n?this._group._map.setView(this._latlng,s):n<=r?this._group._map.setView(this._latlng,r+1):this._group._map.fitBounds(this._bounds)},getBounds:function(){var t=new L.LatLngBounds;return t.extend(this._bounds),t},_updateIcon:function(){this._iconNeedsUpdate=!0,this._icon&&this.setIcon(this)},createIcon:function(){return this._iconNeedsUpdate&&(this._iconObj=this._group.options.iconCreateFunction(this),this._iconNeedsUpdate=!1),this._iconObj.createIcon()},createShadow:function(){return this._iconObj.createShadow()},_addChild:function(t,e){this._iconNeedsUpdate=!0,this._expandBounds(t),t instanceof L.MarkerCluster?(e||(this._childClusters.push(t),t.__parent=this),this._childCount+=t._childCount):(e||this._markers.push(t),this._childCount++),this.__parent&&this.__parent._addChild(t,!0)},_expandBounds:function(t){var e,i=t._wLatLng||t._latlng;e=t instanceof L.MarkerCluster?(this._bounds.extend(t._bounds),t._childCount):(this._bounds.extend(i),1),this._cLatLng||(this._cLatLng=t._cLatLng||i);var n=this._childCount+e;this._wLatLng?(this._wLatLng.lat=(i.lat*e+this._wLatLng.lat*this._childCount)/n,this._wLatLng.lng=(i.lng*e+this._wLatLng.lng*this._childCount)/n):this._latlng=this._wLatLng=new L.LatLng(i.lat,i.lng)},_addToMap:function(t){t&&(this._backupLatlng=this._latlng,this.setLatLng(t)),this._group._featureGroup.addLayer(this)},_recursivelyAnimateChildrenIn:function(t,s,e){this._recursively(t,0,e-1,function(t){var e,i,n=t._markers;for(e=n.length-1;0<=e;e--)(i=n[e])._icon&&(i._setPos(s),i.setOpacity(0))},function(t){var e,i,n=t._childClusters;for(e=n.length-1;0<=e;e--)(i=n[e])._icon&&(i._setPos(s),i.setOpacity(0))})},_recursivelyAnimateChildrenInAndAddSelfToMap:function(e,i,n){this._recursively(e,n,0,function(t){t._recursivelyAnimateChildrenIn(e,t._group._map.latLngToLayerPoint(t.getLatLng()).round(),i),t._isSingleParent()&&i-1===n?(t.setOpacity(1),t._recursivelyRemoveChildrenFromMap(e,i)):t.setOpacity(0),t._addToMap()})},_recursivelyBecomeVisible:function(t,e){this._recursively(t,0,e,null,function(t){t.setOpacity(1)})},_recursivelyAddChildrenToMap:function(n,s,r){this._recursively(r,-1,s,function(t){if(s!==t._zoom)for(var e=t._markers.length-1;0<=e;e--){var i=t._markers[e];r.contains(i._latlng)&&(n&&(i._backupLatlng=i.getLatLng(),i.setLatLng(n),i.setOpacity&&i.setOpacity(0)),t._group._featureGroup.addLayer(i))}},function(t){t._addToMap(n)})},_recursivelyRestoreChildPositions:function(t){for(var e=this._markers.length-1;0<=e;e--){var i=this._markers[e];i._backupLatlng&&(i.setLatLng(i._backupLatlng),delete i._backupLatlng)}if(t-1===this._zoom)for(var n=this._childClusters.length-1;0<=n;n--)this._childClusters[n]._restorePosition();else for(var s=this._childClusters.length-1;0<=s;s--)this._childClusters[s]._recursivelyRestoreChildPositions(t)},_restorePosition:function(){this._backupLatlng&&(this.setLatLng(this._backupLatlng),delete this._backupLatlng)},_recursivelyRemoveChildrenFromMap:function(t,e,i){var n,s;this._recursively(t,-1,e-1,function(t){for(s=t._markers.length-1;0<=s;s--)n=t._markers[s],i&&i.contains(n._latlng)||(t._group._featureGroup.removeLayer(n),n.setOpacity&&n.setOpacity(1))},function(t){for(s=t._childClusters.length-1;0<=s;s--)n=t._childClusters[s],i&&i.contains(n._latlng)||(t._group._featureGroup.removeLayer(n),n.setOpacity&&n.setOpacity(1))})},_recursively:function(t,e,i,n,s){var r,o,a=this._childClusters,h=this._zoom;if(h<e)for(r=a.length-1;0<=r;r--)o=a[r],t.intersects(o._bounds)&&o._recursively(t,e,i,n,s);else if(n&&n(this),s&&this._zoom===i&&s(this),h<i)for(r=a.length-1;0<=r;r--)o=a[r],t.intersects(o._bounds)&&o._recursively(t,e,i,n,s)},_recalculateBounds:function(){var t,e=this._markers,i=this._childClusters;for(this._bounds=new L.LatLngBounds,delete this._wLatLng,t=e.length-1;0<=t;t--)this._expandBounds(e[t]);for(t=i.length-1;0<=t;t--)this._expandBounds(i[t])},_isSingleParent:function(){return 0<this._childClusters.length&&this._childClusters[0]._childCount===this._childCount}}),L.DistanceGrid=function(t){this._cellSize=t,this._sqCellSize=t*t,this._grid={},this._objectPoint={}},L.DistanceGrid.prototype={addObject:function(t,e){var i=this._getCoord(e.x),n=this._getCoord(e.y),s=this._grid,r=s[n]=s[n]||{},o=r[i]=r[i]||[],a=L.Util.stamp(t);this._objectPoint[a]=e,o.push(t)},updateObject:function(t,e){this.removeObject(t),this.addObject(t,e)},removeObject:function(t,e){var i,n,s=this._getCoord(e.x),r=this._getCoord(e.y),o=this._grid,a=o[r]=o[r]||{},h=a[s]=a[s]||[];for(delete this._objectPoint[L.Util.stamp(t)],i=0,n=h.length;i<n;i++)if(h[i]===t)return h.splice(i,1),1===n&&delete a[s],!0},eachObject:function(t,e){var i,n,s,r,o,a,h=this._grid;for(i in h)for(n in o=h[i])for(s=0,r=(a=o[n]).length;s<r;s++)t.call(e,a[s])&&(s--,r--)},getNearObject:function(t){var e,i,n,s,r,o,a,h,_=this._getCoord(t.x),u=this._getCoord(t.y),l=this._objectPoint,d=this._sqCellSize,p=null;for(e=u-1;e<=u+1;e++)if(s=this._grid[e])for(i=_-1;i<=_+1;i++)if(r=s[i])for(n=0,o=r.length;n<o;n++)a=r[n],(h=this._sqDist(l[L.Util.stamp(a)],t))<d&&(d=h,p=a);return p},_getCoord:function(t){return Math.floor(t/this._cellSize)},_sqDist:function(t,e){var i=e.x-t.x,n=e.y-t.y;return i*i+n*n}},L.QuickHull={getDistant:function(t,e){var i=e[1].lat-e[0].lat;return(e[0].lng-e[1].lng)*(t.lat-e[0].lat)+i*(t.lng-e[0].lng)},findMostDistantPointFromBaseLine:function(t,e){var i,n,s,r=0,o=null,a=[];for(i=e.length-1;0<=i;i--)n=e[i],0<(s=this.getDistant(n,t))&&(a.push(n),r<s&&(r=s,o=n));return{maxPoint:o,newPoints:a}},buildConvexHull:function(t,e){var i=[],n=this.findMostDistantPointFromBaseLine(t,e);return n.maxPoint?i=(i=i.concat(this.buildConvexHull([t[0],n.maxPoint],n.newPoints))).concat(this.buildConvexHull([n.maxPoint,t[1]],n.newPoints)):[t[0]]},getConvexHull:function(t){var e,i=!1,n=!1,s=null,r=null;for(e=t.length-1;0<=e;e--){var o=t[e];(!1===i||o.lat>i)&&(i=(s=o).lat),(!1===n||o.lat<n)&&(n=(r=o).lat)}return[].concat(this.buildConvexHull([r,s],t),this.buildConvexHull([s,r],t))}},L.MarkerCluster.include({getConvexHull:function(){var t,e,i=this.getAllChildMarkers(),n=[];for(e=i.length-1;0<=e;e--)t=i[e].getLatLng(),n.push(t);return L.QuickHull.getConvexHull(n)}}),L.MarkerCluster.include({_2PI:2*Math.PI,_circleFootSeparation:25,_circleStartAngle:Math.PI/6,_spiralFootSeparation:28,_spiralLengthStart:11,_spiralLengthFactor:5,_circleSpiralSwitchover:9,spiderfy:function(){if(this._group._spiderfied!==this&&!this._group._inZoomAnimation){var t,e=this.getAllChildMarkers(),i=this._group._map.latLngToLayerPoint(this._latlng);this._group._unspiderfy(),this._group._spiderfied=this,t=e.length>=this._circleSpiralSwitchover?this._generatePointsSpiral(e.length,i):(i.y+=10,this._generatePointsCircle(e.length,i)),this._animationSpiderfy(e,t)}},unspiderfy:function(t){this._group._inZoomAnimation||(this._animationUnspiderfy(t),this._group._spiderfied=null)},_generatePointsCircle:function(t,e){var i,n,s=this._group.options.spiderfyDistanceMultiplier*this._circleFootSeparation*(2+t)/this._2PI,r=this._2PI/t,o=[];for(i=(o.length=t)-1;0<=i;i--)n=this._circleStartAngle+i*r,o[i]=new L.Point(e.x+s*Math.cos(n),e.y+s*Math.sin(n))._round();return o},_generatePointsSpiral:function(t,e){var i,n=this._group.options.spiderfyDistanceMultiplier*this._spiralLengthStart,s=this._group.options.spiderfyDistanceMultiplier*this._spiralFootSeparation,r=this._group.options.spiderfyDistanceMultiplier*this._spiralLengthFactor,o=0,a=[];for(i=(a.length=t)-1;0<=i;i--)o+=s/n+5e-4*i,a[i]=new L.Point(e.x+n*Math.cos(o),e.y+n*Math.sin(o))._round(),n+=this._2PI*r/o;return a},_noanimationUnspiderfy:function(){var t,e,i=this._group,n=i._map,s=i._featureGroup,r=this.getAllChildMarkers();for(this.setOpacity(1),e=r.length-1;0<=e;e--)t=r[e],s.removeLayer(t),t._preSpiderfyLatlng&&(t.setLatLng(t._preSpiderfyLatlng),delete t._preSpiderfyLatlng),t.setZIndexOffset&&t.setZIndexOffset(0),t._spiderLeg&&(n.removeLayer(t._spiderLeg),delete t._spiderLeg);i._spiderfied=null}}),L.MarkerCluster.include(L.DomUtil.TRANSITION?{SVG_ANIMATION:-1<c.createElementNS("http://www.w3.org/2000/svg","animate").toString().indexOf("SVGAnimate"),_animationSpiderfy:function(t,e){var i,n,s,r,o=this._group,a=o._map,h=o._featureGroup,_=a.latLngToLayerPoint(this._latlng);for(i=t.length-1;0<=i;i--)(n=t[i]).setOpacity?(n.setZIndexOffset(1e6),n.setOpacity(0),h.addLayer(n),n._setPos(_)):h.addLayer(n);o._forceLayout(),o._animationStart();var u=L.Path.SVG?0:.3,l=L.Path.SVG_NS;for(i=t.length-1;0<=i;i--)if(r=a.layerPointToLatLng(e[i]),(n=t[i])._preSpiderfyLatlng=n._latlng,n.setLatLng(r),n.setOpacity&&n.setOpacity(1),s=new L.Polyline([this._latlng,r],{weight:1.5,color:"#222",opacity:u}),a.addLayer(s),n._spiderLeg=s,L.Path.SVG&&this.SVG_ANIMATION){var d=s._path.getTotalLength();s._path.setAttribute("stroke-dasharray",d+","+d);var p=c.createElementNS(l,"animate");p.setAttribute("attributeName","stroke-dashoffset"),p.setAttribute("begin","indefinite"),p.setAttribute("from",d),p.setAttribute("to",0),p.setAttribute("dur",.25),s._path.appendChild(p),p.beginElement(),(p=c.createElementNS(l,"animate")).setAttribute("attributeName","stroke-opacity"),p.setAttribute("attributeName","stroke-opacity"),p.setAttribute("begin","indefinite"),p.setAttribute("from",0),p.setAttribute("to",.5),p.setAttribute("dur",.25),s._path.appendChild(p),p.beginElement()}if(this.setOpacity(.3),L.Path.SVG)for(this._group._forceLayout(),i=t.length-1;0<=i;i--)(n=t[i]._spiderLeg).options.opacity=.5,n._path.setAttribute("stroke-opacity",.5);setTimeout(function(){o._animationEnd(),o.fire("spiderfied")},200)},_animationUnspiderfy:function(t){var e,i,n,s=this._group,r=s._map,o=s._featureGroup,a=t?r._latLngToNewLayerPoint(this._latlng,t.zoom,t.center):r.latLngToLayerPoint(this._latlng),h=this.getAllChildMarkers(),_=L.Path.SVG&&this.SVG_ANIMATION;for(s._animationStart(),this.setOpacity(1),i=h.length-1;0<=i;i--)(e=h[i])._preSpiderfyLatlng&&(e.setLatLng(e._preSpiderfyLatlng),delete e._preSpiderfyLatlng,e.setOpacity?(e._setPos(a),e.setOpacity(0)):o.removeLayer(e),_&&((n=e._spiderLeg._path.childNodes[0]).setAttribute("to",n.getAttribute("from")),n.setAttribute("from",0),n.beginElement(),(n=e._spiderLeg._path.childNodes[1]).setAttribute("from",.5),n.setAttribute("to",0),n.setAttribute("stroke-opacity",0),n.beginElement(),e._spiderLeg._path.setAttribute("stroke-opacity",0)));setTimeout(function(){var t=0;for(i=h.length-1;0<=i;i--)(e=h[i])._spiderLeg&&t++;for(i=h.length-1;0<=i;i--)(e=h[i])._spiderLeg&&(e.setOpacity&&(e.setOpacity(1),e.setZIndexOffset(0)),1<t&&o.removeLayer(e),r.removeLayer(e._spiderLeg),delete e._spiderLeg);s._animationEnd()},200)}}:{_animationSpiderfy:function(t,e){var i,n,s,r,o=this._group,a=o._map,h=o._featureGroup;for(i=t.length-1;0<=i;i--)r=a.layerPointToLatLng(e[i]),(n=t[i])._preSpiderfyLatlng=n._latlng,n.setLatLng(r),n.setZIndexOffset&&n.setZIndexOffset(1e6),h.addLayer(n),s=new L.Polyline([this._latlng,r],{weight:1.5,color:"#222"}),a.addLayer(s),n._spiderLeg=s;this.setOpacity(.3),o.fire("spiderfied")},_animationUnspiderfy:function(){this._noanimationUnspiderfy()}}),L.MarkerClusterGroup.include({_spiderfied:null,_spiderfierOnAdd:function(){this._map.on("click",this._unspiderfyWrapper,this),this._map.options.zoomAnimation&&this._map.on("zoomstart",this._unspiderfyZoomStart,this),this._map.on("zoomend",this._noanimationUnspiderfy,this),L.Path.SVG&&!L.Browser.touch&&this._map._initPathRoot()},_spiderfierOnRemove:function(){this._map.off("click",this._unspiderfyWrapper,this),this._map.off("zoomstart",this._unspiderfyZoomStart,this),this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._unspiderfy()},_unspiderfyZoomStart:function(){this._map&&this._map.on("zoomanim",this._unspiderfyZoomAnim,this)},_unspiderfyZoomAnim:function(t){L.DomUtil.hasClass(this._map._mapPane,"leaflet-touching")||(this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._unspiderfy(t))},_unspiderfyWrapper:function(){this._unspiderfy()},_unspiderfy:function(t){this._spiderfied&&this._spiderfied.unspiderfy(t)},_noanimationUnspiderfy:function(){this._spiderfied&&this._spiderfied._noanimationUnspiderfy()},_unspiderfyLayer:function(t){t._spiderLeg&&(this._featureGroup.removeLayer(t),t.setOpacity(1),t.setZIndexOffset(0),this._map.removeLayer(t._spiderLeg),delete t._spiderLeg)}})}(window,document);
!function(i,e){L.drawVersion="0.2.4-dev",L.drawLocal={draw:{toolbar:{actions:{title:"Cancel drawing",text:"Cancel"},undo:{title:"Delete last point drawn",text:"Delete last point"},buttons:{polyline:"Draw a polyline",polygon:"Draw a polygon",rectangle:"Draw a rectangle",circle:"Draw a circle",marker:"Draw a marker"}},handlers:{circle:{tooltip:{start:"Click and drag to draw circle."}},marker:{tooltip:{start:"Click map to place marker."}},polygon:{tooltip:{start:"Click to start drawing shape.",cont:"Click to continue drawing shape.",end:"Click first point to close this shape."}},polyline:{error:"<strong>Error:</strong> shape edges cannot cross!",tooltip:{start:"Click to start drawing line.",cont:"Click to continue drawing line.",end:"Click last point to finish line."}},rectangle:{tooltip:{start:"Click and drag to draw rectangle."}},simpleshape:{tooltip:{end:"Release mouse to finish drawing."}}}},edit:{toolbar:{actions:{save:{title:"Save changes.",text:"Save"},cancel:{title:"Cancel editing, discards all changes.",text:"Cancel"}},buttons:{edit:"Edit layers.",editDisabled:"No layers to edit.",remove:"Delete layers.",removeDisabled:"No layers to delete."}},handlers:{edit:{tooltip:{text:"Drag handles, or marker to edit feature.",subtext:"Click cancel to undo changes."}},remove:{tooltip:{text:"Click on a feature to remove"}}}}},L.Draw={},L.Draw.Feature=L.Handler.extend({includes:L.Mixin.Events,initialize:function(t,e){this._map=t,this._container=t._container,this._overlayPane=t._panes.overlayPane,this._popupPane=t._panes.popupPane,e&&e.shapeOptions&&(e.shapeOptions=L.Util.extend({},this.options.shapeOptions,e.shapeOptions)),L.setOptions(this,e)},enable:function(){this._enabled||(this.fire("enabled",{handler:this.type}),this._map.fire("draw:drawstart",{layerType:this.type}),L.Handler.prototype.enable.call(this))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this._map.fire("draw:drawstop",{layerType:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var t=this._map;t&&(L.DomUtil.disableTextSelection(),t.getContainer().focus(),this._tooltip=new L.Tooltip(this._map),L.DomEvent.on(this._container,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.off(this._container,"keyup",this._cancelDrawing,this))},setOptions:function(t){L.setOptions(this,t)},_fireCreatedEvent:function(t){this._map.fire("draw:created",{layer:t,layerType:this.type})},_cancelDrawing:function(t){27===t.keyCode&&this.disable()}}),L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:"polyline"},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:"#b00b00",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),guidelineDistance:20,maxGuideLineLength:4e3,shapeOptions:{stroke:!0,color:"#f06eaa",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,showLength:!0,zIndexOffset:2e3},initialize:function(t,e){this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error,e&&e.drawError&&(e.drawError=L.Util.extend({},this.options.drawError,e.drawError)),this.type=L.Draw.Polyline.TYPE,L.Draw.Feature.prototype.initialize.call(this,t,e)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("mousedown",this._onMouseDown,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this).on("mouseup",this._onMouseUp,this).on("zoomend",this._onZoomEnd,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._clearHideErrorTimeout(),this._cleanUpShape(),this._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers,this._map.removeLayer(this._poly),delete this._poly,this._mouseMarker.off("mousedown",this._onMouseDown,this).off("mouseup",this._onMouseUp,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._clearGuides(),this._map.off("mousemove",this._onMouseMove,this).off("zoomend",this._onZoomEnd,this)},deleteLastVertex:function(){if(!(this._markers.length<=1)){var t=this._markers.pop(),e=this._poly,i=this._poly.spliceLatLngs(e.getLatLngs().length-1,1)[0];this._markerGroup.removeLayer(t),e.getLatLngs().length<2&&this._map.removeLayer(e),this._vertexChanged(i,!1)}},addVertex:function(t){return 0<this._markers.length&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(t)?void this._showErrorTooltip():(this._errorShown&&this._hideErrorTooltip(),this._markers.push(this._createMarker(t)),this._poly.addLatLng(t),2===this._poly.getLatLngs().length&&this._map.addLayer(this._poly),void this._vertexChanged(t,!0))},_finishShape:function(){var t=this._poly.newLatLngIntersects(this._poly.getLatLngs()[0],!0);return!this.options.allowIntersection&&t||!this._shapeIsValid()?void this._showErrorTooltip():(this._fireCreatedEvent(),this.disable(),void(this.options.repeatMode&&this.enable()))},_shapeIsValid:function(){return!0},_onZoomEnd:function(){this._updateGuide()},_onMouseMove:function(t){var e=t.layerPoint,i=t.latlng;this._currentLatLng=i,this._updateTooltip(i),this._updateGuide(e),this._mouseMarker.setLatLng(i),L.DomEvent.preventDefault(t.originalEvent)},_vertexChanged:function(t,e){this._updateFinishHandler(),this._updateRunningMeasure(t,e),this._clearGuides(),this._updateTooltip()},_onMouseDown:function(t){var e=t.originalEvent;this._mouseDownOrigin=L.point(e.clientX,e.clientY)},_onMouseUp:function(t){if(this._mouseDownOrigin){var e=L.point(t.originalEvent.clientX,t.originalEvent.clientY).distanceTo(this._mouseDownOrigin);Math.abs(e)<9*(i.devicePixelRatio||1)&&this.addVertex(t.latlng)}this._mouseDownOrigin=null},_updateFinishHandler:function(){var t=this._markers.length;1<t&&this._markers[t-1].on("click",this._finishShape,this),2<t&&this._markers[t-2].off("click",this._finishShape,this)},_createMarker:function(t){var e=new L.Marker(t,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});return this._markerGroup.addLayer(e),e},_updateGuide:function(t){var e=this._markers.length;0<e&&(t=t||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[e-1].getLatLng()),t))},_updateTooltip:function(t){var e=this._getTooltipText();t&&this._tooltip.updatePosition(t),this._errorShown||this._tooltip.updateContent(e)},_drawGuide:function(t,e){var i,o,a,s=Math.floor(Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))),r=this.options.guidelineDistance,n=this.options.maxGuideLineLength,l=n<s?s-n:r;for(this._guidesContainer||(this._guidesContainer=L.DomUtil.create("div","leaflet-draw-guides",this._overlayPane));l<s;l+=this.options.guidelineDistance)i=l/s,o={x:Math.floor(t.x*(1-i)+i*e.x),y:Math.floor(t.y*(1-i)+i*e.y)},(a=L.DomUtil.create("div","leaflet-draw-guide-dash",this._guidesContainer)).style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(a,o)},_updateGuideColor:function(t){if(this._guidesContainer)for(var e=0,i=this._guidesContainer.childNodes.length;e<i;e++)this._guidesContainer.childNodes[e].style.backgroundColor=t},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_getTooltipText:function(){var t,e=this.options.showLength;return 0===this._markers.length?{text:L.drawLocal.draw.handlers.polyline.tooltip.start}:(t=e?this._getMeasurementString():"",1===this._markers.length?{text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:t}:{text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:t})},_updateRunningMeasure:function(t,e){var i,o,a=this._markers.length;1===this._markers.length?this._measurementRunningTotal=0:(i=a-(e?2:1),o=t.distanceTo(this._markers[i].getLatLng()),this._measurementRunningTotal+=o*(e?1:-1))},_getMeasurementString:function(){var t,e=this._currentLatLng,i=this._markers[this._markers.length-1].getLatLng();return t=this._measurementRunningTotal+e.distanceTo(i),L.GeometryUtil.readableDistance(t,this.options.metric)},_showErrorTooltip:function(){this._errorShown=!0,this._tooltip.showAsError().updateContent({text:this.options.drawError.message}),this._updateGuideColor(this.options.drawError.color),this._poly.setStyle({color:this.options.drawError.color}),this._clearHideErrorTimeout(),this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1,this._clearHideErrorTimeout(),this._tooltip.removeError().updateContent(this._getTooltipText()),this._updateGuideColor(this.options.shapeOptions.color),this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_cleanUpShape:function(){1<this._markers.length&&this._markers[this._markers.length-1].off("click",this._finishShape,this)},_fireCreatedEvent:function(){var t=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,t)}}),L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:"polygon"},Poly:L.Polygon,options:{showArea:!1,shapeOptions:{stroke:!0,color:"#f06eaa",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0}},initialize:function(t,e){L.Draw.Polyline.prototype.initialize.call(this,t,e),this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var t=this._markers.length;1===t&&this._markers[0].on("click",this._finishShape,this),2<t&&(this._markers[t-1].on("dblclick",this._finishShape,this),3<t&&this._markers[t-2].off("dblclick",this._finishShape,this))},_getTooltipText:function(){var t,e;return 0===this._markers.length?t=L.drawLocal.draw.handlers.polygon.tooltip.start:this._markers.length<3?t=L.drawLocal.draw.handlers.polygon.tooltip.cont:(t=L.drawLocal.draw.handlers.polygon.tooltip.end,e=this._getMeasurementString()),{text:t,subtext:e}},_getMeasurementString:function(){var t=this._area;return t?L.GeometryUtil.readableArea(t,this.options.metric):null},_shapeIsValid:function(){return 3<=this._markers.length},_vertexChanged:function(t,e){var i;!this.options.allowIntersection&&this.options.showArea&&(i=this._poly.getLatLngs(),this._area=L.GeometryUtil.geodesicArea(i)),L.Draw.Polyline.prototype._vertexChanged.call(this,t,e)},_cleanUpShape:function(){var t=this._markers.length;0<t&&(this._markers[0].off("click",this._finishShape,this),2<t&&this._markers[t-1].off("dblclick",this._finishShape,this))}}),L.SimpleShape={},L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:!1},initialize:function(t,e){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end,L.Draw.Feature.prototype.initialize.call(this,t,e)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._mapDraggable=this._map.dragging.enabled(),this._mapDraggable&&this._map.dragging.disable(),this._container.style.cursor="crosshair",this._tooltip.updateContent({text:this._initialLabelText}),this._map.on("mousedown",this._onMouseDown,this).on("mousemove",this._onMouseMove,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._mapDraggable&&this._map.dragging.enable(),this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this),L.DomEvent.off(e,"mouseup",this._onMouseUp,this),this._shape&&(this._map.removeLayer(this._shape),delete this._shape)),this._isDrawing=!1},_onMouseDown:function(t){this._isDrawing=!0,this._startLatLng=t.latlng,L.DomEvent.on(e,"mouseup",this._onMouseUp,this).preventDefault(t.originalEvent)},_onMouseMove:function(t){var e=t.latlng;this._tooltip.updatePosition(e),this._isDrawing&&(this._tooltip.updateContent({text:this._endLabelText}),this._drawShape(e))},_onMouseUp:function(){this._shape&&this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()}}),L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:"rectangle"},options:{shapeOptions:{stroke:!0,color:"#f06eaa",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0}},initialize:function(t,e){this.type=L.Draw.Rectangle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,t,e)},_drawShape:function(t){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,t)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,t),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var t=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,t)}}),L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:"circle"},options:{shapeOptions:{stroke:!0,color:"#f06eaa",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0},initialize:function(t,e){this.type=L.Draw.Circle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,t,e)},_drawShape:function(t){this._shape?this._shape.setRadius(this._startLatLng.distanceTo(t)):(this._shape=new L.Circle(this._startLatLng,this._startLatLng.distanceTo(t),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var t=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,t)},_onMouseMove:function(t){var e,i=t.latlng,o=this.options.showRadius,a=this.options.metric;this._tooltip.updatePosition(i),this._isDrawing&&(this._drawShape(i),e=this._shape.getRadius().toFixed(1),this._tooltip.updateContent({text:this._endLabelText,subtext:o?"Radius: "+L.GeometryUtil.readableDistance(e,a):""}))}}),L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:"marker"},options:{icon:new L.Icon.Default,repeatMode:!1,zIndexOffset:2e3},initialize:function(t,e){this.type=L.Draw.Marker.TYPE,L.Draw.Feature.prototype.initialize.call(this,t,e)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._tooltip.updateContent({text:L.drawLocal.draw.handlers.marker.tooltip.start}),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("click",this._onClick,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._marker&&(this._marker.off("click",this._onClick,this),this._map.off("click",this._onClick,this).removeLayer(this._marker),delete this._marker),this._mouseMarker.off("click",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off("mousemove",this._onMouseMove,this))},_onMouseMove:function(t){var e=t.latlng;this._tooltip.updatePosition(e),this._mouseMarker.setLatLng(e),this._marker?(e=this._mouseMarker.getLatLng(),this._marker.setLatLng(e)):(this._marker=new L.Marker(e,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset}),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,this).addLayer(this._marker))},_onClick:function(){this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_fireCreatedEvent:function(){var t=new L.Marker(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,t)}}),L.Edit=L.Edit||{},L.Edit.Poly=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"})},initialize:function(t,e){this._poly=t,L.setOptions(this,e)},addHooks:function(){this._poly._map&&(this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){this._poly._map&&(this._poly._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._markers=[];var t,e,i,o,a,s,r=this._poly._latlngs;for(t=0,i=r.length;t<i;t++)(o=this._createMarker(r[t],t)).on("click",this._onMarkerClick,this),this._markers.push(o);for(t=0,e=i-1;t<i;e=t++)(0!==t||L.Polygon&&this._poly instanceof L.Polygon)&&(a=this._markers[e],s=this._markers[t],this._createMiddleMarker(a,s),this._updatePrevNext(a,s))},_createMarker:function(t,e){var i=new L.Marker(t,{draggable:!0,icon:this.options.icon});return i._origLatLng=t,i._index=e,i.on("drag",this._onMarkerDrag,this),i.on("dragend",this._fireEdit,this),this._markerGroup.addLayer(i),i},_removeMarker:function(t){var e=t._index;this._markerGroup.removeLayer(t),this._markers.splice(e,1),this._poly.spliceLatLngs(e,1),this._updateIndexes(e,-1),t.off("drag",this._onMarkerDrag,this).off("dragend",this._fireEdit,this).off("click",this._onMarkerClick,this)},_fireEdit:function(){this._poly.edited=!0,this._poly.fire("edit")},_onMarkerDrag:function(t){var e=t.target;L.extend(e._origLatLng,e._latlng),e._middleLeft&&e._middleLeft.setLatLng(this._getMiddleLatLng(e._prev,e)),e._middleRight&&e._middleRight.setLatLng(this._getMiddleLatLng(e,e._next)),this._poly.redraw()},_onMarkerClick:function(t){var e=L.Polygon&&this._poly instanceof L.Polygon?4:3,i=t.target;this._poly._latlngs.length<e||(this._removeMarker(i),this._updatePrevNext(i._prev,i._next),i._middleLeft&&this._markerGroup.removeLayer(i._middleLeft),i._middleRight&&this._markerGroup.removeLayer(i._middleRight),i._prev&&i._next?this._createMiddleMarker(i._prev,i._next):i._prev?i._next||(i._prev._middleRight=null):i._next._middleLeft=null,this._fireEdit())},_updateIndexes:function(e,i){this._markerGroup.eachLayer(function(t){t._index>e&&(t._index+=i)})},_createMiddleMarker:function(e,i){var o,t,a,s=this._getMiddleLatLng(e,i),r=this._createMarker(s);r.setOpacity(.6),e._middleRight=i._middleLeft=r,t=function(){var t=i._index;r._index=t,r.off("click",o,this).on("click",this._onMarkerClick,this),s.lat=r.getLatLng().lat,s.lng=r.getLatLng().lng,this._poly.spliceLatLngs(t,0,s),this._markers.splice(t,0,r),r.setOpacity(1),this._updateIndexes(t,1),i._index++,this._updatePrevNext(e,r),this._updatePrevNext(r,i),this._poly.fire("editstart")},a=function(){r.off("dragstart",t,this),r.off("dragend",a,this),this._createMiddleMarker(e,r),this._createMiddleMarker(r,i)},o=function(){t.call(this),a.call(this),this._fireEdit()},r.on("click",o,this).on("dragstart",t,this).on("dragend",a,this),this._markerGroup.addLayer(r)},_updatePrevNext:function(t,e){t&&(t._next=e),e&&(e._prev=t)},_getMiddleLatLng:function(t,e){var i=this._poly._map,o=i.project(t.getLatLng()),a=i.project(e.getLatLng());return i.unproject(o._add(a)._divideBy(2))}}),L.Polyline.addInitHook(function(){this.editing||(L.Edit.Poly&&(this.editing=new L.Edit.Poly(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))}),L.Edit=L.Edit||{},L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"})},initialize:function(t,e){this._shape=t,L.Util.setOptions(this,e)},addHooks:function(){this._shape._map&&(this._map=this._shape._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup))},removeHooks:function(){if(this._shape._map){this._unbindMarker(this._moveMarker);for(var t=0,e=this._resizeMarkers.length;t<e;t++)this._unbindMarker(this._resizeMarkers[t]);this._resizeMarkers=null,this._map.removeLayer(this._markerGroup),delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._createMoveMarker(),this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(t,e){var i=new L.Marker(t,{draggable:!0,icon:e,zIndexOffset:10});return this._bindMarker(i),this._markerGroup.addLayer(i),i},_bindMarker:function(t){t.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._onMarkerDragEnd,this)},_unbindMarker:function(t){t.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._onMarkerDragEnd,this)},_onMarkerDragStart:function(t){t.target.setOpacity(0),this._shape.fire("editstart")},_fireEdit:function(){this._shape.edited=!0,this._shape.fire("edit")},_onMarkerDrag:function(t){var e=t.target,i=e.getLatLng();e===this._moveMarker?this._move(i):this._resize(i),this._shape.redraw()},_onMarkerDragEnd:function(t){t.target.setOpacity(1),this._fireEdit()},_move:function(){},_resize:function(){}}),L.Edit=L.Edit||{},L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var t=this._shape.getBounds().getCenter();this._moveMarker=this._createMarker(t,this.options.moveIcon)},_createResizeMarker:function(){var t=this._getCorners();this._resizeMarkers=[];for(var e=0,i=t.length;e<i;e++)this._resizeMarkers.push(this._createMarker(t[e],this.options.resizeIcon)),this._resizeMarkers[e]._cornerIndex=e},_onMarkerDragStart:function(t){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,t);var e=this._getCorners(),i=t.target._cornerIndex;this._oppositeCorner=e[(i+2)%4],this._toggleCornerMarkers(0,i)},_onMarkerDragEnd:function(t){var e,i=t.target;i===this._moveMarker&&(e=this._shape.getBounds().getCenter(),i.setLatLng(e)),this._toggleCornerMarkers(1),this._repositionCornerMarkers(),L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,t)},_move:function(t){for(var e,i=this._shape.getLatLngs(),o=this._shape.getBounds().getCenter(),a=[],s=0,r=i.length;s<r;s++)e=[i[s].lat-o.lat,i[s].lng-o.lng],a.push([t.lat+e[0],t.lng+e[1]]);this._shape.setLatLngs(a),this._repositionCornerMarkers()},_resize:function(t){var e;this._shape.setBounds(L.latLngBounds(t,this._oppositeCorner)),e=this._shape.getBounds(),this._moveMarker.setLatLng(e.getCenter())},_getCorners:function(){var t=this._shape.getBounds();return[t.getNorthWest(),t.getNorthEast(),t.getSouthEast(),t.getSouthWest()]},_toggleCornerMarkers:function(t){for(var e=0,i=this._resizeMarkers.length;e<i;e++)this._resizeMarkers[e].setOpacity(t)},_repositionCornerMarkers:function(){for(var t=this._getCorners(),e=0,i=this._resizeMarkers.length;e<i;e++)this._resizeMarkers[e].setLatLng(t[e])}}),L.Rectangle.addInitHook(function(){L.Edit.Rectangle&&(this.editing=new L.Edit.Rectangle(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.Circle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var t=this._shape.getLatLng();this._moveMarker=this._createMarker(t,this.options.moveIcon)},_createResizeMarker:function(){var t=this._shape.getLatLng(),e=this._getResizeMarkerPoint(t);this._resizeMarkers=[],this._resizeMarkers.push(this._createMarker(e,this.options.resizeIcon))},_getResizeMarkerPoint:function(t){var e=this._shape._radius*Math.cos(Math.PI/4),i=this._map.project(t);return this._map.unproject([i.x+e,i.y-e])},_move:function(t){var e=this._getResizeMarkerPoint(t);this._resizeMarkers[0].setLatLng(e),this._shape.setLatLng(t)},_resize:function(t){var e=this._moveMarker.getLatLng().distanceTo(t);this._shape.setRadius(e)}}),L.Circle.addInitHook(function(){L.Edit.Circle&&(this.editing=new L.Edit.Circle(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})}),L.LatLngUtil={cloneLatLngs:function(t){for(var e=[],i=0,o=t.length;i<o;i++)e.push(this.cloneLatLng(t[i]));return e},cloneLatLng:function(t){return L.latLng(t.lat,t.lng)}},L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(t){var e,i,o=t.length,a=0,s=L.LatLng.DEG_TO_RAD;if(2<o){for(var r=0;r<o;r++)e=t[r],a+=((i=t[(r+1)%o]).lng-e.lng)*s*(2+Math.sin(e.lat*s)+Math.sin(i.lat*s));a=6378137*a*6378137/2}return Math.abs(a)},readableArea:function(t,e){return e?1e4<=t?(1e-4*t).toFixed(2)+" ha":t.toFixed(2)+" m&sup2;":3097600<=(t*=.836127)?(t/3097600).toFixed(2)+" mi&sup2;":4840<=t?(t/4840).toFixed(2)+" acres":Math.ceil(t)+" yd&sup2;"},readableDistance:function(t,e){return e?1e3<t?(t/1e3).toFixed(2)+" km":Math.ceil(t)+" m":1760<(t*=1.09361)?(t/1760).toFixed(2)+" miles":Math.ceil(t)+" yd"}}),L.Util.extend(L.LineUtil,{segmentsIntersect:function(t,e,i,o){return this._checkCounterclockwise(t,i,o)!==this._checkCounterclockwise(e,i,o)&&this._checkCounterclockwise(t,e,i)!==this._checkCounterclockwise(t,e,o)},_checkCounterclockwise:function(t,e,i){return(i.y-t.y)*(e.x-t.x)>(e.y-t.y)*(i.x-t.x)}}),L.Polyline.include({intersects:function(){var t,e,i,o=this._originalPoints,a=o?o.length:0;if(this._tooFewPointsForIntersection())return!1;for(t=a-1;3<=t;t--)if(e=o[t-1],i=o[t],this._lineSegmentsIntersectsRange(e,i,t-2))return!0;return!1},newLatLngIntersects:function(t,e){return!!this._map&&this.newPointIntersects(this._map.latLngToLayerPoint(t),e)},newPointIntersects:function(t,e){var i=this._originalPoints,o=i?i.length:0,a=i?i[o-1]:null,s=o-2;return!this._tooFewPointsForIntersection(1)&&this._lineSegmentsIntersectsRange(a,t,s,e?1:0)},_tooFewPointsForIntersection:function(t){var e=this._originalPoints,i=e?e.length:0;return i+=t||0,!this._originalPoints||i<=3},_lineSegmentsIntersectsRange:function(t,e,i,o){var a,s,r=this._originalPoints;o=o||0;for(var n=i;o<n;n--)if(a=r[n-1],s=r[n],L.LineUtil.segmentsIntersect(t,e,a,s))return!0;return!1}}),L.Polygon.include({intersects:function(){var t,e,i,o,a=this._originalPoints;return!this._tooFewPointsForIntersection()&&(!!L.Polyline.prototype.intersects.call(this)||(t=a.length,e=a[0],i=a[t-1],o=t-2,this._lineSegmentsIntersectsRange(i,e,o,1)))}}),L.Control.Draw=L.Control.extend({options:{position:"topleft",draw:{},edit:!1},initialize:function(t){if(L.version<"0.7")throw new Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");var e,i;L.Control.prototype.initialize.call(this,t),this._toolbars={},L.DrawToolbar&&this.options.draw&&(i=new L.DrawToolbar(this.options.draw),e=L.stamp(i),this._toolbars[e]=i,this._toolbars[e].on("enable",this._toolbarEnabled,this)),L.EditToolbar&&this.options.edit&&(i=new L.EditToolbar(this.options.edit),e=L.stamp(i),this._toolbars[e]=i,this._toolbars[e].on("enable",this._toolbarEnabled,this))},onAdd:function(t){var e,i=L.DomUtil.create("div","leaflet-draw"),o=!1,a="leaflet-draw-toolbar-top";for(var s in this._toolbars)this._toolbars.hasOwnProperty(s)&&((e=this._toolbars[s].addToolbar(t))&&(o||(L.DomUtil.hasClass(e,a)||L.DomUtil.addClass(e.childNodes[0],a),o=!0),i.appendChild(e)));return i},onRemove:function(){for(var t in this._toolbars)this._toolbars.hasOwnProperty(t)&&this._toolbars[t].removeToolbar()},setDrawingOptions:function(t){for(var e in this._toolbars)this._toolbars[e]instanceof L.DrawToolbar&&this._toolbars[e].setOptions(t)},_toolbarEnabled:function(t){var e=""+L.stamp(t.target);for(var i in this._toolbars)this._toolbars.hasOwnProperty(i)&&i!==e&&this._toolbars[i].disable()}}),L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1}),L.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))}),L.Toolbar=L.Class.extend({includes:[L.Mixin.Events],initialize:function(t){L.setOptions(this,t),this._modes={},this._actionButtons=[],this._activeMode=null},enabled:function(){return null!==this._activeMode},disable:function(){this.enabled()&&this._activeMode.handler.disable()},addToolbar:function(t){var e,i=L.DomUtil.create("div","leaflet-draw-section"),o=0,a=this._toolbarClass||"",s=this.getModeHandlers(t);for(this._toolbarContainer=L.DomUtil.create("div","leaflet-draw-toolbar leaflet-bar"),this._map=t,e=0;e<s.length;e++)s[e].enabled&&this._initModeHandler(s[e].handler,this._toolbarContainer,o++,a,s[e].title);return o?(this._lastButtonIndex=--o,this._actionsContainer=L.DomUtil.create("ul","leaflet-draw-actions"),i.appendChild(this._toolbarContainer),i.appendChild(this._actionsContainer),i):void 0},removeToolbar:function(){for(var t in this._modes)this._modes.hasOwnProperty(t)&&(this._disposeButton(this._modes[t].button,this._modes[t].handler.enable,this._modes[t].handler),this._modes[t].handler.disable(),this._modes[t].handler.off("enabled",this._handlerActivated,this).off("disabled",this._handlerDeactivated,this));this._modes={};for(var e=0,i=this._actionButtons.length;e<i;e++)this._disposeButton(this._actionButtons[e].button,this._actionButtons[e].callback,this);this._actionButtons=[],this._actionsContainer=null},_initModeHandler:function(t,e,i,o,a){var s=t.type;this._modes[s]={},this._modes[s].handler=t,this._modes[s].button=this._createButton({title:a,className:o+"-"+s,container:e,callback:this._modes[s].handler.enable,context:this._modes[s].handler}),this._modes[s].buttonIndex=i,this._modes[s].handler.on("enabled",this._handlerActivated,this).on("disabled",this._handlerDeactivated,this)},_createButton:function(t){var e=L.DomUtil.create("a",t.className||"",t.container);return e.href="#",t.text&&(e.innerHTML=t.text),t.title&&(e.title=t.title),L.DomEvent.on(e,"click",L.DomEvent.stopPropagation).on(e,"mousedown",L.DomEvent.stopPropagation).on(e,"dblclick",L.DomEvent.stopPropagation).on(e,"click",L.DomEvent.preventDefault).on(e,"click",t.callback,t.context),e},_disposeButton:function(t,e){L.DomEvent.off(t,"click",L.DomEvent.stopPropagation).off(t,"mousedown",L.DomEvent.stopPropagation).off(t,"dblclick",L.DomEvent.stopPropagation).off(t,"click",L.DomEvent.preventDefault).off(t,"click",e)},_handlerActivated:function(t){this.disable(),this._activeMode=this._modes[t.handler],L.DomUtil.addClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._showActionsToolbar(),this.fire("enable")},_handlerDeactivated:function(){this._hideActionsToolbar(),L.DomUtil.removeClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._activeMode=null,this.fire("disable")},_createActions:function(t){var e,i,o,a,s=this._actionsContainer,r=this.getActions(t),n=r.length;for(i=0,o=this._actionButtons.length;i<o;i++)this._disposeButton(this._actionButtons[i].button,this._actionButtons[i].callback);for(this._actionButtons=[];s.firstChild;)s.removeChild(s.firstChild);for(var l=0;l<n;l++)"enabled"in r[l]&&!r[l].enabled||(e=L.DomUtil.create("li","",s),a=this._createButton({title:r[l].title,text:r[l].text,container:e,callback:r[l].callback,context:r[l].context}),this._actionButtons.push({button:a,callback:r[l].callback}))},_showActionsToolbar:function(){var t=this._activeMode.buttonIndex,e=this._lastButtonIndex,i=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler),this._actionsContainer.style.top=i+"px",0===t&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-top")),t===e&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-bottom")),this._actionsContainer.style.display="block"},_hideActionsToolbar:function(){this._actionsContainer.style.display="none",L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-top"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-bottom")}}),L.Tooltip=L.Class.extend({initialize:function(t){this._map=t,this._popupPane=t._panes.popupPane,this._container=t.options.drawControlTooltips?L.DomUtil.create("div","leaflet-draw-tooltip",this._popupPane):null,this._singleLineLabel=!1},dispose:function(){this._container&&(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(t){return this._container&&(t.subtext=t.subtext||"",0!==t.subtext.length||this._singleLineLabel?0<t.subtext.length&&this._singleLineLabel&&(L.DomUtil.removeClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!1):(L.DomUtil.addClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!0),this._container.innerHTML=(0<t.subtext.length?'<span class="leaflet-draw-tooltip-subtext">'+t.subtext+"</span><br />":"")+"<span>"+t.text+"</span>"),this},updatePosition:function(t){var e=this._map.latLngToLayerPoint(t),i=this._container;return this._container&&(i.style.visibility="inherit",L.DomUtil.setPosition(i,e)),this},showAsError:function(){return this._container&&L.DomUtil.addClass(this._container,"leaflet-error-draw-tooltip"),this},removeError:function(){return this._container&&L.DomUtil.removeClass(this._container,"leaflet-error-draw-tooltip"),this}}),L.DrawToolbar=L.Toolbar.extend({options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{}},initialize:function(t){for(var e in this.options)this.options.hasOwnProperty(e)&&t[e]&&(t[e]=L.extend({},this.options[e],t[e]));this._toolbarClass="leaflet-draw-draw",L.Toolbar.prototype.initialize.call(this,t)},getModeHandlers:function(t){return[{enabled:this.options.polyline,handler:new L.Draw.Polyline(t,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(t,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(t,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new L.Draw.Circle(t,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(t,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker}]},getActions:function(t){return[{enabled:t.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,callback:t.deleteLastVertex,context:t},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(t){for(var e in L.setOptions(this,t),this._modes)this._modes.hasOwnProperty(e)&&t.hasOwnProperty(e)&&this._modes[e].handler.setOptions(t[e])}}),L.EditToolbar=L.Toolbar.extend({options:{edit:{selectedPathOptions:{color:"#fe57a1",opacity:.6,dashArray:"10, 10",fill:!0,fillColor:"#fe57a1",fillOpacity:.1}},remove:{},featureGroup:null},initialize:function(t){t.edit&&(void 0===t.edit.selectedPathOptions&&(t.edit.selectedPathOptions=this.options.edit.selectedPathOptions),t.edit=L.extend({},this.options.edit,t.edit)),t.remove&&(t.remove=L.extend({},this.options.remove,t.remove)),this._toolbarClass="leaflet-draw-edit",L.Toolbar.prototype.initialize.call(this,t),this._selectedFeatureCount=0},getModeHandlers:function(t){var e=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(t,{featureGroup:e,selectedPathOptions:this.options.edit.selectedPathOptions}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(t,{featureGroup:e}),title:L.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(){return[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}]},addToolbar:function(t){var e=L.Toolbar.prototype.addToolbar.call(this,t);return this._checkDisabled(),this.options.featureGroup.on("layeradd layerremove",this._checkDisabled,this),e},removeToolbar:function(){this.options.featureGroup.off("layeradd layerremove",this._checkDisabled,this),L.Toolbar.prototype.removeToolbar.call(this)},disable:function(){this.enabled()&&(this._activeMode.handler.revertLayers(),L.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save(),this._activeMode.handler.disable()},_checkDisabled:function(){var t,e=0!==this.options.featureGroup.getLayers().length;this.options.edit&&(t=this._modes[L.EditToolbar.Edit.TYPE].button,e?L.DomUtil.removeClass(t,"leaflet-disabled"):L.DomUtil.addClass(t,"leaflet-disabled"),t.setAttribute("title",e?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled)),this.options.remove&&(t=this._modes[L.EditToolbar.Delete.TYPE].button,e?L.DomUtil.removeClass(t,"leaflet-disabled"):L.DomUtil.addClass(t,"leaflet-disabled"),t.setAttribute("title",e?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled))}}),L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:"edit"},includes:L.Mixin.Events,initialize:function(t,e){if(L.Handler.prototype.initialize.call(this,t),this._selectedPathOptions=e.selectedPathOptions,this._featureGroup=e.featureGroup,!(this._featureGroup instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this._uneditedLayerProps={},this.type=L.EditToolbar.Edit.TYPE},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire("draw:editstart",{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this))},disable:function(){this._enabled&&(this._featureGroup.off("layeradd",this._enableLayerEdit,this).off("layerremove",this._disableLayerEdit,this),L.Handler.prototype.disable.call(this),this._map.fire("draw:editstop",{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var t=this._map;t&&(t.getContainer().focus(),this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new L.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._featureGroup.eachLayer(function(t){this._revertLayer(t)},this)},save:function(){var e=new L.LayerGroup;this._featureGroup.eachLayer(function(t){t.edited&&(e.addLayer(t),t.edited=!1)}),this._map.fire("draw:edited",{layers:e})},_backupLayer:function(t){var e=L.Util.stamp(t);this._uneditedLayerProps[e]||(t instanceof L.Polyline||t instanceof L.Polygon||t instanceof L.Rectangle?this._uneditedLayerProps[e]={latlngs:L.LatLngUtil.cloneLatLngs(t.getLatLngs())}:t instanceof L.Circle?this._uneditedLayerProps[e]={latlng:L.LatLngUtil.cloneLatLng(t.getLatLng()),radius:t.getRadius()}:t instanceof L.Marker&&(this._uneditedLayerProps[e]={latlng:L.LatLngUtil.cloneLatLng(t.getLatLng())}))},_revertLayer:function(t){var e=L.Util.stamp(t);t.edited=!1,this._uneditedLayerProps.hasOwnProperty(e)&&(t instanceof L.Polyline||t instanceof L.Polygon||t instanceof L.Rectangle?t.setLatLngs(this._uneditedLayerProps[e].latlngs):t instanceof L.Circle?(t.setLatLng(this._uneditedLayerProps[e].latlng),t.setRadius(this._uneditedLayerProps[e].radius)):t instanceof L.Marker&&t.setLatLng(this._uneditedLayerProps[e].latlng))},_toggleMarkerHighlight:function(t){if(t._icon){var e=t._icon;e.style.display="none",L.DomUtil.hasClass(e,"leaflet-edit-marker-selected")?(L.DomUtil.removeClass(e,"leaflet-edit-marker-selected"),this._offsetMarker(e,-4)):(L.DomUtil.addClass(e,"leaflet-edit-marker-selected"),this._offsetMarker(e,4)),e.style.display=""}},_offsetMarker:function(t,e){var i=parseInt(t.style.marginTop,10)-e,o=parseInt(t.style.marginLeft,10)-e;t.style.marginTop=i+"px",t.style.marginLeft=o+"px"},_enableLayerEdit:function(t){var e,i=t.layer||t.target||t,o=i instanceof L.Marker;(!o||i._icon)&&(this._backupLayer(i),this._selectedPathOptions&&(e=L.Util.extend({},this._selectedPathOptions),o?this._toggleMarkerHighlight(i):(i.options.previousOptions=L.Util.extend({dashArray:null},i.options),i instanceof L.Circle||i instanceof L.Polygon||i instanceof L.Rectangle||(e.fill=!1),i.setStyle(e))),o?(i.dragging.enable(),i.on("dragend",this._onMarkerDragEnd)):i.editing.enable())},_disableLayerEdit:function(t){var e=t.layer||t.target||t;e.edited=!1,this._selectedPathOptions&&(e instanceof L.Marker?this._toggleMarkerHighlight(e):(e.setStyle(e.options.previousOptions),delete e.options.previousOptions)),e instanceof L.Marker?(e.dragging.disable(),e.off("dragend",this._onMarkerDragEnd,this)):e.editing.disable()},_onMarkerDragEnd:function(t){t.target.edited=!0},_onMouseMove:function(t){this._tooltip.updatePosition(t.latlng)},_hasAvailableLayers:function(){return 0!==this._featureGroup.getLayers().length}}),L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:"remove"},includes:L.Mixin.Events,initialize:function(t,e){if(L.Handler.prototype.initialize.call(this,t),L.Util.setOptions(this,e),this._deletableLayers=this.options.featureGroup,!(this._deletableLayers instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this.type=L.EditToolbar.Delete.TYPE},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire("draw:deletestart",{handler:this.type}),L.Handler.prototype.enable.call(this),this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this))},disable:function(){this._enabled&&(this._deletableLayers.off("layeradd",this._enableLayerDelete,this).off("layerremove",this._disableLayerDelete,this),L.Handler.prototype.disable.call(this),this._map.fire("draw:deletestop",{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var t=this._map;t&&(t.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,this),this._deletedLayers=new L.layerGroup,this._tooltip=new L.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._deletedLayers.eachLayer(function(t){this._deletableLayers.addLayer(t)},this)},save:function(){this._map.fire("draw:deleted",{layers:this._deletedLayers})},_enableLayerDelete:function(t){(t.layer||t.target||t).on("click",this._removeLayer,this)},_disableLayerDelete:function(t){var e=t.layer||t.target||t;e.off("click",this._removeLayer,this),this._deletedLayers.removeLayer(e)},_removeLayer:function(t){var e=t.layer||t.target||t;this._deletableLayers.removeLayer(e),this._deletedLayers.addLayer(e)},_onMouseMove:function(t){this._tooltip.updatePosition(t.latlng)},_hasAvailableLayers:function(){return 0!==this._deletableLayers.getLayers().length}})}(window,document);
L.Edit=L.Edit||{},L.Edit.Poly=L.Handler.extend({options:{allowIntersection:!1,icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"})},initialize:function(t,e){this._poly=t,L.setOptions(this,e)},addHooks:function(){this._poly._map&&(this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){this._poly._map&&(this._poly._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._markers=[];var t,e,i,r,n,a,s=this._poly._latlngs;for(t=0,i=s.length;t<i;t++)(r=this._createMarker(s[t],t)).on("click",this._onMarkerClick,this),this._markers.push(r);for(t=0,e=i-1;t<i;e=t++)(0!==t||L.Polygon&&this._poly instanceof L.Polygon)&&(n=this._markers[e],a=this._markers[t],this._createMiddleMarker(n,a),this._updatePrevNext(n,a))},_createMarker:function(t,e){var i=new L.Marker(t,{draggable:!0,icon:this.options.icon});return i._origLatLng=t,i._index=e,i.on("drag",this._onMarkerDrag,this),i.on("dragend",this._onMarkerDragEnd,this),i.on("dragstart",this._onMarkerDragStart,this),this._markerGroup.addLayer(i),i},_removeMarker:function(t){var e=t._index;this._markerGroup.removeLayer(t),this._markers.splice(e,1),this._poly.spliceLatLngs(e,1),this._updateIndexes(e,-1),t.off("drag",this._onMarkerDrag,this).off("dragend",this._onMarkerDragEnd,this).off("dragstart",this._onMarkerDragStart,this).off("click",this._onMarkerClick,this)},_fireEdit:function(){this._poly.edited=!0,this._poly.fire("edit")},_onMarkerDragStart:function(t){var e=t.target;e._srcLatLng={},L.extend(e._srcLatLng,e._latlng)},_onMarkerDragEnd:function(t){if(this.options.allowIntersection)this._fireEdit();else{var e,i,r=t.target,n=this._poly.getLatLngs(),a=!1;for(e in n)if(n.hasOwnProperty(e)&&(n[e],this._poly.intersects(r.getLatLng()))){a=!0,i=new L.LatLng(r._srcLatLng.lat,r._srcLatLng.lng),L.extend(r._origLatLng,i),r.setLatLng(i);break}a?(this._poly.redraw(),this.updateMarkers()):this._fireEdit()}},_onMarkerDrag:function(t){var e=t.target;L.extend(e._origLatLng,e._latlng),e._middleLeft&&e._middleLeft.setLatLng(this._getMiddleLatLng(e._prev,e)),e._middleRight&&e._middleRight.setLatLng(this._getMiddleLatLng(e,e._next)),this._poly.redraw()},_onMarkerClick:function(t){var e=L.Polygon&&this._poly instanceof L.Polygon?4:3,i=t.target;this._poly._latlngs.length<e||(this._removeMarker(i),this._updatePrevNext(i._prev,i._next),i._middleLeft&&this._markerGroup.removeLayer(i._middleLeft),i._middleRight&&this._markerGroup.removeLayer(i._middleRight),i._prev&&i._next?this._createMiddleMarker(i._prev,i._next):i._prev?i._next||(i._prev._middleRight=null):i._next._middleLeft=null,this._fireEdit())},_updateIndexes:function(e,i){this._markerGroup.eachLayer(function(t){t._index>e&&(t._index+=i)})},_createMiddleMarker:function(e,i){var r,t,n,a=this._getMiddleLatLng(e,i),s=this._createMarker(a);s.setOpacity(.6),e._middleRight=i._middleLeft=s,t=function(){var t=i._index;s._index=t,s.off("click",r,this).on("click",this._onMarkerClick,this),a.lat=s.getLatLng().lat,a.lng=s.getLatLng().lng,this._poly.spliceLatLngs(t,0,a),this._markers.splice(t,0,s),s.setOpacity(1),this._updateIndexes(t,1),i._index++,this._updatePrevNext(e,s),this._updatePrevNext(s,i),this._poly.fire("editstart")},n=function(){s.off("dragstart",t,this),s.off("dragend",n,this),this._createMiddleMarker(e,s),this._createMiddleMarker(s,i)},r=function(){t.call(this),n.call(this),this._fireEdit()},s.on("click",r,this).on("dragstart",t,this).on("dragend",n,this),this._markerGroup.addLayer(s)},_updatePrevNext:function(t,e){t&&(t._next=e),e&&(e._prev=t)},_getMiddleLatLng:function(t,e){var i=this._poly._map,r=i.project(t.getLatLng()),n=i.project(e.getLatLng());return i.unproject(r._add(n)._divideBy(2))}}),L.Polyline.addInitHook(function(){this.editing||(L.Edit.Poly&&(this.editing=new L.Edit.Poly(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))});
L.DrawTouch=L.Class.extend({includes:L.Mixin.Events,initialize:function(t){this._map=t},enable:function(){this._enabled||(this._map&&L.DomEvent.addListener(this._map._container,"touchstart",this._onTouchStart,this),this._enabled=!0)},disable:function(){this._enabled&&(this._map&&L.DomEvent.removeListener(this._map._container,"touchstart",this._onTouchStart,this),this._enabled=!1)},_normaliseEvent:function(t){L.DomUtil.disableImageDrag(),L.DomUtil.disableTextSelection();var n=t.touches?t.touches[0]:t,e=this._map.mouseEventToContainerPoint(n),i=this._map.mouseEventToLayerPoint(n);return{latlng:this._map.layerPointToLatLng(i),layerPoint:i,containerPoint:e,clientX:n.clientX,clientY:n.clientY,originalEvent:t}},_onTouchStart:function(t){1===t.touches.length&&(this.fire("down",this._normaliseEvent(t)),L.DomEvent.addListener(this._map._container,"touchmove",this._onTouchMove,this),L.DomEvent.addListener(this._map._container,"touchend",this._onTouchEnd,this))},_onTouchMove:function(t){this.fire("move",this._normaliseEvent(t))},_onTouchEnd:function(){this.fire("up"),L.DomEvent.removeListener(this._map._container,"touchmove",this._onTouchMove,this),L.DomEvent.removeListener(this._map._container,"touchend",this._onTouchEnd,this)}});
L.Draw={},L.Draw.Feature=L.Handler.extend({includes:L.Mixin.Events,initialize:function(e,t){this._map=e,this._container=e._container,this._overlayPane=e._panes.overlayPane,this._popupPane=e._panes.popupPane,t&&t.shapeOptions&&(t.shapeOptions=L.Util.extend({},this.options.shapeOptions,t.shapeOptions)),L.setOptions(this,t)},enable:function(){this._enabled||(this.fire("enabled",{handler:this.type}),this._map.fire("draw:drawstart",{layerType:this.type}),L.Handler.prototype.enable.call(this))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this._map.fire("draw:drawstop",{layerType:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var e=this._map;e&&(L.DomUtil.disableTextSelection(),e.getContainer().focus(),this._tooltip=new L.Tooltip(this._map),L.DomEvent.on(this._container,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.off(this._container,"keyup",this._cancelDrawing,this))},setOptions:function(e){L.setOptions(this,e)},_fireCreatedEvent:function(e){this._map.fire("draw:created",{layer:e,layerType:this.type})},_cancelDrawing:function(e){27===e.keyCode&&this.disable()}});
L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:"polyline"},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:"#b00b00",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(10,10),className:"leaflet-div-icon leaflet-editing-icon"}),guidelineDistance:20,maxGuideLineLength:4e3,shapeOptions:{stroke:!0,color:"#f06eaa",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,zIndexOffset:2e3},initialize:function(e,i){i&&i.drawError&&(i.drawError=L.Util.extend({},this.options.drawError,i.drawError)),this.type=L.Draw.Polyline.TYPE,L.Draw.Feature.prototype.initialize.call(this,e,i)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("mousedown",this._onMouseDown,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this).on("mouseup",this._onMouseUp,this).on("zoomend",this._onZoomEnd,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._clearHideErrorTimeout(),this._cleanUpShape(),this._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers,this._map.removeLayer(this._poly),delete this._poly,this._mouseMarker.off("mousedown",this._onMouseDown,this).off("mouseup",this._onMouseUp,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._clearGuides(),this._map.off("mousemove",this._onMouseMove,this).off("zoomend",this._onZoomEnd,this)},deleteLastVertex:function(){if(!(this._markers.length<=1)){var e=this._markers.pop(),i=this._poly,t=this._poly.spliceLatLngs(i.getLatLngs().length-1,1)[0];this._markerGroup.removeLayer(e),i.getLatLngs().length<2&&this._map.removeLayer(i),this._vertexChanged(t,!1)}},addVertex:function(e){this._markers.push(this._createMarker(e)),this._poly.addLatLng(e),2===this._poly.getLatLngs().length&&this._map.addLayer(this._poly),this._vertexChanged(e,!0)},_finishShape:function(){this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_shapeIsValid:function(){return!0},_onZoomEnd:function(){this._updateGuide()},_onMouseMove:function(e){var i=e.layerPoint,t=e.latlng;this._currentLatLng=t,this._updateGuide(i),this._mouseMarker.setLatLng(t),L.DomEvent.preventDefault(e.originalEvent)},_vertexChanged:function(){this._updateFinishHandler(),this._clearGuides()},_onMouseDown:function(e){var i=e.originalEvent;this._mouseDownOrigin=L.point(i.clientX,i.clientY)},_onMouseUp:function(e){if(this._mouseDownOrigin){var i=L.point(e.originalEvent.clientX,e.originalEvent.clientY).distanceTo(this._mouseDownOrigin);Math.abs(i)<9*(window.devicePixelRatio||1)&&this.addVertex(e.latlng)}this._mouseDownOrigin=null},_updateFinishHandler:function(){var e=this._markers.length;1<e&&this._markers[e-1].on("click",this._finishShape,this),2<e&&this._markers[e-2].off("click",this._finishShape,this)},_createMarker:function(e){var i=new L.Marker(e,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});return this._markerGroup.addLayer(i),i},_updateGuide:function(e){var i=this._markers.length;0<i&&(e=e||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[i-1].getLatLng()),e))},_drawGuide:function(e,i){var t,o,s,r=Math.floor(Math.sqrt(Math.pow(i.x-e.x,2)+Math.pow(i.y-e.y,2))),n=this.options.guidelineDistance,a=this.options.maxGuideLineLength,h=a<r?r-a:n;for(this._guidesContainer||(this._guidesContainer=L.DomUtil.create("div","leaflet-draw-guides",this._overlayPane));h<r;h+=this.options.guidelineDistance)t=h/r,o={x:Math.floor(e.x*(1-t)+t*i.x),y:Math.floor(e.y*(1-t)+t*i.y)},(s=L.DomUtil.create("div","leaflet-draw-guide-dash",this._guidesContainer)).style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(s,o)},_updateGuideColor:function(e){if(this._guidesContainer)for(var i=0,t=this._guidesContainer.childNodes.length;i<t;i++)this._guidesContainer.childNodes[i].style.backgroundColor=e},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_cleanUpShape:function(){1<this._markers.length&&this._markers[this._markers.length-1].off("click",this._finishShape,this)},_fireCreatedEvent:function(){var e=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,e)}});
L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:"polygon"},Poly:L.Polygon,options:{showArea:!1,shapeOptions:{stroke:!0,color:"#f06eaa",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0}},initialize:function(t,i){L.Draw.Polyline.prototype.initialize.call(this,t,i),this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var t=this._markers.length;1===t&&this._markers[0].on("click",this._finishShape,this),2<t&&(this._markers[t-1].on("dblclick",this._finishShape,this),3<t&&this._markers[t-2].off("dblclick",this._finishShape,this))},_getTooltipText:function(){var t,i;return 0===this._markers.length?t=L.drawLocal.draw.handlers.polygon.tooltip.start:this._markers.length<3?t=L.drawLocal.draw.handlers.polygon.tooltip.cont:(t=L.drawLocal.draw.handlers.polygon.tooltip.end,i=this._getMeasurementString()),{text:t,subtext:i}},_getMeasurementString:function(){var t=this._area;return t?L.GeometryUtil.readableArea(t,this.options.metric):null},_shapeIsValid:function(){return 3<=this._markers.length},_vertexChanged:function(t,i){var e;!this.options.allowIntersection&&this.options.showArea&&(e=this._poly.getLatLngs(),this._area=L.GeometryUtil.geodesicArea(e)),L.Draw.Polyline.prototype._vertexChanged.call(this,t,i)},_cleanUpShape:function(){var t=this._markers.length;0<t&&(this._markers[0].off("click",this._finishShape,this),2<t&&this._markers[t-1].off("dblclick",this._finishShape,this))}});
L.Draw.PolygonTouch=L.Draw.Polygon.extend({initialize:function(t,o){L.Draw.Polygon.prototype.initialize.call(this,t,o)},addHooks:function(){L.Draw.Polygon.prototype.addHooks.call(this),this._touchable||(this._touchable=new L.DrawTouch(this._map)),this._map&&this._touchable.on({down:this._onTouchStart,move:this._onTouchMove,up:this._onTouchEnd},this).enable()},removeHooks:function(){L.Draw.Polygon.prototype.removeHooks.call(this),this._map&&this._map&&this._touchable.off({down:this._onTouchStart,move:this._onTouchMove,up:this._onTouchEnd},this).disable()},_updateFinishHandler:function(){L.Draw.Polygon.prototype._updateFinishHandler.call(this);var t,o=this._markers.length,i=this._map.containerPointToLatLng([0,0]).distanceTo(this._map.containerPointToLatLng([0,1]));2<o&&(t=this._markers[0].getLatLng().distanceTo(this._markers[o-1].getLatLng()),Math.floor(t/i)<12*(window.devicePixelRatio||1)&&(this.deleteLastVertex(),this._finishShape()))},_onTouchStart:function(t){this._currentLatLng=t.latlng,this._touchOriginPoint=L.point(t.clientX,t.clientY),this._map.off("mousemove",this._onMouseMove,this)},_onTouchMove:function(t){this._touchOriginPoint&&(this._touchEndPoint=L.point(t.clientX,t.clientY))},_onTouchEnd:function(){if(this._touchOriginPoint)if(this._touchEndPoint){var t=L.point(this._touchEndPoint).distanceTo(this._touchOriginPoint);Math.abs(t)<9*(window.devicePixelRatio||1)&&this.addVertex(this._currentLatLng)}else this.addVertex(this._currentLatLng);this._map.on("mousemove",this._onMouseMove,this),this._touchOriginPoint=null,this._touchEndPoint=null}});
var MapManager=function(e){this.DEBUG=!1,this.MAPBOX_ID_ROADMAP="ihomefinder.k3f0npic",this.MAPBOX_ID_SATELLITE="ihomefinder.k3f132cj",this.MAPBOX_ID_HYBRID="ihomefinder.k767gpl3",this.MAPBOX_ID_TERRAIN="ihomefinder.k3f11f54",this.MAPQUEST_KEY="Gmjtd%7Cluurn96bng%2Cb5%3Do5-lrba1",this.MAPBOX_ACCESS_TOKEN,this.containerId,this.markerAjaxUrl,this.detailAjaxUrl,this.map,this.clusterMarkers=!1,this.markerLayer=null,this.cachedMarkers,this.cachedAreas,this.ajaxRequest};MapManager.prototype.debug=function(e){this.DEBUG&&console.log(e)},MapManager.prototype.createMap=function(e,a){var t="//api.tiles.mapbox.com/v4/{mapboxId}/{z}/{x}/{y}.png?access_token="+this.MAPBOX_ACCESS_TOKEN,r='<a href="https://www.mapbox.com/about/maps/" target="_blank">&copy; Mapbox</a> <a href="http://www.openstreetmap.org/copyright" target="_blank">&copy; OpenStreetMap</a> <a href="http://developer.mapquest.com/web/info/terms-of-use" target="_blank">&copy; MapQuest</a>',i=new L.TileLayer(t,{mapboxId:this.MAPBOX_ID_ROADMAP,attribution:r,maxZoom:18}),n=new L.TileLayer(t,{mapboxId:this.MAPBOX_ID_SATELLITE,attribution:r,maxZoom:18}),o=new L.TileLayer(t,{mapboxId:this.MAPBOX_ID_HYBRID,attribution:r,maxZoom:18}),s=new L.TileLayer(t,{mapboxId:this.MAPBOX_ID_TERRAIN,attribution:r,maxZoom:18});switch(e){case"G_NORMAL_MAP":case"ROADMAP":default:defaultLayer=i;break;case"G_SATELLITE_MAP":case"SATELLITE":defaultLayer=n;break;case"G_HYBRID_MAP":case"HYBRID":defaultLayer=o;break;case"G_PHYSICAL_MAP":case"TERRAIN":defaultLayer=s}if(this.map=new L.Map(this.containerId,{scrollWheelZoom:!1,layers:[defaultLayer]}),this.map.attributionControl.setPrefix(""),a){var p={Map:i,Satellite:n,Hybrid:o,Terrain:s};L.control.layers(p).addTo(this.map)}},MapManager.prototype.centerMap=function(e,a){null===a?this.map.setView(e):this.map.setView(e,a)},MapManager.prototype.fitBounds=function(e){1===e.length?this.map.setView(e[0],15):this.map.fitBounds(e,{padding:[5,5]})},MapManager.prototype.centerMapToMarker=function(e){var a=e.getLatLng();this.map.setView(a),e.getPopup()._isOpen&&this.map.panBy([0,-75])},MapManager.prototype.resetCachedAreas=function(){delete this.cachedAreas,this.cachedAreas=[]},MapManager.prototype.isCachedArea=function(){return!1},MapManager.prototype.setCachedArea=function(){this.cachedAreas.push(this.map.getBounds())},MapManager.prototype.resetMarkerCache=function(){delete this.cachedMarkers,this.cachedMarkers=[]},MapManager.prototype.isCachedMarker=function(e,a){return void 0!==this.cachedMarkers[e+"-"+a]},MapManager.prototype.setCachedMarker=function(e,a,t){this.cachedMarkers[e+"-"+a]=t},MapManager.prototype.resetMarkerLayer=function(){null!==this.markerLayer&&(this.map.removeLayer(this.markerLayer),delete this.markerLayer),this.resetMarkerCache(),this.resetCachedAreas(),this.clusterMarkers?this.markerLayer=new L.MarkerClusterGroup({showCoverageOnHover:!1,maxClusterRadius:80}):this.markerLayer=new L.LayerGroup,this.map.addLayer(this.markerLayer),this.updateCountText()},MapManager.prototype.abortAjaxRequest=function(){void 0!==this.ajaxRequest&&void 0!==this.ajaxRequest.abort()&&this.ajaxRequest.abort()},MapManager.prototype.updateCountText=function(){var a=0,t=this.map.getBounds();this.markerLayer.eachLayer(function(e){t.contains(e.getLatLng())&&a++}),jQuery(".ihf-map-results-count").html(a+" listings found")},MapManager.prototype.updateMarkerLayer=function(){data=this.getMarkerRequestData();var s=this;this.isCachedArea()||(this.ajaxRequest=jQuery.ajax({type:"GET",url:this.markerAjaxUrl,data:data,dataType:"jsonp"}).done(function(e){if(0<e.data.length){for(var a in e.data){var t=e.data[a],r=new L.LatLng(t.latitude,t.longitude),i=t.boardId,n=t.listingNumber,o=t.propertyType;s.addMarkerForMapSearch(r,i,n,o)}e.length<1e3&&s.setCachedArea(),s.updateCountText()}}))},MapManager.prototype.getMarkerRequestData=function(){var e=this.map.getBounds().getSouthWest(),a=this.map.getBounds().getNorthEast(),t=this.map.getZoom(),r=this.map.getCenter().lat,i=this.map.getCenter().lng,n={swlat:e.lat,swlong:e.lng,nelat:a.lat,nelong:a.lng,mapZoomLevel:t,centerLat:r,centerLong:i};return $location=jQuery("#ihf-refine-map-search-form input[name=location]"),$location.val()&&(n.location=$location.val()),$minPrice=jQuery("#ihf-refine-map-search-form input[name=minPrice]"),$minPrice.val()&&(n.minPrice=$minPrice.val()),$maxPrice=jQuery("#ihf-refine-map-search-form input[name=maxPrice]"),$maxPrice.val()&&(n.maxPrice=$maxPrice.val()),$bedRooms=jQuery("#ihf-refine-map-search-form select[name=bedRooms]"),$bedRooms.val()&&(n.bedRooms=$bedRooms.val()),$bathRooms=jQuery("#ihf-refine-map-search-form select[name=bathRooms]"),$bathRooms.val()&&(n.bathRooms=$bathRooms.val()),propertyType=jQuery('#ihf-refine-map-search-form input:checkbox[name="propertyType"]:checked').map(function(){return jQuery(this).val()}).get().join(","),0!==propertyType.length&&(n.propertyType=propertyType),n},MapManager.prototype.addMarkerForMapSearch=function(e,a,t,r){if(!this.isCachedMarker(a,t)){var i=this.getPropertyTypeSpecificMarkerIconHtml(r),n=new L.Point(24,24),o=new L.Point(12,30),s=new L.DivIcon({html:i,iconSize:n,iconAnchor:o}),p=new L.Marker(e,{icon:s});if(void 0!==p){this.markerLayer.addLayer(p),this.setCachedMarker(a,t,p);var l=this;p.on("click",function(e){l.openInfoWindow(this,a,t)})}}},MapManager.prototype.getPropertyTypeSpecificMarkerIconHtml=function(e){var a;switch(e){case"SFR":a='<div class="ihf-map-icon ihf-map-icon-house"><i class="fa fa-home"></i></div>';break;case"CND":a='<div class="ihf-map-icon ihf-map-icon-condo"><i class="glyphicon glyphicon-credit-card"></i></div>';break;case"LL":a='<div class="ihf-map-icon ihf-map-icon-land"><i class="glyphicon glyphicon-tree-conifer"></i></div>';break;case"COM":a='<div class="ihf-map-icon ihf-map-icon-commercial"><i class="fa fa-tag"></i></div>';break;case"RI":a='<div class="ihf-map-icon ihf-map-icon-multiunit"><i class="glyphicon glyphicon-th-large"></i></div>';break;case"MH":a='<div class="ihf-map-icon ihf-map-icon-mobilehome"><i class="fa fa-road"></i></div>';break;case"FRM":a='<div class="ihf-map-icon ihf-map-icon-house"><i class="fa fa-leaf"></i></div>';break;case"RNT":a='<div class="ihf-map-icon ihf-map-icon-rental"><i class="fa fa-building-o"></i></div>';break;default:a='<div class="ihf-map-icon ihf-map-icon-house"><i class="fa fa-home"></i></div>'}return a},MapManager.prototype.getNumericMarkerIconHtml=function(e){return'<div class="ihf-map-icon">'+e+"</div>"},MapManager.prototype.addMarkerForResultsOrDetail=function(e,a,t,r){var i=new L.Point(24,24),n=new L.Point(12,30),o=this.getNumericMarkerIconHtml(r),s=new L.DivIcon({html:o,iconSize:i,iconAnchor:n}),p=new L.Marker(a,{icon:s});if(this.markerLayer.addLayer(p),"results"===e){var l=(new L.Popup).setContent(t);p.bindPopup(l,{offset:[0,-35]});var c=this;jQuery('[data-map-icon="'+r+'"]').click(function(){p.togglePopup(),c.centerMapToMarker(p),jQuery("html, body").animate({scrollTop:jQuery("#"+c.containerId).offset().top-50},250)})}},MapManager.prototype.openInfoWindow=function(t,e,a){if(void 0===t.getPopup()){var r={boardId:e,listingNumber:a},i=this;this.abortAjaxRequest(),this.ajaxRequest=jQuery.ajax({type:"GET",url:i.detailAjaxUrl,dataType:"jsonp",data:r}).done(function(e){var a=(new L.Popup).setContent(e[0].content);t.bindPopup(a,{offset:[0,-35]}).openPopup(),i.centerMapToMarker(t)})}},MapManager.prototype.getGeoData=function(e,o){var a=jQuery.trim(e.term),s=this,t="//www.mapquestapi.com/geocoding/v1/address?key="+this.MAPQUEST_KEY+"&location="+encodeURIComponent(a);this.abortAjaxRequest(),this.ajaxRequest=jQuery.ajax({type:"GET",url:t,dataType:"jsonp"}).done(function(e){var t=s.map.getCenter(),a=[];for(var r in e.results[0].locations){var i=e.results[0].locations[r],n=s.generateLabel(i);null!==n&&a.push({label:n,value:{latLng:new L.LatLng(i.latLng.lat,i.latLng.lng)}})}a=a.sort(function(e,a){return t.distanceTo(e.value.latLng)-t.distanceTo(a.value.latLng)}),o(a)})},MapManager.prototype.generateLabel=function(e){var a=!0,t="";return 0!==e.street.length&&(t+=e.street+", "),0!==e.adminArea6.length&&(t+=e.adminArea6+", "),0!==e.adminArea5.length?t+=e.adminArea5+", ":a=!1,0!==e.adminArea3.length?t+=e.adminArea3+", ":a=!1,0===e.adminArea1.length||"US"!==e.adminArea1&&"CA"!==e.adminArea1?a=!1:t+=e.adminArea1,a?t:null},MapManager.prototype.geocodeAddress=function(e,a,t){this.abortAjaxRequest(),this.ajaxRequest=jQuery.ajax({url:a,data:{address:e},dataType:"jsonp",crossDomain:!0}).done(function(e){lat=e.features[0].geometry.coordinates[1],lng=e.features[0].geometry.coordinates[0],latLng=new L.LatLng(lat,lng),t(latLng)})},MapManager.prototype.getDefaultCenter=function(){return new L.LatLng(39.8282,-98.5795)},MapManager.prototype.toggleRefineForm=function(){jQuery(".ihf-mapsearch-refine-overlay").toggle(),jQuery(".ihf-map-search-refine-link").toggle()},MapManager.prototype.getPolygonPaths=function(e){var a=[];if(e)for(var t=(e=(e=e.replace(new RegExp("^POLYGON ?\\(\\("),"")).replace(new RegExp("\\)\\)$"),"")).split(","),r=0;r<t.length;r++)if(r+1<t.length){var i=t[r].trim();if(null!=i){var n=i.split(" "),o=n[0],s=n[1],p=new L.LatLng(s,o);a.push(p)}}return a},MapManager.prototype.addPolygonToMap=function(e){null!=this.markerLayer&&new L.polygon(e,{stroke:!0,color:"#000000",weight:4,opacity:1,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0}).addTo(this.markerLayer)},MapManager.prototype.initializeMapSearch=function(e,a,t,r,i,n,o,s,p,l){this.containerId=e,this.markerAjaxUrl=o,this.detailAjaxUrl=s,this.MAPBOX_ACCESS_TOKEN=l;p=p;this.createMap(n);var c=this,h=function(e){c.centerMap(e,a),c.clusterMarkers=!0,c.resetMarkerLayer(),c.updateMarkerLayer(o),c.map.on("moveend",function(){c.updateCountText(),c.updateMarkerLayer()}),jQuery("#ihf-location").autocomplete({source:function(e,a){c.getGeoData(e,a)},select:function(e,a){e.preventDefault(),jQuery("#ihf-location").val(a.item.label),c.centerMap(a.item.value.latLng)},focus:function(e,a){e.preventDefault()}}),jQuery(".ihf-map-search-refine-link, #ihf-refine-search-close").click(function(){c.toggleRefineForm()}),jQuery("#ihf-main-search-form-submit").click(function(){c.toggleRefineForm(),c.resetMarkerLayer(),c.updateMarkerLayer()})};0!==r.length&&0!==i.length&&0!==r&&0!==i?h(new L.latLng(r,i)):0!==t.length?this.geocodeAddress(t,p,h):h(this.getDefaultCenter())},MapManager.prototype.initializeResultsOrDetailMap=function(e,i,n,a,o,s){if(!(0<!i.length)){this.containerId=e,this.MAPBOX_ACCESS_TOKEN=a;var p=this,l=(o=o,function(){if(null!==(a=function(){for(var e in i){var a=i[e];if(0===a.latitude.length||0===a.longitude.length||0===a.latitude||0===a.longitude)return a}return null}()))p.debug("listing #"+a.number+": invalid lat lng"),p.geocodeAddress(a.address,o,function(e){p.debug("listing #"+a.number+": updating listing lat lng"),a.latitude=e.lat,a.longitude=e.lng,l()});else{for(var e in p.createMap("ROADMAP",!0),listingCoordinates=[],i){var a=i[e],t=new L.LatLng(a.latitude,a.longitude);listingCoordinates.push(t)}var r=p.getPolygonPaths(s);for(var e in 0<r.length?p.fitBounds(r):p.fitBounds(listingCoordinates),p.resetMarkerLayer(),i){a=i[e];p.debug("listing #"+a.number+": adding marker");t=new L.LatLng(a.latitude,a.longitude);p.addMarkerForResultsOrDetail(n,t,a.message,a.number)}0<r.length&&p.addPolygonToMap(r)}});l()}},MapManager.prototype.initializeResultsMap=function(e,a,t,r,i){this.initializeResultsOrDetailMap(e,a,"results",t,r,i)},MapManager.prototype.initializeDetailMap=function(e,a,t,r){this.initializeResultsOrDetailMap(e,a,"detail",t,r,"")};
var PolygonMapManager=function(){this.containerId,this.mapBoxToken,this.mapBoxIdRoadMap="ihomefinder.k3f0npic",this.map,this.ajaxRequest,this.shapeLayer=null,this.polygon,this.geocodeAddress=function(e,t,o){this.abortAjaxRequest(),t+="?address="+encodeURIComponent(e),this.ajaxRequest=jQuery.ajax({type:"GET",url:t,dataType:"jsonp"}).done(function(e){lat=e.features[0].geometry.coordinates[1],lng=e.features[0].geometry.coordinates[0],latLng=new L.LatLng(lat,lng),o(latLng)})},this.abortAjaxRequest=function(){void 0!==this.ajaxRequest&&void 0!==this.ajaxRequest.abort()&&this.ajaxRequest.abort()},this.createMap=function(){var e="//api.tiles.mapbox.com/v4/"+this.mapBoxIdRoadMap+"/{z}/{x}/{y}.png?access_token="+this.mapBoxToken,t=new L.TileLayer(e,{maxZoom:18,attribution:'<a href="https://www.mapbox.com/about/maps/" target="_blank">&copy; Mapbox</a> <a href="http://www.openstreetmap.org/copyright" target="_blank">&copy; OpenStreetMap</a> <a href="http://developer.mapquest.com/web/info/terms-of-use" target="_blank">&copy; MapQuest</a>'});this.map=new L.Map(this.containerId,{scrollWheelZoom:!1,layers:[t]}),this.map.attributionControl.setPrefix("")},this.centerMap=function(e,t,o,a,n){var i=this;if(e){var r=i.getPolygonBounds(e);i.map.setView(r.getCenter(),10),setTimeout(function(){i.map.fitBounds(r),n()},1e3)}else i.geocodeAddress(t,a,function(e){null===o?i.map.setView(e):i.map.setView(e,o),n()})},this.addPolygon=function(e){var t={stroke:!0,color:"#000000",weight:4,opacity:1,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},o={allowIntersection:!1,drawError:{color:"#b00b00",timeout:3e3,message:"<strong>Oh snap!<strong> you can't draw that!"},shapeOptions:t};this.shapeLayer=new L.FeatureGroup,this.map.addLayer(this.shapeLayer),null!=e&&0<e.length?(this.polygon=new L.Polygon(e,t).addTo(this.shapeLayer),this.shapeLayer.eachLayer(function(e){e.editing.enable()})):(this.polygon=new L.Draw.PolygonTouch(this.map,o),this.polygon.enable())},this.updateBoundaryFormField=function(){var t=null;if(null!==this.shapeLayer){this.shapeLayer.eachLayer(function(e){t=e.toGeoJSON()});var e=this.polygonToWkt(t);null!=e&&jQuery("#ihf-boundary").val(e).trigger("change")}},this.polygonToWkt=function(e){for(var t=e.geometry.coordinates[0],o="POLYGON ((",a=(t[0],0);a<t.length;a++){var n=t[a];o+=n[0]+" "+n[1]+", "}return 100<a?(alert("Too many points drawn. Please remove "+(a-100)+" points."),null):(o=o.slice(0,-2),o+="))")},this.getPolygonBounds=function(e){for(var t=new L.LatLngBounds,o=0;o<e.length;o++)t.extend(e[o]);return t},this.getPolygonPaths=function(e){var t=[];if(!e||0===e.length)return null;for(var o=(e=(e=e.replace(new RegExp("^POLYGON ?\\(\\("),"")).replace(new RegExp("\\)\\)$"),"")).split(","),a=0;a<o.length;a++)if(a+1<o.length){var n=o[a].trim();if(null!=n){var i=n.split(" "),r=i[0],s=i[1],l=new L.LatLng(s,r);t.push(l)}}return t},this.addResetControl=function(){var e=L.Control.extend({options:{position:"topright"},onAdd:function(){var e=L.DomUtil.create("div","ihf-polygon-reset");return e.innerHTML="Start Over",e}});this.map.addControl(new e)},this.reset=function(){var t=this;if(null!=t.shapeLayer){t.shapeLayer.eachLayer(function(e){t.shapeLayer.removeLayer(e)}),void 0!==t.polygon&&void 0!==t.polygon.disable&&(t.polygon.disable(),delete t.polygon),jQuery("#ihf-boundary").val("").trigger("change");t.addPolygon(null)}},this.updateBoundaryFromString=function(){for(var e="POLYGON ((",t=jQuery("#ihf-polygon-id").val().split(","),o=0;o<t.length;o++){var a=t[o].indexOf("+"),n=t[o].substring(0,a);e+=t[o].substring(a+1)+" "+n+", "}if(100<o)return alert("Too many points drawn. Please remove "+(o-100)+" points."),null;e=e.slice(0,-2),e+="))",jQuery("#ihf-boundary").val(e).trigger("change")},this.updateMapLayer=function(e){var t=e.layer;t.editing.enable(),this.shapeLayer.addLayer(t)},this.initializeMapWithPolygon=function(e,t,o,a,n,i){this.containerId=e,this.mapBoxToken=t;var r=this,s=r.getPolygonPaths(i);r.createMap(),r.centerMap(s,o,a,n,function(){r.addResetControl(),r.map.on("draw:created",function(e){r.updateMapLayer(e),r.updateBoundaryFormField()}),r.addPolygon(s),r.polygon.on("edit",function(e){r.updateBoundaryFormField()}),jQuery("#ihf-polygon-id").on("input change",function(){r.updateBoundaryFromString()}),jQuery(".ihf-polygon-reset").on("click",function(){r.reset()})})}};
!function(){function a(n){return n&&(n.ownerDocument||n.document||n).documentElement}function T(n){return n&&(n.ownerDocument&&n.ownerDocument.defaultView||n.document&&n||n.defaultView)}function o(n,t){return n<t?-1:t<n?1:t<=n?0:NaN}function c(n){return null===n?NaN:+n}function f(n){return!isNaN(n)}function n(u){return{left:function(n,t,e,r){for(arguments.length<3&&(e=0),arguments.length<4&&(r=n.length);e<r;){var i=e+r>>>1;u(n[i],t)<0?e=1+i:r=i}return e},right:function(n,t,e,r){for(arguments.length<3&&(e=0),arguments.length<4&&(r=n.length);e<r;){var i=e+r>>>1;0<u(n[i],t)?r=i:e=1+i}return e}}}function l(n){return n.length}function t(n,t){for(var e in t)Object.defineProperty(n.prototype,e,{value:t[e],enumerable:!1})}function m(){this._=Object.create(null)}function e(n){return(n+="")===nu||n[0]===tu?tu+n:n}function r(n){return(n+="")[0]===tu?n.slice(1):n}function i(n){return e(n)in this._}function u(n){return(n=e(n))in this._&&delete this._[n]}function s(){var n=[];for(var t in this._)n.push(r(t));return n}function h(){var n=0;for(var t in this._)++n;return n}function p(){for(var n in this._)return!1;return!0}function g(){this._=Object.create(null)}function R(n){return n}function v(t,e,r){return function(){var n=r.apply(e,arguments);return n===e?t:n}}function d(n,t){if(t in n)return t;t=t.charAt(0).toUpperCase()+t.slice(1);for(var e=0,r=eu.length;e<r;++e){var i=eu[e]+t;if(i in n)return i}}function y(){}function M(){}function x(i){function n(){for(var n,t=u,e=-1,r=t.length;++e<r;)(n=t[e].on)&&n.apply(this,arguments);return i}var u=[],o=new m;return n.on=function(n,t){var e,r=o.get(n);return arguments.length<2?r&&r.on:(r&&(r.on=null,u=u.slice(0,e=u.indexOf(r)).concat(u.slice(e+1)),o.remove(n)),t&&u.push(o.set(n,{on:t})),i)},n}function D(){Yi.event.preventDefault()}function b(){for(var n,t=Yi.event;n=t.sourceEvent;)t=n;return t}function P(i){for(var u=new M,n=0,t=arguments.length;++n<t;)u[arguments[n]]=x(u);return u.of=function(e,r){return function(n){try{var t=n.sourceEvent=Yi.event;n.target=i,Yi.event=n,u[n.type].apply(e,r)}finally{Yi.event=t}}},u}function _(n){return iu(n,lu),n}function w(n){return"function"==typeof n?n:function(){return uu(n,this)}}function S(n){return"function"==typeof n?n:function(){return ou(n,this)}}function k(t,e){return t=Yi.ns.qualify(t),null==e?t.local?function(){this.removeAttributeNS(t.space,t.local)}:function(){this.removeAttribute(t)}:"function"==typeof e?t.local?function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}:function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}:t.local?function(){this.setAttributeNS(t.space,t.local,e)}:function(){this.setAttribute(t,e)}}function N(n){return n.trim().replace(/\s+/g," ")}function E(n){return new RegExp("(?:^|\\s+)"+Yi.requote(n)+"(?:\\s+|$)","g")}function A(n){return(n+"").trim().split(/^|\s+/)}function C(e,r){var i=(e=A(e).map(z)).length;return"function"==typeof r?function(){for(var n=-1,t=r.apply(this,arguments);++n<i;)e[n](this,t)}:function(){for(var n=-1;++n<i;)e[n](this,r)}}function z(r){var i=E(r);return function(n,t){if(e=n.classList)return t?e.add(r):e.remove(r);var e=n.getAttribute("class")||"";t?(i.lastIndex=0,i.test(e)||n.setAttribute("class",N(e+" "+r))):n.setAttribute("class",N(e.replace(i," ")))}}function q(t,e,r){return null==e?function(){this.style.removeProperty(t)}:"function"==typeof e?function(){var n=e.apply(this,arguments);null==n?this.style.removeProperty(t):this.style.setProperty(t,n,r)}:function(){this.style.setProperty(t,e,r)}}function L(t,e){return null==e?function(){delete this[t]}:"function"==typeof e?function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}:function(){this[t]=e}}function U(e){return"function"==typeof e?e:(e=Yi.ns.qualify(e)).local?function(){return this.ownerDocument.createElementNS(e.space,e.local)}:function(){var n=this.ownerDocument,t=this.namespaceURI;return t?n.createElementNS(t,e):n.createElement(e)}}function j(){var n=this.parentNode;n&&n.removeChild(this)}function F(n){return{__data__:n}}function H(n){return function(){return au(this,n)}}function O(n,t){for(var e=0,r=n.length;e<r;e++)for(var i,u=n[e],o=0,a=u.length;o<a;o++)(i=u[o])&&t(i,o,e);return n}function I(n){return iu(n,fu),n}function Y(i,t,e){function r(){var n=this[u];n&&(this.removeEventListener(i,n,n.$),delete this[u])}var u="__on"+i,n=i.indexOf("."),o=Z;0<n&&(i=i.slice(0,n));var a=su.get(i);return a&&(i=a,o=V),n?t?function(){var n=o(t,Vi(arguments));r.call(this),this.addEventListener(i,this[u]=n,n.$=e),n._=t}:r:t?y:function(){var n,t=new RegExp("^__on([^.]+)"+Yi.requote(i)+"$");for(var e in this)if(n=e.match(t)){var r=this[e];this.removeEventListener(n[1],r,r.$),delete this[e]}}}function Z(e,r){return function(n){var t=Yi.event;Yi.event=n,r[0]=this.__data__;try{e.apply(this,r)}finally{Yi.event=t}}}function V(n,t){var e=Z(n,t);return function(n){var t=n.relatedTarget;t&&(t===this||8&t.compareDocumentPosition(this))||e.call(this,n)}}function X(n){var e=".dragsuppress-"+ ++pu,r="click"+e,i=Yi.select(T(n)).on("touchmove"+e,D).on("dragstart"+e,D).on("selectstart"+e,D);if(null==hu&&(hu=!("onselectstart"in n)&&d(n.style,"userSelect")),hu){var u=a(n).style,o=u[hu];u[hu]="none"}return function(n){if(i.on(e,null),hu&&(u[hu]=o),n){var t=function(){i.on(r,null)};i.on(r,function(){D(),t()},!0),setTimeout(t,0)}}}function $(n,t){t.changedTouches&&(t=t.changedTouches[0]);var e=n.ownerSVGElement||n;if(e.createSVGPoint){var r=e.createSVGPoint();if(gu<0){var i=T(n);if(i.scrollX||i.scrollY){var u=(e=Yi.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important"))[0][0].getScreenCTM();gu=!(u.f||u.e),e.remove()}}return gu?(r.x=t.pageX,r.y=t.pageY):(r.x=t.clientX,r.y=t.clientY),[(r=r.matrixTransform(n.getScreenCTM().inverse())).x,r.y]}var o=n.getBoundingClientRect();return[t.clientX-o.left-n.clientLeft,t.clientY-o.top-n.clientTop]}function B(){return Yi.event.changedTouches[0].identifier}function W(n){return 0<n?1:n<0?-1:0}function J(n,t,e){return(t[0]-n[0])*(e[1]-n[1])-(t[1]-n[1])*(e[0]-n[0])}function G(n){return 1<n?0:n<-1?yu:Math.acos(n)}function K(n){return 1<n?xu:n<-1?-xu:Math.asin(n)}function Q(n){return((n=Math.exp(n))+1/n)/2}function nn(n){return(n=Math.sin(n/2))*n}function tn(){}function en(n,t,e){return this instanceof en?(this.h=+n,this.s=+t,void(this.l=+e)):arguments.length<2?n instanceof en?new en(n.h,n.s,n.l):yn(""+n,mn,en):new en(n,t,e)}function rn(n,t,e){function r(n){return Math.round(255*function(n){return 360<n?n-=360:n<0&&(n+=360),n<60?i+(u-i)*n/60:n<180?u:n<240?i+(u-i)*(240-n)/60:i}(n))}var i,u;return n=isNaN(n)?0:(n%=360)<0?n+360:n,t=isNaN(t)?0:t<0?0:1<t?1:t,i=2*(e=e<0?0:1<e?1:e)-(u=e<=.5?e*(1+t):e+t-e*t),new pn(r(n+120),r(n),r(n-120))}function un(n,t,e){return this instanceof un?(this.h=+n,this.c=+t,void(this.l=+e)):arguments.length<2?n instanceof un?new un(n.h,n.c,n.l):cn(n instanceof an?n.l:(n=Mn((n=Yi.rgb(n)).r,n.g,n.b)).l,n.a,n.b):new un(n,t,e)}function on(n,t,e){return isNaN(n)&&(n=0),isNaN(t)&&(t=0),new an(e,Math.cos(n*=bu)*t,Math.sin(n)*t)}function an(n,t,e){return this instanceof an?(this.l=+n,this.a=+t,void(this.b=+e)):arguments.length<2?n instanceof an?new an(n.l,n.a,n.b):n instanceof un?on(n.h,n.c,n.l):Mn((n=pn(n)).r,n.g,n.b):new an(n,t,e)}function ln(n,t,e){var r=(n+16)/116,i=r+t/500,u=r-e/200;return new pn(hn(3.2404542*(i=fn(i)*zu)-1.5371385*(r=fn(r)*qu)-.4985314*(u=fn(u)*Lu)),hn(-.969266*i+1.8760108*r+.041556*u),hn(.0556434*i-.2040259*r+1.0572252*u))}function cn(n,t,e){return 0<n?new un(Math.atan2(e,t)*_u,Math.sqrt(t*t+e*e),n):new un(NaN,NaN,n)}function fn(n){return.206893034<n?n*n*n:(n-4/29)/7.787037}function sn(n){return.008856<n?Math.pow(n,1/3):7.787037*n+4/29}function hn(n){return Math.round(255*(n<=.00304?12.92*n:1.055*Math.pow(n,1/2.4)-.055))}function pn(n,t,e){return this instanceof pn?(this.r=~~n,this.g=~~t,void(this.b=~~e)):arguments.length<2?n instanceof pn?new pn(n.r,n.g,n.b):yn(""+n,pn,rn):new pn(n,t,e)}function gn(n){return new pn(n>>16,n>>8&255,255&n)}function vn(n){return gn(n)+""}function dn(n){return n<16?"0"+Math.max(0,n).toString(16):Math.min(255,n).toString(16)}function yn(n,t,e){n=n.toLowerCase();var r,i,u,o=0,a=0,l=0;if(r=/([a-z]+)\((.*)\)/.exec(n))switch(i=r[2].split(","),r[1]){case"hsl":return e(parseFloat(i[0]),parseFloat(i[1])/100,parseFloat(i[2])/100);case"rgb":return t(bn(i[0]),bn(i[1]),bn(i[2]))}return(u=Du.get(n))?t(u.r,u.g,u.b):(null==n||"#"!==n.charAt(0)||isNaN(u=parseInt(n.slice(1),16))||(4===n.length?(o=(3840&u)>>4,o|=o>>4,a=240&u,a|=a>>4,l=15&u,l|=l<<4):7===n.length&&(o=(16711680&u)>>16,a=(65280&u)>>8,l=255&u)),t(o,a,l))}function mn(n,t,e){var r,i,u=Math.min(n/=255,t/=255,e/=255),o=Math.max(n,t,e),a=o-u,l=(o+u)/2;return a?(i=l<.5?a/(o+u):a/(2-o-u),r=n==o?(t-e)/a+(t<e?6:0):t==o?(e-n)/a+2:(n-t)/a+4,r*=60):(r=NaN,i=0<l&&l<1?0:r),new en(r,i,l)}function Mn(n,t,e){var r=sn((.4124564*(n=xn(n))+.3575761*(t=xn(t))+.1804375*(e=xn(e)))/zu),i=sn((.2126729*n+.7151522*t+.072175*e)/qu);return an(116*i-16,500*(r-i),200*(i-sn((.0193339*n+.119192*t+.9503041*e)/Lu)))}function xn(n){return(n/=255)<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4)}function bn(n){var t=parseFloat(n);return"%"===n.charAt(n.length-1)?Math.round(2.55*t):t}function _n(n){return"function"==typeof n?n:function(){return n}}function wn(r){return function(n,t,e){return 2===arguments.length&&"function"==typeof t&&(e=t,t=null),Sn(n,t,r,e)}}function Sn(i,u,e,n){function t(){var n,t=c.status;if(!t&&function(n){var t=n.responseType;return t&&"text"!==t?n.response:n.responseText}(c)||200<=t&&t<300||304===t){try{n=e.call(o,c)}catch(n){return void a.error.call(o,n)}a.load.call(o,n)}else a.error.call(o,c)}var o={},a=Yi.dispatch("beforesend","progress","load","error"),l={},c=new XMLHttpRequest,f=null;return!this.XDomainRequest||"withCredentials"in c||!/^(http(s)?:)?\/\//.test(i)||(c=new XDomainRequest),"onload"in c?c.onload=c.onerror=t:c.onreadystatechange=function(){3<c.readyState&&t()},c.onprogress=function(n){var t=Yi.event;Yi.event=n;try{a.progress.call(o,c)}finally{Yi.event=t}},o.header=function(n,t){return n=(n+"").toLowerCase(),arguments.length<2?l[n]:(null==t?delete l[n]:l[n]=t+"",o)},o.mimeType=function(n){return arguments.length?(u=null==n?null:n+"",o):u},o.responseType=function(n){return arguments.length?(f=n,o):f},o.response=function(n){return e=n,o},["get","post"].forEach(function(n){o[n]=function(){return o.send.apply(o,[n].concat(Vi(arguments)))}}),o.send=function(n,t,e){if(2===arguments.length&&"function"==typeof t&&(e=t,t=null),c.open(n,i,!0),null==u||"accept"in l||(l.accept=u+",*/*"),c.setRequestHeader)for(var r in l)c.setRequestHeader(r,l[r]);return null!=u&&c.overrideMimeType&&c.overrideMimeType(u),null!=f&&(c.responseType=f),null!=e&&o.on("error",e).on("load",function(n){e(null,n)}),a.beforesend.call(o,c),c.send(null==t?null:t),o},o.abort=function(){return c.abort(),o},Yi.rebind(o,a,"on"),null==n?o:o.get(function(e){return 1===e.length?function(n,t){e(null==n?t:null)}:e}(n))}function kn(){var n=Nn(),t=En()-n;24<t?(isFinite(t)&&(clearTimeout(Fu),Fu=setTimeout(kn,t)),ju=0):(ju=1,Ou(kn))}function Nn(){var n=Date.now();for(Hu=Pu;Hu;)n>=Hu.t&&(Hu.f=Hu.c(n-Hu.t)),Hu=Hu.n;return n}function En(){for(var n,t=Pu,e=1/0;t;)t=t.f?n?n.n=t.n:Pu=t.n:(t.t<e&&(e=t.t),(n=t).n);return Uu=n,e}function An(n,t){return t-(n?Math.ceil(Math.log(n)/Math.LN10):1)}function Cn(n){return n+""}function zn(){this._=new Date(1<arguments.length?Date.UTC.apply(this,arguments):arguments[0])}function qn(r,u,o){function n(n){var t=r(n),e=i(t,1);return n-t<e-n?t:e}function a(n){return u(n=r(new Xu(n-1)),1),n}function i(n,t){return u(n=new Xu(+n),t),n}function l(n,t,e){var r=a(n),i=[];if(1<e)for(;r<t;)o(r)%e||i.push(new Date(+r)),u(r,1);else for(;r<t;)i.push(new Date(+r)),u(r,1);return i}(r.floor=r).round=n,r.ceil=a,r.offset=i,r.range=l;var t=r.utc=Ln(r);return(t.floor=t).round=Ln(n),t.ceil=Ln(a),t.offset=Ln(i),t.range=function(n,t,e){try{var r=new(Xu=zn);return r._=n,l(r,t,e)}finally{Xu=Date}},r}function Ln(r){return function(n,t){try{var e=new(Xu=zn);return e._=n,r(e,t)._}finally{Xu=Date}}}function Tn(n,t,e){var r=n<0?"-":"",i=(r?-n:n)+"",u=i.length;return r+(u<e?new Array(e-u+1).join(t)+i:i)}function Rn(n){return new RegExp("^(?:"+n.map(Yi.requote).join("|")+")","i")}function Dn(n){for(var t=new m,e=-1,r=n.length;++e<r;)t.set(n[e].toLowerCase(),e);return t}function Pn(n,t,e){Wu.lastIndex=0;var r=Wu.exec(t.slice(e,e+1));return r?(n.w=+r[0],e+r[0].length):-1}function Un(n,t,e){Wu.lastIndex=0;var r=Wu.exec(t.slice(e));return r?(n.U=+r[0],e+r[0].length):-1}function jn(n,t,e){Wu.lastIndex=0;var r=Wu.exec(t.slice(e));return r?(n.W=+r[0],e+r[0].length):-1}function Fn(n,t,e){Wu.lastIndex=0;var r=Wu.exec(t.slice(e,e+4));return r?(n.y=+r[0],e+r[0].length):-1}function Hn(n,t,e){Wu.lastIndex=0;var r=Wu.exec(t.slice(e,e+2));return r?(n.y=function(n){return n+(68<n?1900:2e3)}(+r[0]),e+r[0].length):-1}function On(n,t,e){return/^[+-]\d{4}$/.test(t=t.slice(e,e+5))?(n.Z=-t,e+5):-1}function In(n,t,e){Wu.lastIndex=0;var r=Wu.exec(t.slice(e,e+2));return r?(n.m=r[0]-1,e+r[0].length):-1}function Yn(n,t,e){Wu.lastIndex=0;var r=Wu.exec(t.slice(e,e+2));return r?(n.d=+r[0],e+r[0].length):-1}function Zn(n,t,e){Wu.lastIndex=0;var r=Wu.exec(t.slice(e,e+3));return r?(n.j=+r[0],e+r[0].length):-1}function Vn(n,t,e){Wu.lastIndex=0;var r=Wu.exec(t.slice(e,e+2));return r?(n.H=+r[0],e+r[0].length):-1}function Xn(n,t,e){Wu.lastIndex=0;var r=Wu.exec(t.slice(e,e+2));return r?(n.M=+r[0],e+r[0].length):-1}function $n(n,t,e){Wu.lastIndex=0;var r=Wu.exec(t.slice(e,e+2));return r?(n.S=+r[0],e+r[0].length):-1}function Bn(n,t,e){Wu.lastIndex=0;var r=Wu.exec(t.slice(e,e+3));return r?(n.L=+r[0],e+r[0].length):-1}function Wn(n){var t=n.getTimezoneOffset(),e=0<t?"-":"+",r=Qi(t)/60|0,i=Qi(t)%60;return e+Tn(r,"0",2)+Tn(i,"0",2)}function Jn(n,t,e){Ju.lastIndex=0;var r=Ju.exec(t.slice(e,e+1));return r?e+r[0].length:-1}function Gn(r){for(var n=r.length,t=-1;++t<n;)r[t][0]=this(r[t][0]);return function(n){for(var t=0,e=r[t];!e[1](n);)e=r[++t];return e[0](n)}}function Kn(){}function Qn(n,t,e){var r=e.s=n+t,i=r-n,u=r-i;e.t=n-u+(t-i)}function nt(n,t){n&&no.hasOwnProperty(n.type)&&no[n.type](n,t)}function tt(n,t,e){var r,i=-1,u=n.length-e;for(t.lineStart();++i<u;)r=n[i],t.point(r[0],r[1],r[2]);t.lineEnd()}function et(n,t){var e=-1,r=n.length;for(t.polygonStart();++e<r;)tt(n[e],t,1);t.polygonEnd()}function rt(){function e(n,t){t=t*bu/2+yu/4;var e=(n*=bu)-f,r=0<=e?1:-1,i=r*e,u=Math.cos(t),o=Math.sin(t),a=h*o,l=s*u+a*Math.cos(i),c=a*r*Math.sin(i);eo.add(Math.atan2(c,l)),f=n,s=u,h=o}var r,i,f,s,h;ro.point=function(n,t){ro.point=e,f=(r=n)*bu,s=Math.cos(t=(i=t)*bu/2+yu/4),h=Math.sin(t)},ro.lineEnd=function(){e(r,i)}}function it(n){var t=n[0],e=n[1],r=Math.cos(e);return[r*Math.cos(t),r*Math.sin(t),Math.sin(e)]}function ut(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]}function ot(n,t){return[n[1]*t[2]-n[2]*t[1],n[2]*t[0]-n[0]*t[2],n[0]*t[1]-n[1]*t[0]]}function at(n,t){n[0]+=t[0],n[1]+=t[1],n[2]+=t[2]}function lt(n,t){return[n[0]*t,n[1]*t,n[2]*t]}function ct(n){var t=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);n[0]/=t,n[1]/=t,n[2]/=t}function ft(n){return[Math.atan2(n[1],n[0]),K(n[2])]}function st(n,t){return Qi(n[0]-t[0])<vu&&Qi(n[1]-t[1])<vu}function ht(n,t){n*=bu;var e=Math.cos(t*=bu);pt(e*Math.cos(n),e*Math.sin(n),Math.sin(t))}function pt(n,t,e){oo+=(n-oo)/++io,ao+=(t-ao)/io,lo+=(e-lo)/io}function gt(){function r(n,t){n*=bu;var e=Math.cos(t*=bu),r=e*Math.cos(n),i=e*Math.sin(n),u=Math.sin(t),o=Math.atan2(Math.sqrt((o=l*u-c*i)*o+(o=c*r-a*u)*o+(o=a*i-l*r)*o),a*r+l*i+c*u);uo+=o,co+=o*(a+(a=r)),fo+=o*(l+(l=i)),so+=o*(c+(c=u)),pt(a,l,c)}var a,l,c;vo.point=function(n,t){n*=bu;var e=Math.cos(t*=bu);a=e*Math.cos(n),l=e*Math.sin(n),c=Math.sin(t),vo.point=r,pt(a,l,c)}}function vt(){vo.point=ht}function dt(){function r(n,t){n*=bu;var e=Math.cos(t*=bu),r=e*Math.cos(n),i=e*Math.sin(n),u=Math.sin(t),o=g*u-v*i,a=v*r-p*u,l=p*i-g*r,c=Math.sqrt(o*o+a*a+l*l),f=p*r+g*i+v*u,s=c&&-G(f)/c,h=Math.atan2(c,f);ho+=s*o,po+=s*a,go+=s*l,uo+=h,co+=h*(p+(p=r)),fo+=h*(g+(g=i)),so+=h*(v+(v=u)),pt(p,g,v)}var i,u,p,g,v;vo.point=function(n,t){i=n,u=t,vo.point=r,n*=bu;var e=Math.cos(t*=bu);p=e*Math.cos(n),g=e*Math.sin(n),v=Math.sin(t),pt(p,g,v)},vo.lineEnd=function(){r(i,u),vo.lineEnd=vt,vo.point=ht}}function yt(e,r){function n(n,t){return n=e(n,t),r(n[0],n[1])}return e.invert&&r.invert&&(n.invert=function(n,t){return(n=r.invert(n,t))&&e.invert(n[0],n[1])}),n}function mt(){return!0}function Mt(n,t,e,r,a){var l=[],c=[];if(n.forEach(function(n){if(!((t=n.length-1)<=0)){var t,e=n[0],r=n[t];if(st(e,r)){a.lineStart();for(var i=0;i<t;++i)a.point((e=n[i])[0],e[1]);return void a.lineEnd()}var u=new bt(e,n,null,!0),o=new bt(e,null,u,!1);u.o=o,l.push(u),c.push(o),o=new bt(r,null,u=new bt(r,n,null,!1),!0),u.o=o,l.push(u),c.push(o)}}),c.sort(t),xt(l),xt(c),l.length){for(var i=0,u=e,o=c.length;i<o;++i)c[i].e=u=!u;for(var f,s,h=l[0];;){for(var p=h,g=!0;p.v;)if((p=p.n)===h)return;f=p.z,a.lineStart();do{if(p.v=p.o.v=!0,p.e){if(g)for(i=0,o=f.length;i<o;++i)a.point((s=f[i])[0],s[1]);else r(p.x,p.n.x,1,a);p=p.n}else{if(g)for(i=(f=p.p.z).length-1;0<=i;--i)a.point((s=f[i])[0],s[1]);else r(p.x,p.p.x,-1,a);p=p.p}f=(p=p.o).z,g=!g}while(!p.v);a.lineEnd()}}}function xt(n){if(t=n.length){for(var t,e,r=0,i=n[0];++r<t;)i.n=e=n[r],e.p=i,i=e;i.n=e=n[0],e.p=i}}function bt(n,t,e,r){this.x=n,this.z=t,this.o=e,this.e=r,this.v=!1,this.n=this.p=null}function _t(m,M,x,b){return function(r,o){function t(n,t){var e=r(n,t);m(n=e[0],t=e[1])&&o.point(n,t)}function n(n,t){var e=r(n,t);h.point(e[0],e[1])}function e(){g.point=n,h.lineStart()}function i(){g.point=t,h.lineEnd()}function a(n,t){s.push([n,t]);var e=r(n,t);d.point(e[0],e[1])}function u(){d.lineStart(),s=[]}function l(){a(s[0][0],s[0][1]),d.lineEnd();var n,t=d.clean(),e=v.buffer(),r=e.length;if(s.pop(),f.push(s),s=null,r)if(1&t){var i,u=-1;if(0<(r=(n=e[0]).length-1)){for(y||(o.polygonStart(),y=!0),o.lineStart();++u<r;)o.point((i=n[u])[0],i[1]);o.lineEnd()}}else 1<r&&2&t&&e.push(e.pop().concat(e.shift())),c.push(e.filter(wt))}var c,f,s,h=M(o),p=r.invert(b[0],b[1]),g={point:t,lineStart:e,lineEnd:i,polygonStart:function(){g.point=a,g.lineStart=u,g.lineEnd=l,c=[],f=[]},polygonEnd:function(){g.point=t,g.lineStart=e,g.lineEnd=i,c=Yi.merge(c);var n=function(n,t){var e=n[0],r=n[1],i=[Math.sin(e),-Math.cos(e),0],u=0,o=0;eo.reset();for(var a=0,l=t.length;a<l;++a){var c=t[a],f=c.length;if(f)for(var s=c[0],h=s[0],p=s[1]/2+yu/4,g=Math.sin(p),v=Math.cos(p),d=1;;){d===f&&(d=0);var y=(n=c[d])[0],m=n[1]/2+yu/4,M=Math.sin(m),x=Math.cos(m),b=y-h,_=0<=b?1:-1,w=_*b,S=yu<w,k=g*M;if(eo.add(Math.atan2(k*_*Math.sin(w),v*x+k*Math.cos(w))),u+=S?b+_*mu:b,S^e<=h^e<=y){var N=ot(it(s),it(n));ct(N);var E=ot(i,N);ct(E);var A=(S^0<=b?-1:1)*K(E[2]);(A<r||r===A&&(N[0]||N[1]))&&(o+=S^0<=b?1:-1)}if(!d++)break;h=y,g=M,v=x,s=n}}return(u<-vu||u<vu&&eo<0)^1&o}(p,f);c.length?(y||(o.polygonStart(),y=!0),Mt(c,kt,n,x,o)):n&&(y||(o.polygonStart(),y=!0),o.lineStart(),x(null,null,1,o),o.lineEnd()),y&&(o.polygonEnd(),y=!1),c=f=null},sphere:function(){o.polygonStart(),o.lineStart(),x(null,null,1,o),o.lineEnd(),o.polygonEnd()}},v=St(),d=M(v),y=!1;return g}}function wt(n){return 1<n.length}function St(){var e,t=[];return{lineStart:function(){t.push(e=[])},point:function(n,t){e.push([n,t])},lineEnd:y,buffer:function(){var n=t;return t=[],e=null,n},rejoin:function(){1<t.length&&t.push(t.pop().concat(t.shift()))}}}function kt(n,t){return((n=n.x)[0]<0?n[1]-xu-vu:xu-n[1])-((t=t.x)[0]<0?t[1]-xu-vu:xu-t[1])}function Nt(f,s,h,p){return function(n){var t,e=n.a,r=n.b,i=e.x,u=e.y,o=0,a=1,l=r.x-i,c=r.y-u;if(t=f-i,l||!(0<t)){if(t/=l,l<0){if(t<o)return;t<a&&(a=t)}else if(0<l){if(a<t)return;o<t&&(o=t)}if(t=h-i,l||!(t<0)){if(t/=l,l<0){if(a<t)return;o<t&&(o=t)}else if(0<l){if(t<o)return;t<a&&(a=t)}if(t=s-u,c||!(0<t)){if(t/=c,c<0){if(t<o)return;t<a&&(a=t)}else if(0<c){if(a<t)return;o<t&&(o=t)}if(t=p-u,c||!(t<0)){if(t/=c,c<0){if(a<t)return;o<t&&(o=t)}else if(0<c){if(t<o)return;t<a&&(a=t)}return 0<o&&(n.a={x:i+o*l,y:u+o*c}),a<1&&(n.b={x:i+a*l,y:u+a*c}),n}}}}}}function Et(x,b,_,w){function S(n,t){return Qi(n[0]-x)<vu?0<t?0:3:Qi(n[0]-_)<vu?0<t?2:1:Qi(n[1]-b)<vu?0<t?1:0:0<t?3:2}function k(n,t){return N(n.x,t.x)}function N(n,t){var e=S(n,1),r=S(t,1);return e!==r?e-r:0===e?t[1]-n[1]:1===e?n[0]-t[0]:2===e?n[1]-t[1]:t[0]-n[0]}return function(i){function r(n,t,e,r){var i=0,u=0;if(null==n||(i=S(n,e))!==(u=S(t,e))||N(n,t)<0^0<e)for(;r.point(0===i||3===i?x:_,1<i?w:b),(i=(i+e+4)%4)!==u;);else r.point(t[0],t[1])}function u(n,t){return x<=n&&n<=_&&b<=t&&t<=w}function n(n,t){u(n,t)&&i.point(n,t)}function t(n,t){var e=u(n=Math.max(-mo,Math.min(mo,n)),t=Math.max(-mo,Math.min(mo,t)));if(f&&a.push([n,t]),v)l=n,c=t,v=!1,(s=e)&&(i.lineStart(),i.point(n,t));else if(e&&g)i.point(n,t);else{var r={a:{x:h,y:p},b:{x:n,y:t}};m(r)?(g||(i.lineStart(),i.point(r.a.x,r.a.y)),i.point(r.b.x,r.b.y),e||i.lineEnd(),d=!1):e&&(i.lineStart(),i.point(n,t),d=!1)}h=n,p=t,g=e}var o,f,a,l,c,s,h,p,g,v,d,y=i,e=St(),m=Nt(x,b,_,w),M={point:n,lineStart:function(){M.point=t,f&&f.push(a=[]),g=!(v=!0),h=p=NaN},lineEnd:function(){o&&(t(l,c),s&&g&&e.rejoin(),o.push(e.buffer())),M.point=n,g&&i.lineEnd()},polygonStart:function(){i=e,o=[],f=[],d=!0},polygonEnd:function(){i=y,o=Yi.merge(o);var n=function(n){for(var t=0,e=f.length,r=n[1],i=0;i<e;++i)for(var u,o=1,a=f[i],l=a.length,c=a[0];o<l;++o)u=a[o],c[1]<=r?u[1]>r&&0<J(c,u,n)&&++t:u[1]<=r&&J(c,u,n)<0&&--t,c=u;return 0!==t}([x,w]),t=d&&n,e=o.length;(t||e)&&(i.polygonStart(),t&&(i.lineStart(),r(null,null,1,i),i.lineEnd()),e&&Mt(o,k,n,r,i),i.polygonEnd()),o=f=a=null}};return M}}function At(n){var t=0,e=yu/3,r=It(n),i=r(t,e);return i.parallels=function(n){return arguments.length?r(t=n[0]*yu/180,e=n[1]*yu/180):[t/yu*180,e/yu*180]},i}function Ct(n,t){function e(n,t){var e=Math.sqrt(u-2*i*Math.sin(t))/i;return[e*Math.sin(n*=i),o-e*Math.cos(n)]}var r=Math.sin(n),i=(r+Math.sin(t))/2,u=1+r*(2*i-r),o=Math.sqrt(u)/i;return e.invert=function(n,t){var e=o-t;return[Math.atan2(n,e)/i,K((u-(n*n+e*e)*i*i)/(2*i))]},e}function zt(){function e(n,t){xo+=o*n-u*t,u=n,o=t}var r,i,u,o;ko.point=function(n,t){ko.point=e,r=u=n,i=o=t},ko.lineEnd=function(){e(r,i)}}function qt(){function n(n,t){o.push("M",n,",",t,u)}function t(n,t){o.push("M",n,",",t),a.point=e}function e(n,t){o.push("L",n,",",t)}function r(){a.point=n}function i(){o.push("Z")}var u=Lt(4.5),o=[],a={point:n,lineStart:function(){a.point=t},lineEnd:r,polygonStart:function(){a.lineEnd=i},polygonEnd:function(){a.lineEnd=r,a.point=n},pointRadius:function(n){return u=Lt(n),a},result:function(){if(o.length){var n=o.join("");return o=[],n}}};return a}function Lt(n){return"m0,"+n+"a"+n+","+n+" 0 1,1 0,"+-2*n+"a"+n+","+n+" 0 1,1 0,"+2*n+"z"}function Tt(n,t){oo+=n,ao+=t,++lo}function Rt(){function e(n,t){var e=n-u,r=t-o,i=Math.sqrt(e*e+r*r);co+=i*(u+n)/2,fo+=i*(o+t)/2,so+=i,Tt(u=n,o=t)}var u,o;Eo.point=function(n,t){Eo.point=e,Tt(u=n,o=t)}}function Dt(){Eo.point=Tt}function Pt(){function e(n,t){var e=n-u,r=t-o,i=Math.sqrt(e*e+r*r);co+=i*(u+n)/2,fo+=i*(o+t)/2,so+=i,ho+=(i=o*n-u*t)*(u+n),po+=i*(o+t),go+=3*i,Tt(u=n,o=t)}var r,i,u,o;Eo.point=function(n,t){Eo.point=e,Tt(r=u=n,i=o=t)},Eo.lineEnd=function(){e(r,i)}}function Ut(e){function n(n,t){e.moveTo(n+o,t),e.arc(n,t,o,0,mu)}function t(n,t){e.moveTo(n,t),a.point=r}function r(n,t){e.lineTo(n,t)}function i(){a.point=n}function u(){e.closePath()}var o=4.5,a={point:n,lineStart:function(){a.point=t},lineEnd:i,polygonStart:function(){a.lineEnd=u},polygonEnd:function(){a.lineEnd=i,a.point=n},pointRadius:function(n){return o=n,a},result:y};return a}function jt(C){function t(n){return(b?function(i){function n(n,t){n=C(n,t),i.point(n[0],n[1])}function t(){v=NaN,x.point=e,i.lineStart()}function e(n,t){var e=it([n,t]),r=C(n,t);z(v,d,g,y,m,M,v=r[0],d=r[1],g=n,y=e[0],m=e[1],M=e[2],b,i),i.point(v,d)}function r(){x.point=n,i.lineEnd()}function u(){t(),x.point=o,x.lineEnd=a}function o(n,t){e(l=n,t),c=v,f=d,s=y,h=m,p=M,x.point=e}function a(){z(v,d,g,y,m,M,c,f,l,s,h,p,b,i),(x.lineEnd=r)()}var l,c,f,s,h,p,g,v,d,y,m,M,x={point:n,lineStart:t,lineEnd:r,polygonStart:function(){i.polygonStart(),x.lineStart=u},polygonEnd:function(){i.polygonEnd(),x.lineStart=t}};return x}:function(e){return Ht(e,function(n,t){n=C(n,t),e.point(n[0],n[1])})})(n)}function z(n,t,e,r,i,u,o,a,l,c,f,s,h,p){var g=o-n,v=a-t,d=g*g+v*v;if(4*q<d&&h--){var y=r+c,m=i+f,M=u+s,x=Math.sqrt(y*y+m*m+M*M),b=Math.asin(M/=x),_=Qi(Qi(M)-1)<vu||Qi(e-l)<vu?(e+l)/2:Math.atan2(m,y),w=C(_,b),S=w[0],k=w[1],N=S-n,E=k-t,A=v*N-g*E;(q<A*A/d||.3<Qi((g*N+v*E)/d-.5)||r*c+i*f+u*s<L)&&(z(n,t,e,r,i,u,S,k,_,y/=x,m/=x,M,h,p),p.point(S,k),z(S,k,_,y,m,M,o,a,l,c,f,s,h,p))}}var q=.5,L=Math.cos(30*bu),b=16;return t.precision=function(n){return arguments.length?(b=0<(q=n*n)&&16,t):Math.sqrt(q)},t}function Ft(n){this.stream=n}function Ht(n,t){return{point:t,sphere:function(){n.sphere()},lineStart:function(){n.lineStart()},lineEnd:function(){n.lineEnd()},polygonStart:function(){n.polygonStart()},polygonEnd:function(){n.polygonEnd()}}}function Ot(n){return It(function(){return n})()}function It(n){function t(n){return[(n=a(n[0]*bu,n[1]*bu))[0]*h+l,c-n[1]*h]}function e(n){return(n=a.invert((n[0]-l)/h,(c-n[1])/h))&&[n[0]*_u,n[1]*_u]}function r(){a=yt(o=Xt(y,m,M),u);var n=u(v,d);return l=p-n[0]*h,c=g+n[1]*h,i()}function i(){return f&&(f.valid=!1,f=null),t}var u,o,a,l,c,f,s=jt(function(n,t){return[(n=u(n,t))[0]*h+l,c-n[1]*h]}),h=150,p=480,g=250,v=0,d=0,y=0,m=0,M=0,x=yo,b=R,_=null,w=null;return t.stream=function(n){return f&&(f.valid=!1),(f=Yt(x(o,s(b(n))))).valid=!0,f},t.clipAngle=function(n){return arguments.length?(x=null==n?(_=n,yo):function(i){function p(n,t){return Math.cos(n)*Math.cos(t)>N}function g(n,t,e){var r=[1,0,0],i=ot(it(n),it(t)),u=ut(i,i),o=i[0],a=u-o*o;if(!a)return!e&&n;var l=N*u/a,c=-N*o/a,f=ot(r,i),s=lt(r,l);at(s,lt(i,c));var h=f,p=ut(s,h),g=ut(h,h),v=p*p-g*(ut(s,s)-1);if(!(v<0)){var d=Math.sqrt(v),y=lt(h,(-p-d)/g);if(at(y,s),y=ft(y),!e)return y;var m,M=n[0],x=t[0],b=n[1],_=t[1];x<M&&(m=M,M=x,x=m);var w=x-M,S=Qi(w-yu)<vu;if(!S&&_<b&&(m=b,b=_,_=m),S||w<vu?S?0<b+_^y[1]<(Qi(y[0]-M)<vu?b:_):b<=y[1]&&y[1]<=_:yu<w^(M<=y[0]&&y[0]<=x)){var k=lt(h,(-p+d)/g);return at(k,s),[y,ft(k)]}}}function v(n,t){var e=d?i:yu-i,r=0;return n<-e?r|=1:e<n&&(r|=2),t<-e?r|=4:e<t&&(r|=8),r}var N=Math.cos(i),d=0<N,y=Qi(N)>vu;return _t(p,function(a){var l,c,f,s,h;return{lineStart:function(){s=f=!1,h=1},point:function(n,t){var e,r=[n,t],i=p(n,t),u=d?i?0:v(n,t):i?v(n+(n<0?yu:-yu),t):0;if(!l&&(s=f=i)&&a.lineStart(),i!==f&&(e=g(l,r),(st(l,e)||st(r,e))&&(r[0]+=vu,r[1]+=vu,i=p(r[0],r[1]))),i!==f)h=0,i?(a.lineStart(),e=g(r,l),a.point(e[0],e[1])):(e=g(l,r),a.point(e[0],e[1]),a.lineEnd()),l=e;else if(y&&l&&d^i){var o;u&c||!(o=g(r,l,!0))||(h=0,d?(a.lineStart(),a.point(o[0][0],o[0][1]),a.point(o[1][0],o[1][1]),a.lineEnd()):(a.point(o[1][0],o[1][1]),a.lineEnd(),a.lineStart(),a.point(o[0][0],o[0][1])))}!i||l&&st(l,r)||a.point(r[0],r[1]),l=r,f=i,c=u},lineEnd:function(){f&&a.lineEnd(),l=null},clean:function(){return h|(s&&f)<<1}}},Jt(i,6*bu),d?[0,-i]:[-yu,i-yu])}((_=+n)*bu),i()):_},t.clipExtent=function(n){return arguments.length?(b=(w=n)?Et(n[0][0],n[0][1],n[1][0],n[1][1]):R,i()):w},t.scale=function(n){return arguments.length?(h=+n,r()):h},t.translate=function(n){return arguments.length?(p=+n[0],g=+n[1],r()):[p,g]},t.center=function(n){return arguments.length?(v=n[0]%360*bu,d=n[1]%360*bu,r()):[v*_u,d*_u]},t.rotate=function(n){return arguments.length?(y=n[0]%360*bu,m=n[1]%360*bu,M=2<n.length?n[2]%360*bu:0,r()):[y*_u,m*_u,M*_u]},Yi.rebind(t,s,"precision"),function(){return u=n.apply(this,arguments),t.invert=u.invert&&e,r()}}function Yt(e){return Ht(e,function(n,t){e.point(n*bu,t*bu)})}function Zt(n,t){return[n,t]}function Vt(n,t){return[yu<n?n-mu:n<-yu?n+mu:n,t]}function Xt(n,t,e){return n?t||e?yt(Bt(n),Wt(t,e)):Bt(n):t||e?Wt(t,e):Vt}function $t(e){return function(n,t){return[yu<(n+=e)?n-mu:n<-yu?n+mu:n,t]}}function Bt(n){var t=$t(n);return t.invert=$t(-n),t}function Wt(n,t){function e(n,t){var e=Math.cos(t),r=Math.cos(n)*e,i=Math.sin(n)*e,u=Math.sin(t),o=u*a+r*l;return[Math.atan2(i*c-o*f,r*a-u*l),K(o*c+i*f)]}var a=Math.cos(n),l=Math.sin(n),c=Math.cos(t),f=Math.sin(t);return e.invert=function(n,t){var e=Math.cos(t),r=Math.cos(n)*e,i=Math.sin(n)*e,u=Math.sin(t),o=u*c-i*f;return[Math.atan2(i*c+u*f,r*a+o*l),K(o*a-r*l)]},e}function Jt(a,l){var c=Math.cos(a),f=Math.sin(a);return function(n,t,e,r){var i=e*l;null!=n?(n=Gt(c,n),t=Gt(c,t),(0<e?n<t:t<n)&&(n+=e*mu)):(n=a+e*mu,t=a-.5*i);for(var u,o=n;0<e?t<o:o<t;o-=i)r.point((u=ft([c,-f*Math.cos(o),-f*Math.sin(o)]))[0],u[1])}}function Gt(n,t){var e=it(t);e[0]-=n,ct(e);var r=G(-e[1]);return((-e[2]<0?-r:r)+2*Math.PI-vu)%(2*Math.PI)}function Kt(n,t,e){var r=Yi.range(n,t-vu,e).concat(t);return function(t){return r.map(function(n){return[t,n]})}}function Qt(n,t,e){var r=Yi.range(n,t-vu,e).concat(t);return function(t){return r.map(function(n){return[n,t]})}}function ne(n){return n.source}function te(n){return n.target}function ee(u,o){function n(n,t){var e=Math.cos(n),r=Math.cos(t),i=u(e*r);return[i*r*Math.sin(n),i*Math.sin(t)]}return n.invert=function(n,t){var e=Math.sqrt(n*n+t*t),r=o(e),i=Math.sin(r),u=Math.cos(r);return[Math.atan2(n*i,e*u),Math.asin(e&&t*i/e)]},n}function re(n,t){function e(n,t){0<o?t<-xu+vu&&(t=-xu+vu):xu-vu<t&&(t=xu-vu);var e=o/Math.pow(i(t),u);return[e*Math.sin(u*n),o-e*Math.cos(u*n)]}var r=Math.cos(n),i=function(n){return Math.tan(yu/4+n/2)},u=n===t?Math.sin(n):Math.log(r/Math.cos(t))/Math.log(i(t)/i(n)),o=r*Math.pow(i(n),u)/u;return u?(e.invert=function(n,t){var e=o-t,r=W(u)*Math.sqrt(n*n+e*e);return[Math.atan2(n,e)/u,2*Math.atan(Math.pow(o/r,1/u))-xu]},e):ue}function ie(n,t){function e(n,t){var e=u-t;return[e*Math.sin(i*n),u-e*Math.cos(i*n)]}var r=Math.cos(n),i=n===t?Math.sin(n):(r-Math.cos(t))/(t-n),u=r/i+n;return Qi(i)<vu?Zt:(e.invert=function(n,t){var e=u-t;return[Math.atan2(n,e)/i,u-W(i)*Math.sqrt(n*n+e*e)]},e)}function ue(n,t){return[n,Math.log(Math.tan(yu/4+t/2))]}function oe(n){var i,u=Ot(n),o=u.scale,a=u.translate,l=u.clipExtent;return u.scale=function(){var n=o.apply(u,arguments);return n===u?i?u.clipExtent(null):u:n},u.translate=function(){var n=a.apply(u,arguments);return n===u?i?u.clipExtent(null):u:n},u.clipExtent=function(n){var t=l.apply(u,arguments);if(t===u){if(i=null==n){var e=yu*o(),r=a();l([[r[0]-e,r[1]-e],[r[0]+e,r[1]+e]])}}else i&&(t=null);return t},u.clipExtent(null)}function ae(n,t){return[Math.log(Math.tan(yu/4+t/2)),-n]}function le(n){return n[0]}function ce(n){return n[1]}function fe(n){for(var t=n.length,e=[0,1],r=2,i=2;i<t;i++){for(;1<r&&J(n[e[r-2]],n[e[r-1]],n[i])<=0;)--r;e[r++]=i}return e.slice(0,r)}function se(n,t){return n[0]-t[0]||n[1]-t[1]}function he(n,t,e){return(e[0]-t[0])*(n[1]-t[1])<(e[1]-t[1])*(n[0]-t[0])}function pe(n,t,e,r){var i=n[0],u=e[0],o=t[0]-i,a=r[0]-u,l=n[1],c=e[1],f=t[1]-l,s=r[1]-c,h=(a*(l-c)-s*(i-u))/(s*o-a*f);return[i+h*o,l+h*f]}function ge(n){var t=n[0],e=n[n.length-1];return!(t[0]-e[0]||t[1]-e[1])}function ve(){Te(this),this.edge=this.site=this.circle=null}function de(n){var t=Oo.pop()||new ve;return t.site=n,t}function ye(n){Ne(n),jo.remove(n),Oo.push(n),Te(n)}function me(n){var t=n.circle,e=t.x,r=t.cy,i={x:e,y:r},u=n.P,o=n.N,a=[n];ye(n);for(var l=u;l.circle&&Qi(e-l.circle.x)<vu&&Qi(r-l.circle.cy)<vu;)u=l.P,a.unshift(l),ye(l),l=u;a.unshift(l),Ne(l);for(var c=o;c.circle&&Qi(e-c.circle.x)<vu&&Qi(r-c.circle.cy)<vu;)o=c.N,a.push(c),ye(c),c=o;a.push(c),Ne(c);var f,s=a.length;for(f=1;f<s;++f)c=a[f],l=a[f-1],ze(c.edge,l.site,c.site,i);l=a[0],(c=a[s-1]).edge=Ce(l.site,c.site,null,i),ke(l),ke(c)}function Me(n){for(var t,e,r,i,u=n.x,o=n.y,a=jo._;a;)if(r=xe(a,o)-u,vu<r)a=a.L;else{if(i=u-be(a,o),!(vu<i)){-vu<r?(t=a.P,e=a):-vu<i?e=(t=a).N:t=e=a;break}if(!a.R){t=a;break}a=a.R}var l=de(n);if(jo.insert(t,l),t||e){if(t===e)return Ne(t),e=de(t.site),jo.insert(l,e),l.edge=e.edge=Ce(t.site,l.site),ke(t),void ke(e);if(!e)return void(l.edge=Ce(t.site,l.site));Ne(t),Ne(e);var c=t.site,f=c.x,s=c.y,h=n.x-f,p=n.y-s,g=e.site,v=g.x-f,d=g.y-s,y=2*(h*d-p*v),m=h*h+p*p,M=v*v+d*d,x={x:(d*m-p*M)/y+f,y:(h*M-v*m)/y+s};ze(e.edge,c,g,x),l.edge=Ce(c,n,null,x),e.edge=Ce(n,g,null,x),ke(t),ke(e)}}function xe(n,t){var e=n.site,r=e.x,i=e.y,u=i-t;if(!u)return r;var o=n.P;if(!o)return-1/0;var a=(e=o.site).x,l=e.y,c=l-t;if(!c)return a;var f=a-r,s=1/u-1/c,h=f/c;return s?(-h+Math.sqrt(h*h-2*s*(f*f/(-2*c)-l+c/2+i-u/2)))/s+r:(r+a)/2}function be(n,t){var e=n.N;if(e)return xe(e,t);var r=n.site;return r.y===t?r.x:1/0}function _e(n){this.site=n,this.edges=[]}function we(n,t){return t.angle-n.angle}function Se(){Te(this),this.x=this.y=this.arc=this.site=this.cy=null}function ke(n){var t=n.P,e=n.N;if(t&&e){var r=t.site,i=n.site,u=e.site;if(r!==u){var o=i.x,a=i.y,l=r.x-o,c=r.y-a,f=u.x-o,s=2*(l*(d=u.y-a)-c*f);if(!(-du<=s)){var h=l*l+c*c,p=f*f+d*d,g=(d*h-c*p)/s,v=(l*p-f*h)/s,d=v+a,y=Io.pop()||new Se;y.arc=n,y.site=i,y.x=g+o,y.y=d+Math.sqrt(g*g+v*v),y.cy=d,n.circle=y;for(var m=null,M=Ho._;M;)if(y.y<M.y||y.y===M.y&&y.x<=M.x){if(!M.L){m=M.P;break}M=M.L}else{if(!M.R){m=M;break}M=M.R}Ho.insert(m,y),m||(Fo=y)}}}}function Ne(n){var t=n.circle;t&&(t.P||(Fo=t.N),Ho.remove(t),Io.push(t),Te(t),n.circle=null)}function Ee(n,t){var e=n.b;if(e)return!0;var r,i,u=n.a,o=t[0][0],a=t[1][0],l=t[0][1],c=t[1][1],f=n.l,s=n.r,h=f.x,p=f.y,g=s.x,v=s.y,d=(h+g)/2,y=(p+v)/2;if(v===p){if(d<o||a<=d)return;if(g<h){if(u){if(u.y>=c)return}else u={x:d,y:l};e={x:d,y:c}}else{if(u){if(u.y<l)return}else u={x:d,y:c};e={x:d,y:l}}}else if(i=y-(r=(h-g)/(v-p))*d,r<-1||1<r)if(g<h){if(u){if(u.y>=c)return}else u={x:(l-i)/r,y:l};e={x:(c-i)/r,y:c}}else{if(u){if(u.y<l)return}else u={x:(c-i)/r,y:c};e={x:(l-i)/r,y:l}}else if(p<v){if(u){if(u.x>=a)return}else u={x:o,y:r*o+i};e={x:a,y:r*a+i}}else{if(u){if(u.x<o)return}else u={x:a,y:r*a+i};e={x:o,y:r*o+i}}return n.a=u,n.b=e,!0}function Ae(n,t){this.l=n,this.r=t,this.a=this.b=null}function Ce(n,t,e,r){var i=new Ae(n,t);return Po.push(i),e&&ze(i,n,t,e),r&&ze(i,t,n,r),Uo[n.i].edges.push(new qe(i,n,t)),Uo[t.i].edges.push(new qe(i,t,n)),i}function ze(n,t,e,r){n.a||n.b?n.l===e?n.b=r:n.a=r:(n.a=r,n.l=t,n.r=e)}function qe(n,t,e){var r=n.a,i=n.b;this.edge=n,this.site=t,this.angle=e?Math.atan2(e.y-t.y,e.x-t.x):n.l===t?Math.atan2(i.x-r.x,r.y-i.y):Math.atan2(r.x-i.x,i.y-r.y)}function Le(){this._=null}function Te(n){n.U=n.C=n.L=n.R=n.P=n.N=null}function Re(n,t){var e=t,r=t.R,i=e.U;i?i.L===e?i.L=r:i.R=r:n._=r,r.U=i,e.U=r,e.R=r.L,e.R&&(e.R.U=e),r.L=e}function De(n,t){var e=t,r=t.L,i=e.U;i?i.L===e?i.L=r:i.R=r:n._=r,r.U=i,e.U=r,e.L=r.R,e.L&&(e.L.U=e),r.R=e}function Pe(n){for(;n.L;)n=n.L;return n}function Ue(n,t){var e,r,i,u=n.sort(je).pop();for(Po=[],Uo=new Array(n.length),jo=new Le,Ho=new Le;;)if(i=Fo,u&&(!i||u.y<i.y||u.y===i.y&&u.x<i.x))(u.x!==e||u.y!==r)&&(Uo[u.i]=new _e(u),Me(u),e=u.x,r=u.y),u=n.pop();else{if(!i)break;me(i.arc)}t&&(function(n){for(var t,e=Po,r=Nt(n[0][0],n[0][1],n[1][0],n[1][1]),i=e.length;i--;)(!Ee(t=e[i],n)||!r(t)||Qi(t.a.x-t.b.x)<vu&&Qi(t.a.y-t.b.y)<vu)&&(t.a=t.b=null,e.splice(i,1))}(t),function(n){for(var t,e,r,i,u,o,a,l,c,f,s=n[0][0],h=n[1][0],p=n[0][1],g=n[1][1],v=Uo,d=v.length;d--;)if((u=v[d])&&u.prepare())for(l=(a=u.edges).length,o=0;o<l;)r=(f=a[o].end()).x,i=f.y,t=(c=a[++o%l].start()).x,e=c.y,(Qi(r-t)>vu||Qi(i-e)>vu)&&(a.splice(o,0,new qe((y=u.site,m=f,M=Qi(r-s)<vu&&vu<g-i?{x:s,y:Qi(t-s)<vu?e:g}:Qi(i-g)<vu&&vu<h-r?{x:Qi(e-g)<vu?t:h,y:g}:Qi(r-h)<vu&&vu<i-p?{x:h,y:Qi(t-h)<vu?e:p}:Qi(i-p)<vu&&vu<r-s?{x:Qi(e-p)<vu?t:s,y:p}:null,x=void 0,(x=new Ae(y,null)).a=m,x.b=M,Po.push(x),x),u.site,null)),++l);var y,m,M,x}(t));var o={cells:Uo,edges:Po};return jo=Ho=Po=Uo=null,o}function je(n,t){return t.y-n.y||t.x-n.x}function Fe(n){return n.x}function He(n){return n.y}function Oe(n,t){n=Yi.rgb(n),t=Yi.rgb(t);var e=n.r,r=n.g,i=n.b,u=t.r-e,o=t.g-r,a=t.b-i;return function(n){return"#"+dn(Math.round(e+u*n))+dn(Math.round(r+o*n))+dn(Math.round(i+a*n))}}function Ie(n,t){var e,r={},i={};for(e in n)e in t?r[e]=Ve(n[e],t[e]):i[e]=n[e];for(e in t)e in n||(i[e]=t[e]);return function(n){for(e in r)i[e]=r[e](n);return i}}function Ye(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function Ze(n,r){var t,e,i,u=Zo.lastIndex=Vo.lastIndex=0,o=-1,a=[],l=[];for(n+="",r+="";(t=Zo.exec(n))&&(e=Vo.exec(r));)(i=e.index)>u&&(i=r.slice(u,i),a[o]?a[o]+=i:a[++o]=i),(t=t[0])===(e=e[0])?a[o]?a[o]+=e:a[++o]=e:(a[++o]=null,l.push({i:o,x:Ye(t,e)})),u=Vo.lastIndex;return u<r.length&&(i=r.slice(u),a[o]?a[o]+=i:a[++o]=i),a.length<2?l[0]?(r=l[0].x,function(n){return r(n)+""}):function(){return r}:(r=l.length,function(n){for(var t,e=0;e<r;++e)a[(t=l[e]).i]=t.x(n);return a.join("")})}function Ve(n,t){for(var e,r=Yi.interpolators.length;0<=--r&&!(e=Yi.interpolators[r](n,t)););return e}function Xe(n,t){var e,r=[],i=[],u=n.length,o=t.length,a=Math.min(n.length,t.length);for(e=0;e<a;++e)r.push(Ve(n[e],t[e]));for(;e<u;++e)i[e]=n[e];for(;e<o;++e)i[e]=t[e];return function(n){for(e=0;e<a;++e)i[e]=r[e](n);return i}}function $e(t){return function(n){return 1-t(1-n)}}function Be(t){return function(n){return.5*(n<.5?t(2*n):2-t(2-2*n))}}function We(n){return n*n}function Je(n){return n*n*n}function Ge(n){if(n<=0)return 0;if(1<=n)return 1;var t=n*n,e=t*n;return 4*(n<.5?e:3*(n-t)+e-.75)}function Ke(n){return 1-Math.cos(n*xu)}function Qe(n){return Math.pow(2,10*(n-1))}function nr(n){return 1-Math.sqrt(1-n*n)}function tr(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375}function er(t,e){return e-=t,function(n){return Math.round(t+e*n)}}function rr(n){var t=[n.a,n.b],e=[n.c,n.d],r=ur(t),i=ir(t,e),u=ur(function(n,t,e){return n[0]+=e*t[0],n[1]+=e*t[1],n}(e,t,-i))||0;t[0]*e[1]<e[0]*t[1]&&(t[0]*=-1,t[1]*=-1,r*=-1,i*=-1),this.rotate=(r?Math.atan2(t[1],t[0]):Math.atan2(-e[0],e[1]))*_u,this.translate=[n.e,n.f],this.scale=[r,u],this.skew=u?Math.atan2(i,u)*_u:0}function ir(n,t){return n[0]*t[0]+n[1]*t[1]}function ur(n){var t=Math.sqrt(ir(n,n));return t&&(n[0]/=t,n[1]/=t),t}function or(n,t){var r,i=[],u=[],e=Yi.transform(n),o=Yi.transform(t),a=e.translate,l=o.translate,c=e.rotate,f=o.rotate,s=e.skew,h=o.skew,p=e.scale,g=o.scale;return a[0]!=l[0]||a[1]!=l[1]?(i.push("translate(",null,",",null,")"),u.push({i:1,x:Ye(a[0],l[0])},{i:3,x:Ye(a[1],l[1])})):i.push(l[0]||l[1]?"translate("+l+")":""),c!=f?(180<c-f?f+=360:180<f-c&&(c+=360),u.push({i:i.push(i.pop()+"rotate(",null,")")-2,x:Ye(c,f)})):f&&i.push(i.pop()+"rotate("+f+")"),s!=h?u.push({i:i.push(i.pop()+"skewX(",null,")")-2,x:Ye(s,h)}):h&&i.push(i.pop()+"skewX("+h+")"),p[0]!=g[0]||p[1]!=g[1]?(r=i.push(i.pop()+"scale(",null,",",null,")"),u.push({i:r-4,x:Ye(p[0],g[0])},{i:r-2,x:Ye(p[1],g[1])})):(1!=g[0]||1!=g[1])&&i.push(i.pop()+"scale("+g+")"),r=u.length,function(n){for(var t,e=-1;++e<r;)i[(t=u[e]).i]=t.x(n);return i.join("")}}function ar(t,e){return e=(e-=t=+t)||1/e,function(n){return(n-t)/e}}function lr(t,e){return e=(e-=t=+t)||1/e,function(n){return Math.max(0,Math.min(1,(n-t)/e))}}function cr(n){for(var t=n.source,e=n.target,r=function(n,t){if(n===t)return n;for(var e=fr(n),r=fr(t),i=e.pop(),u=r.pop(),o=null;i===u;)o=i,i=e.pop(),u=r.pop();return o}(t,e),i=[t];t!==r;)t=t.parent,i.push(t);for(var u=i.length;e!==r;)i.splice(u,0,e),e=e.parent;return i}function fr(n){for(var t=[],e=n.parent;null!=e;)t.push(n),e=(n=e).parent;return t.push(n),t}function sr(n){n.fixed|=2}function hr(n){n.fixed&=-7}function pr(n){n.fixed|=4,n.px=n.x,n.py=n.y}function gr(n){n.fixed&=-5}function vr(n,t){return Yi.rebind(n,t,"sort","children","value"),(n.nodes=n).links=br,n}function dr(n,t){for(var e=[n];null!=(n=e.pop());)if(t(n),(i=n.children)&&(r=i.length))for(var r,i;0<=--r;)e.push(i[r])}function yr(n,t){for(var e=[n],r=[];null!=(n=e.pop());)if(r.push(n),(u=n.children)&&(i=u.length))for(var i,u,o=-1;++o<i;)e.push(u[o]);for(;null!=(n=r.pop());)t(n)}function mr(n){return n.children}function Mr(n){return n.value}function xr(n,t){return t.value-n.value}function br(n){return Yi.merge(n.map(function(t){return(t.children||[]).map(function(n){return{source:t,target:n}})}))}function _r(n){return n.x}function wr(n){return n.y}function Sr(n,t,e){n.y0=t,n.y=e}function kr(n){return Yi.range(n.length)}function Nr(n){for(var t=-1,e=n[0].length,r=[];++t<e;)r[t]=0;return r}function Er(n){for(var t,e=1,r=0,i=n[0][1],u=n.length;e<u;++e)(t=n[e][1])>i&&(r=e,i=t);return r}function Ar(n){return n.reduce(Cr,0)}function Cr(n,t){return n+t[1]}function zr(n,t){return qr(n,Math.ceil(Math.log(t.length)/Math.LN2+1))}function qr(n,t){for(var e=-1,r=+n[0],i=(n[1]-r)/t,u=[];++e<=t;)u[e]=i*e+r;return u}function Lr(n){return[Yi.min(n),Yi.max(n)]}function Tr(n,t){return n.value-t.value}function Rr(n,t){var e=n._pack_next;(n._pack_next=t)._pack_prev=n,(t._pack_next=e)._pack_prev=t}function Dr(n,t){(n._pack_next=t)._pack_prev=n}function Pr(n,t){var e=t.x-n.x,r=t.y-n.y,i=n.r+t.r;return e*e+r*r<.999*i*i}function Ur(n){function t(n){f=Math.min(n.x-n.r,f),s=Math.max(n.x+n.r,s),h=Math.min(n.y-n.r,h),p=Math.max(n.y+n.r,p)}if((e=n.children)&&(c=e.length)){var e,r,i,u,o,a,l,c,f=1/0,s=-1/0,h=1/0,p=-1/0;if(e.forEach(jr),(r=e[0]).x=-r.r,r.y=0,t(r),1<c&&((i=e[1]).x=i.r,i.y=0,t(i),2<c))for(Hr(r,i,u=e[2]),t(u),Rr(r,u),Rr(r._pack_prev=u,i),i=r._pack_next,o=3;o<c;o++){Hr(r,i,u=e[o]);var g=0,v=1,d=1;for(a=i._pack_next;a!==i;a=a._pack_next,v++)if(Pr(a,u)){g=1;break}if(1==g)for(l=r._pack_prev;l!==a._pack_prev&&!Pr(l,u);l=l._pack_prev,d++);g?(v<d||v==d&&i.r<r.r?Dr(r,i=a):Dr(r=l,i),o--):(Rr(r,u),t(i=u))}var y=(f+s)/2,m=(h+p)/2,M=0;for(o=0;o<c;o++)(u=e[o]).x-=y,u.y-=m,M=Math.max(M,u.r+Math.sqrt(u.x*u.x+u.y*u.y));n.r=M,e.forEach(Fr)}}function jr(n){n._pack_next=n._pack_prev=n}function Fr(n){delete n._pack_next,delete n._pack_prev}function Hr(n,t,e){var r=n.r+e.r,i=t.x-n.x,u=t.y-n.y;if(r&&(i||u)){var o=t.r+e.r,a=i*i+u*u,l=.5+((r*=r)-(o*=o))/(2*a),c=Math.sqrt(Math.max(0,2*o*(r+a)-(r-=a)*r-o*o))/(2*a);e.x=n.x+l*i+c*u,e.y=n.y+l*u-c*i}else e.x=n.x+r,e.y=n.y}function Or(n,t){return n.parent==t.parent?1:2}function Ir(n){var t=n.children;return t.length?t[0]:n.t}function Yr(n){var t,e=n.children;return(t=e.length)?e[t-1]:n.t}function Zr(n){return{x:n.x,y:n.y,dx:n.dx,dy:n.dy}}function Vr(n,t){var e=n.x+t[3],r=n.y+t[0],i=n.dx-t[1]-t[3],u=n.dy-t[0]-t[2];return i<0&&(e+=i/2,i=0),u<0&&(r+=u/2,u=0),{x:e,y:r,dx:i,dy:u}}function Xr(n){var t=n[0],e=n[n.length-1];return t<e?[t,e]:[e,t]}function $r(n){return n.rangeExtent?n.rangeExtent():Xr(n.range())}function Br(n,t,e,r){var i=e(n[0],n[1]),u=r(t[0],t[1]);return function(n){return u(i(n))}}function Wr(n,t){var e,r=0,i=n.length-1,u=n[r],o=n[i];return o<u&&(e=r,r=i,i=e,e=u,u=o,o=e),n[r]=t.floor(u),n[i]=t.ceil(o),n}function Jr(e,n,t,r){var i=[],u=[],o=0,a=Math.min(e.length,n.length)-1;for(e[a]<e[0]&&(e=e.slice().reverse(),n=n.slice().reverse());++o<=a;)i.push(t(e[o-1],e[o])),u.push(r(n[o-1],n[o]));return function(n){var t=Yi.bisect(e,n,1,a)-1;return u[t](i[t](n))}}function Gr(n,t){return Yi.rebind(n,t,"range","rangeRound","interpolate","clamp")}function Kr(n,t){return Wr(n,function(t){return t?{floor:function(n){return Math.floor(n/t)*t},ceil:function(n){return Math.ceil(n/t)*t}}:ea}(Qr(n,t)[2]))}function Qr(n,t){null==t&&(t=10);var e=Xr(n),r=e[1]-e[0],i=Math.pow(10,Math.floor(Math.log(r/t)/Math.LN10)),u=t/r*i;return u<=.15?i*=10:u<=.35?i*=5:u<=.75&&(i*=2),e[0]=Math.ceil(e[0]/i)*i,e[1]=Math.floor(e[1]/i)*i+.5*i,e[2]=i,e}function ni(n,t){return Yi.range.apply(Yi,Qr(n,t))}function ti(n,t,e){var r=Qr(n,t);if(e){var i=Yu.exec(e);if(i.shift(),"s"===i[8]){var u=Yi.formatPrefix(Math.max(Qi(r[0]),Qi(r[1])));return i[7]||(i[7]="."+ei(u.scale(r[2]))),i[8]="f",e=Yi.format(i.join("")),function(n){return e(u.scale(n))+u.symbol}}i[7]||(i[7]="."+function(n,t){var e=ei(t[2]);return n in ra?Math.abs(e-ei(Math.max(Qi(t[0]),Qi(t[1]))))+ +("e"!==n):e-2*("%"===n)}(i[8],r)),e=i.join("")}else e=",."+ei(r[2])+"f";return Yi.format(e)}function ei(n){return-Math.floor(Math.log(n)/Math.LN10+.01)}function ri(t){return function(n){return n<0?-Math.pow(-n,t):Math.pow(n,t)}}function ii(){return 0}function ui(n){return n.innerRadius}function oi(n){return n.outerRadius}function ai(n){return n.startAngle}function li(n){return n.endAngle}function ci(n){return n&&n.padAngle}function fi(n,t,e,r){return 0<(n-e)*t-(t-r)*n?0:1}function si(n,t,e,r,i){var u=n[0]-t[0],o=n[1]-t[1],a=(i?r:-r)/Math.sqrt(u*u+o*o),l=a*o,c=-a*u,f=n[0]+l,s=n[1]+c,h=t[0]+l,p=t[1]+c,g=(f+h)/2,v=(s+p)/2,d=h-f,y=p-s,m=d*d+y*y,M=e-r,x=f*p-h*s,b=(y<0?-1:1)*Math.sqrt(M*M*m-x*x),_=(x*y-d*b)/m,w=(-x*d-y*b)/m,S=(x*y+d*b)/m,k=(-x*d+y*b)/m,N=_-g,E=w-v,A=S-g,C=k-v;return A*A+C*C<N*N+E*E&&(_=S,w=k),[[_-l,w-c],[_*e/M,w*e/M]]}function hi(c){function t(n){function t(){r.push("M",p(c(i),g))}for(var e,r=[],i=[],u=-1,o=n.length,a=_n(f),l=_n(s);++u<o;)h.call(this,e=n[u],u)?i.push([+a.call(this,e,u),+l.call(this,e,u)]):i.length&&(t(),i=[]);return i.length&&t(),r.length?r.join(""):null}var f=le,s=ce,h=mt,p=pi,e=p.key,g=.7;return t.x=function(n){return arguments.length?(f=n,t):f},t.y=function(n){return arguments.length?(s=n,t):s},t.defined=function(n){return arguments.length?(h=n,t):h},t.interpolate=function(n){return arguments.length?(e="function"==typeof n?p=n:(p=sa.get(n)||pi).key,t):e},t.tension=function(n){return arguments.length?(g=n,t):g},t}function pi(n){return n.join("L")}function gi(n){for(var t=0,e=n.length,r=n[0],i=[r[0],",",r[1]];++t<e;)i.push("V",(r=n[t])[1],"H",r[0]);return i.join("")}function vi(n){for(var t=0,e=n.length,r=n[0],i=[r[0],",",r[1]];++t<e;)i.push("H",(r=n[t])[0],"V",r[1]);return i.join("")}function di(n,t){if(t.length<1||n.length!=t.length&&n.length!=t.length+2)return pi(n);var e=n.length!=t.length,r="",i=n[0],u=n[1],o=t[0],a=o,l=1;if(e&&(r+="Q"+(u[0]-2*o[0]/3)+","+(u[1]-2*o[1]/3)+","+u[0]+","+u[1],i=n[1],l=2),1<t.length){a=t[1],u=n[l],l++,r+="C"+(i[0]+o[0])+","+(i[1]+o[1])+","+(u[0]-a[0])+","+(u[1]-a[1])+","+u[0]+","+u[1];for(var c=2;c<t.length;c++,l++)u=n[l],a=t[c],r+="S"+(u[0]-a[0])+","+(u[1]-a[1])+","+u[0]+","+u[1]}if(e){var f=n[l];r+="Q"+(u[0]+2*a[0]/3)+","+(u[1]+2*a[1]/3)+","+f[0]+","+f[1]}return r}function yi(n,t){for(var e,r=[],i=(1-t)/2,u=n[0],o=n[1],a=1,l=n.length;++a<l;)e=u,u=o,o=n[a],r.push([i*(o[0]-e[0]),i*(o[1]-e[1])]);return r}function mi(n){if(n.length<3)return pi(n);var t=1,e=n.length,r=n[0],i=r[0],u=r[1],o=[i,i,i,(r=n[1])[0]],a=[u,u,u,r[1]],l=[i,",",u,"L",Mi(ga,o),",",Mi(ga,a)];for(n.push(n[e-1]);++t<=e;)r=n[t],o.shift(),o.push(r[0]),a.shift(),a.push(r[1]),xi(l,o,a);return n.pop(),l.push("L",r),l.join("")}function Mi(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]+n[3]*t[3]}function xi(n,t,e){n.push("C",Mi(ha,t),",",Mi(ha,e),",",Mi(pa,t),",",Mi(pa,e),",",Mi(ga,t),",",Mi(ga,e))}function bi(n,t){return(t[1]-n[1])/(t[0]-n[0])}function _i(n){for(var t,e,r,i,u=[],o=function(n){for(var t=0,e=n.length-1,r=[],i=n[0],u=n[1],o=r[0]=bi(i,u);++t<e;)r[t]=(o+(o=bi(i=u,u=n[t+1])))/2;return r[t]=o,r}(n),a=-1,l=n.length-1;++a<l;)t=bi(n[a],n[a+1]),Qi(t)<vu?o[a]=o[a+1]=0:9<(i=(e=o[a]/t)*e+(r=o[a+1]/t)*r)&&(i=3*t/Math.sqrt(i),o[a]=i*e,o[a+1]=i*r);for(a=-1;++a<=l;)i=(n[Math.min(l,a+1)][0]-n[Math.max(0,a-1)][0])/(6*(1+o[a]*o[a])),u.push([i||0,o[a]*i||0]);return u}function wi(n){for(var t,e,r,i=-1,u=n.length;++i<u;)e=(t=n[i])[0],r=t[1]-xu,t[0]=e*Math.cos(r),t[1]=e*Math.sin(r);return n}function Si(g){function t(n){function t(){u.push("M",x(g(a),w),_,b(g(o.reverse()),w),"Z")}for(var e,r,i,u=[],o=[],a=[],l=-1,c=n.length,f=_n(v),s=_n(y),h=v===d?function(){return r}:_n(d),p=y===m?function(){return i}:_n(m);++l<c;)M.call(this,e=n[l],l)?(o.push([r=+f.call(this,e,l),i=+s.call(this,e,l)]),a.push([+h.call(this,e,l),+p.call(this,e,l)])):o.length&&(t(),o=[],a=[]);return o.length&&t(),u.length?u.join(""):null}var v=le,d=le,y=0,m=ce,M=mt,x=pi,e=x.key,b=x,_="L",w=.7;return t.x=function(n){return arguments.length?(v=d=n,t):d},t.x0=function(n){return arguments.length?(v=n,t):v},t.x1=function(n){return arguments.length?(d=n,t):d},t.y=function(n){return arguments.length?(y=m=n,t):m},t.y0=function(n){return arguments.length?(y=n,t):y},t.y1=function(n){return arguments.length?(m=n,t):m},t.defined=function(n){return arguments.length?(M=n,t):M},t.interpolate=function(n){return arguments.length?(e="function"==typeof n?x=n:(x=sa.get(n)||pi).key,b=x.reverse||x,_=x.closed?"M":"L",t):e},t.tension=function(n){return arguments.length?(w=n,t):w},t}function ki(n){return n.radius}function Ni(n){return[n.x,n.y]}function Ei(){return 64}function Ai(){return"circle"}function Ci(n){var t=Math.sqrt(n/yu);return"M0,"+t+"A"+t+","+t+" 0 1,1 0,"+-t+"A"+t+","+t+" 0 1,1 0,"+t+"Z"}function zi(e){return function(){var n,t;(n=this[e])&&(t=n[n.active])&&(--n.count?delete n[n.active]:delete this[e],n.active+=.5,t.event&&t.event.interrupt.call(this,this.__data__,t.index))}}function qi(n,t,e){return iu(n,ba),n.namespace=t,n.id=e,n}function Li(n,r,i,u){var o=n.id,a=n.namespace;return O(n,"function"==typeof i?function(n,t,e){n[a][o].tween.set(r,u(i.call(n,n.__data__,t,e)))}:(i=u(i),function(n){n[a][o].tween.set(r,i)}))}function Ti(n){return null==n&&(n=""),function(){this.textContent=n}}function Ri(n){return null==n?"__transition__":"__transition_"+n+"__"}function Di(c,f,s,h,n){var p=c[s]||(c[s]={active:0,count:0}),g=p[h];if(!g){var v=n.time;g=p[h]={tween:new m,time:v,delay:n.delay,duration:n.duration,ease:n.ease,index:f},n=null,++p.count,Yi.timer(function(n){function t(n){if(p.active>h)return i();var t=p[p.active];t&&(--p.count,delete p[p.active],t.event&&t.event.interrupt.call(c,c.__data__,t.index)),p.active=h,g.event&&g.event.start.call(c,c.__data__,f),g.tween.forEach(function(n,t){(t=t.call(c,c.__data__,f))&&l.push(t)}),o=g.ease,u=g.duration,Yi.timer(function(){return a.c=e(n||1)?mt:e,1},0,v)}function e(n){if(p.active!==h)return 1;for(var t=n/u,e=o(t),r=l.length;0<r;)l[--r].call(c,e);return 1<=t?(g.event&&g.event.end.call(c,c.__data__,f),i()):void 0}function i(){return--p.count?delete p[h]:delete c[s],1}var u,o,r=g.delay,a=Hu,l=[];return a.t=r+v,r<=n?t(n-r):void(a.c=t)},0,v)}}function Pi(n,e,r){n.attr("transform",function(n){var t=e(n);return"translate("+(isFinite(t)?t:r(n))+",0)"})}function Ui(n,e,r){n.attr("transform",function(n){var t=e(n);return"translate(0,"+(isFinite(t)?t:r(n))+")"})}function ji(n){return n.toISOString()}function Fi(t,i,n){function o(n){return t(n)}function a(n,t){var e=(n[1]-n[0])/t,r=Yi.bisect(za,e);return r==za.length?[i.year,Qr(n.map(function(n){return n/31536e6}),t)[2]]:r?i[e/za[r-1]<za[r]/e?r-1:r]:[Ta,Qr(n,t)[2]]}return o.invert=function(n){return Hi(t.invert(n))},o.domain=function(n){return arguments.length?(t.domain(n),o):t.domain().map(Hi)},o.nice=function(t,e){function r(n){return!isNaN(n)&&!t.range(n,Hi(+n+1),e).length}var n=o.domain(),i=Xr(n),u=null==t?a(i,10):"number"==typeof t&&a(i,t);return u&&(t=u[0],e=u[1]),o.domain(Wr(n,1<e?{floor:function(n){for(;r(n=t.floor(n));)n=Hi(n-1);return n},ceil:function(n){for(;r(n=t.ceil(n));)n=Hi(+n+1);return n}}:t))},o.ticks=function(n,t){var e=Xr(o.domain()),r=null==n?a(e,10):"number"==typeof n?a(e,n):!n.range&&[{range:n},t];return r&&(n=r[0],t=r[1]),n.range(e[0],Hi(+e[1]+1),t<1?1:t)},o.tickFormat=function(){return n},o.copy=function(){return Fi(t.copy(),i,n)},Gr(o,t)}function Hi(n){return new Date(n)}function Oi(n){return JSON.parse(n.responseText)}function Ii(n){var t=Xi.createRange();return t.selectNode(Xi.body),t.createContextualFragment(n.responseText)}var Yi={version:"3.5.6"},Zi=[].slice,Vi=function(n){return Zi.call(n)},Xi=this.document;if(Xi)try{Vi(Xi.documentElement.childNodes)[0].nodeType}catch(n){Vi=function(n){for(var t=n.length,e=new Array(t);t--;)e[t]=n[t];return e}}if(Date.now||(Date.now=function(){return+new Date}),Xi)try{Xi.createElement("DIV").style.setProperty("opacity",0,"")}catch(n){var $i=this.Element.prototype,Bi=$i.setAttribute,Wi=$i.setAttributeNS,Ji=this.CSSStyleDeclaration.prototype,Gi=Ji.setProperty;$i.setAttribute=function(n,t){Bi.call(this,n,t+"")},$i.setAttributeNS=function(n,t,e){Wi.call(this,n,t,e+"")},Ji.setProperty=function(n,t,e){Gi.call(this,n,t+"",e)}}Yi.ascending=o,Yi.descending=function(n,t){return t<n?-1:n<t?1:n<=t?0:NaN},Yi.min=function(n,t){var e,r,i=-1,u=n.length;if(1===arguments.length){for(;++i<u;)if(null!=(r=n[i])&&r<=r){e=r;break}for(;++i<u;)null!=(r=n[i])&&r<e&&(e=r)}else{for(;++i<u;)if(null!=(r=t.call(n,n[i],i))&&r<=r){e=r;break}for(;++i<u;)null!=(r=t.call(n,n[i],i))&&r<e&&(e=r)}return e},Yi.max=function(n,t){var e,r,i=-1,u=n.length;if(1===arguments.length){for(;++i<u;)if(null!=(r=n[i])&&r<=r){e=r;break}for(;++i<u;)null!=(r=n[i])&&e<r&&(e=r)}else{for(;++i<u;)if(null!=(r=t.call(n,n[i],i))&&r<=r){e=r;break}for(;++i<u;)null!=(r=t.call(n,n[i],i))&&e<r&&(e=r)}return e},Yi.extent=function(n,t){var e,r,i,u=-1,o=n.length;if(1===arguments.length){for(;++u<o;)if(null!=(r=n[u])&&r<=r){e=i=r;break}for(;++u<o;)null!=(r=n[u])&&(r<e&&(e=r),i<r&&(i=r))}else{for(;++u<o;)if(null!=(r=t.call(n,n[u],u))&&r<=r){e=i=r;break}for(;++u<o;)null!=(r=t.call(n,n[u],u))&&(r<e&&(e=r),i<r&&(i=r))}return[e,i]},Yi.sum=function(n,t){var e,r=0,i=n.length,u=-1;if(1===arguments.length)for(;++u<i;)f(e=+n[u])&&(r+=e);else for(;++u<i;)f(e=+t.call(n,n[u],u))&&(r+=e);return r},Yi.mean=function(n,t){var e,r=0,i=n.length,u=-1,o=i;if(1===arguments.length)for(;++u<i;)f(e=c(n[u]))?r+=e:--o;else for(;++u<i;)f(e=c(t.call(n,n[u],u)))?r+=e:--o;return o?r/o:void 0},Yi.quantile=function(n,t){var e=(n.length-1)*t+1,r=Math.floor(e),i=+n[r-1],u=e-r;return u?i+u*(n[r]-i):i},Yi.median=function(n,t){var e,r=[],i=n.length,u=-1;if(1===arguments.length)for(;++u<i;)f(e=c(n[u]))&&r.push(e);else for(;++u<i;)f(e=c(t.call(n,n[u],u)))&&r.push(e);return r.length?Yi.quantile(r.sort(o),.5):void 0},Yi.variance=function(n,t){var e,r,i=n.length,u=0,o=0,a=-1,l=0;if(1===arguments.length)for(;++a<i;)f(e=c(n[a]))&&(o+=(r=e-u)*(e-(u+=r/++l)));else for(;++a<i;)f(e=c(t.call(n,n[a],a)))&&(o+=(r=e-u)*(e-(u+=r/++l)));return 1<l?o/(l-1):void 0},Yi.deviation=function(){var n=Yi.variance.apply(this,arguments);return n?Math.sqrt(n):n};var Ki=n(o);Yi.bisectLeft=Ki.left,Yi.bisect=Yi.bisectRight=Ki.right,Yi.bisector=function(e){return n(1===e.length?function(n,t){return o(e(n),t)}:e)},Yi.shuffle=function(n,t,e){(u=arguments.length)<3&&(e=n.length,u<2&&(t=0));for(var r,i,u=e-t;u;)i=Math.random()*u--|0,r=n[u+t],n[u+t]=n[i+t],n[i+t]=r;return n},Yi.permute=function(n,t){for(var e=t.length,r=new Array(e);e--;)r[e]=n[t[e]];return r},Yi.pairs=function(n){for(var t=0,e=n.length-1,r=n[0],i=new Array(e<0?0:e);t<e;)i[t]=[r,r=n[++t]];return i},Yi.zip=function(){if(!(r=arguments.length))return[];for(var n=-1,t=Yi.min(arguments,l),e=new Array(t);++n<t;)for(var r,i=-1,u=e[n]=new Array(r);++i<r;)u[i]=arguments[i][n];return e},Yi.transpose=function(n){return Yi.zip.apply(Yi,n)},Yi.keys=function(n){var t=[];for(var e in n)t.push(e);return t},Yi.values=function(n){var t=[];for(var e in n)t.push(n[e]);return t},Yi.entries=function(n){var t=[];for(var e in n)t.push({key:e,value:n[e]});return t},Yi.merge=function(n){for(var t,e,r,i=n.length,u=-1,o=0;++u<i;)o+=n[u].length;for(e=new Array(o);0<=--i;)for(t=(r=n[i]).length;0<=--t;)e[--o]=r[t];return e};var Qi=Math.abs;Yi.range=function(n,t,e){if(arguments.length<3&&(e=1,arguments.length<2&&(t=n,n=0)),(t-n)/e==1/0)throw new Error("infinite range");var r,i=[],u=function(n){for(var t=1;n*t%1;)t*=10;return t}(Qi(e)),o=-1;if(n*=u,t*=u,(e*=u)<0)for(;(r=n+e*++o)>t;)i.push(r/u);else for(;(r=n+e*++o)<t;)i.push(r/u);return i},Yi.map=function(n,t){var e=new m;if(n instanceof m)n.forEach(function(n,t){e.set(n,t)});else if(Array.isArray(n)){var r,i=-1,u=n.length;if(1===arguments.length)for(;++i<u;)e.set(i,n[i]);else for(;++i<u;)e.set(t.call(n,r=n[i],i),r)}else for(var o in n)e.set(o,n[o]);return e};var nu="__proto__",tu="\0";t(m,{has:i,get:function(n){return this._[e(n)]},set:function(n,t){return this._[e(n)]=t},remove:u,keys:s,values:function(){var n=[];for(var t in this._)n.push(this._[t]);return n},entries:function(){var n=[];for(var t in this._)n.push({key:r(t),value:this._[t]});return n},size:h,empty:p,forEach:function(n){for(var t in this._)n.call(this,r(t),this._[t])}}),Yi.nest=function(){function s(e,n,r){if(r>=v.length)return p?p.call(g,n):h?n.sort(h):n;for(var t,i,u,o,a=-1,l=n.length,c=v[r++],f=new m;++a<l;)(o=f.get(t=c(i=n[a])))?o.push(i):f.set(t,[i]);return u=e?(i=e(),function(n,t){i.set(n,s(e,t,r))}):(i={},function(n,t){i[n]=s(e,t,r)}),f.forEach(u),i}var h,p,g={},v=[],t=[];return g.map=function(n,t){return s(t,n,0)},g.entries=function(n){return function e(n,r){if(r>=v.length)return n;var i=[],u=t[r++];return n.forEach(function(n,t){i.push({key:n,values:e(t,r)})}),u?i.sort(function(n,t){return u(n.key,t.key)}):i}(s(Yi.map,n,0),0)},g.key=function(n){return v.push(n),g},g.sortKeys=function(n){return t[v.length-1]=n,g},g.sortValues=function(n){return h=n,g},g.rollup=function(n){return p=n,g},g},Yi.set=function(n){var t=new g;if(n)for(var e=0,r=n.length;e<r;++e)t.add(n[e]);return t},t(g,{has:i,add:function(n){return this._[e(n+="")]=!0,n},remove:u,values:s,size:h,empty:p,forEach:function(n){for(var t in this._)n.call(this,r(t))}}),Yi.behavior={},Yi.rebind=function(n,t){for(var e,r=1,i=arguments.length;++r<i;)n[e=arguments[r]]=v(n,t,t[e]);return n};var eu=["webkit","ms","moz","Moz","o","O"];Yi.dispatch=function(){for(var n=new M,t=-1,e=arguments.length;++t<e;)n[arguments[t]]=x(n);return n},M.prototype.on=function(n,t){var e=n.indexOf("."),r="";if(0<=e&&(r=n.slice(e+1),n=n.slice(0,e)),n)return arguments.length<2?this[n].on(r):this[n].on(r,t);if(2===arguments.length){if(null==t)for(n in this)this.hasOwnProperty(n)&&this[n].on(r,null);return this}},Yi.event=null,Yi.requote=function(n){return n.replace(ru,"\\$&")};var ru=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,iu={}.__proto__?function(n,t){n.__proto__=t}:function(n,t){for(var e in t)n[e]=t[e]},uu=function(n,t){return t.querySelector(n)},ou=function(n,t){return t.querySelectorAll(n)},au=function(n,t){var e=n.matches||n[d(n,"matchesSelector")];return(au=function(n,t){return e.call(n,t)})(n,t)};"function"==typeof Sizzle&&(uu=function(n,t){return Sizzle(n,t)[0]||null},ou=Sizzle,au=Sizzle.matchesSelector),Yi.selection=function(){return Yi.select(Xi.documentElement)};var lu=Yi.selection.prototype=[];lu.select=function(n){var t,e,r,i,u=[];n=w(n);for(var o=-1,a=this.length;++o<a;){u.push(t=[]),t.parentNode=(r=this[o]).parentNode;for(var l=-1,c=r.length;++l<c;)(i=r[l])?(t.push(e=n.call(i,i.__data__,l,o)),e&&"__data__"in i&&(e.__data__=i.__data__)):t.push(null)}return _(u)},lu.selectAll=function(n){var t,e,r=[];n=S(n);for(var i=-1,u=this.length;++i<u;)for(var o=this[i],a=-1,l=o.length;++a<l;)(e=o[a])&&(r.push(t=Vi(n.call(e,e.__data__,a,i))),t.parentNode=e);return _(r)};var cu={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};Yi.ns={prefix:cu,qualify:function(n){var t=n.indexOf(":"),e=n;return 0<=t&&(e=n.slice(0,t),n=n.slice(t+1)),cu.hasOwnProperty(e)?{space:cu[e],local:n}:n}},lu.attr=function(n,t){if(arguments.length<2){if("string"==typeof n){var e=this.node();return(n=Yi.ns.qualify(n)).local?e.getAttributeNS(n.space,n.local):e.getAttribute(n)}for(t in n)this.each(k(t,n[t]));return this}return this.each(k(n,t))},lu.classed=function(n,t){if(arguments.length<2){if("string"==typeof n){var e=this.node(),r=(n=A(n)).length,i=-1;if(t=e.classList){for(;++i<r;)if(!t.contains(n[i]))return!1}else for(t=e.getAttribute("class");++i<r;)if(!E(n[i]).test(t))return!1;return!0}for(t in n)this.each(C(t,n[t]));return this}return this.each(C(n,t))},lu.style=function(n,t,e){var r=arguments.length;if(r<3){if("string"!=typeof n){for(e in r<2&&(t=""),n)this.each(q(e,n[e],t));return this}if(r<2){var i=this.node();return T(i).getComputedStyle(i,null).getPropertyValue(n)}e=""}return this.each(q(n,t,e))},lu.property=function(n,t){if(arguments.length<2){if("string"==typeof n)return this.node()[n];for(t in n)this.each(L(t,n[t]));return this}return this.each(L(n,t))},lu.text=function(t){return arguments.length?this.each("function"==typeof t?function(){var n=t.apply(this,arguments);this.textContent=null==n?"":n}:null==t?function(){this.textContent=""}:function(){this.textContent=t}):this.node().textContent},lu.html=function(t){return arguments.length?this.each("function"==typeof t?function(){var n=t.apply(this,arguments);this.innerHTML=null==n?"":n}:null==t?function(){this.innerHTML=""}:function(){this.innerHTML=t}):this.node().innerHTML},lu.append=function(n){return n=U(n),this.select(function(){return this.appendChild(n.apply(this,arguments))})},lu.insert=function(n,t){return n=U(n),t=w(t),this.select(function(){return this.insertBefore(n.apply(this,arguments),t.apply(this,arguments)||null)})},lu.remove=function(){return this.each(j)},lu.data=function(n,g){function t(n,t){var e,r,i,u=n.length,o=t.length,a=Math.min(u,o),l=new Array(o),c=new Array(o),f=new Array(u);if(g){var s,h=new m,p=new Array(u);for(e=-1;++e<u;)h.has(s=g.call(r=n[e],r.__data__,e))?f[e]=r:h.set(s,r),p[e]=s;for(e=-1;++e<o;)(r=h.get(s=g.call(t,i=t[e],e)))?!0!==r&&((l[e]=r).__data__=i):c[e]=F(i),h.set(s,!0);for(e=-1;++e<u;)!0!==h.get(p[e])&&(f[e]=n[e])}else{for(e=-1;++e<a;)r=n[e],i=t[e],r?(r.__data__=i,l[e]=r):c[e]=F(i);for(;e<o;++e)c[e]=F(t[e]);for(;e<u;++e)f[e]=n[e]}c.update=l,c.parentNode=l.parentNode=f.parentNode=n.parentNode,v.push(c),d.push(l),y.push(f)}var e,r,i=-1,u=this.length;if(!arguments.length){for(n=new Array(u=(e=this[0]).length);++i<u;)(r=e[i])&&(n[i]=r.__data__);return n}var v=I([]),d=_([]),y=_([]);if("function"==typeof n)for(;++i<u;)t(e=this[i],n.call(e,e.parentNode.__data__,i));else for(;++i<u;)t(e=this[i],n);return d.enter=function(){return v},d.exit=function(){return y},d},lu.datum=function(n){return arguments.length?this.property("__data__",n):this.property("__data__")},lu.filter=function(n){var t,e,r,i=[];"function"!=typeof n&&(n=H(n));for(var u=0,o=this.length;u<o;u++){i.push(t=[]),t.parentNode=(e=this[u]).parentNode;for(var a=0,l=e.length;a<l;a++)(r=e[a])&&n.call(r,r.__data__,a,u)&&t.push(r)}return _(i)},lu.order=function(){for(var n=-1,t=this.length;++n<t;)for(var e,r=this[n],i=r.length-1,u=r[i];0<=--i;)(e=r[i])&&(u&&u!==e.nextSibling&&u.parentNode.insertBefore(e,u),u=e);return this},lu.sort=function(n){n=function(e){return arguments.length||(e=o),function(n,t){return n&&t?e(n.__data__,t.__data__):!n-!t}}.apply(this,arguments);for(var t=-1,e=this.length;++t<e;)this[t].sort(n);return this.order()},lu.each=function(r){return O(this,function(n,t,e){r.call(n,n.__data__,t,e)})},lu.call=function(n){var t=Vi(arguments);return n.apply(t[0]=this,t),this},lu.empty=function(){return!this.node()},lu.node=function(){for(var n=0,t=this.length;n<t;n++)for(var e=this[n],r=0,i=e.length;r<i;r++){var u=e[r];if(u)return u}return null},lu.size=function(){var n=0;return O(this,function(){++n}),n};var fu=[];Yi.selection.enter=I,(Yi.selection.enter.prototype=fu).append=lu.append,fu.empty=lu.empty,fu.node=lu.node,fu.call=lu.call,fu.size=lu.size,fu.select=function(n){for(var t,e,r,i,u,o=[],a=-1,l=this.length;++a<l;){r=(i=this[a]).update,o.push(t=[]),t.parentNode=i.parentNode;for(var c=-1,f=i.length;++c<f;)(u=i[c])?(t.push(r[c]=e=n.call(i.parentNode,u.__data__,c,a)),e.__data__=u.__data__):t.push(null)}return _(o)},fu.insert=function(n,t){return arguments.length<2&&(t=function(o){var a,l;return function(n,t,e){var r,i=o[e].update,u=i.length;for(e!=l&&(l=e,a=0),a<=t&&(a=t+1);!(r=i[a])&&++a<u;);return r}}(this)),lu.insert.call(this,n,t)},Yi.select=function(n){var t;return"string"==typeof n?(t=[uu(n,Xi)]).parentNode=Xi.documentElement:(t=[n]).parentNode=a(n),_([t])},Yi.selectAll=function(n){var t;return"string"==typeof n?(t=Vi(ou(n,Xi))).parentNode=Xi.documentElement:(t=n).parentNode=null,_([t])},lu.on=function(n,t,e){var r=arguments.length;if(r<3){if("string"!=typeof n){for(e in r<2&&(t=!1),n)this.each(Y(e,n[e],t));return this}if(r<2)return(r=this.node()["__on"+n])&&r._;e=!1}return this.each(Y(n,t,e))};var su=Yi.map({mouseenter:"mouseover",mouseleave:"mouseout"});Xi&&su.forEach(function(n){"on"+n in Xi&&su.remove(n)});var hu,pu=0;Yi.mouse=function(n){return $(n,b())};var gu=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;Yi.touch=function(n,t,e){if(arguments.length<3&&(e=t,t=b().changedTouches),t)for(var r,i=0,u=t.length;i<u;++i)if((r=t[i]).identifier===e)return $(n,r)},Yi.behavior.drag=function(){function t(){this.on("mousedown.drag",e).on("touchstart.drag",r)}function n(f,s,h,p,g){return function(){var r,n=Yi.event.target,i=this.parentNode,u=v.of(this,arguments),o=0,a=f(),t=".drag"+(null==a?"":"-"+a),e=Yi.select(h(n)).on(p+t,function(){var n,t,e=s(i,a);e&&(n=e[0]-c[0],t=e[1]-c[1],o|=n|t,u({type:"drag",x:(c=e)[0]+r[0],y:e[1]+r[1],dx:n,dy:t}))}).on(g+t,function(){s(i,a)&&(e.on(p+t,null).on(g+t,null),l(o&&Yi.event.target===n),u({type:"dragend"}))}),l=X(n),c=s(i,a);r=d?[(r=d.apply(this,arguments)).x-c[0],r.y-c[1]]:[0,0],u({type:"dragstart"})}}var v=P(t,"drag","dragstart","dragend"),d=null,e=n(y,Yi.mouse,T,"mousemove","mouseup"),r=n(B,Yi.touch,R,"touchmove","touchend");return t.origin=function(n){return arguments.length?(d=n,t):d},Yi.rebind(t,v,"on")},Yi.touches=function(e,n){return arguments.length<2&&(n=b().touches),n?Vi(n).map(function(n){var t=$(e,n);return t.identifier=n.identifier,t}):[]};var vu=1e-6,du=vu*vu,yu=Math.PI,mu=2*yu,Mu=mu-vu,xu=yu/2,bu=yu/180,_u=180/yu,wu=Math.SQRT2;Yi.interpolateZoom=function(n,t){function e(n){var t=n*y;if(d){var e=Q(v),r=o/(2*h)*(e*function(n){return((n=Math.exp(2*n))-1)/(n+1)}(wu*t+v)-function(n){return((n=Math.exp(n))-1/n)/2}(v));return[i+r*c,u+r*f,o*e/Q(wu*t+v)]}return[i+n*c,u+n*f,o*Math.exp(wu*t)]}var i=n[0],u=n[1],o=n[2],r=t[0],a=t[1],l=t[2],c=r-i,f=a-u,s=c*c+f*f,h=Math.sqrt(s),p=(l*l-o*o+4*s)/(2*o*2*h),g=(l*l-o*o-4*s)/(2*l*2*h),v=Math.log(Math.sqrt(p*p+1)-p),d=Math.log(Math.sqrt(g*g+1)-g)-v,y=(d||Math.log(l/o))/wu;return e.duration=1e3*y,e},Yi.behavior.zoom=function(){function i(n){n.on(C,k).on(ku+".zoom",e).on("dblclick.zoom",r).on(q,N)}function a(n){return[(n[0]-A.x)/A.k,(n[1]-A.y)/A.k]}function x(n){A.k=Math.max(d[0],Math.min(d[1],n))}function b(n,t){t=function(n){return[n[0]*A.k+A.x,n[1]*A.k+A.y]}(t),A.x+=n[0]-t[0],A.y+=n[1]-t[1]}function _(n,t,e,r){n.__chart__={x:A.x,y:A.y,k:A.k},x(Math.pow(2,r)),b(c=t,e),n=Yi.select(n),0<y&&(n=n.transition().duration(y)),n.call(i.event)}function t(){h&&h.domain(s.range().map(function(n){return(n-A.x)/A.k}).map(s.invert)),g&&g.domain(p.range().map(function(n){return(n-A.y)/A.k}).map(p.invert))}function l(n){m++||n({type:"zoomstart"})}function w(n){t(),n({type:"zoom",scale:A.k,translate:[A.x,A.y]})}function S(n){--m||(n({type:"zoomend"}),c=null)}function k(){var n=this,t=Yi.event.target,e=L.of(n,arguments),r=0,i=Yi.select(T(n)).on(M,function(){r=1,b(Yi.mouse(n),u),w(e)}).on(z,function(){i.on(M,null).on(z,null),o(r&&Yi.event.target===t),S(e)}),u=a(Yi.mouse(n)),o=X(n);xa.call(n),l(e)}function N(){function f(){var n=Yi.touches(p);return c=A.k,n.forEach(function(n){n.identifier in v&&(v[n.identifier]=a(n))}),n}function n(){var n=Yi.event.target;Yi.select(n).on(y,s).on(m,h),M.push(n);for(var t=Yi.event.changedTouches,e=0,r=t.length;e<r;++e)v[t[e].identifier]=null;var i=f(),u=Date.now();if(1===i.length){if(u-E<500){var o=i[0];_(p,o,v[o.identifier],Math.floor(Math.log(A.k)/Math.LN2)+1),D()}E=u}else if(1<i.length){o=i[0];var a=i[1],l=o[0]-a[0],c=o[1]-a[1];d=l*l+c*c}}function s(){var n,t,e,r,i=Yi.touches(p);xa.call(p);for(var u=0,o=i.length;u<o;++u,r=null)if(e=i[u],r=v[e.identifier]){if(t)break;n=e,t=r}if(r){var a=(a=e[0]-n[0])*a+(a=e[1]-n[1])*a,l=d&&Math.sqrt(a/d);n=[(n[0]+e[0])/2,(n[1]+e[1])/2],t=[(t[0]+r[0])/2,(t[1]+r[1])/2],x(l*c)}E=null,b(n,t),w(g)}function h(){if(Yi.event.touches.length){for(var n=Yi.event.changedTouches,t=0,e=n.length;t<e;++t)delete v[n[t].identifier];for(var r in v)return void f()}Yi.selectAll(M).on(i,null),u.on(C,k).on(q,N),o(),S(g)}var c,p=this,g=L.of(p,arguments),v={},d=0,i=".zoom-"+Yi.event.changedTouches[0].identifier,y="touchmove"+i,m="touchend"+i,M=[],u=Yi.select(p),o=X(p);n(),l(g),u.on(C,null).on(q,n)}function e(){var n=L.of(this,arguments);f?clearTimeout(f):(xa.call(this),u=a(c=o||Yi.mouse(this)),l(n)),f=setTimeout(function(){f=null,S(n)},50),D(),x(Math.pow(2,.002*Su())*A.k),b(c,u),w(n)}function r(){var n=Yi.mouse(this),t=Math.log(A.k)/Math.LN2;_(this,n,a(n),Yi.event.shiftKey?Math.ceil(t)-1:Math.floor(t)+1)}var u,c,o,f,E,s,h,p,g,A={x:0,y:0,k:1},v=[960,500],d=Nu,y=250,m=0,C="mousedown.zoom",M="mousemove.zoom",z="mouseup.zoom",q="touchstart.zoom",L=P(i,"zoomstart","zoom","zoomend");return ku||(ku="onwheel"in Xi?(Su=function(){return-Yi.event.deltaY*(Yi.event.deltaMode?120:1)},"wheel"):"onmousewheel"in Xi?(Su=function(){return Yi.event.wheelDelta},"mousewheel"):(Su=function(){return-Yi.event.detail},"MozMousePixelScroll")),i.event=function(n){n.each(function(){var a=L.of(this,arguments),t=A;ma?Yi.select(this).transition().each("start.zoom",function(){A=this.__chart__||{x:0,y:0,k:1},l(a)}).tween("zoom:zoom",function(){var r=v[0],n=v[1],i=c?c[0]:r/2,u=c?c[1]:n/2,o=Yi.interpolateZoom([(i-A.x)/A.k,(u-A.y)/A.k,r/A.k],[(i-t.x)/t.k,(u-t.y)/t.k,r/t.k]);return function(n){var t=o(n),e=r/t[2];this.__chart__=A={x:i-t[0]*e,y:u-t[1]*e,k:e},w(a)}}).each("interrupt.zoom",function(){S(a)}).each("end.zoom",function(){S(a)}):(this.__chart__=A,l(a),w(a),S(a))})},i.translate=function(n){return arguments.length?(A={x:+n[0],y:+n[1],k:A.k},t(),i):[A.x,A.y]},i.scale=function(n){return arguments.length?(A={x:A.x,y:A.y,k:+n},t(),i):A.k},i.scaleExtent=function(n){return arguments.length?(d=null==n?Nu:[+n[0],+n[1]],i):d},i.center=function(n){return arguments.length?(o=n&&[+n[0],+n[1]],i):o},i.size=function(n){return arguments.length?(v=n&&[+n[0],+n[1]],i):v},i.duration=function(n){return arguments.length?(y=+n,i):y},i.x=function(n){return arguments.length?(s=(h=n).copy(),A={x:0,y:0,k:1},i):h},i.y=function(n){return arguments.length?(p=(g=n).copy(),A={x:0,y:0,k:1},i):g},Yi.rebind(i,L,"on")};var Su,ku,Nu=[0,1/0];(Yi.color=tn).prototype.toString=function(){return this.rgb()+""};var Eu=(Yi.hsl=en).prototype=new tn;Eu.brighter=function(n){return n=Math.pow(.7,arguments.length?n:1),new en(this.h,this.s,this.l/n)},Eu.darker=function(n){return n=Math.pow(.7,arguments.length?n:1),new en(this.h,this.s,n*this.l)},Eu.rgb=function(){return rn(this.h,this.s,this.l)};var Au=(Yi.hcl=un).prototype=new tn;Au.brighter=function(n){return new un(this.h,this.c,Math.min(100,this.l+Cu*(arguments.length?n:1)))},Au.darker=function(n){return new un(this.h,this.c,Math.max(0,this.l-Cu*(arguments.length?n:1)))},Au.rgb=function(){return on(this.h,this.c,this.l).rgb()},Yi.lab=an;var Cu=18,zu=.95047,qu=1,Lu=1.08883,Tu=an.prototype=new tn;Tu.brighter=function(n){return new an(Math.min(100,this.l+Cu*(arguments.length?n:1)),this.a,this.b)},Tu.darker=function(n){return new an(Math.max(0,this.l-Cu*(arguments.length?n:1)),this.a,this.b)},Tu.rgb=function(){return ln(this.l,this.a,this.b)};var Ru=(Yi.rgb=pn).prototype=new tn;Ru.brighter=function(n){n=Math.pow(.7,arguments.length?n:1);var t=this.r,e=this.g,r=this.b;return t||e||r?(t&&t<30&&(t=30),e&&e<30&&(e=30),r&&r<30&&(r=30),new pn(Math.min(255,t/n),Math.min(255,e/n),Math.min(255,r/n))):new pn(30,30,30)},Ru.darker=function(n){return new pn((n=Math.pow(.7,arguments.length?n:1))*this.r,n*this.g,n*this.b)},Ru.hsl=function(){return mn(this.r,this.g,this.b)},Ru.toString=function(){return"#"+dn(this.r)+dn(this.g)+dn(this.b)};var Du=Yi.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});Du.forEach(function(n,t){Du.set(n,gn(t))}),Yi.functor=_n,Yi.xhr=wn(R),Yi.dsv=function(i,u){function o(n,t,e){arguments.length<3&&(e=t,t=null);var r=Sn(n,u,null==t?a:l(t),e);return r.row=function(n){return arguments.length?r.response(null==(t=n)?a:l(n)):t},r}function a(n){return o.parse(n.responseText)}function l(t){return function(n){return o.parse(n.responseText,t)}}function t(n){return n.map(c).join(i)}function c(n){return e.test(n)?'"'+n.replace(/\"/g,'""')+'"':n}var e=new RegExp('["'+i+"\n]"),h=i.charCodeAt(0);return o.parse=function(n,r){var i;return o.parseRows(n,function(n,t){if(i)return i(n,t-1);var e=new Function("d","return {"+n.map(function(n,t){return JSON.stringify(n)+": d["+t+"]"}).join(",")+"}");i=r?function(n,t){return r(e(n),t)}:e})},o.parseRows=function(i,n){function t(){if(l<=c)return a;if(u)return u=!1,o;var n=c;if(34===i.charCodeAt(n)){for(var t=n;t++<l;)if(34===i.charCodeAt(t)){if(34!==i.charCodeAt(t+1))break;++t}return c=t+2,13===(e=i.charCodeAt(t+1))?(u=!0,10===i.charCodeAt(t+2)&&++c):10===e&&(u=!0),i.slice(n+1,t).replace(/""/g,'"')}for(;c<l;){var e,r=1;if(10===(e=i.charCodeAt(c++)))u=!0;else if(13===e)u=!0,10===i.charCodeAt(c)&&(++c,++r);else if(e!==h)continue;return i.slice(n,c-r)}return i.slice(n)}for(var e,u,o={},a={},r=[],l=i.length,c=0,f=0;(e=t())!==a;){for(var s=[];e!==o&&e!==a;)s.push(e),e=t();n&&null==(s=n(s,f++))||r.push(s)}return r},o.format=function(n){if(Array.isArray(n[0]))return o.formatRows(n);var e=new g,r=[];return n.forEach(function(n){for(var t in n)e.has(t)||r.push(e.add(t))}),[r.map(c).join(i)].concat(n.map(function(t){return r.map(function(n){return c(t[n])}).join(i)})).join("\n")},o.formatRows=function(n){return n.map(t).join("\n")},o},Yi.csv=Yi.dsv(",","text/csv"),Yi.tsv=Yi.dsv("\t","text/tab-separated-values");var Pu,Uu,ju,Fu,Hu,Ou=this[d(this,"requestAnimationFrame")]||function(n){setTimeout(n,17)};Yi.timer=function(n,t,e){var r=arguments.length;r<2&&(t=0),r<3&&(e=Date.now());var i={c:n,t:e+t,f:!1,n:null};Uu?Uu.n=i:Pu=i,Uu=i,ju||(Fu=clearTimeout(Fu),ju=1,Ou(kn))},Yi.timer.flush=function(){Nn(),En()},Yi.round=function(n,t){return t?Math.round(n*(t=Math.pow(10,t)))/t:Math.round(n)};var Iu=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"].map(function(n,t){var e=Math.pow(10,3*Qi(8-t));return{scale:8<t?function(n){return n/e}:function(n){return n*e},symbol:n}});Yi.formatPrefix=function(n,t){var e=0;return n&&(n<0&&(n*=-1),t&&(n=Yi.round(n,An(n,t))),e=1+Math.floor(1e-12+Math.log(n)/Math.LN10),e=Math.max(-24,Math.min(24,3*Math.floor((e-1)/3)))),Iu[8+e/3]};var Yu=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,Zu=Yi.map({b:function(n){return n.toString(2)},c:function(n){return String.fromCharCode(n)},o:function(n){return n.toString(8)},x:function(n){return n.toString(16)},X:function(n){return n.toString(16).toUpperCase()},g:function(n,t){return n.toPrecision(t)},e:function(n,t){return n.toExponential(t)},f:function(n,t){return n.toFixed(t)},r:function(n,t){return(n=Yi.round(n,An(n,t))).toFixed(Math.max(0,Math.min(20,An(n*(1+1e-15),t))))}}),Vu=Yi.time={},Xu=Date;zn.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){$u.setUTCDate.apply(this._,arguments)},setDay:function(){$u.setUTCDay.apply(this._,arguments)},setFullYear:function(){$u.setUTCFullYear.apply(this._,arguments)},setHours:function(){$u.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){$u.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){$u.setUTCMinutes.apply(this._,arguments)},setMonth:function(){$u.setUTCMonth.apply(this._,arguments)},setSeconds:function(){$u.setUTCSeconds.apply(this._,arguments)},setTime:function(){$u.setTime.apply(this._,arguments)}};var $u=Date.prototype;Vu.year=qn(function(n){return(n=Vu.day(n)).setMonth(0,1),n},function(n,t){n.setFullYear(n.getFullYear()+t)},function(n){return n.getFullYear()}),Vu.years=Vu.year.range,Vu.years.utc=Vu.year.utc.range,Vu.day=qn(function(n){var t=new Xu(2e3,0);return t.setFullYear(n.getFullYear(),n.getMonth(),n.getDate()),t},function(n,t){n.setDate(n.getDate()+t)},function(n){return n.getDate()-1}),Vu.days=Vu.day.range,Vu.days.utc=Vu.day.utc.range,Vu.dayOfYear=function(n){var t=Vu.year(n);return Math.floor((n-t-6e4*(n.getTimezoneOffset()-t.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(n,e){e=7-e;var t=Vu[n]=qn(function(n){return(n=Vu.day(n)).setDate(n.getDate()-(n.getDay()+e)%7),n},function(n,t){n.setDate(n.getDate()+7*Math.floor(t))},function(n){var t=Vu.year(n).getDay();return Math.floor((Vu.dayOfYear(n)+(t+e)%7)/7)-(t!==e)});Vu[n+"s"]=t.range,Vu[n+"s"].utc=t.utc.range,Vu[n+"OfYear"]=function(n){var t=Vu.year(n).getDay();return Math.floor((Vu.dayOfYear(n)+(t+e)%7)/7)}}),Vu.week=Vu.sunday,Vu.weeks=Vu.sunday.range,Vu.weeks.utc=Vu.sunday.utc.range,Vu.weekOfYear=Vu.sundayOfYear;var Bu={"-":"",_:" ",0:"0"},Wu=/^\s*\d+/,Ju=/^%/;Yi.locale=function(n){return{numberFormat:function(n){var S=n.decimal,a=n.thousands,l=n.grouping,r=n.currency,k=l&&a?function(n,t){for(var e=n.length,r=[],i=0,u=l[0],o=0;0<e&&0<u&&(t<o+u+1&&(u=Math.max(1,t-o)),r.push(n.substring(e-=u,e+u)),!((o+=u+1)>t));)u=l[i=(i+1)%l.length];return r.reverse().join(a)}:R;return function(n){var t=Yu.exec(n),f=t[1]||" ",s=t[2]||">",h=t[3]||"-",e=t[4]||"",p=t[5],g=+t[6],v=t[7],d=t[8],y=t[9],m=1,M="",x="",b=!1,_=!0;switch(d&&(d=+d.substring(1)),(p||"0"===f&&"="===s)&&(p=f="0",s="="),y){case"n":v=!0,y="g";break;case"%":m=100,x="%",y="f";break;case"p":m=100,x="%",y="r";break;case"b":case"o":case"x":case"X":"#"===e&&(M="0"+y.toLowerCase());case"c":_=!1;case"d":b=!0,d=0;break;case"s":m=-1,y="r"}"$"===e&&(M=r[0],x=r[1]),"r"!=y||d||(y="g"),null!=d&&("g"==y?d=Math.max(1,Math.min(21,d)):("e"==y||"f"==y)&&(d=Math.max(0,Math.min(20,d)))),y=Zu.get(y)||Cn;var w=p&&v;return function(n){var t=x;if(b&&n%1)return"";var e=n<0||0===n&&1/n<0?(n=-n,"-"):"-"===h?"":h;if(m<0){var r=Yi.formatPrefix(n,d);n=r.scale(n),t=r.symbol+x}else n*=m;var i,u,o=(n=y(n,d)).lastIndexOf(".");if(o<0){var a=_?n.lastIndexOf("e"):-1;u=a<0?(i=n,""):(i=n.substring(0,a),n.substring(a))}else i=n.substring(0,o),u=S+n.substring(o+1);!p&&v&&(i=k(i,1/0));var l=M.length+i.length+u.length+(w?0:e.length),c=l<g?new Array(l=g-l+1).join(f):"";return w&&(i=k(c+i,c.length?g-u.length:1/0)),e+=M,n=i+u,("<"===s?e+n+c:">"===s?c+e+n:"^"===s?c.substring(0,l>>=1)+e+n+c.substring(l):e+(w?n:c+n))+t}}}(n),timeFormat:function(n){function r(a){function n(n){for(var t,e,r,i=[],u=-1,o=0;++u<l;)37===a.charCodeAt(u)&&(i.push(a.slice(o,u)),null!=(e=Bu[t=a.charAt(++u)])&&(t=a.charAt(++u)),(r=x[t])&&(t=r(n,null==e?"e"===t?" ":"0":e)),i.push(t),o=u+1);return i.push(a.slice(o,u)),i.join("")}var l=a.length;return n.parse=function(n){var t={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null};if(i(t,a,n,0)!=n.length)return null;"p"in t&&(t.H=t.H%12+12*t.p);var e=null!=t.Z&&Xu!==zn,r=new(e?zn:Xu);return"j"in t?r.setFullYear(t.y,0,t.j):"w"in t&&("W"in t||"U"in t)?(r.setFullYear(t.y,0,1),r.setFullYear(t.y,0,"W"in t?(t.w+6)%7+7*t.W-(r.getDay()+5)%7:t.w+7*t.U-(r.getDay()+6)%7)):r.setFullYear(t.y,t.m,t.d),r.setHours(t.H+(t.Z/100|0),t.M+t.Z%100,t.S,t.L),e?r._:r},n.toString=function(){return a},n}function i(n,t,e,r){for(var i,u,o,a=0,l=t.length,c=e.length;a<l;){if(c<=r)return-1;if(37===(i=t.charCodeAt(a++))){if(o=t.charAt(a++),!(u=b[o in Bu?t.charAt(a++):o])||(r=u(n,e,r))<0)return-1}else if(i!=e.charCodeAt(r++))return-1}return r}var t=n.dateTime,e=n.date,u=n.time,o=n.periods,a=n.days,l=n.shortDays,c=n.months,f=n.shortMonths;r.multi=(r.utc=function(n){function t(n){try{var t=new(Xu=zn);return t._=n,e(t)}finally{Xu=Date}}var e=r(n);return t.parse=function(n){try{Xu=zn;var t=e.parse(n);return t&&t._}finally{Xu=Date}},t.toString=e.toString,t}).multi=Gn;var s=Yi.map(),h=Rn(a),p=Dn(a),g=Rn(l),v=Dn(l),d=Rn(c),y=Dn(c),m=Rn(f),M=Dn(f);o.forEach(function(n,t){s.set(n.toLowerCase(),t)});var x={a:function(n){return l[n.getDay()]},A:function(n){return a[n.getDay()]},b:function(n){return f[n.getMonth()]},B:function(n){return c[n.getMonth()]},c:r(t),d:function(n,t){return Tn(n.getDate(),t,2)},e:function(n,t){return Tn(n.getDate(),t,2)},H:function(n,t){return Tn(n.getHours(),t,2)},I:function(n,t){return Tn(n.getHours()%12||12,t,2)},j:function(n,t){return Tn(1+Vu.dayOfYear(n),t,3)},L:function(n,t){return Tn(n.getMilliseconds(),t,3)},m:function(n,t){return Tn(n.getMonth()+1,t,2)},M:function(n,t){return Tn(n.getMinutes(),t,2)},p:function(n){return o[+(12<=n.getHours())]},S:function(n,t){return Tn(n.getSeconds(),t,2)},U:function(n,t){return Tn(Vu.sundayOfYear(n),t,2)},w:function(n){return n.getDay()},W:function(n,t){return Tn(Vu.mondayOfYear(n),t,2)},x:r(e),X:r(u),y:function(n,t){return Tn(n.getFullYear()%100,t,2)},Y:function(n,t){return Tn(n.getFullYear()%1e4,t,4)},Z:Wn,"%":function(){return"%"}},b={a:function(n,t,e){g.lastIndex=0;var r=g.exec(t.slice(e));return r?(n.w=v.get(r[0].toLowerCase()),e+r[0].length):-1},A:function(n,t,e){h.lastIndex=0;var r=h.exec(t.slice(e));return r?(n.w=p.get(r[0].toLowerCase()),e+r[0].length):-1},b:function(n,t,e){m.lastIndex=0;var r=m.exec(t.slice(e));return r?(n.m=M.get(r[0].toLowerCase()),e+r[0].length):-1},B:function(n,t,e){d.lastIndex=0;var r=d.exec(t.slice(e));return r?(n.m=y.get(r[0].toLowerCase()),e+r[0].length):-1},c:function(n,t,e){return i(n,x.c.toString(),t,e)},d:Yn,e:Yn,H:Vn,I:Vn,j:Zn,L:Bn,m:In,M:Xn,p:function(n,t,e){var r=s.get(t.slice(e,e+=2).toLowerCase());return null==r?-1:(n.p=r,e)},S:$n,U:Un,w:Pn,W:jn,x:function(n,t,e){return i(n,x.x.toString(),t,e)},X:function(n,t,e){return i(n,x.X.toString(),t,e)},y:Hn,Y:Fn,Z:On,"%":Jn};return r}(n)}};var Gu=Yi.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});Yi.format=Gu.numberFormat,Yi.geo={},Kn.prototype={s:0,t:0,add:function(n){Qn(n,this.t,Ku),Qn(Ku.s,this.s,this),this.s?this.t+=Ku.t:this.s=Ku.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var Ku=new Kn;Yi.geo.stream=function(n,t){n&&Qu.hasOwnProperty(n.type)?Qu[n.type](n,t):nt(n,t)};var Qu={Feature:function(n,t){nt(n.geometry,t)},FeatureCollection:function(n,t){for(var e=n.features,r=-1,i=e.length;++r<i;)nt(e[r].geometry,t)}},no={Sphere:function(n,t){t.sphere()},Point:function(n,t){n=n.coordinates,t.point(n[0],n[1],n[2])},MultiPoint:function(n,t){for(var e=n.coordinates,r=-1,i=e.length;++r<i;)n=e[r],t.point(n[0],n[1],n[2])},LineString:function(n,t){tt(n.coordinates,t,0)},MultiLineString:function(n,t){for(var e=n.coordinates,r=-1,i=e.length;++r<i;)tt(e[r],t,0)},Polygon:function(n,t){et(n.coordinates,t)},MultiPolygon:function(n,t){for(var e=n.coordinates,r=-1,i=e.length;++r<i;)et(e[r],t)},GeometryCollection:function(n,t){for(var e=n.geometries,r=-1,i=e.length;++r<i;)nt(e[r],t)}};Yi.geo.area=function(n){return to=0,Yi.geo.stream(n,ro),to};var to,eo=new Kn,ro={sphere:function(){to+=4*yu},point:y,lineStart:y,lineEnd:y,polygonStart:function(){eo.reset(),ro.lineStart=rt},polygonEnd:function(){var n=2*eo;to+=n<0?4*yu+n:n,ro.lineStart=ro.lineEnd=ro.point=y}};Yi.geo.bounds=function(){function f(n,t){M.push(x=[h=n,g=n]),t<p&&(p=t),v<t&&(v=t)}function r(n,t){var e=it([n*bu,t*bu]);if(y){var r=ot(y,e),i=ot([r[1],-r[0],0],r);ct(i),i=ft(i);var u=n-d,o=0<u?1:-1,a=i[0]*_u*o,l=180<Qi(u);if(l^(o*d<a&&a<o*n)){var c=i[1]*_u;v<c&&(v=c)}else if(l^(o*d<(a=(a+360)%360-180)&&a<o*n)){(c=-i[1]*_u)<p&&(p=c)}else t<p&&(p=t),v<t&&(v=t);l?n<d?s(h,n)>s(h,g)&&(g=n):s(n,g)>s(h,g)&&(h=n):h<=g?(n<h&&(h=n),g<n&&(g=n)):d<n?s(h,n)>s(h,g)&&(g=n):s(n,g)>s(h,g)&&(h=n)}else f(n,t);y=e,d=n}function n(){b.point=r}function t(){x[0]=h,x[1]=g,b.point=f,y=null}function e(n,t){if(y){var e=n-d;m+=180<Qi(e)?e+(0<e?360:-360):e}else o=n,a=t;ro.point(n,t),r(n,t)}function i(){ro.lineStart()}function u(){e(o,a),ro.lineEnd(),Qi(m)>vu&&(h=-(g=180)),x[0]=h,x[1]=g,y=null}function s(n,t){return(t-=n)<0?t+360:t}function l(n,t){return n[0]-t[0]}function c(n,t){return t[0]<=t[1]?t[0]<=n&&n<=t[1]:n<t[0]||t[1]<n}var h,p,g,v,d,o,a,y,m,M,x,b={point:f,lineStart:n,lineEnd:t,polygonStart:function(){b.point=e,b.lineStart=i,b.lineEnd=u,m=0,ro.polygonStart()},polygonEnd:function(){ro.polygonEnd(),b.point=f,b.lineStart=n,b.lineEnd=t,eo<0?(h=-(g=180),p=-(v=90)):vu<m?v=90:m<-vu&&(p=-90),x[0]=h,x[1]=g}};return function(n){if(v=g=-(h=p=1/0),M=[],Yi.geo.stream(n,b),u=M.length){M.sort(l);for(var t=1,e=[a=M[0]];t<u;++t)c((i=M[t])[0],a)||c(i[1],a)?(s(a[0],i[1])>s(a[0],a[1])&&(a[1]=i[1]),s(i[0],a[1])>s(a[0],a[1])&&(a[0]=i[0])):e.push(a=i);for(var r,i,u,o=-1/0,a=(t=0,e[u=e.length-1]);t<=u;a=i,++t)i=e[t],(r=s(a[1],i[0]))>o&&(o=r,h=i[0],g=a[1])}return M=x=null,1/0===h||1/0===p?[[NaN,NaN],[NaN,NaN]]:[[h,p],[g,v]]}}(),Yi.geo.centroid=function(n){io=uo=oo=ao=lo=co=fo=so=ho=po=go=0,Yi.geo.stream(n,vo);var t=ho,e=po,r=go,i=t*t+e*e+r*r;return i<du&&(t=co,e=fo,r=so,uo<vu&&(t=oo,e=ao,r=lo),(i=t*t+e*e+r*r)<du)?[NaN,NaN]:[Math.atan2(e,t)*_u,K(r/Math.sqrt(i))*_u]};var io,uo,oo,ao,lo,co,fo,so,ho,po,go,vo={sphere:y,point:ht,lineStart:gt,lineEnd:vt,polygonStart:function(){vo.lineStart=dt},polygonEnd:function(){vo.lineStart=gt}},yo=_t(mt,function(i){var u,o=NaN,a=NaN,l=NaN;return{lineStart:function(){i.lineStart(),u=1},point:function(n,t){var e=0<n?yu:-yu,r=Qi(n-o);Qi(r-yu)<vu?(i.point(o,a=0<(a+t)/2?xu:-xu),i.point(l,a),i.lineEnd(),i.lineStart(),i.point(e,a),i.point(n,a),u=0):l!==e&&yu<=r&&(Qi(o-l)<vu&&(o-=l*vu),Qi(n-e)<vu&&(n-=e*vu),a=function(n,t,e,r){var i,u,o=Math.sin(n-e);return Qi(o)>vu?Math.atan((Math.sin(t)*(u=Math.cos(r))*Math.sin(e)-Math.sin(r)*(i=Math.cos(t))*Math.sin(n))/(i*u*o)):(t+r)/2}(o,a,n,t),i.point(l,a),i.lineEnd(),i.lineStart(),i.point(e,a),u=0),i.point(o=n,a=t),l=e},lineEnd:function(){i.lineEnd(),o=a=NaN},clean:function(){return 2-u}}},function(n,t,e,r){var i;if(null==n)i=e*xu,r.point(-yu,i),r.point(0,i),r.point(yu,i),r.point(yu,0),r.point(yu,-i),r.point(0,-i),r.point(-yu,-i),r.point(-yu,0),r.point(-yu,i);else if(Qi(n[0]-t[0])>vu){var u=n[0]<t[0]?yu:-yu;i=e*u/2,r.point(-u,i),r.point(0,i),r.point(u,i)}else r.point(t[0],t[1])},[-yu,-yu/2]),mo=1e9;Yi.geo.clipExtent=function(){var t,e,r,i,u,o,a={stream:function(n){return u&&(u.valid=!1),(u=o(n)).valid=!0,u},extent:function(n){return arguments.length?(o=Et(t=+n[0][0],e=+n[0][1],r=+n[1][0],i=+n[1][1]),u&&(u.valid=!1,u=null),a):[[t,e],[r,i]]}};return a.extent([[0,0],[960,500]])},(Yi.geo.conicEqualArea=function(){return At(Ct)}).raw=Ct,Yi.geo.albers=function(){return Yi.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},Yi.geo.albersUsa=function(){function i(n){var t=n[0],e=n[1];return r=null,u(t,e),r||(o(t,e),r)||a(t,e),r}var r,u,o,a,l=Yi.geo.albers(),c=Yi.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),f=Yi.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),s={point:function(n,t){r=[n,t]}};return i.invert=function(n){var t=l.scale(),e=l.translate(),r=(n[0]-e[0])/t,i=(n[1]-e[1])/t;return(.12<=i&&i<.234&&-.425<=r&&r<-.214?c:.166<=i&&i<.234&&-.214<=r&&r<-.115?f:l).invert(n)},i.stream=function(n){var e=l.stream(n),r=c.stream(n),i=f.stream(n);return{point:function(n,t){e.point(n,t),r.point(n,t),i.point(n,t)},sphere:function(){e.sphere(),r.sphere(),i.sphere()},lineStart:function(){e.lineStart(),r.lineStart(),i.lineStart()},lineEnd:function(){e.lineEnd(),r.lineEnd(),i.lineEnd()},polygonStart:function(){e.polygonStart(),r.polygonStart(),i.polygonStart()},polygonEnd:function(){e.polygonEnd(),r.polygonEnd(),i.polygonEnd()}}},i.precision=function(n){return arguments.length?(l.precision(n),c.precision(n),f.precision(n),i):l.precision()},i.scale=function(n){return arguments.length?(l.scale(n),c.scale(.35*n),f.scale(n),i.translate(l.translate())):l.scale()},i.translate=function(n){if(!arguments.length)return l.translate();var t=l.scale(),e=+n[0],r=+n[1];return u=l.translate(n).clipExtent([[e-.455*t,r-.238*t],[e+.455*t,r+.238*t]]).stream(s).point,o=c.translate([e-.307*t,r+.201*t]).clipExtent([[e-.425*t+vu,r+.12*t+vu],[e-.214*t-vu,r+.234*t-vu]]).stream(s).point,a=f.translate([e-.205*t,r+.212*t]).clipExtent([[e-.214*t+vu,r+.166*t+vu],[e-.115*t-vu,r+.234*t-vu]]).stream(s).point,i},i.scale(1070)};var Mo,xo,bo,_o,wo,So,ko={point:y,lineStart:y,lineEnd:y,polygonStart:function(){xo=0,ko.lineStart=zt},polygonEnd:function(){ko.lineStart=ko.lineEnd=ko.point=y,Mo+=Qi(xo/2)}},No={point:function(n,t){n<bo&&(bo=n),wo<n&&(wo=n),t<_o&&(_o=t),So<t&&(So=t)},lineStart:y,lineEnd:y,polygonStart:y,polygonEnd:y},Eo={point:Tt,lineStart:Rt,lineEnd:Dt,polygonStart:function(){Eo.lineStart=Pt},polygonEnd:function(){Eo.point=Tt,Eo.lineStart=Rt,Eo.lineEnd=Dt}};Yi.geo.path=function(){function t(n){return n&&("function"==typeof l&&o.pointRadius(+l.apply(this,arguments)),a&&a.valid||(a=u(o)),Yi.geo.stream(n,a)),o.result()}function e(){return a=null,t}var r,i,u,o,a,l=4.5;return t.area=function(n){return Mo=0,Yi.geo.stream(n,u(ko)),Mo},t.centroid=function(n){return oo=ao=lo=co=fo=so=ho=po=go=0,Yi.geo.stream(n,u(Eo)),go?[ho/go,po/go]:so?[co/so,fo/so]:lo?[oo/lo,ao/lo]:[NaN,NaN]},t.bounds=function(n){return wo=So=-(bo=_o=1/0),Yi.geo.stream(n,u(No)),[[bo,_o],[wo,So]]},t.projection=function(n){return arguments.length?(u=(r=n)?n.stream||function(e){var t=jt(function(n,t){return e([n*_u,t*_u])});return function(n){return Yt(t(n))}}(n):R,e()):r},t.context=function(n){return arguments.length?(o=null==(i=n)?new qt:new Ut(n),"function"!=typeof l&&o.pointRadius(l),e()):i},t.pointRadius=function(n){return arguments.length?(l="function"==typeof n?n:(o.pointRadius(+n),+n),t):l},t.projection(Yi.geo.albersUsa()).context(null)},Yi.geo.transform=function(r){return{stream:function(n){var t=new Ft(n);for(var e in r)t[e]=r[e];return t}}},Ft.prototype={point:function(n,t){this.stream.point(n,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},Yi.geo.projection=Ot,Yi.geo.projectionMutator=It,(Yi.geo.equirectangular=function(){return Ot(Zt)}).raw=Zt.invert=Zt,Yi.geo.rotation=function(t){function n(n){return(n=t(n[0]*bu,n[1]*bu))[0]*=_u,n[1]*=_u,n}return t=Xt(t[0]%360*bu,t[1]*bu,2<t.length?t[2]*bu:0),n.invert=function(n){return(n=t.invert(n[0]*bu,n[1]*bu))[0]*=_u,n[1]*=_u,n},n},Vt.invert=Zt,Yi.geo.circle=function(){function t(){var n="function"==typeof u?u.apply(this,arguments):u,e=Xt(-n[0]*bu,-n[1]*bu,0).invert,r=[];return i(null,null,1,{point:function(n,t){r.push(n=e(n,t)),n[0]*=_u,n[1]*=_u}}),{type:"Polygon",coordinates:[r]}}var e,i,u=[0,0],r=6;return t.origin=function(n){return arguments.length?(u=n,t):u},t.angle=function(n){return arguments.length?(i=Jt((e=+n)*bu,r*bu),t):e},t.precision=function(n){return arguments.length?(i=Jt(e*bu,(r=+n)*bu),t):r},t.angle(90)},Yi.geo.distance=function(n,t){var e,r=(t[0]-n[0])*bu,i=n[1]*bu,u=t[1]*bu,o=Math.sin(r),a=Math.cos(r),l=Math.sin(i),c=Math.cos(i),f=Math.sin(u),s=Math.cos(u);return Math.atan2(Math.sqrt((e=s*o)*e+(e=c*f-l*s*a)*e),l*f+c*s*a)},Yi.geo.graticule=function(){function t(){return{type:"MultiLineString",coordinates:n()}}function n(){return Yi.range(Math.ceil(u/d)*d,i,d).map(h).concat(Yi.range(Math.ceil(c/y)*y,l,y).map(p)).concat(Yi.range(Math.ceil(r/g)*g,e,g).filter(function(n){return Qi(n%d)>vu}).map(f)).concat(Yi.range(Math.ceil(a/v)*v,o,v).filter(function(n){return Qi(n%y)>vu}).map(s))}var e,r,i,u,o,a,l,c,f,s,h,p,g=10,v=g,d=90,y=360,m=2.5;return t.lines=function(){return n().map(function(n){return{type:"LineString",coordinates:n}})},t.outline=function(){return{type:"Polygon",coordinates:[h(u).concat(p(l).slice(1),h(i).reverse().slice(1),p(c).reverse().slice(1))]}},t.extent=function(n){return arguments.length?t.majorExtent(n).minorExtent(n):t.minorExtent()},t.majorExtent=function(n){return arguments.length?(u=+n[0][0],i=+n[1][0],c=+n[0][1],l=+n[1][1],i<u&&(n=u,u=i,i=n),l<c&&(n=c,c=l,l=n),t.precision(m)):[[u,c],[i,l]]},t.minorExtent=function(n){return arguments.length?(r=+n[0][0],e=+n[1][0],a=+n[0][1],o=+n[1][1],e<r&&(n=r,r=e,e=n),o<a&&(n=a,a=o,o=n),t.precision(m)):[[r,a],[e,o]]},t.step=function(n){return arguments.length?t.majorStep(n).minorStep(n):t.minorStep()},t.majorStep=function(n){return arguments.length?(d=+n[0],y=+n[1],t):[d,y]},t.minorStep=function(n){return arguments.length?(g=+n[0],v=+n[1],t):[g,v]},t.precision=function(n){return arguments.length?(m=+n,f=Kt(a,o,90),s=Qt(r,e,m),h=Kt(c,l,90),p=Qt(u,i,m),t):m},t.majorExtent([[-180,-90+vu],[180,90-vu]]).minorExtent([[-180,-80-vu],[180,80+vu]])},Yi.geo.greatArc=function(){function t(){return{type:"LineString",coordinates:[e||i.apply(this,arguments),r||u.apply(this,arguments)]}}var e,r,i=ne,u=te;return t.distance=function(){return Yi.geo.distance(e||i.apply(this,arguments),r||u.apply(this,arguments))},t.source=function(n){return arguments.length?(e="function"==typeof(i=n)?null:n,t):i},t.target=function(n){return arguments.length?(r="function"==typeof(u=n)?null:n,t):u},t.precision=function(){return arguments.length?t:0},t},Yi.geo.interpolate=function(n,t){return function(n,t,e,r){var i=Math.cos(t),o=Math.sin(t),u=Math.cos(r),a=Math.sin(r),l=i*Math.cos(n),c=i*Math.sin(n),f=u*Math.cos(e),s=u*Math.sin(e),h=2*Math.asin(Math.sqrt(nn(r-t)+i*u*nn(e-n))),p=1/Math.sin(h),g=h?function(n){var t=Math.sin(n*=h)*p,e=Math.sin(h-n)*p,r=e*l+t*f,i=e*c+t*s,u=e*o+t*a;return[Math.atan2(i,r)*_u,Math.atan2(u,Math.sqrt(r*r+i*i))*_u]}:function(){return[n*_u,t*_u]};return g.distance=h,g}(n[0]*bu,n[1]*bu,t[0]*bu,t[1]*bu)},Yi.geo.length=function(n){return Ao=0,Yi.geo.stream(n,Co),Ao};var Ao,Co={sphere:y,point:y,lineStart:function(){function e(n,t){var e=Math.sin(t*=bu),r=Math.cos(t),i=Qi((n*=bu)-o),u=Math.cos(i);Ao+=Math.atan2(Math.sqrt((i=r*Math.sin(i))*i+(i=l*e-a*r*u)*i),a*e+l*r*u),o=n,a=e,l=r}var o,a,l;Co.point=function(n,t){o=n*bu,a=Math.sin(t*=bu),l=Math.cos(t),Co.point=e},Co.lineEnd=function(){Co.point=Co.lineEnd=y}},lineEnd:y,polygonStart:y,polygonEnd:y},zo=ee(function(n){return Math.sqrt(2/(1+n))},function(n){return 2*Math.asin(n/2)});(Yi.geo.azimuthalEqualArea=function(){return Ot(zo)}).raw=zo;var qo=ee(function(n){var t=Math.acos(n);return t&&t/Math.sin(t)},R);(Yi.geo.azimuthalEquidistant=function(){return Ot(qo)}).raw=qo,(Yi.geo.conicConformal=function(){return At(re)}).raw=re,(Yi.geo.conicEquidistant=function(){return At(ie)}).raw=ie;var Lo=ee(function(n){return 1/n},Math.atan);(Yi.geo.gnomonic=function(){return Ot(Lo)}).raw=Lo,ue.invert=function(n,t){return[n,2*Math.atan(Math.exp(t))-xu]},(Yi.geo.mercator=function(){return oe(ue)}).raw=ue;var To=ee(function(){return 1},Math.asin);(Yi.geo.orthographic=function(){return Ot(To)}).raw=To;var Ro=ee(function(n){return 1/(1+n)},function(n){return 2*Math.atan(n)});(Yi.geo.stereographic=function(){return Ot(Ro)}).raw=Ro,ae.invert=function(n,t){return[-t,2*Math.atan(Math.exp(n))-xu]},(Yi.geo.transverseMercator=function(){var n=oe(ae),t=n.center,e=n.rotate;return n.center=function(n){return n?t([-n[1],n[0]]):[(n=t())[1],-n[0]]},n.rotate=function(n){return n?e([n[0],n[1],2<n.length?n[2]+90:90]):[(n=e())[0],n[1],n[2]-90]},e([0,0,90])}).raw=ae,Yi.geom={},Yi.geom.hull=function(n){function t(n){if(n.length<3)return[];var t,e=_n(h),r=_n(p),i=n.length,u=[],o=[];for(t=0;t<i;t++)u.push([+e.call(this,n[t],t),+r.call(this,n[t],t),t]);for(u.sort(se),t=0;t<i;t++)o.push([u[t][0],-u[t][1]]);var a=fe(u),l=fe(o),c=l[0]===a[0],f=l[l.length-1]===a[a.length-1],s=[];for(t=a.length-1;0<=t;--t)s.push(n[u[a[t]][2]]);for(t=+c;t<l.length-f;++t)s.push(n[u[l[t]][2]]);return s}var h=le,p=ce;return arguments.length?t(n):(t.x=function(n){return arguments.length?(h=n,t):h},t.y=function(n){return arguments.length?(p=n,t):p},t)},Yi.geom.polygon=function(n){return iu(n,Do),n};var Do=Yi.geom.polygon.prototype=[];Do.area=function(){for(var n,t=-1,e=this.length,r=this[e-1],i=0;++t<e;)n=r,r=this[t],i+=n[1]*r[0]-n[0]*r[1];return.5*i},Do.centroid=function(n){var t,e,r=-1,i=this.length,u=0,o=0,a=this[i-1];for(arguments.length||(n=-1/(6*this.area()));++r<i;)t=a,a=this[r],e=t[0]*a[1]-a[0]*t[1],u+=(t[0]+a[0])*e,o+=(t[1]+a[1])*e;return[u*n,o*n]},Do.clip=function(n){for(var t,e,r,i,u,o,a=ge(n),l=-1,c=this.length-ge(this),f=this[c-1];++l<c;){for(t=n.slice(),n.length=0,i=this[l],u=t[(r=t.length-a)-1],e=-1;++e<r;)he(o=t[e],f,i)?(he(u,f,i)||n.push(pe(u,o,f,i)),n.push(o)):he(u,f,i)&&n.push(pe(u,o,f,i)),u=o;a&&n.push(n[0]),f=i}return n};var Po,Uo,jo,Fo,Ho,Oo=[],Io=[];_e.prototype.prepare=function(){for(var n,t=this.edges,e=t.length;e--;)(n=t[e].edge).b&&n.a||t.splice(e,1);return t.sort(we),t.length},qe.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},Le.prototype={insert:function(n,t){var e,r,i;if(n){if(t.P=n,t.N=n.N,n.N&&(n.N.P=t),n.N=t,n.R){for(n=n.R;n.L;)n=n.L;n.L=t}else n.R=t;e=n}else e=this._?(n=Pe(this._),t.P=null,(t.N=n).P=n.L=t,n):(t.P=t.N=null,this._=t,null);for(t.L=t.R=null,t.U=e,t.C=!0,n=t;e&&e.C;)e===(r=e.U).L?(i=r.R)&&i.C?(e.C=i.C=!1,r.C=!0,n=r):(n===e.R&&(Re(this,e),e=(n=e).U),e.C=!1,r.C=!0,De(this,r)):(i=r.L)&&i.C?(e.C=i.C=!1,r.C=!0,n=r):(n===e.L&&(De(this,e),e=(n=e).U),e.C=!1,r.C=!0,Re(this,r)),e=n.U;this._.C=!1},remove:function(n){n.N&&(n.N.P=n.P),n.P&&(n.P.N=n.N),n.N=n.P=null;var t,e,r,i=n.U,u=n.L,o=n.R;if(e=u?o?Pe(o):u:o,i?i.L===n?i.L=e:i.R=e:this._=e,u&&o?(r=e.C,e.C=n.C,((e.L=u).U=e)!==o?(i=e.U,e.U=n.U,n=e.R,i.L=n,(e.R=o).U=e):(e.U=i,n=(i=e).R)):(r=n.C,n=e),n&&(n.U=i),!r){if(n&&n.C)return void(n.C=!1);do{if(n===this._)break;if(n===i.L){if((t=i.R).C&&(t.C=!1,i.C=!0,Re(this,i),t=i.R),t.L&&t.L.C||t.R&&t.R.C){t.R&&t.R.C||(t.L.C=!1,t.C=!0,De(this,t),t=i.R),t.C=i.C,i.C=t.R.C=!1,Re(this,i),n=this._;break}}else if((t=i.L).C&&(t.C=!1,i.C=!0,De(this,i),t=i.L),t.L&&t.L.C||t.R&&t.R.C){t.L&&t.L.C||(t.R.C=!1,t.C=!0,Re(this,t),t=i.L),t.C=i.C,i.C=t.L.C=!1,De(this,i),n=this._;break}t.C=!0,i=(n=i).U}while(!n.C);n&&(n.C=!1)}}},Yi.geom.voronoi=function(n){function t(i){var u=new Array(i.length),o=f[0][0],a=f[0][1],l=f[1][0],c=f[1][1];return Ue(e(i),f).cells.forEach(function(n,t){var e=n.edges,r=n.site;(u[t]=e.length?e.map(function(n){var t=n.start();return[t.x,t.y]}):r.x>=o&&r.x<=l&&r.y>=a&&r.y<=c?[[o,c],[l,c],[l,a],[o,a]]:[]).point=i[t]}),u}function e(n){return n.map(function(n,t){return{x:Math.round(u(n,t)/vu)*vu,y:Math.round(o(n,t)/vu)*vu,i:t}})}var r=le,i=ce,u=r,o=i,f=Yo;return n?t(n):(t.links=function(t){return Ue(e(t)).edges.filter(function(n){return n.l&&n.r}).map(function(n){return{source:t[n.l.i],target:t[n.r.i]}})},t.triangles=function(h){var p=[];return Ue(e(h)).cells.forEach(function(n,t){for(var e,r=n.site,i=n.edges.sort(we),u=-1,o=i.length,a=i[o-1].edge,l=a.l===r?a.r:a.l;++u<o;)a,e=l,l=(a=i[u].edge).l===r?a.r:a.l,t<e.i&&t<l.i&&(f=e,s=l,((c=r).x-s.x)*(f.y-c.y)-(c.x-f.x)*(s.y-c.y)<0)&&p.push([h[t],h[e.i],h[l.i]]);var c,f,s}),p},t.x=function(n){return arguments.length?(u=_n(r=n),t):r},t.y=function(n){return arguments.length?(o=_n(i=n),t):i},t.clipExtent=function(n){return arguments.length?(f=null==n?Yo:n,t):f===Yo?null:f},t.size=function(n){return arguments.length?t.clipExtent(n&&[[0,0],n]):f===Yo?null:f&&f[1]},t)};var Yo=[[-1e6,-1e6],[1e6,1e6]];Yi.geom.delaunay=function(n){return Yi.geom.voronoi().triangles(n)},Yi.geom.quadtree=function(n,M,x,b,_){function t(n){function p(n,t,e,r,i,u,o,a){if(!isNaN(e)&&!isNaN(r))if(n.leaf){var l=n.x,c=n.y;if(null!=l)if(Qi(l-e)+Qi(c-r)<.01)s(n,t,e,r,i,u,o,a);else{var f=n.point;n.x=n.y=n.point=null,s(n,f,l,c,i,u,o,a),s(n,t,e,r,i,u,o,a)}else n.x=e,n.y=r,n.point=t}else s(n,t,e,r,i,u,o,a)}function s(n,t,e,r,i,u,o,a){var l=.5*(i+o),c=.5*(u+a),f=l<=e,s=c<=r,h=s<<1|f;n.leaf=!1,f?i=l:o=l,s?u=c:a=c,p(n=n.nodes[h]||(n.nodes[h]={leaf:!0,nodes:[],point:null,x:null,y:null}),t,e,r,i,u,o,a)}var t,e,r,i,u,o,a,l,c,f=_n(S),h=_n(k);if(null!=M)o=M,a=x,l=b,c=_;else if(l=c=-(o=a=1/0),e=[],r=[],u=n.length,w)for(i=0;i<u;++i)(t=n[i]).x<o&&(o=t.x),t.y<a&&(a=t.y),t.x>l&&(l=t.x),t.y>c&&(c=t.y),e.push(t.x),r.push(t.y);else for(i=0;i<u;++i){var g=+f(t=n[i],i),v=+h(t,i);g<o&&(o=g),v<a&&(a=v),l<g&&(l=g),c<v&&(c=v),e.push(g),r.push(v)}var d=l-o,y=c-a;y<d?c=a+d:l=o+y;var m={leaf:!0,nodes:[],point:null,x:null,y:null,add:function(n){p(m,n,+f(n,++i),+h(n,i),o,a,l,c)}};if(m.visit=function(n){!function n(t,e,r,i,u,o){if(!t(e,r,i,u,o)){var a=.5*(r+u),l=.5*(i+o),c=e.nodes;c[0]&&n(t,c[0],r,i,a,l),c[1]&&n(t,c[1],a,i,u,l),c[2]&&n(t,c[2],r,l,a,o),c[3]&&n(t,c[3],a,l,u,o)}}(n,m,o,a,l,c)},m.find=function(n){return function(n,d,y,m,M,x,b){var _,w=1/0;return function n(t,e,r,i,u){if(!(x<e||b<r||i<m||u<M)){if(o=t.point){var o,a=d-t.x,l=y-t.y,c=a*a+l*l;if(c<w){var f=Math.sqrt(w=c);m=d-f,M=y-f,x=d+f,b=y+f,_=o}}for(var s=t.nodes,h=.5*(e+i),p=.5*(r+u),g=(p<=y)<<1|h<=d,v=g+4;g<v;++g)if(t=s[3&g])switch(3&g){case 0:n(t,e,r,h,p);break;case 1:n(t,h,r,i,p);break;case 2:n(t,e,p,h,u);break;case 3:n(t,h,p,i,u)}}}(n,m,M,x,b),_}(m,n[0],n[1],o,a,l,c)},i=-1,null==M){for(;++i<u;)p(m,n[i],e[i],r[i],o,a,l,c);--i}else n.forEach(m.add);return e=r=n=t=null,m}var w,S=le,k=ce;return(w=arguments.length)?(S=Fe,k=He,3===w&&(_=x,b=M,x=M=0),t(n)):(t.x=function(n){return arguments.length?(S=n,t):S},t.y=function(n){return arguments.length?(k=n,t):k},t.extent=function(n){return arguments.length?(null==n?M=x=b=_=null:(M=+n[0][0],x=+n[0][1],b=+n[1][0],_=+n[1][1]),t):null==M?null:[[M,x],[b,_]]},t.size=function(n){return arguments.length?(null==n?M=x=b=_=null:(M=x=0,b=+n[0],_=+n[1]),t):null==M?null:[b-M,_-x]},t)},Yi.interpolateRgb=Oe,Yi.interpolateObject=Ie,Yi.interpolateNumber=Ye,Yi.interpolateString=Ze;var Zo=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Vo=new RegExp(Zo.source,"g");Yi.interpolate=Ve,Yi.interpolators=[function(n,t){var e=typeof t;return("string"==e?Du.has(t.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(t)?Oe:Ze:t instanceof tn?Oe:Array.isArray(t)?Xe:"object"==e&&isNaN(t)?Ie:Ye)(n,t)}],Yi.interpolateArray=Xe;var Xo=function(){return R},$o=Yi.map({linear:Xo,poly:function(t){return function(n){return Math.pow(n,t)}},quad:function(){return We},cubic:function(){return Je},sin:function(){return Ke},exp:function(){return Qe},circle:function(){return nr},elastic:function(t,e){var r;return arguments.length<2&&(e=.45),r=arguments.length?e/mu*Math.asin(1/t):(t=1,e/4),function(n){return 1+t*Math.pow(2,-10*n)*Math.sin((n-r)*mu/e)}},back:function(t){return t||(t=1.70158),function(n){return n*n*((t+1)*n-t)}},bounce:function(){return tr}}),Bo=Yi.map({in:R,out:$e,"in-out":Be,"out-in":function(n){return Be($e(n))}});Yi.ease=function(n){var t=n.indexOf("-"),e=0<=t?n.slice(0,t):n,r=0<=t?n.slice(t+1):"in";return e=$o.get(e)||Xo,function(t){return function(n){return n<=0?0:1<=n?1:t(n)}}((r=Bo.get(r)||R)(e.apply(null,Zi.call(arguments,1))))},Yi.interpolateHcl=function(n,t){n=Yi.hcl(n),t=Yi.hcl(t);var e=n.h,r=n.c,i=n.l,u=t.h-e,o=t.c-r,a=t.l-i;return isNaN(o)&&(o=0,r=isNaN(r)?t.c:r),isNaN(u)?(u=0,e=isNaN(e)?t.h:e):180<u?u-=360:u<-180&&(u+=360),function(n){return on(e+u*n,r+o*n,i+a*n)+""}},Yi.interpolateHsl=function(n,t){n=Yi.hsl(n),t=Yi.hsl(t);var e=n.h,r=n.s,i=n.l,u=t.h-e,o=t.s-r,a=t.l-i;return isNaN(o)&&(o=0,r=isNaN(r)?t.s:r),isNaN(u)?(u=0,e=isNaN(e)?t.h:e):180<u?u-=360:u<-180&&(u+=360),function(n){return rn(e+u*n,r+o*n,i+a*n)+""}},Yi.interpolateLab=function(n,t){n=Yi.lab(n),t=Yi.lab(t);var e=n.l,r=n.a,i=n.b,u=t.l-e,o=t.a-r,a=t.b-i;return function(n){return ln(e+u*n,r+o*n,i+a*n)+""}},Yi.interpolateRound=er,Yi.transform=function(n){var e=Xi.createElementNS(Yi.ns.prefix.svg,"g");return(Yi.transform=function(n){if(null!=n){e.setAttribute("transform",n);var t=e.transform.baseVal.consolidate()}return new rr(t?t.matrix:Wo)})(n)},rr.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var Wo={a:1,b:0,c:0,d:1,e:0,f:0};Yi.interpolateTransform=or,Yi.layout={},Yi.layout.bundle=function(){return function(n){for(var t=[],e=-1,r=n.length;++e<r;)t.push(cr(n[e]));return t}},Yi.layout.chord=function(){function n(){var n,t,e,r,i,u={},o=[],a=Yi.range(x),l=[];for(y=[],m=[],n=0,r=-1;++r<x;){for(t=0,i=-1;++i<x;)t+=M[r][i];o.push(t),l.push(Yi.range(x)),n+=t}for(b&&a.sort(function(n,t){return b(o[n],o[t])}),_&&l.forEach(function(n,e){n.sort(function(n,t){return _(M[e][n],M[e][t])})}),n=(mu-S*x)/n,t=0,r=-1;++r<x;){for(e=t,i=-1;++i<x;){var c=a[r],f=l[c][i],s=M[c][f],h=t,p=t+=s*n;u[c+"-"+f]={index:c,subindex:f,startAngle:h,endAngle:p,value:s}}m[c]={index:c,startAngle:e,endAngle:t,value:(t-e)/n},t+=S}for(r=-1;++r<x;)for(i=r-1;++i<x;){var g=u[r+"-"+i],v=u[i+"-"+r];(g.value||v.value)&&y.push(g.value<v.value?{source:v,target:g}:{source:g,target:v})}w&&d()}function d(){y.sort(function(n,t){return w((n.source.value+n.target.value)/2,(t.source.value+t.target.value)/2)})}var y,m,M,x,b,_,w,t={},S=0;return t.matrix=function(n){return arguments.length?(x=(M=n)&&M.length,y=m=null,t):M},t.padding=function(n){return arguments.length?(S=n,y=m=null,t):S},t.sortGroups=function(n){return arguments.length?(b=n,y=m=null,t):b},t.sortSubgroups=function(n){return arguments.length?(_=n,y=null,t):_},t.sortChords=function(n){return arguments.length?(w=n,y&&d(),t):w},t.chords=function(){return y||n(),y},t.groups=function(){return m||n(),m},t},Yi.layout.force=function(){function s(c){return function(n,t,e,r){if(n.point!==c){var i=n.cx-c.x,u=n.cy-c.y,o=r-t,a=i*i+u*u;if(o*o/b<a){if(a<f){var l=n.charge/a;c.px-=i*l,c.py-=u*l}return!0}if(n.point&&a&&a<f){l=n.pointCharge/a;c.px-=i*l,c.py-=u*l}}return!n.charge}}function n(n){n.px=Yi.event.x,n.py=Yi.event.y,i.resume()}var t,h,p,g,v,i={},d=Yi.dispatch("start","tick","end"),y=[1,1],m=.9,u=Jo,o=Go,M=-30,f=Ko,x=.1,b=.64,_=[],w=[];return i.tick=function(){if((h*=.99)<.005)return d.end({type:"end",alpha:h=0}),!0;var n,t,e,r,i,u,o,a,l,c=_.length,f=w.length;for(t=0;t<f;++t)r=(e=w[t]).source,(u=(a=(i=e.target).x-r.x)*a+(l=i.y-r.y)*l)&&(a*=u=h*g[t]*((u=Math.sqrt(u))-p[t])/u,l*=u,i.x-=a*(o=r.weight/(i.weight+r.weight)),i.y-=l*o,r.x+=a*(o=1-o),r.y+=l*o);if((o=h*x)&&(a=y[0]/2,l=y[1]/2,t=-1,o))for(;++t<c;)(e=_[t]).x+=(a-e.x)*o,e.y+=(l-e.y)*o;if(M)for(function n(t,e,r){var i=0,u=0;if(t.charge=0,!t.leaf)for(var o,a=t.nodes,l=a.length,c=-1;++c<l;)null!=(o=a[c])&&(n(o,e,r),t.charge+=o.charge,i+=o.charge*o.cx,u+=o.charge*o.cy);if(t.point){t.leaf||(t.point.x+=Math.random()-.5,t.point.y+=Math.random()-.5);var f=e*r[t.point.index];t.charge+=t.pointCharge=f,i+=f*t.point.x,u+=f*t.point.y}t.cx=i/t.charge,t.cy=u/t.charge}(n=Yi.geom.quadtree(_),h,v),t=-1;++t<c;)(e=_[t]).fixed||n.visit(s(e));for(t=-1;++t<c;)(e=_[t]).fixed?(e.x=e.px,e.y=e.py):(e.x-=(e.px-(e.px=e.x))*m,e.y-=(e.py-(e.py=e.y))*m);d.tick({type:"tick",alpha:h})},i.nodes=function(n){return arguments.length?(_=n,i):_},i.links=function(n){return arguments.length?(w=n,i):w},i.size=function(n){return arguments.length?(y=n,i):y},i.linkDistance=function(n){return arguments.length?(u="function"==typeof n?n:+n,i):u},i.distance=i.linkDistance,i.linkStrength=function(n){return arguments.length?(o="function"==typeof n?n:+n,i):o},i.friction=function(n){return arguments.length?(m=+n,i):m},i.charge=function(n){return arguments.length?(M="function"==typeof n?n:+n,i):M},i.chargeDistance=function(n){return arguments.length?(f=n*n,i):Math.sqrt(f)},i.gravity=function(n){return arguments.length?(x=+n,i):x},i.theta=function(n){return arguments.length?(b=n*n,i):Math.sqrt(b)},i.alpha=function(n){return arguments.length?(n=+n,h?h=0<n?n:0:0<n&&(d.start({type:"start",alpha:h=n}),Yi.timer(i.tick)),i):h},i.start=function(){function n(n,t){if(!l){for(l=new Array(c),u=0;u<c;++u)l[u]=[];for(u=0;u<f;++u){var e=w[u];l[e.source.index].push(e.target),l[e.target.index].push(e.source)}}for(var r,i=l[a],u=-1,o=i.length;++u<o;)if(!isNaN(r=i[u][n]))return r;return Math.random()*t}var a,l,t,c=_.length,f=w.length,e=y[0],r=y[1];for(a=0;a<c;++a)(t=_[a]).index=a,t.weight=0;for(a=0;a<f;++a)"number"==typeof(t=w[a]).source&&(t.source=_[t.source]),"number"==typeof t.target&&(t.target=_[t.target]),++t.source.weight,++t.target.weight;for(a=0;a<c;++a)t=_[a],isNaN(t.x)&&(t.x=n("x",e)),isNaN(t.y)&&(t.y=n("y",r)),isNaN(t.px)&&(t.px=t.x),isNaN(t.py)&&(t.py=t.y);if(p=[],"function"==typeof u)for(a=0;a<f;++a)p[a]=+u.call(this,w[a],a);else for(a=0;a<f;++a)p[a]=u;if(g=[],"function"==typeof o)for(a=0;a<f;++a)g[a]=+o.call(this,w[a],a);else for(a=0;a<f;++a)g[a]=o;if(v=[],"function"==typeof M)for(a=0;a<c;++a)v[a]=+M.call(this,_[a],a);else for(a=0;a<c;++a)v[a]=M;return i.resume()},i.resume=function(){return i.alpha(.1)},i.stop=function(){return i.alpha(0)},i.drag=function(){return t||(t=Yi.behavior.drag().origin(R).on("dragstart.force",sr).on("drag.force",n).on("dragend.force",hr)),arguments.length?void this.on("mouseover.force",pr).on("mouseout.force",gr).call(t):t},Yi.rebind(i,d,"on")};var Jo=20,Go=1,Ko=1/0;Yi.layout.hierarchy=function(){function a(n){var t,e=[n],r=[];for(n.depth=0;null!=(t=e.pop());)if(r.push(t),(u=c.call(a,t,t.depth))&&(i=u.length)){for(var i,u,o;0<=--i;)e.push(o=u[i]),o.parent=t,o.depth=t.depth+1;f&&(t.value=0),t.children=u}else f&&(t.value=+f.call(a,t,t.depth)||0),delete t.children;return yr(n,function(n){var t,e;l&&(t=n.children)&&t.sort(l),f&&(e=n.parent)&&(e.value+=n.value)}),r}var l=xr,c=mr,f=Mr;return a.sort=function(n){return arguments.length?(l=n,a):l},a.children=function(n){return arguments.length?(c=n,a):c},a.value=function(n){return arguments.length?(f=n,a):f},a.revalue=function(n){return f&&(dr(n,function(n){n.children&&(n.value=0)}),yr(n,function(n){var t;n.children||(n.value=+f.call(a,n,n.depth)||0),(t=n.parent)&&(t.value+=n.value)})),n},a},Yi.layout.partition=function(){function t(n,t){var e=r.call(this,n,t);return function n(t,e,r,i){var u=t.children;if(t.x=e,t.y=t.depth*i,t.dx=r,t.dy=i,u&&(o=u.length)){var o,a,l,c=-1;for(r=t.value?r/t.value:0;++c<o;)n(a=u[c],e,l=a.value*r,i),e+=l}}(e[0],0,i[0],i[1]/function n(t){var e=t.children,r=0;if(e&&(i=e.length))for(var i,u=-1;++u<i;)r=Math.max(r,n(e[u]));return 1+r}(e[0])),e}var r=Yi.layout.hierarchy(),i=[1,1];return t.size=function(n){return arguments.length?(i=n,t):i},vr(t,r)},Yi.layout.pie=function(){function s(e){var t,n=e.length,r=e.map(function(n,t){return+h.call(s,n,t)}),i=+("function"==typeof g?g.apply(this,arguments):g),u=("function"==typeof v?v.apply(this,arguments):v)-i,o=Math.min(Math.abs(u)/n,+("function"==typeof d?d.apply(this,arguments):d)),a=o*(u<0?-1:1),l=(u-n*a)/Yi.sum(r),c=Yi.range(n),f=[];return null!=p&&c.sort(p===Qo?function(n,t){return r[t]-r[n]}:function(n,t){return p(e[n],e[t])}),c.forEach(function(n){f[n]={data:e[n],value:t=r[n],startAngle:i,endAngle:i+=t*l+a,padAngle:o}}),f}var h=Number,p=Qo,g=0,v=mu,d=0;return s.value=function(n){return arguments.length?(h=n,s):h},s.sort=function(n){return arguments.length?(p=n,s):p},s.startAngle=function(n){return arguments.length?(g=n,s):g},s.endAngle=function(n){return arguments.length?(v=n,s):v},s.padAngle=function(n){return arguments.length?(d=n,s):d},s};var Qo={};Yi.layout.stack=function(){function s(n,t){if(!(u=n.length))return n;var e=n.map(function(n,t){return h.call(s,n,t)}),r=e.map(function(n){return n.map(function(n,t){return[d.call(s,n,t),y.call(s,n,t)]})}),i=p.call(s,r,t);e=Yi.permute(e,i),r=Yi.permute(r,i);var u,o,a,l,c=g.call(s,r,t),f=e[0].length;for(a=0;a<f;++a)for(v.call(s,e[0][a],l=c[a],r[0][a][1]),o=1;o<u;++o)v.call(s,e[o][a],l+=r[o-1][a][1],r[o][a][1]);return n}var h=R,p=kr,g=Nr,v=Sr,d=_r,y=wr;return s.values=function(n){return arguments.length?(h=n,s):h},s.order=function(n){return arguments.length?(p="function"==typeof n?n:na.get(n)||kr,s):p},s.offset=function(n){return arguments.length?(g="function"==typeof n?n:ta.get(n)||Nr,s):g},s.x=function(n){return arguments.length?(d=n,s):d},s.y=function(n){return arguments.length?(y=n,s):y},s.out=function(n){return arguments.length?(v=n,s):v},s};var na=Yi.map({"inside-out":function(n){var t,e,r=n.length,i=n.map(Er),u=n.map(Ar),o=Yi.range(r).sort(function(n,t){return i[n]-i[t]}),a=0,l=0,c=[],f=[];for(t=0;t<r;++t)e=o[t],a<l?(a+=u[e],c.push(e)):(l+=u[e],f.push(e));return f.reverse().concat(c)},reverse:function(n){return Yi.range(n.length).reverse()},default:kr}),ta=Yi.map({silhouette:function(n){var t,e,r,i=n.length,u=n[0].length,o=[],a=0,l=[];for(e=0;e<u;++e){for(r=t=0;t<i;t++)r+=n[t][e][1];a<r&&(a=r),o.push(r)}for(e=0;e<u;++e)l[e]=(a-o[e])/2;return l},wiggle:function(n){var t,e,r,i,u,o,a,l,c,f=n.length,s=n[0],h=s.length,p=[];for(p[0]=l=c=0,e=1;e<h;++e){for(i=t=0;t<f;++t)i+=n[t][e][1];for(u=t=0,a=s[e][0]-s[e-1][0];t<f;++t){for(r=0,o=(n[t][e][1]-n[t][e-1][1])/(2*a);r<t;++r)o+=(n[r][e][1]-n[r][e-1][1])/a;u+=o*n[t][e][1]}p[e]=l-=i?u/i*a:0,l<c&&(c=l)}for(e=0;e<h;++e)p[e]-=c;return p},expand:function(n){var t,e,r,i=n.length,u=n[0].length,o=1/i,a=[];for(e=0;e<u;++e){for(r=t=0;t<i;t++)r+=n[t][e][1];if(r)for(t=0;t<i;t++)n[t][e][1]/=r;else for(t=0;t<i;t++)n[t][e][1]=o}for(e=0;e<u;++e)a[e]=0;return a},zero:Nr});Yi.layout.histogram=function(){function e(n,t){for(var e,r,i=[],u=n.map(h,this),o=p.call(this,u,t),a=g.call(this,o,u,t),l=(t=-1,u.length),c=a.length-1,f=s?1:1/l;++t<c;)(e=i[t]=[]).dx=a[t+1]-(e.x=a[t]),e.y=0;if(0<c)for(t=-1;++t<l;)(r=u[t])>=o[0]&&r<=o[1]&&((e=i[Yi.bisect(a,r,1,c)-1]).y+=f,e.push(n[t]));return i}var s=!0,h=Number,p=Lr,g=zr;return e.value=function(n){return arguments.length?(h=n,e):h},e.range=function(n){return arguments.length?(p=_n(n),e):p},e.bins=function(t){return arguments.length?(g="number"==typeof t?function(n){return qr(n,t)}:_n(t),e):g},e.frequency=function(n){return arguments.length?(s=!!n,e):s},e},Yi.layout.pack=function(){function t(n,t){var e=c.call(this,n,t),r=e[0],i=s[0],u=s[1],o=null==l?Math.sqrt:"function"==typeof l?l:function(){return l};if(r.x=r.y=0,yr(r,function(n){n.r=+o(n.value)}),yr(r,Ur),f){var a=f*(l?1:Math.max(2*r.r/i,2*r.r/u))/2;yr(r,function(n){n.r+=a}),yr(r,Ur),yr(r,function(n){n.r-=a})}return function n(t,e,r,i){var u=t.children;if(t.x=e+=i*t.x,t.y=r+=i*t.y,t.r*=i,u)for(var o=-1,a=u.length;++o<a;)n(u[o],e,r,i)}(r,i/2,u/2,l?1:1/Math.max(2*r.r/i,2*r.r/u)),e}var l,c=Yi.layout.hierarchy().sort(Tr),f=0,s=[1,1];return t.size=function(n){return arguments.length?(s=n,t):s},t.radius=function(n){return arguments.length?(l=null==n||"function"==typeof n?n:+n,t):l},t.padding=function(n){return arguments.length?(f=+n,t):f},vr(t,c)},Yi.layout.tree=function(){function t(n,t){var e=g.call(this,n,t),r=e[0],i=function(n){for(var t,e={A:null,children:[n]},r=[e];null!=(t=r.pop());)for(var i,u=t.children,o=0,a=u.length;o<a;++o)r.push((u[o]=i={_:u[o],parent:t,children:(i=u[o].children)&&i.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:o}).a=i);return e.children[0]}(r);if(yr(i,s),i.parent.m=-i.z,dr(i,h),d)dr(r,p);else{var u=r,o=r,a=r;dr(r,function(n){n.x<u.x&&(u=n),n.x>o.x&&(o=n),n.depth>a.depth&&(a=n)});var l=M(u,o)/2-u.x,c=v[0]/(o.x+M(o,u)/2+l),f=v[1]/(a.depth||1);dr(r,function(n){n.x=(n.x+l)*c,n.y=n.depth*f})}return e}function s(n){var t=n.children,e=n.parent.children,r=n.i?e[n.i-1]:null;if(t.length){!function(n){for(var t,e=0,r=0,i=n.children,u=i.length;0<=--u;)(t=i[u]).z+=e,t.m+=e,e+=t.s+(r+=t.c)}(n);var i=(t[0].z+t[t.length-1].z)/2;r?(n.z=r.z+M(n._,r._),n.m=n.z-i):n.z=i}else r&&(n.z=r.z+M(n._,r._));n.parent.A=function(n,t,e){if(t){for(var r,i=n,u=n,o=t,a=i.parent.children[0],l=i.m,c=u.m,f=o.m,s=a.m;o=Yr(o),i=Ir(i),o&&i;)a=Ir(a),(u=Yr(u)).a=n,0<(r=o.z+f-i.z-l+M(o._,i._))&&(y=n,m=e,h=(d=o).a.parent===y.parent?d.a:m,void 0,v=(g=r)/((p=n).i-h.i),p.c-=v,p.s+=g,h.c+=v,p.z+=g,p.m+=g,l+=r,c+=r),f+=o.m,l+=i.m,s+=a.m,c+=u.m;o&&!Yr(u)&&(u.t=o,u.m+=f-c),i&&!Ir(a)&&(a.t=i,a.m+=l-s,e=n)}var h,p,g,v;var d,y,m;return e}(n,r,n.parent.A||e[0])}function h(n){n._.x=n.z+n.parent.m,n.m+=n.parent.m}function p(n){n.x*=v[0],n.y=n.depth*v[1]}var g=Yi.layout.hierarchy().sort(null).value(null),M=Or,v=[1,1],d=null;return t.separation=function(n){return arguments.length?(M=n,t):M},t.size=function(n){return arguments.length?(d=null==(v=n)?p:null,t):d?null:v},t.nodeSize=function(n){return arguments.length?(d=null==(v=n)?null:p,t):d?v:null},vr(t,g)},Yi.layout.cluster=function(){function t(n,t){var e,r=f.call(this,n,t),i=r[0],u=0;yr(i,function(n){var t=n.children;t&&t.length?(n.x=function(n){return n.reduce(function(n,t){return n+t.x},0)/n.length}(t),n.y=function(n){return 1+Yi.max(n,function(n){return n.y})}(t)):(n.x=e?u+=s(n,e):0,n.y=0,e=n)});var o=function n(t){var e=t.children;return e&&e.length?n(e[0]):t}(i),a=function n(t){var e,r=t.children;return r&&(e=r.length)?n(r[e-1]):t}(i),l=o.x-s(o,a)/2,c=a.x+s(a,o)/2;return yr(i,p?function(n){n.x=(n.x-i.x)*h[0],n.y=(i.y-n.y)*h[1]}:function(n){n.x=(n.x-l)/(c-l)*h[0],n.y=(1-(i.y?n.y/i.y:1))*h[1]}),r}var f=Yi.layout.hierarchy().sort(null).value(null),s=Or,h=[1,1],p=!1;return t.separation=function(n){return arguments.length?(s=n,t):s},t.size=function(n){return arguments.length?(p=null==(h=n),t):p?null:h},t.nodeSize=function(n){return arguments.length?(p=null!=(h=n),t):p?h:null},vr(t,f)},Yi.layout.treemap=function(){function f(n,t){for(var e,r,i=-1,u=n.length;++i<u;)r=(e=n[i]).value*(t<0?0:t),e.area=isNaN(r)||r<=0?0:r}function s(n){var t=n.children;if(t&&t.length){var e,r,i,u=v(n),o=[],a=t.slice(),l=1/0,c="slice"===d?u.dx:"dice"===d?u.dy:"slice-dice"===d?1&n.depth?u.dy:u.dx:Math.min(u.dx,u.dy);for(f(a,u.dx*u.dy/n.value),o.area=0;0<(i=a.length);)o.push(e=a[i-1]),o.area+=e.area,l="squarify"!==d||(r=h(o,c))<=l?(a.pop(),r):(o.area-=o.pop().area,p(o,c,u,!1),c=Math.min(u.dx,u.dy),o.length=o.area=0,1/0);o.length&&(p(o,c,u,!0),o.length=o.area=0),t.forEach(s)}}function o(n){var t=n.children;if(t&&t.length){var e,r=v(n),i=t.slice(),u=[];for(f(i,r.dx*r.dy/n.value),u.area=0;e=i.pop();)u.push(e),u.area+=e.area,null!=e.z&&(p(u,e.z?r.dx:r.dy,r,!i.length),u.length=u.area=0);t.forEach(o)}}function h(n,t){for(var e,r=n.area,i=0,u=1/0,o=-1,a=n.length;++o<a;)(e=n[o].area)&&(e<u&&(u=e),i<e&&(i=e));return t*=t,(r*=r)?Math.max(t*i*y/r,r/(t*u*y)):1/0}function p(n,t,e,r){var i,u=-1,o=n.length,a=e.x,l=e.y,c=t?g(n.area/t):0;if(t==e.dx){for((r||c>e.dy)&&(c=e.dy);++u<o;)(i=n[u]).x=a,i.y=l,i.dy=c,a+=i.dx=Math.min(e.x+e.dx-a,c?g(i.area/c):0);i.z=!0,i.dx+=e.x+e.dx-a,e.y+=c,e.dy-=c}else{for((r||c>e.dx)&&(c=e.dx);++u<o;)(i=n[u]).x=a,i.y=l,i.dx=c,l+=i.dy=Math.min(e.y+e.dy-l,c?g(i.area/c):0);i.z=!1,i.dy+=e.y+e.dy-l,e.x+=c,e.dx-=c}}function r(n){var t=i||u(n),e=t[0];return e.x=0,e.y=0,e.dx=a[0],e.dy=a[1],i&&u.revalue(e),f([e],e.dx*e.dy/e.value),(i?o:s)(e),c&&(i=t),t}var i,u=Yi.layout.hierarchy(),g=Math.round,a=[1,1],l=null,v=Zr,c=!1,d="squarify",y=.5*(1+Math.sqrt(5));return r.size=function(n){return arguments.length?(a=n,r):a},r.padding=function(e){function n(n){return Vr(n,e)}return arguments.length?(v=null==(l=e)?Zr:"function"==(t=typeof e)?function(n){var t=e.call(r,n,n.depth);return null==t?Zr(n):Vr(n,"number"==typeof t?[t,t,t,t]:t)}:("number"==t&&(e=[e,e,e,e]),n),r):l;var t},r.round=function(n){return arguments.length?(g=n?Math.round:Number,r):g!=Number},r.sticky=function(n){return arguments.length?(c=n,i=null,r):c},r.ratio=function(n){return arguments.length?(y=n,r):y},r.mode=function(n){return arguments.length?(d=n+"",r):d},vr(r,u)},Yi.random={normal:function(r,i){var n=arguments.length;return n<2&&(i=1),n<1&&(r=0),function(){for(var n,t,e;!(e=(n=2*Math.random()-1)*n+(t=2*Math.random()-1)*t)||1<e;);return r+i*n*Math.sqrt(-2*Math.log(e)/e)}},logNormal:function(){var n=Yi.random.normal.apply(Yi,arguments);return function(){return Math.exp(n())}},bates:function(n){var t=Yi.random.irwinHall(n);return function(){return t()/n}},irwinHall:function(e){return function(){for(var n=0,t=0;t<e;t++)n+=Math.random();return n}}},Yi.scale={};var ea={floor:R,ceil:R};Yi.scale.linear=function(){return function n(e,r,i,u){function t(){var n=2<Math.min(e.length,r.length)?Jr:Br,t=u?lr:ar;return a=n(e,r,t,i),l=n(r,e,t,Ve),o}function o(n){return a(n)}var a,l;return o.invert=function(n){return l(n)},o.domain=function(n){return arguments.length?(e=n.map(Number),t()):e},o.range=function(n){return arguments.length?(r=n,t()):r},o.rangeRound=function(n){return o.range(n).interpolate(er)},o.clamp=function(n){return arguments.length?(u=n,t()):u},o.interpolate=function(n){return arguments.length?(i=n,t()):i},o.ticks=function(n){return ni(e,n)},o.tickFormat=function(n,t){return ti(e,n,t)},o.nice=function(n){return Kr(e,n),t()},o.copy=function(){return n(e,r,i,u)},t()}([0,1],[0,1],Ve,!1)};var ra={s:1,g:1,p:1,r:1,e:1};Yi.scale.log=function(){return function n(t,l,c,f){function s(n){return(c?Math.log(n<0?0:n):-Math.log(0<n?0:-n))/Math.log(l)}function h(n){return c?Math.pow(l,n):-Math.pow(l,-n)}function u(n){return t(s(n))}return u.invert=function(n){return h(t.invert(n))},u.domain=function(n){return arguments.length?(c=0<=n[0],t.domain((f=n.map(Number)).map(s)),u):f},u.base=function(n){return arguments.length?(l=+n,t.domain(f.map(s)),u):l},u.nice=function(){var n=Wr(f.map(s),c?Math:ua);return t.domain(n),f=n.map(h),u},u.ticks=function(){var n=Xr(f),t=[],e=n[0],r=n[1],i=Math.floor(s(e)),u=Math.ceil(s(r)),o=l%1?2:l;if(isFinite(u-i)){if(c){for(;i<u;i++)for(var a=1;a<o;a++)t.push(h(i)*a);t.push(h(i))}else for(t.push(h(i));i++<u;)for(a=o-1;0<a;a--)t.push(h(i)*a);for(i=0;t[i]<e;i++);for(u=t.length;t[u-1]>r;u--);t=t.slice(i,u)}return t},u.tickFormat=function(n,t){if(!arguments.length)return ia;arguments.length<2?t=ia:"function"!=typeof t&&(t=Yi.format(t));var e,r=Math.max(.1,n/u.ticks().length),i=c?(e=1e-12,Math.ceil):(e=-1e-12,Math.floor);return function(n){return n/h(i(s(n)+e))<=r?t(n):""}},u.copy=function(){return n(t.copy(),l,c,f)},Gr(u,t)}(Yi.scale.linear().domain([0,1]),10,!0,[1,10])};var ia=Yi.format(".0e"),ua={floor:function(n){return-Math.ceil(-n)},ceil:function(n){return-Math.floor(-n)}};Yi.scale.pow=function(){return function n(t,e,r){function i(n){return t(u(n))}var u=ri(e),o=ri(1/e);return i.invert=function(n){return o(t.invert(n))},i.domain=function(n){return arguments.length?(t.domain((r=n.map(Number)).map(u)),i):r},i.ticks=function(n){return ni(r,n)},i.tickFormat=function(n,t){return ti(r,n,t)},i.nice=function(n){return i.domain(Kr(r,n))},i.exponent=function(n){return arguments.length?(u=ri(e=n),o=ri(1/e),t.domain(r.map(u)),i):e},i.copy=function(){return n(t.copy(),e,r)},Gr(i,t)}(Yi.scale.linear(),1,[0,1])},Yi.scale.sqrt=function(){return Yi.scale.pow().exponent(.5)},Yi.scale.ordinal=function(){return function n(a,l){function c(n){return s[((i.get(n)||("range"===l.t?i.set(n,a.push(n)):NaN))-1)%s.length]}function f(t,e){return Yi.range(a.length).map(function(n){return t+e*n})}var i,s,h;return c.domain=function(n){if(!arguments.length)return a;a=[],i=new m;for(var t,e=-1,r=n.length;++e<r;)i.has(t=n[e])||i.set(t,a.push(t));return c[l.t].apply(c,l.a)},c.range=function(n){return arguments.length?(s=n,h=0,l={t:"range",a:arguments},c):s},c.rangePoints=function(n,t){arguments.length<2&&(t=0);var e=n[0],r=n[1],i=a.length<2?(e=(e+r)/2,0):(r-e)/(a.length-1+t);return s=f(e+i*t/2,i),h=0,l={t:"rangePoints",a:arguments},c},c.rangeRoundPoints=function(n,t){arguments.length<2&&(t=0);var e=n[0],r=n[1],i=a.length<2?(e=r=Math.round((e+r)/2),0):(r-e)/(a.length-1+t)|0;return s=f(e+Math.round(i*t/2+(r-e-(a.length-1+t)*i)/2),i),h=0,l={t:"rangeRoundPoints",a:arguments},c},c.rangeBands=function(n,t,e){arguments.length<2&&(t=0),arguments.length<3&&(e=t);var r=n[1]<n[0],i=n[r-0],u=(n[1-r]-i)/(a.length-t+2*e);return s=f(i+u*e,u),r&&s.reverse(),h=u*(1-t),l={t:"rangeBands",a:arguments},c},c.rangeRoundBands=function(n,t,e){arguments.length<2&&(t=0),arguments.length<3&&(e=t);var r=n[1]<n[0],i=n[r-0],u=n[1-r],o=Math.floor((u-i)/(a.length-t+2*e));return s=f(i+Math.round((u-i-(a.length-t)*o)/2),o),r&&s.reverse(),h=Math.round(o*(1-t)),l={t:"rangeRoundBands",a:arguments},c},c.rangeBand=function(){return h},c.rangeExtent=function(){return Xr(l.a[0])},c.copy=function(){return n(a,l)},c.domain(a)}([],{t:"range",a:[[]]})},Yi.scale.category10=function(){return Yi.scale.ordinal().range(oa)},Yi.scale.category20=function(){return Yi.scale.ordinal().range(aa)},Yi.scale.category20b=function(){return Yi.scale.ordinal().range(la)},Yi.scale.category20c=function(){return Yi.scale.ordinal().range(ca)};var oa=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(vn),aa=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(vn),la=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(vn),ca=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(vn);Yi.scale.quantile=function(){return function n(e,r){function t(){var n=0,t=r.length;for(u=[];++n<t;)u[n-1]=Yi.quantile(e,n/t);return i}function i(n){return isNaN(n=+n)?void 0:r[Yi.bisect(u,n)]}var u;return i.domain=function(n){return arguments.length?(e=n.map(c).filter(f).sort(o),t()):e},i.range=function(n){return arguments.length?(r=n,t()):r},i.quantiles=function(){return u},i.invertExtent=function(n){return(n=r.indexOf(n))<0?[NaN,NaN]:[0<n?u[n-1]:e[0],n<u.length?u[n]:e[e.length-1]]},i.copy=function(){return n(e,r)},t()}([],[])},Yi.scale.quantize=function(){return function n(t,e,r){function i(n){return r[Math.max(0,Math.min(a,Math.floor(o*(n-t))))]}function u(){return o=r.length/(e-t),a=r.length-1,i}var o,a;return i.domain=function(n){return arguments.length?(t=+n[0],e=+n[n.length-1],u()):[t,e]},i.range=function(n){return arguments.length?(r=n,u()):r},i.invertExtent=function(n){return[n=(n=r.indexOf(n))<0?NaN:n/o+t,n+1/o]},i.copy=function(){return n(t,e,r)},u()}(0,1,[0,1])},Yi.scale.threshold=function(){return function n(t,e){function r(n){return n<=n?e[Yi.bisect(t,n)]:void 0}return r.domain=function(n){return arguments.length?(t=n,r):t},r.range=function(n){return arguments.length?(e=n,r):e},r.invertExtent=function(n){return n=e.indexOf(n),[t[n-1],t[n]]},r.copy=function(){return n(t,e)},r}([.5],[0,1])},Yi.scale.identity=function(){return function n(e){function t(n){return+n}return(t.invert=t).domain=t.range=function(n){return arguments.length?(e=n.map(t),t):e},t.ticks=function(n){return ni(e,n)},t.tickFormat=function(n,t){return ti(e,n,t)},t.copy=function(){return n(e)},t}([0,1])},Yi.svg={},Yi.svg.arc=function(){function t(){var n=Math.max(0,+F.apply(this,arguments)),t=Math.max(0,+H.apply(this,arguments)),e=Y.apply(this,arguments)-xu,r=Z.apply(this,arguments)-xu,i=Math.abs(r-e),u=r<e?0:1;if(t<n&&(o=t,t=n,n=o),Mu<=i)return j(t,u)+(n?j(n,1-u):"")+"Z";var o,a,l,c,f,s,h,p,g,v,d,y,m=0,M=0,x=[];if((c=(+V.apply(this,arguments)||0)/2)&&(l=I===fa?Math.sqrt(n*n+t*t):+I.apply(this,arguments),u||(M*=-1),t&&(M=K(l/t*Math.sin(c))),n&&(m=K(l/n*Math.sin(c)))),t){f=t*Math.cos(e+M),s=t*Math.sin(e+M),h=t*Math.cos(r-M),p=t*Math.sin(r-M);var b=Math.abs(r-e-2*M)<=yu?0:1;if(M&&fi(f,s,h,p)===u^b){var _=(e+r)/2;f=t*Math.cos(_),s=t*Math.sin(_),h=p=null}}else f=s=0;if(n){g=n*Math.cos(r-m),v=n*Math.sin(r-m),d=n*Math.cos(e+m),y=n*Math.sin(e+m);var w=Math.abs(e-r+2*m)<=yu?0:1;if(m&&fi(g,v,d,y)===1-u^w){var S=(e+r)/2;g=n*Math.cos(S),v=n*Math.sin(S),d=y=null}}else g=v=0;if(.001<(o=Math.min(Math.abs(t-n)/2,+O.apply(this,arguments)))){a=n<t^u?0:1;var k=null==d?[g,v]:null==h?[f,s]:pe([f,s],[d,y],[h,p],[g,v]),N=f-k[0],E=s-k[1],A=h-k[0],C=p-k[1],z=1/Math.sin(Math.acos((N*A+E*C)/(Math.sqrt(N*N+E*E)*Math.sqrt(A*A+C*C)))/2),q=Math.sqrt(k[0]*k[0]+k[1]*k[1]);if(null!=h){var L=Math.min(o,(t-q)/(1+z)),T=si(null==d?[g,v]:[d,y],[f,s],t,L,u),R=si([h,p],[g,v],t,L,u);o===L?x.push("M",T[0],"A",L,",",L," 0 0,",a," ",T[1],"A",t,",",t," 0 ",1-u^fi(T[1][0],T[1][1],R[1][0],R[1][1]),",",u," ",R[1],"A",L,",",L," 0 0,",a," ",R[0]):x.push("M",T[0],"A",L,",",L," 0 1,",a," ",R[0])}else x.push("M",f,",",s);if(null!=d){var D=Math.min(o,(n-q)/(z-1)),P=si([f,s],[d,y],n,-D,u),U=si([g,v],null==h?[f,s]:[h,p],n,-D,u);o===D?x.push("L",U[0],"A",D,",",D," 0 0,",a," ",U[1],"A",n,",",n," 0 ",u^fi(U[1][0],U[1][1],P[1][0],P[1][1]),",",1-u," ",P[1],"A",D,",",D," 0 0,",a," ",P[0]):x.push("L",U[0],"A",D,",",D," 0 0,",a," ",P[0])}else x.push("L",g,",",v)}else x.push("M",f,",",s),null!=h&&x.push("A",t,",",t," 0 ",b,",",u," ",h,",",p),x.push("L",g,",",v),null!=d&&x.push("A",n,",",n," 0 ",w,",",1-u," ",d,",",y);return x.push("Z"),x.join("")}function j(n,t){return"M0,"+n+"A"+n+","+n+" 0 1,"+t+" 0,"+-n+"A"+n+","+n+" 0 1,"+t+" 0,"+n}var F=ui,H=oi,O=ii,I=fa,Y=ai,Z=li,V=ci;return t.innerRadius=function(n){return arguments.length?(F=_n(n),t):F},t.outerRadius=function(n){return arguments.length?(H=_n(n),t):H},t.cornerRadius=function(n){return arguments.length?(O=_n(n),t):O},t.padRadius=function(n){return arguments.length?(I=n==fa?fa:_n(n),t):I},t.startAngle=function(n){return arguments.length?(Y=_n(n),t):Y},t.endAngle=function(n){return arguments.length?(Z=_n(n),t):Z},t.padAngle=function(n){return arguments.length?(V=_n(n),t):V},t.centroid=function(){var n=(+F.apply(this,arguments)+ +H.apply(this,arguments))/2,t=(+Y.apply(this,arguments)+ +Z.apply(this,arguments))/2-xu;return[Math.cos(t)*n,Math.sin(t)*n]},t};var fa="auto";Yi.svg.line=function(){return hi(R)};var sa=Yi.map({linear:pi,"linear-closed":function(n){return pi(n)+"Z"},step:function(n){for(var t=0,e=n.length,r=n[0],i=[r[0],",",r[1]];++t<e;)i.push("H",(r[0]+(r=n[t])[0])/2,"V",r[1]);return 1<e&&i.push("H",r[0]),i.join("")},"step-before":gi,"step-after":vi,basis:mi,"basis-open":function(n){if(n.length<4)return pi(n);for(var t,e=[],r=-1,i=n.length,u=[0],o=[0];++r<3;)t=n[r],u.push(t[0]),o.push(t[1]);for(e.push(Mi(ga,u)+","+Mi(ga,o)),--r;++r<i;)t=n[r],u.shift(),u.push(t[0]),o.shift(),o.push(t[1]),xi(e,u,o);return e.join("")},"basis-closed":function(n){for(var t,e,r=-1,i=n.length,u=i+4,o=[],a=[];++r<4;)e=n[r%i],o.push(e[0]),a.push(e[1]);for(t=[Mi(ga,o),",",Mi(ga,a)],--r;++r<u;)e=n[r%i],o.shift(),o.push(e[0]),a.shift(),a.push(e[1]),xi(t,o,a);return t.join("")},bundle:function(n,t){var e=n.length-1;if(e)for(var r,i,u=n[0][0],o=n[0][1],a=n[e][0]-u,l=n[e][1]-o,c=-1;++c<=e;)i=c/e,(r=n[c])[0]=t*r[0]+(1-t)*(u+i*a),r[1]=t*r[1]+(1-t)*(o+i*l);return mi(n)},cardinal:function(n,t){return n.length<3?pi(n):n[0]+di(n,yi(n,t))},"cardinal-open":function(n,t){return n.length<4?pi(n):n[1]+di(n.slice(1,-1),yi(n,t))},"cardinal-closed":function(n,t){return n.length<3?pi(n):n[0]+di((n.push(n[0]),n),yi([n[n.length-2]].concat(n,[n[1]]),t))},monotone:function(n){return n.length<3?pi(n):n[0]+di(n,_i(n))}});sa.forEach(function(n,t){t.key=n,t.closed=/-closed$/.test(n)});var ha=[0,2/3,1/3,0],pa=[0,1/3,2/3,0],ga=[0,1/6,2/3,1/6];Yi.svg.line.radial=function(){var n=hi(wi);return n.radius=n.x,delete n.x,n.angle=n.y,delete n.y,n},(gi.reverse=vi).reverse=gi,Yi.svg.area=function(){return Si(R)},Yi.svg.area.radial=function(){var n=Si(wi);return n.radius=n.x,delete n.x,n.innerRadius=n.x0,delete n.x0,n.outerRadius=n.x1,delete n.x1,n.angle=n.y,delete n.y,n.startAngle=n.y0,delete n.y0,n.endAngle=n.y1,delete n.y1,n},Yi.svg.chord=function(){function t(n,t){var e=i(this,a,n,t),r=i(this,l,n,t);return"M"+e.p0+u(e.r,e.p1,e.a1-e.a0)+(function(n,t){return n.a0==t.a0&&n.a1==t.a1}(e,r)?o(e.r,e.p1,e.r,e.p0):o(e.r,e.p1,r.r,r.p0)+u(r.r,r.p1,r.a1-r.a0)+o(r.r,r.p1,e.r,e.p0))+"Z"}function i(n,t,e,r){var i=t.call(n,e,r),u=c.call(n,i,r),o=f.call(n,i,r)-xu,a=s.call(n,i,r)-xu;return{r:u,a0:o,a1:a,p0:[u*Math.cos(o),u*Math.sin(o)],p1:[u*Math.cos(a),u*Math.sin(a)]}}function u(n,t,e){return"A"+n+","+n+" 0 "+ +(yu<e)+",1 "+t}function o(n,t,e,r){return"Q 0,0 "+r}var a=ne,l=te,c=ki,f=ai,s=li;return t.radius=function(n){return arguments.length?(c=_n(n),t):c},t.source=function(n){return arguments.length?(a=_n(n),t):a},t.target=function(n){return arguments.length?(l=_n(n),t):l},t.startAngle=function(n){return arguments.length?(f=_n(n),t):f},t.endAngle=function(n){return arguments.length?(s=_n(n),t):s},t},Yi.svg.diagonal=function(){function t(n,t){var e=o.call(this,n,t),r=a.call(this,n,t),i=(e.y+r.y)/2,u=[e,{x:e.x,y:i},{x:r.x,y:i},r];return"M"+(u=u.map(l))[0]+"C"+u[1]+" "+u[2]+" "+u[3]}var o=ne,a=te,l=Ni;return t.source=function(n){return arguments.length?(o=_n(n),t):o},t.target=function(n){return arguments.length?(a=_n(n),t):a},t.projection=function(n){return arguments.length?(l=n,t):l},t},Yi.svg.diagonal.radial=function(){var n=Yi.svg.diagonal(),t=Ni,e=n.projection;return n.projection=function(n){return arguments.length?e(function(r){return function(){var n=r.apply(this,arguments),t=n[0],e=n[1]-xu;return[t*Math.cos(e),t*Math.sin(e)]}}(t=n)):t},n},Yi.svg.symbol=function(){function t(n,t){return(va.get(e.call(this,n,t))||Ci)(r.call(this,n,t))}var e=Ai,r=Ei;return t.type=function(n){return arguments.length?(e=_n(n),t):e},t.size=function(n){return arguments.length?(r=_n(n),t):r},t};var va=Yi.map({circle:Ci,cross:function(n){var t=Math.sqrt(n/5)/2;return"M"+-3*t+","+-t+"H"+-t+"V"+-3*t+"H"+t+"V"+-t+"H"+3*t+"V"+t+"H"+t+"V"+3*t+"H"+-t+"V"+t+"H"+-3*t+"Z"},diamond:function(n){var t=Math.sqrt(n/(2*ya)),e=t*ya;return"M0,"+-t+"L"+e+",0 0,"+t+" "+-e+",0Z"},square:function(n){var t=Math.sqrt(n)/2;return"M"+-t+","+-t+"L"+t+","+-t+" "+t+","+t+" "+-t+","+t+"Z"},"triangle-down":function(n){var t=Math.sqrt(n/da),e=t*da/2;return"M0,"+e+"L"+t+","+-e+" "+-t+","+-e+"Z"},"triangle-up":function(n){var t=Math.sqrt(n/da),e=t*da/2;return"M0,"+-e+"L"+t+","+e+" "+-t+","+e+"Z"}});Yi.svg.symbolTypes=va.keys();var da=Math.sqrt(3),ya=Math.tan(30*bu);lu.transition=function(n){for(var t,e,r=ma||++_a,i=Ri(n),u=[],o=Ma||{time:Date.now(),ease:Ge,delay:0,duration:250},a=-1,l=this.length;++a<l;){u.push(t=[]);for(var c=this[a],f=-1,s=c.length;++f<s;)(e=c[f])&&Di(e,f,i,r,o),t.push(e)}return qi(u,i,r)},lu.interrupt=function(n){return this.each(null==n?xa:zi(Ri(n)))};var ma,Ma,xa=zi(Ri()),ba=[],_a=0;ba.call=lu.call,ba.empty=lu.empty,ba.node=lu.node,ba.size=lu.size,Yi.transition=function(n,t){return n&&n.transition?ma?n.transition(t):n:Yi.selection().transition(n)},(Yi.transition.prototype=ba).select=function(n){var t,e,r,i=this.id,u=this.namespace,o=[];n=w(n);for(var a=-1,l=this.length;++a<l;){o.push(t=[]);for(var c=this[a],f=-1,s=c.length;++f<s;)(r=c[f])&&(e=n.call(r,r.__data__,f,a))?("__data__"in r&&(e.__data__=r.__data__),Di(e,f,u,i,r[u][i]),t.push(e)):t.push(null)}return qi(o,u,i)},ba.selectAll=function(n){var t,e,r,i,u,o=this.id,a=this.namespace,l=[];n=S(n);for(var c=-1,f=this.length;++c<f;)for(var s=this[c],h=-1,p=s.length;++h<p;)if(r=s[h]){u=r[a][o],e=n.call(r,r.__data__,h,c),l.push(t=[]);for(var g=-1,v=e.length;++g<v;)(i=e[g])&&Di(i,g,a,o,u),t.push(i)}return qi(l,a,o)},ba.filter=function(n){var t,e,r=[];"function"!=typeof n&&(n=H(n));for(var i=0,u=this.length;i<u;i++){r.push(t=[]);for(var o,a=0,l=(o=this[i]).length;a<l;a++)(e=o[a])&&n.call(e,e.__data__,a,i)&&t.push(e)}return qi(r,this.namespace,this.id)},ba.tween=function(t,e){var r=this.id,i=this.namespace;return arguments.length<2?this.node()[i][r].tween.get(t):O(this,null==e?function(n){n[i][r].tween.remove(t)}:function(n){n[i][r].tween.set(t,e)})},ba.attr=function(n,t){function r(){this.removeAttribute(o)}function i(){this.removeAttributeNS(o.space,o.local)}if(arguments.length<2){for(t in n)this.attr(t,n[t]);return this}var u="transform"==n?or:Ve,o=Yi.ns.qualify(n);return Li(this,"attr."+n,t,o.local?function(e){return null==e?i:(e+="",function(){var t,n=this.getAttributeNS(o.space,o.local);return n!==e&&(t=u(n,e),function(n){this.setAttributeNS(o.space,o.local,t(n))})})}:function(e){return null==e?r:(e+="",function(){var t,n=this.getAttribute(o);return n!==e&&(t=u(n,e),function(n){this.setAttribute(o,t(n))})})})},ba.attrTween=function(n,r){var i=Yi.ns.qualify(n);return this.tween("attr."+n,i.local?function(n,t){var e=r.call(this,n,t,this.getAttributeNS(i.space,i.local));return e&&function(n){this.setAttributeNS(i.space,i.local,e(n))}}:function(n,t){var e=r.call(this,n,t,this.getAttribute(i));return e&&function(n){this.setAttribute(i,e(n))}})},ba.style=function(r,n,i){function t(){this.style.removeProperty(r)}var e=arguments.length;if(e<3){if("string"!=typeof r){for(i in e<2&&(n=""),r)this.style(i,r[i],n);return this}i=""}return Li(this,"style."+r,n,function(e){return null==e?t:(e+="",function(){var t,n=T(this).getComputedStyle(this,null).getPropertyValue(r);return n!==e&&(t=Ve(n,e),function(n){this.style.setProperty(r,t(n),i)})})})},ba.styleTween=function(r,i,u){return arguments.length<3&&(u=""),this.tween("style."+r,function(n,t){var e=i.call(this,n,t,T(this).getComputedStyle(this,null).getPropertyValue(r));return e&&function(n){this.style.setProperty(r,e(n),u)}})},ba.text=function(n){return Li(this,"text",n,Ti)},ba.remove=function(){var t=this.namespace;return this.each("end.transition",function(){var n;this[t].count<2&&(n=this.parentNode)&&n.removeChild(this)})},ba.ease=function(t){var e=this.id,r=this.namespace;return arguments.length<1?this.node()[r][e].ease:("function"!=typeof t&&(t=Yi.ease.apply(Yi,arguments)),O(this,function(n){n[r][e].ease=t}))},ba.delay=function(r){var i=this.id,u=this.namespace;return arguments.length<1?this.node()[u][i].delay:O(this,"function"==typeof r?function(n,t,e){n[u][i].delay=+r.call(n,n.__data__,t,e)}:(r=+r,function(n){n[u][i].delay=r}))},ba.duration=function(r){var i=this.id,u=this.namespace;return arguments.length<1?this.node()[u][i].duration:O(this,"function"==typeof r?function(n,t,e){n[u][i].duration=Math.max(1,r.call(n,n.__data__,t,e))}:(r=Math.max(1,r),function(n){n[u][i].duration=r}))},ba.each=function(r,e){var i=this.id,u=this.namespace;if(arguments.length<2){var n=Ma,t=ma;try{ma=i,O(this,function(n,t,e){Ma=n[u][i],r.call(n,n.__data__,t,e)})}finally{Ma=n,ma=t}}else O(this,function(n){var t=n[u][i];(t.event||(t.event=Yi.dispatch("start","end","interrupt"))).on(r,e)});return this},ba.transition=function(){for(var n,t,e,r=this.id,i=++_a,u=this.namespace,o=[],a=0,l=this.length;a<l;a++){o.push(n=[]);for(var c,f=0,s=(c=this[a]).length;f<s;f++)(t=c[f])&&Di(t,f,u,i,{time:(e=t[u][r]).time,ease:e.ease,delay:e.delay+e.duration,duration:e.duration}),n.push(t)}return qi(o,u,i)},Yi.svg.axis=function(){function e(n){n.each(function(){var n,t=Yi.select(this),e=this.__chart__||E,r=this.__chart__=E.copy(),i=null==T?r.ticks?r.ticks.apply(r,L):r.domain():T,u=null==N?r.tickFormat?r.tickFormat.apply(r,L):R:N,o=t.selectAll(".tick").data(i,r),a=o.enter().insert("g",".domain").attr("class","tick").style("opacity",vu),l=Yi.transition(o.exit()).style("opacity",vu).remove(),c=Yi.transition(o.order()).style("opacity",1),f=Math.max(C,0)+q,s=$r(r),h=t.selectAll(".domain").data([0]),p=(h.enter().append("path").attr("class","domain"),Yi.transition(h));a.append("line"),a.append("text");var g,v,d,y,m=a.select("line"),M=c.select("line"),x=o.select("text").text(u),b=a.select("text"),_=c.select("text"),w="top"===A||"left"===A?-1:1;if("bottom"===A||"top"===A?(n=Pi,g="x",d="y",v="x2",y="y2",x.attr("dy",w<0?"0em":".71em").style("text-anchor","middle"),p.attr("d","M"+s[0]+","+w*z+"V0H"+s[1]+"V"+w*z)):(n=Ui,g="y",d="x",v="y2",y="x2",x.attr("dy",".32em").style("text-anchor",w<0?"end":"start"),p.attr("d","M"+w*z+","+s[0]+"H0V"+s[1]+"H"+w*z)),m.attr(y,w*C),b.attr(d,w*f),M.attr(v,0).attr(y,w*C),_.attr(g,0).attr(d,w*f),r.rangeBand){var S=r,k=S.rangeBand()/2;e=r=function(n){return S(n)+k}}else e.rangeBand?e=r:l.call(n,r,e);a.call(n,e,r),c.call(n,r,r)})}var N,E=Yi.scale.linear(),A=wa,C=6,z=6,q=3,L=[10],T=null;return e.scale=function(n){return arguments.length?(E=n,e):E},e.orient=function(n){return arguments.length?(A=n in Sa?n+"":wa,e):A},e.ticks=function(){return arguments.length?(L=arguments,e):L},e.tickValues=function(n){return arguments.length?(T=n,e):T},e.tickFormat=function(n){return arguments.length?(N=n,e):N},e.tickSize=function(n){var t=arguments.length;return t?(C=+n,z=+arguments[t-1],e):C},e.innerTickSize=function(n){return arguments.length?(C=+n,e):C},e.outerTickSize=function(n){return arguments.length?(z=+n,e):z},e.tickPadding=function(n){return arguments.length?(q=+n,e):q},e.tickSubdivide=function(){return arguments.length&&e},e};var wa="bottom",Sa={top:1,right:1,bottom:1,left:1};Yi.svg.brush=function(){function m(n){n.each(function(){var n=Yi.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",o).on("touchstart.brush",o),t=n.selectAll(".background").data([0]);t.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),n.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var e=n.selectAll(".resize").data(a,R);e.exit().remove(),e.enter().append("g").attr("class",function(n){return"resize "+n}).style("cursor",function(n){return ka[n]}).append("rect").attr("x",function(n){return/[ew]$/.test(n)?-3:null}).attr("y",function(n){return/^[ns]/.test(n)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),e.style("display",m.empty()?"none":null);var r,i=Yi.transition(n),u=Yi.transition(t);k&&(r=$r(k),u.attr("x",r[0]).attr("width",r[1]-r[0]),x(i)),N&&(r=$r(N),u.attr("y",r[0]).attr("height",r[1]-r[0]),b(i)),M(i)})}function M(n){n.selectAll(".resize").attr("transform",function(n){return"translate("+E[+/e$/.test(n)]+","+A[+/^s/.test(n)]+")"})}function x(n){n.select(".extent").attr("x",E[0]),n.selectAll(".extent,.n>rect,.s>rect").attr("width",E[1]-E[0])}function b(n){n.select(".extent").attr("y",A[0]),n.selectAll(".extent,.e>rect,.w>rect").attr("height",A[1]-A[0])}function o(){function n(){var n=Yi.mouse(i),t=!1;r&&(n[0]+=r[0],n[1]+=r[1]),h||(Yi.event.altKey?(s||(s=[(E[0]+E[1])/2,(A[0]+A[1])/2]),g[0]=E[+(n[0]<s[0])],g[1]=A[+(n[1]<s[1])]):s=null),c&&e(n,k,0)&&(x(a),t=!0),f&&e(n,N,1)&&(b(a),t=!0),t&&(M(a),o({type:"brush",mode:h?"move":"resize"}))}function e(n,t,e){var r,i,u=$r(t),o=u[0],a=u[1],l=g[e],c=e?A:E,f=c[1]-c[0];return h&&(o-=l,a-=f+l),r=(e?z:C)?Math.max(o,Math.min(a,n[e])):n[e],h?i=(r+=l)+f:(s&&(l=Math.max(o,Math.min(a,2*s[e]-r))),l<r?(i=r,r=l):i=l),c[0]!=r||c[1]!=i?(e?w=null:_=null,c[0]=r,c[1]=i,!0):void 0}function t(){n(),a.style("pointer-events","all").selectAll(".resize").style("display",m.empty()?"none":null),Yi.select("body").style("cursor",null),v.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),p(),o({type:"brushend"})}var s,r,i=this,u=Yi.select(Yi.event.target),o=S.of(i,arguments),a=Yi.select(i),l=u.datum(),c=!/^(n|s)$/.test(l)&&k,f=!/^(e|w)$/.test(l)&&N,h=u.classed("extent"),p=X(i),g=Yi.mouse(i),v=Yi.select(T(i)).on("keydown.brush",function(){32==Yi.event.keyCode&&(h||(s=null,g[0]-=E[1],g[1]-=A[1],h=2),D())}).on("keyup.brush",function(){32==Yi.event.keyCode&&2==h&&(g[0]+=E[1],g[1]+=A[1],h=0,D())});if(Yi.event.changedTouches?v.on("touchmove.brush",n).on("touchend.brush",t):v.on("mousemove.brush",n).on("mouseup.brush",t),a.interrupt().selectAll("*").interrupt(),h)g[0]=E[0]-g[0],g[1]=A[0]-g[1];else if(l){var d=+/w$/.test(l),y=+/^n/.test(l);r=[E[1-d]-g[0],A[1-y]-g[1]],g[0]=E[d],g[1]=A[y]}else Yi.event.altKey&&(s=g.slice());a.style("pointer-events","none").selectAll(".resize").style("display",null),Yi.select("body").style("cursor",u.style("cursor")),o({type:"brushstart"}),n()}var _,w,S=P(m,"brushstart","brush","brushend"),k=null,N=null,E=[0,0],A=[0,0],C=!0,z=!0,a=Na[0];return m.event=function(n){n.each(function(){var r=S.of(this,arguments),i={x:E,y:A,i:_,j:w},n=this.__chart__||i;this.__chart__=i,ma?Yi.select(this).transition().each("start.brush",function(){_=n.i,w=n.j,E=n.x,A=n.y,r({type:"brushstart"})}).tween("brush:brush",function(){var t=Xe(E,i.x),e=Xe(A,i.y);return _=w=null,function(n){E=i.x=t(n),A=i.y=e(n),r({type:"brush",mode:"resize"})}}).each("end.brush",function(){_=i.i,w=i.j,r({type:"brush",mode:"resize"}),r({type:"brushend"})}):(r({type:"brushstart"}),r({type:"brush",mode:"resize"}),r({type:"brushend"}))})},m.x=function(n){return arguments.length?(a=Na[!(k=n)<<1|!N],m):k},m.y=function(n){return arguments.length?(a=Na[!k<<1|!(N=n)],m):N},m.clamp=function(n){return arguments.length?(k&&N?(C=!!n[0],z=!!n[1]):k?C=!!n:N&&(z=!!n),m):k&&N?[C,z]:k?C:N?z:null},m.extent=function(n){var t,e,r,i,u;return arguments.length?(k&&(t=n[0],e=n[1],N&&(t=t[0],e=e[0]),_=[t,e],k.invert&&(t=k(t),e=k(e)),e<t&&(u=t,t=e,e=u),(t!=E[0]||e!=E[1])&&(E=[t,e])),N&&(r=n[0],i=n[1],k&&(r=r[1],i=i[1]),w=[r,i],N.invert&&(r=N(r),i=N(i)),i<r&&(u=r,r=i,i=u),(r!=A[0]||i!=A[1])&&(A=[r,i])),m):(k&&(_?(t=_[0],e=_[1]):(t=E[0],e=E[1],k.invert&&(t=k.invert(t),e=k.invert(e)),e<t&&(u=t,t=e,e=u))),N&&(w?(r=w[0],i=w[1]):(r=A[0],i=A[1],N.invert&&(r=N.invert(r),i=N.invert(i)),i<r&&(u=r,r=i,i=u))),k&&N?[[t,r],[e,i]]:k?[t,e]:N&&[r,i])},m.clear=function(){return m.empty()||(E=[0,0],A=[0,0],_=w=null),m},m.empty=function(){return!!k&&E[0]==E[1]||!!N&&A[0]==A[1]},Yi.rebind(m,S,"on")};var ka={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Na=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],Ea=Vu.format=Gu.timeFormat,Aa=Ea.utc,Ca=Aa("%Y-%m-%dT%H:%M:%S.%LZ");Ea.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?ji:Ca,ji.parse=function(n){var t=new Date(n);return isNaN(t)?null:t},ji.toString=Ca.toString,Vu.second=qn(function(n){return new Xu(1e3*Math.floor(n/1e3))},function(n,t){n.setTime(n.getTime()+1e3*Math.floor(t))},function(n){return n.getSeconds()}),Vu.seconds=Vu.second.range,Vu.seconds.utc=Vu.second.utc.range,Vu.minute=qn(function(n){return new Xu(6e4*Math.floor(n/6e4))},function(n,t){n.setTime(n.getTime()+6e4*Math.floor(t))},function(n){return n.getMinutes()}),Vu.minutes=Vu.minute.range,Vu.minutes.utc=Vu.minute.utc.range,Vu.hour=qn(function(n){var t=n.getTimezoneOffset()/60;return new Xu(36e5*(Math.floor(n/36e5-t)+t))},function(n,t){n.setTime(n.getTime()+36e5*Math.floor(t))},function(n){return n.getHours()}),Vu.hours=Vu.hour.range,Vu.hours.utc=Vu.hour.utc.range,Vu.month=qn(function(n){return(n=Vu.day(n)).setDate(1),n},function(n,t){n.setMonth(n.getMonth()+t)},function(n){return n.getMonth()}),Vu.months=Vu.month.range,Vu.months.utc=Vu.month.utc.range;var za=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],qa=[[Vu.second,1],[Vu.second,5],[Vu.second,15],[Vu.second,30],[Vu.minute,1],[Vu.minute,5],[Vu.minute,15],[Vu.minute,30],[Vu.hour,1],[Vu.hour,3],[Vu.hour,6],[Vu.hour,12],[Vu.day,1],[Vu.day,2],[Vu.week,1],[Vu.month,1],[Vu.month,3],[Vu.year,1]],La=Ea.multi([[".%L",function(n){return n.getMilliseconds()}],[":%S",function(n){return n.getSeconds()}],["%I:%M",function(n){return n.getMinutes()}],["%I %p",function(n){return n.getHours()}],["%a %d",function(n){return n.getDay()&&1!=n.getDate()}],["%b %d",function(n){return 1!=n.getDate()}],["%B",function(n){return n.getMonth()}],["%Y",mt]]),Ta={range:function(n,t,e){return Yi.range(Math.ceil(n/e)*e,+t,e).map(Hi)},floor:R,ceil:R};qa.year=Vu.year,Vu.scale=function(){return Fi(Yi.scale.linear(),qa,La)};var Ra=qa.map(function(n){return[n[0].utc,n[1]]}),Da=Aa.multi([[".%L",function(n){return n.getUTCMilliseconds()}],[":%S",function(n){return n.getUTCSeconds()}],["%I:%M",function(n){return n.getUTCMinutes()}],["%I %p",function(n){return n.getUTCHours()}],["%a %d",function(n){return n.getUTCDay()&&1!=n.getUTCDate()}],["%b %d",function(n){return 1!=n.getUTCDate()}],["%B",function(n){return n.getUTCMonth()}],["%Y",mt]]);Ra.year=Vu.year.utc,Vu.scale.utc=function(){return Fi(Yi.scale.linear(),Ra,Da)},Yi.text=wn(function(n){return n.responseText}),Yi.json=function(n,t){return Sn(n,"application/json",Oi,t)},Yi.html=function(n,t){return Sn(n,"text/html",Ii,t)},Yi.xml=wn(function(n){return n.responseXML}),"function"==typeof define&&define.amd?define(Yi):"object"==typeof module&&module.exports&&(module.exports=Yi),this.d3=Yi}();
!function(d){"use strict";function e(t){this.owner=t}function i(t){var e=this.internal=new a(this);e.loadConfig(t),e.init(),function e(i,a,n){Object.keys(i).forEach(function(t){a[t]=i[t].bind(n),0<Object.keys(i[t]).length&&e(i[t],a[t],n)})}(n,this,this)}function a(t){var e=this;e.d3=d.d3?d.d3:"undefined"!=typeof require?require("d3"):void 0,e.api=t,e.config=e.getDefaultConfig(),e.data={},e.cache={},e.axes={}}function o(t){e.call(this,t)}function u(k,E){function Y(t,e){t.attr("transform",function(t){return"translate("+Math.ceil(e(t)+U)+", 0)"})}function R(t,e){t.attr("transform",function(t){return"translate(0,"+Math.ceil(e(t))+")"})}function O(t){var e=i?i(t):t;return void 0!==e?e:""}function M(t){return E.withoutTransition?t:k.transition(t)}function B(t){t.each(function(){function t(t,e){var i=T.h;return 0===e&&(i="left"===G||"right"===G?-((b[t.index]-1)*(T.h/2)-3):".71em"),i}var e,i,a,n=B.g=k.select(this),r=this.__chart__||W,c=this.__chart__=function(){var t,e=W.copy();return E.isCategory&&(t=W.domain(),e.domain([t[0],t[1]-1])),e}(),d=j||function(t){var e,i,a=[];if(t.ticks)return t.ticks.apply(t,z);for(i=t.domain(),e=Math.ceil(i[0]);e<i[1];e++)a.push(e);return 0<a.length&&0<a[0]&&a.unshift(a[0]-(a[1]-a[0])),a}(c),s=n.selectAll(".tick").data(d,c),o=s.enter().insert("g",".domain").attr("class","tick").style("opacity",1e-6),l=s.exit().remove(),u=M(s).style("opacity",1),g=W.rangeExtent?W.rangeExtent():function(t){var e=t[0],i=t[t.length-1];return e<i?[e,i]:[i,e]}(W.range()),h=n.selectAll(".domain").data([0]),f=(h.enter().append("path").attr("class","domain"),M(h));o.append("line"),o.append("text");var x=o.select("line"),p=u.select("line"),_=o.select("text"),m=u.select("text");E.isCategory?(U=Math.ceil((c(1)-c(0))/2),i=V?0:U,a=V?U:0):U=i=0;var y,v,T=function(t){if(K)return K;var r={h:11.5,w:5.5};return t.select("text").text(O).each(function(t){var e=this.getBoundingClientRect(),i=O(t),a=e.height,n=i?e.width/i.length:void 0;a&&n&&(r.h=a,r.w=n)}).text(""),K=r}(n.select(".tick")),b=[],A=Math.max(H,0)+N,w="left"===G||"right"===G;(v=(y=s.select("text")).selectAll("tspan").data(function(t,e){var i=E.tickMultiline?function(t,n){var r,s,o,e=O(t);return"[object Array]"===Object.prototype.toString.call(e)?e:((!n||n<=0)&&(n=w?95:E.isCategory?Math.ceil(c(d[1])-c(d[0]))-12:110),function t(e,i){s=void 0;for(var a=1;a<i.length;a++)if(" "===i.charAt(a)&&(s=a),r=i.substr(0,a+1),o=T.w*r.length,n<o)return t(e.concat(i.substr(0,s||a)),i.slice(s?s+1:a));return e.concat(i)}([],e+""))}(t,E.tickWidth):[].concat(O(t));return b[e]=i.length,i.map(function(t){return{index:e,splitted:t}})})).enter().append("tspan"),v.exit().remove(),v.text(function(t){return t.splitted});var L,S,C,D,X=E.tickTextRotate;switch(G){case"bottom":e=Y,x.attr("y2",H),_.attr("y",A),p.attr("x1",i).attr("x2",i).attr("y2",function(t){var e=W(t)+(V?0:U);return g[0]<e&&e<g[1]?H:0}),m.attr("x",0).attr("y",(D=X)?11.5-D/15*2.5*(0<D?1:-1):A).style("text-anchor",(C=X)?0<C?"start":"end":"middle").attr("transform",(S=X)?"rotate("+S+")":""),v.attr("x",0).attr("dy",t).attr("dx",(L=X)?8*Math.sin(Math.PI*(L/180)):0),f.attr("d","M"+g[0]+","+P+"V0H"+g[1]+"V"+P);break;case"top":e=Y,x.attr("y2",-H),_.attr("y",-A),p.attr("x2",0).attr("y2",-H),m.attr("x",0).attr("y",-A),y.style("text-anchor","middle"),v.attr("x",0).attr("dy","0em"),f.attr("d","M"+g[0]+","+-P+"V0H"+g[1]+"V"+-P);break;case"left":e=R,x.attr("x2",-H),_.attr("x",-A),p.attr("x2",-H).attr("y1",a).attr("y2",a),m.attr("x",-A).attr("y",U),y.style("text-anchor","end"),v.attr("x",-A).attr("dy",t),f.attr("d","M"+-P+","+g[0]+"H0V"+g[1]+"H"+-P);break;case"right":e=R,x.attr("x2",H),_.attr("x",A),p.attr("x2",H).attr("y2",0),m.attr("x",A).attr("y",0),y.style("text-anchor","start"),v.attr("x",A).attr("dy",t),f.attr("d","M"+P+","+g[0]+"H0V"+g[1]+"H"+P)}if(c.rangeBand){var F=c,I=F.rangeBand()/2;r=c=function(t){return F(t)+I}}else r.rangeBand?r=c:l.call(e,c);o.call(e,r),u.call(e,c)})}var P,i,z,V,W=k.scale.linear(),G="bottom",H=6,N=3,j=null,U=0,e=!0;return P=(E=E||{}).withOuterTick?6:0,B.scale=function(t){return arguments.length?(W=t,B):W},B.orient=function(t){return arguments.length?(G=t in{top:1,right:1,bottom:1,left:1}?t+"":"bottom",B):G},B.tickFormat=function(t){return arguments.length?(i=t,B):i},B.tickCentered=function(t){return arguments.length?(V=t,B):V},B.tickOffset=function(){return U},B.tickInterval=function(){var t;return 1/0===(t=E.isCategory?2*U:(B.g.select("path.domain").node().getTotalLength()-2*P)/B.g.selectAll("line").size())?0:t},B.ticks=function(){return arguments.length?(z=arguments,B):z},B.tickCulling=function(t){return arguments.length?(e=t,B):e},B.tickValues=function(t){if("function"==typeof t)j=function(){return t(W.domain())};else{if(!arguments.length)return j;j=t}return B},B}var n,l,t={version:"0.4.10",generate:function(t){return new i(t)}};t.chart={fn:i.prototype,internal:{fn:a.prototype,axis:{fn:o.prototype}}},n=t.chart.fn,l=t.chart.internal.fn,t.chart.internal.axis.fn,l.init=function(){var t=this,e=t.config;if(t.initParams(),e.data_url)t.convertUrlToData(e.data_url,e.data_mimeType,e.data_keys,t.initWithData);else if(e.data_json)t.initWithData(t.convertJsonToData(e.data_json,e.data_keys));else if(e.data_rows)t.initWithData(t.convertRowsToData(e.data_rows));else{if(!e.data_columns)throw Error("url or json or rows or columns is required.");t.initWithData(t.convertColumnsToData(e.data_columns))}},l.initParams=function(){var t=this,e=t.d3,i=t.config;t.clipId="c3-"+ +new Date+"-clip",t.clipIdForXAxis=t.clipId+"-xaxis",t.clipIdForYAxis=t.clipId+"-yaxis",t.clipIdForGrid=t.clipId+"-grid",t.clipIdForSubchart=t.clipId+"-subchart",t.clipPath=t.getClipPath(t.clipId),t.clipPathForXAxis=t.getClipPath(t.clipIdForXAxis),t.clipPathForYAxis=t.getClipPath(t.clipIdForYAxis),t.clipPathForGrid=t.getClipPath(t.clipIdForGrid),t.clipPathForSubchart=t.getClipPath(t.clipIdForSubchart),t.dragStart=null,t.dragging=!1,t.flowing=!1,t.cancelClick=!1,t.mouseover=!1,t.transiting=!1,t.color=t.generateColor(),t.levelColor=t.generateLevelColor(),t.dataTimeFormat=i.data_xLocaltime?e.time.format:e.time.format.utc,t.axisTimeFormat=i.axis_x_localtime?e.time.format:e.time.format.utc,t.defaultAxisTimeFormat=t.axisTimeFormat.multi([[".%L",function(t){return t.getMilliseconds()}],[":%S",function(t){return t.getSeconds()}],["%I:%M",function(t){return t.getMinutes()}],["%I %p",function(t){return t.getHours()}],["%-m/%-d",function(t){return t.getDay()&&1!==t.getDate()}],["%-m/%-d",function(t){return 1!==t.getDate()}],["%-m/%-d",function(t){return t.getMonth()}],["%Y/%-m/%-d",function(){return!0}]]),t.hiddenTargetIds=[],t.hiddenLegendIds=[],t.focusedTargetIds=[],t.defocusedTargetIds=[],t.xOrient=i.axis_rotated?"left":"bottom",t.yOrient=i.axis_rotated?i.axis_y_inner?"top":"bottom":i.axis_y_inner?"right":"left",t.y2Orient=i.axis_rotated?i.axis_y2_inner?"bottom":"top":i.axis_y2_inner?"left":"right",t.subXOrient=i.axis_rotated?"left":"bottom",t.isLegendRight="right"===i.legend_position,t.isLegendInset="inset"===i.legend_position,t.isLegendTop="top-left"===i.legend_inset_anchor||"top-right"===i.legend_inset_anchor,t.isLegendLeft="top-left"===i.legend_inset_anchor||"bottom-left"===i.legend_inset_anchor,t.legendStep=0,t.legendItemWidth=0,t.legendItemHeight=0,t.currentMaxTickWidths={x:0,y:0,y2:0},t.rotated_padding_left=30,t.rotated_padding_right=i.axis_rotated&&!i.axis_x_show?0:30,t.rotated_padding_top=5,t.withoutFadeIn={},t.intervalForObserveInserted=void 0,t.axes.subx=e.selectAll([])},l.initChartElements=function(){this.initBar&&this.initBar(),this.initLine&&this.initLine(),this.initArc&&this.initArc(),this.initGauge&&this.initGauge(),this.initText&&this.initText()},l.initWithData=function(t){var e,i,a=this,n=a.d3,r=a.config,s=!0;a.axis=new o(a),a.initPie&&a.initPie(),a.initBrush&&a.initBrush(),a.initZoom&&a.initZoom(),a.selectChart=r.bindto?"function"==typeof r.bindto.node?r.bindto:n.select(r.bindto):n.selectAll([]),a.selectChart.empty()&&(a.selectChart=n.select(document.createElement("div")).style("opacity",0),a.observeInserted(a.selectChart),s=!1),a.selectChart.html("").classed("c3",!0),a.data.xs={},a.data.targets=a.convertDataToTargets(t),r.data_filter&&(a.data.targets=a.data.targets.filter(r.data_filter)),r.data_hide&&a.addHiddenTargetIds(!0===r.data_hide?a.mapToIds(a.data.targets):r.data_hide),r.legend_hide&&a.addHiddenLegendIds(!0===r.legend_hide?a.mapToIds(a.data.targets):r.legend_hide),a.hasType("gauge")&&(r.legend_show=!1),a.updateSizes(),a.updateScales(),a.x.domain(n.extent(a.getXDomain(a.data.targets))),a.y.domain(a.getYDomain(a.data.targets,"y")),a.y2.domain(a.getYDomain(a.data.targets,"y2")),a.subX.domain(a.x.domain()),a.subY.domain(a.y.domain()),a.subY2.domain(a.y2.domain()),a.orgXDomain=a.x.domain(),a.brush&&a.brush.scale(a.subX),r.zoom_enabled&&a.zoom.scale(a.x),a.svg=a.selectChart.append("svg").style("overflow","hidden").on("mouseenter",function(){return r.onmouseover.call(a)}).on("mouseleave",function(){return r.onmouseout.call(a)}),e=a.svg.append("defs"),a.clipChart=a.appendClip(e,a.clipId),a.clipXAxis=a.appendClip(e,a.clipIdForXAxis),a.clipYAxis=a.appendClip(e,a.clipIdForYAxis),a.clipGrid=a.appendClip(e,a.clipIdForGrid),a.clipSubchart=a.appendClip(e,a.clipIdForSubchart),a.updateSvgSize(),i=a.main=a.svg.append("g").attr("transform",a.getTranslate("main")),a.initSubchart&&a.initSubchart(),a.initTooltip&&a.initTooltip(),a.initLegend&&a.initLegend(),i.append("text").attr("class",V.text+" "+V.empty).attr("text-anchor","middle").attr("dominant-baseline","middle"),a.initRegion(),a.initGrid(),i.append("g").attr("clip-path",a.clipPath).attr("class",V.chart),r.grid_lines_front&&a.initGridLines(),a.initEventRect(),a.initChartElements(),i.insert("rect",r.zoom_privileged?null:"g."+V.regions).attr("class",V.zoomRect).attr("width",a.width).attr("height",a.height).style("opacity",0).on("dblclick.zoom",null),r.axis_x_extent&&a.brush.extent(a.getDefaultExtent()),a.axis.init(),a.updateTargets(a.data.targets),s&&(a.updateDimension(),a.config.oninit.call(a),a.redraw({withTransition:!1,withTransform:!0,withUpdateXDomain:!0,withUpdateOrgXDomain:!0,withTransitionForAxis:!1})),null==d.onresize&&(d.onresize=a.generateResize()),d.onresize.add&&(d.onresize.add(function(){r.onresize.call(a)}),d.onresize.add(function(){a.api.flush()}),d.onresize.add(function(){r.onresized.call(a)})),a.api.element=a.selectChart.node()},l.smoothLines=function(t,e){var r=this;"grid"===e&&t.each(function(){var t=r.d3.select(this),e=t.attr("x1"),i=t.attr("x2"),a=t.attr("y1"),n=t.attr("y2");t.attr({x1:Math.ceil(e),x2:Math.ceil(i),y1:Math.ceil(a),y2:Math.ceil(n)})})},l.updateSizes=function(){var t=this,e=t.config,i=t.legend?t.getLegendHeight():0,a=t.legend?t.getLegendWidth():0,n=t.isLegendRight||t.isLegendInset?0:i,r=t.hasArcType(),s=e.axis_rotated||r?0:t.getHorizontalAxisHeight("x"),o=e.subchart_show&&!r?e.subchart_size_height+s:0;t.currentWidth=t.getCurrentWidth(),t.currentHeight=t.getCurrentHeight(),t.margin=e.axis_rotated?{top:t.getHorizontalAxisHeight("y2")+t.getCurrentPaddingTop(),right:r?0:t.getCurrentPaddingRight(),bottom:t.getHorizontalAxisHeight("y")+n+t.getCurrentPaddingBottom(),left:o+(r?0:t.getCurrentPaddingLeft())}:{top:4+t.getCurrentPaddingTop(),right:r?0:t.getCurrentPaddingRight(),bottom:s+o+n+t.getCurrentPaddingBottom(),left:r?0:t.getCurrentPaddingLeft()},t.margin2=e.axis_rotated?{top:t.margin.top,right:NaN,bottom:20+n,left:t.rotated_padding_left}:{top:t.currentHeight-o-n,right:NaN,bottom:s+n,left:t.margin.left},t.margin3={top:0,right:NaN,bottom:0,left:0},t.updateSizeForLegend&&t.updateSizeForLegend(i,a),t.width=t.currentWidth-t.margin.left-t.margin.right,t.height=t.currentHeight-t.margin.top-t.margin.bottom,t.width<0&&(t.width=0),t.height<0&&(t.height=0),t.width2=e.axis_rotated?t.margin.left-t.rotated_padding_left-t.rotated_padding_right:t.width,t.height2=e.axis_rotated?t.height:t.currentHeight-t.margin2.top-t.margin2.bottom,t.width2<0&&(t.width2=0),t.height2<0&&(t.height2=0),t.arcWidth=t.width-(t.isLegendRight?a+10:0),t.arcHeight=t.height-(t.isLegendRight?0:10),t.hasType("gauge")&&(t.arcHeight+=t.height-t.getGaugeLabelHeight()),t.updateRadius&&t.updateRadius(),t.isLegendRight&&r&&(t.margin3.left=t.arcWidth/2+1.1*t.radiusExpanded)},l.updateTargets=function(t){var e=this;e.updateTargetsForText(t),e.updateTargetsForBar(t),e.updateTargetsForLine(t),e.hasArcType()&&e.updateTargetsForArc&&e.updateTargetsForArc(t),e.updateTargetsForSubchart&&e.updateTargetsForSubchart(t),e.showTargets()},l.showTargets=function(){var e=this;e.svg.selectAll("."+V.target).filter(function(t){return e.isTargetToShow(t.id)}).transition().duration(e.config.transition_duration).style("opacity",1)},l.redraw=function(t,e){var i,a,n,r,s,o,c,d,l,u,g,h,f,x,p,_,m,y,v,T,b,A,w,L,S,C,D,X,F,I=this,k=I.main,E=I.d3,Y=I.config,R=I.getShapeIndices(I.isAreaType),O=I.getShapeIndices(I.isBarType),M=I.getShapeIndices(I.isLineType),B=I.hasArcType(),P=I.filterTargetsToShow(I.data.targets),z=I.xv.bind(I);if(i=W(t=t||{},"withY",!0),a=W(t,"withSubchart",!0),n=W(t,"withTransition",!0),o=W(t,"withTransform",!1),c=W(t,"withUpdateXDomain",!1),d=W(t,"withUpdateOrgXDomain",!1),l=W(t,"withTrimXDomain",!0),f=W(t,"withUpdateXAxis",c),u=W(t,"withLegend",!1),g=W(t,"withEventRect",!0),h=W(t,"withDimension",!0),r=W(t,"withTransitionForExit",n),s=W(t,"withTransitionForAxis",n),v=n?Y.transition_duration:0,T=r?v:0,b=s?v:0,e=e||I.axis.generateTransitions(b),u&&Y.legend_show?I.updateLegend(I.mapToIds(I.data.targets),t,e):h&&I.updateDimension(!0),I.isCategorized()&&0===P.length&&I.x.domain([0,I.axes.x.selectAll(".tick").size()]),P.length?(I.updateXDomain(P,c,d,l),Y.axis_x_tick_values||(L=I.axis.updateXAxisTickValues(P))):(I.xAxis.tickValues([]),I.subXAxis.tickValues([])),Y.zoom_rescale&&!t.flow&&(D=I.x.orgDomain()),I.y.domain(I.getYDomain(P,"y",D)),I.y2.domain(I.getYDomain(P,"y2",D)),!Y.axis_y_tick_values&&Y.axis_y_tick_count&&I.yAxis.tickValues(I.axis.generateTickValues(I.y.domain(),Y.axis_y_tick_count)),!Y.axis_y2_tick_values&&Y.axis_y2_tick_count&&I.y2Axis.tickValues(I.axis.generateTickValues(I.y2.domain(),Y.axis_y2_tick_count)),I.axis.redraw(e,B),I.axis.updateLabels(n),(c||f)&&P.length)if(Y.axis_x_tick_culling&&L){for(S=1;S<L.length;S++)if(L.length/S<Y.axis_x_tick_culling_max){C=S;break}I.svg.selectAll("."+V.axisX+" .tick text").each(function(t){var e=L.indexOf(t);0<=e&&E.select(this).style("display",e%C?"none":"block")})}else I.svg.selectAll("."+V.axisX+" .tick text").style("display","block");x=I.generateDrawArea?I.generateDrawArea(R,!1):void 0,p=I.generateDrawBar?I.generateDrawBar(O):void 0,_=I.generateDrawLine?I.generateDrawLine(M,!1):void 0,m=I.generateXYForText(R,O,M,!0),y=I.generateXYForText(R,O,M,!1),i&&(I.subY.domain(I.getYDomain(P,"y")),I.subY2.domain(I.getYDomain(P,"y2"))),I.tooltip.style("display","none"),I.updateXgridFocus(),k.select("text."+V.text+"."+V.empty).attr("x",I.width/2).attr("y",I.height/2).text(Y.data_empty_label_text).transition().style("opacity",P.length?0:1),I.updateGrid(v),I.updateRegion(v),I.updateBar(T),I.updateLine(T),I.updateArea(T),I.updateCircle(),I.hasDataLabel()&&I.updateText(T),I.redrawArc&&I.redrawArc(v,T,o),I.redrawSubchart&&I.redrawSubchart(a,e,v,T,R,O,M),k.selectAll("."+V.selectedCircles).filter(I.isBarType.bind(I)).selectAll("circle").remove(),Y.interaction_enabled&&!t.flow&&g&&(I.redrawEventRect(),I.updateZoom&&I.updateZoom()),I.updateCircleY(),X=(I.config.axis_rotated?I.circleY:I.circleX).bind(I),F=(I.config.axis_rotated?I.circleX:I.circleY).bind(I),t.flow&&(w=I.generateFlow({targets:P,flow:t.flow,duration:t.flow.duration,drawBar:p,drawLine:_,drawArea:x,cx:X,cy:F,xv:z,xForText:m,yForText:y})),(v||w)&&I.isTabVisible()?E.transition().duration(v).each(function(){var e=[];[I.redrawBar(p,!0),I.redrawLine(_,!0),I.redrawArea(x,!0),I.redrawCircle(X,F,!0),I.redrawText(m,y,t.flow,!0),I.redrawRegion(!0),I.redrawGrid(!0)].forEach(function(t){t.forEach(function(t){e.push(t)})}),A=I.generateWait(),e.forEach(function(t){A.add(t)})}).call(A,function(){w&&w(),Y.onrendered&&Y.onrendered.call(I)}):(I.redrawBar(p),I.redrawLine(_),I.redrawArea(x),I.redrawCircle(X,F),I.redrawText(m,y,t.flow),I.redrawRegion(),I.redrawGrid(),Y.onrendered&&Y.onrendered.call(I)),I.mapToIds(I.data.targets).forEach(function(t){I.withoutFadeIn[t]=!0})},l.updateAndRedraw=function(t){var e,i=this,a=i.config;(t=t||{}).withTransition=W(t,"withTransition",!0),t.withTransform=W(t,"withTransform",!1),t.withLegend=W(t,"withLegend",!1),t.withUpdateXDomain=!0,t.withUpdateOrgXDomain=!0,t.withTransitionForExit=!1,t.withTransitionForTransform=W(t,"withTransitionForTransform",t.withTransition),i.updateSizes(),t.withLegend&&a.legend_show||(e=i.axis.generateTransitions(t.withTransitionForAxis?a.transition_duration:0),i.updateScales(),i.updateSvgSize(),i.transformAll(t.withTransitionForTransform,e)),i.redraw(t,e)},l.redrawWithoutRescale=function(){this.redraw({withY:!1,withSubchart:!1,withEventRect:!1,withTransitionForAxis:!1})},l.isTimeSeries=function(){return"timeseries"===this.config.axis_x_type},l.isCategorized=function(){return 0<=this.config.axis_x_type.indexOf("categor")},l.isCustomX=function(){var t=this.config;return!this.isTimeSeries()&&(t.data_x||C(t.data_xs))},l.isTimeSeriesY=function(){return"timeseries"===this.config.axis_y_type},l.getTranslate=function(t){var e,i,a=this,n=a.config;return"main"===t?(e=c(a.margin.left),i=c(a.margin.top)):"context"===t?(e=c(a.margin2.left),i=c(a.margin2.top)):"legend"===t?(e=a.margin3.left,i=a.margin3.top):"x"===t?(e=0,i=n.axis_rotated?0:a.height):"y"===t?(e=0,i=n.axis_rotated?a.height:0):"y2"===t?(e=n.axis_rotated?0:a.width,i=n.axis_rotated?1:0):"subx"===t?(e=0,i=n.axis_rotated?0:a.height2):"arc"===t&&(e=a.arcWidth/2,i=a.arcHeight/2),"translate("+e+","+i+")"},l.initialOpacity=function(t){return null!==t.value&&this.withoutFadeIn[t.id]?1:0},l.initialOpacityForCircle=function(t){return null!==t.value&&this.withoutFadeIn[t.id]?this.opacityForCircle(t):0},l.opacityForCircle=function(t){var e=this.config.point_show?1:0;return S(t.value)?this.isScatterType(t)?.5:e:0},l.opacityForText=function(){return this.hasDataLabel()?1:0},l.xx=function(t){return t?this.x(t.x):null},l.xv=function(t){var e=this,i=t.value;return e.isTimeSeries()?i=e.parseDate(t.value):e.isCategorized()&&"string"==typeof t.value&&(i=e.config.axis_x_categories.indexOf(t.value)),Math.ceil(e.x(i))},l.yv=function(t){var e=t.axis&&"y2"===t.axis?this.y2:this.y;return Math.ceil(e(t.value))},l.subxx=function(t){return t?this.subX(t.x):null},l.transformMain=function(t,e){var i,a,n,r=this;e&&e.axisX?i=e.axisX:(i=r.main.select("."+V.axisX),t&&(i=i.transition())),e&&e.axisY?a=e.axisY:(a=r.main.select("."+V.axisY),t&&(a=a.transition())),e&&e.axisY2?n=e.axisY2:(n=r.main.select("."+V.axisY2),t&&(n=n.transition())),(t?r.main.transition():r.main).attr("transform",r.getTranslate("main")),i.attr("transform",r.getTranslate("x")),a.attr("transform",r.getTranslate("y")),n.attr("transform",r.getTranslate("y2")),r.main.select("."+V.chartArcs).attr("transform",r.getTranslate("arc"))},l.transformAll=function(t,e){var i=this;i.transformMain(t,e),i.config.subchart_show&&i.transformContext(t,e),i.legend&&i.transformLegend(t)},l.updateSvgSize=function(){var t=this,e=t.svg.select(".c3-brush .background");t.svg.attr("width",t.currentWidth).attr("height",t.currentHeight),t.svg.selectAll(["#"+t.clipId,"#"+t.clipIdForGrid]).select("rect").attr("width",t.width).attr("height",t.height),t.svg.select("#"+t.clipIdForXAxis).select("rect").attr("x",t.getXAxisClipX.bind(t)).attr("y",t.getXAxisClipY.bind(t)).attr("width",t.getXAxisClipWidth.bind(t)).attr("height",t.getXAxisClipHeight.bind(t)),t.svg.select("#"+t.clipIdForYAxis).select("rect").attr("x",t.getYAxisClipX.bind(t)).attr("y",t.getYAxisClipY.bind(t)).attr("width",t.getYAxisClipWidth.bind(t)).attr("height",t.getYAxisClipHeight.bind(t)),t.svg.select("#"+t.clipIdForSubchart).select("rect").attr("width",t.width).attr("height",e.size()?e.attr("height"):0),t.svg.select("."+V.zoomRect).attr("width",t.width).attr("height",t.height),t.selectChart.style("max-height",t.currentHeight+"px")},l.updateDimension=function(t){var e=this;t||(e.config.axis_rotated?(e.axes.x.call(e.xAxis),e.axes.subx.call(e.subXAxis)):(e.axes.y.call(e.yAxis),e.axes.y2.call(e.y2Axis))),e.updateSizes(),e.updateScales(),e.updateSvgSize(),e.transformAll(!1)},l.observeInserted=function(e){var i,a=this;return"undefined"==typeof MutationObserver?void d.console.error("MutationObserver not defined."):void(i=new MutationObserver(function(t){t.forEach(function(t){"childList"===t.type&&t.previousSibling&&(i.disconnect(),a.intervalForObserveInserted=d.setInterval(function(){e.node().parentNode&&(d.clearInterval(a.intervalForObserveInserted),a.updateDimension(),a.config.oninit.call(a),a.redraw({withTransform:!0,withUpdateXDomain:!0,withUpdateOrgXDomain:!0,withTransition:!1,withTransitionForTransform:!1,withLegend:!0}),e.transition().style("opacity",1))},10))})})).observe(e.node(),{attributes:!0,childList:!0,characterData:!0})},l.generateResize=function(){function t(){e.forEach(function(t){t()})}var e=[];return t.add=function(t){e.push(t)},t},l.endall=function(t,e){var i=0;t.each(function(){++i}).each("end",function(){--i||e.apply(this,arguments)})},l.generateWait=function(){var n=[],t=function(t,i){var a=setInterval(function(){var e=0;n.forEach(function(t){if(t.empty())e+=1;else try{t.transition()}catch(t){e+=1}}),e===n.length&&(clearInterval(a),i&&i())},10)};return t.add=function(t){n.push(t)},t},l.parseDate=function(t){var e;return t instanceof Date?e=t:"string"==typeof t?e=this.dataTimeFormat(this.config.data_xFormat).parse(t):"number"!=typeof t&&isNaN(t)||(e=new Date(+t)),(!e||isNaN(+e))&&d.console.error("Failed to parse x '"+t+"' to Date object"),e},l.isTabVisible=function(){var t;return void 0!==document.hidden?t="hidden":void 0!==document.mozHidden?t="mozHidden":void 0!==document.msHidden?t="msHidden":void 0!==document.webkitHidden&&(t="webkitHidden"),!document[t]},l.getDefaultConfig=function(){var e={bindto:"#chart",size_width:void 0,size_height:void 0,padding_left:void 0,padding_right:void 0,padding_top:void 0,padding_bottom:void 0,zoom_enabled:!1,zoom_extent:void 0,zoom_privileged:!1,zoom_rescale:!1,zoom_onzoom:function(){},zoom_onzoomstart:function(){},zoom_onzoomend:function(){},interaction_enabled:!0,onmouseover:function(){},onmouseout:function(){},onresize:function(){},onresized:function(){},oninit:function(){},onrendered:function(){},transition_duration:350,data_x:void 0,data_xs:{},data_xFormat:"%Y-%m-%d",data_xLocaltime:!0,data_xSort:!0,data_idConverter:function(t){return t},data_names:{},data_classes:{},data_groups:[],data_axes:{},data_type:void 0,data_types:{},data_labels:{},data_order:"desc",data_regions:{},data_color:void 0,data_colors:{},data_hide:!1,data_filter:void 0,data_selection_enabled:!1,data_selection_grouped:!1,data_selection_isselectable:function(){return!0},data_selection_multiple:!0,data_selection_draggable:!1,data_onclick:function(){},data_onmouseover:function(){},data_onmouseout:function(){},data_onselected:function(){},data_onunselected:function(){},data_url:void 0,data_json:void 0,data_rows:void 0,data_columns:void 0,data_mimeType:void 0,data_keys:void 0,data_empty_label_text:"",subchart_show:!1,subchart_size_height:60,subchart_onbrush:function(){},color_pattern:[],color_threshold:{},legend_show:!0,legend_hide:!1,legend_position:"bottom",legend_inset_anchor:"top-left",legend_inset_x:10,legend_inset_y:0,legend_inset_step:void 0,legend_item_onclick:void 0,legend_item_onmouseover:void 0,legend_item_onmouseout:void 0,legend_equally:!1,axis_rotated:!1,axis_x_show:!0,axis_x_type:"indexed",axis_x_localtime:!0,axis_x_categories:[],axis_x_tick_centered:!1,axis_x_tick_format:void 0,axis_x_tick_culling:{},axis_x_tick_culling_max:10,axis_x_tick_count:void 0,axis_x_tick_fit:!0,axis_x_tick_values:null,axis_x_tick_rotate:0,axis_x_tick_outer:!0,axis_x_tick_multiline:!0,axis_x_tick_width:null,axis_x_max:void 0,axis_x_min:void 0,axis_x_padding:{},axis_x_height:void 0,axis_x_extent:void 0,axis_x_label:{},axis_y_show:!0,axis_y_type:void 0,axis_y_max:void 0,axis_y_min:void 0,axis_y_inverted:!1,axis_y_center:void 0,axis_y_inner:void 0,axis_y_label:{},axis_y_tick_format:void 0,axis_y_tick_outer:!0,axis_y_tick_values:null,axis_y_tick_count:void 0,axis_y_tick_time_value:void 0,axis_y_tick_time_interval:void 0,axis_y_padding:{},axis_y_default:void 0,axis_y2_show:!1,axis_y2_max:void 0,axis_y2_min:void 0,axis_y2_inverted:!1,axis_y2_center:void 0,axis_y2_inner:void 0,axis_y2_label:{},axis_y2_tick_format:void 0,axis_y2_tick_outer:!0,axis_y2_tick_values:null,axis_y2_tick_count:void 0,axis_y2_padding:{},axis_y2_default:void 0,grid_x_show:!1,grid_x_type:"tick",grid_x_lines:[],grid_y_show:!1,grid_y_lines:[],grid_y_ticks:10,grid_focus_show:!0,grid_lines_front:!0,point_show:!0,point_r:2.5,point_focus_expand_enabled:!0,point_focus_expand_r:void 0,point_select_r:void 0,line_connectNull:!1,line_step_type:"step",bar_width:void 0,bar_width_ratio:.6,bar_width_max:void 0,bar_zerobased:!0,area_zerobased:!0,pie_label_show:!0,pie_label_format:void 0,pie_label_threshold:.05,pie_expand:!0,gauge_label_show:!0,gauge_label_format:void 0,gauge_expand:!0,gauge_min:0,gauge_max:100,gauge_units:void 0,gauge_width:void 0,donut_label_show:!0,donut_label_format:void 0,donut_label_threshold:.05,donut_width:void 0,donut_expand:!0,donut_title:"",regions:[],tooltip_show:!0,tooltip_grouped:!0,tooltip_format_title:void 0,tooltip_format_name:void 0,tooltip_format_value:void 0,tooltip_position:void 0,tooltip_contents:function(t,e,i,a){return this.getTooltipContent?this.getTooltipContent(t,e,i,a):""},tooltip_init_show:!1,tooltip_init_x:0,tooltip_init_position:{top:"0px",left:"50px"}};return Object.keys(this.additionalConfig).forEach(function(t){e[t]=this.additionalConfig[t]},this),e},l.additionalConfig={},l.loadConfig=function(e){var i,a,n,r=this.config;Object.keys(r).forEach(function(t){i=e,a=t.split("_"),n=function t(){var e=a.shift();return e&&i&&"object"==typeof i&&e in i?(i=i[e],t()):e?void 0:i}(),k(n)&&(r[t]=n)})},l.getScale=function(t,e,i){return(i?this.d3.time.scale():this.d3.scale.linear()).range([t,e])},l.getX=function(t,e,i,a){var n,r=this.getScale(t,e,this.isTimeSeries()),s=i?r.domain(i):r;for(n in r=this.isCategorized()?(a=a||function(){return 0},function(t,e){var i=s(t)+a(t);return e?i:Math.ceil(i)}):function(t,e){var i=s(t);return e?i:Math.ceil(i)},s)r[n]=s[n];return r.orgDomain=function(){return s.domain()},this.isCategorized()&&(r.domain=function(t){return arguments.length?(s.domain(t),r):[(t=this.orgDomain())[0],t[1]+1]}),r},l.getY=function(t,e,i){var a=this.getScale(t,e,this.isTimeSeriesY());return i&&a.domain(i),a},l.getYScale=function(t){return"y2"===this.axis.getId(t)?this.y2:this.y},l.getSubYScale=function(t){return"y2"===this.axis.getId(t)?this.subY2:this.subY},l.updateScales=function(){var e=this,t=e.config,i=!e.x;e.xMin=t.axis_rotated?1:0,e.xMax=t.axis_rotated?e.height:e.width,e.yMin=t.axis_rotated?0:e.height,e.yMax=t.axis_rotated?e.width:1,e.subXMin=e.xMin,e.subXMax=e.xMax,e.subYMin=t.axis_rotated?0:e.height2,e.subYMax=t.axis_rotated?e.width2:1,e.x=e.getX(e.xMin,e.xMax,i?void 0:e.x.orgDomain(),function(){return e.xAxis.tickOffset()}),e.y=e.getY(e.yMin,e.yMax,i?t.axis_y_default:e.y.domain()),e.y2=e.getY(e.yMin,e.yMax,i?t.axis_y2_default:e.y2.domain()),e.subX=e.getX(e.xMin,e.xMax,e.orgXDomain,function(t){return t%1?0:e.subXAxis.tickOffset()}),e.subY=e.getY(e.subYMin,e.subYMax,i?t.axis_y_default:e.subY.domain()),e.subY2=e.getY(e.subYMin,e.subYMax,i?t.axis_y2_default:e.subY2.domain()),e.xAxisTickFormat=e.axis.getXAxisTickFormat(),e.xAxisTickValues=e.axis.getXAxisTickValues(),e.yAxisTickValues=e.axis.getYAxisTickValues(),e.y2AxisTickValues=e.axis.getY2AxisTickValues(),e.xAxis=e.axis.getXAxis(e.x,e.xOrient,e.xAxisTickFormat,e.xAxisTickValues,t.axis_x_tick_outer),e.subXAxis=e.axis.getXAxis(e.subX,e.subXOrient,e.xAxisTickFormat,e.xAxisTickValues,t.axis_x_tick_outer),e.yAxis=e.axis.getYAxis(e.y,e.yOrient,t.axis_y_tick_format,e.yAxisTickValues,t.axis_y_tick_outer),e.y2Axis=e.axis.getYAxis(e.y2,e.y2Orient,t.axis_y2_tick_format,e.y2AxisTickValues,t.axis_y2_tick_outer),i||(e.brush&&e.brush.scale(e.subX),t.zoom_enabled&&e.zoom.scale(e.x)),e.updateArc&&e.updateArc()},l.getYDomainMin=function(t){var e,i,a,n,r,s,o=this,c=o.config,d=o.mapToIds(t),l=o.getValuesAsIdKeyed(t);if(0<c.data_groups.length)for(s=o.hasNegativeValueInTargets(t),e=0;e<c.data_groups.length;e++)if(0!==(n=c.data_groups[e].filter(function(t){return 0<=d.indexOf(t)})).length)for(a=n[0],s&&l[a]&&l[a].forEach(function(t,e){l[a][e]=t<0?t:0}),i=1;i<n.length;i++)r=n[i],l[r]&&l[r].forEach(function(t,e){o.axis.getId(r)!==o.axis.getId(a)||!l[a]||s&&0<+t||(l[a][e]+=+t)});return o.d3.min(Object.keys(l).map(function(t){return o.d3.min(l[t])}))},l.getYDomainMax=function(t){var e,i,a,n,r,s,o=this,c=o.config,d=o.mapToIds(t),l=o.getValuesAsIdKeyed(t);if(0<c.data_groups.length)for(s=o.hasPositiveValueInTargets(t),e=0;e<c.data_groups.length;e++)if(0!==(n=c.data_groups[e].filter(function(t){return 0<=d.indexOf(t)})).length)for(a=n[0],s&&l[a]&&l[a].forEach(function(t,e){l[a][e]=0<t?t:0}),i=1;i<n.length;i++)r=n[i],l[r]&&l[r].forEach(function(t,e){o.axis.getId(r)!==o.axis.getId(a)||!l[a]||s&&+t<0||(l[a][e]+=+t)});return o.d3.max(Object.keys(l).map(function(t){return o.d3.max(l[t])}))},l.getYDomain=function(t,e,i){var a,n,r,s,o,c,d,l,u,g,h=this,f=h.config,x=t.filter(function(t){return h.axis.getId(t.id)===e}),p=i?h.filterByXDomain(x,i):x,_="y2"===e?f.axis_y2_min:f.axis_y_min,m="y2"===e?f.axis_y2_max:f.axis_y_max,y=h.getYDomainMin(p),v=h.getYDomainMax(p),T="y2"===e?f.axis_y2_center:f.axis_y_center,b=h.hasType("bar",p)&&f.bar_zerobased||h.hasType("area",p)&&f.area_zerobased,A="y2"===e?f.axis_y2_inverted:f.axis_y_inverted,w=h.hasDataLabel()&&f.axis_rotated,L=h.hasDataLabel()&&!f.axis_rotated;return y=S(_)?_:S(m)?y<m?y:m-10:y,v=S(m)?m:S(_)?_<v?v:_+10:v,0===p.length?"y2"===e?h.y2.domain():h.y.domain():(isNaN(y)&&(y=0),isNaN(v)&&(v=y),y===v&&(y<0?v=0:y=0),u=0<=y&&0<=v,g=y<=0&&v<=0,(S(_)&&u||S(m)&&g)&&(b=!1),b&&(u&&(y=0),g&&(v=0)),r=s=.1*(n=Math.abs(v-y)),void 0!==T&&(v=T+(o=Math.max(Math.abs(y),Math.abs(v))),y=T-o),w?(c=h.getDataLabelLength(y,v,"width"),d=R(h.y.range()),r+=n*((l=[c[0]/d,c[1]/d])[1]/(1-l[0]-l[1])),s+=n*(l[0]/(1-l[0]-l[1]))):L&&(c=h.getDataLabelLength(y,v,"height"),r+=h.axis.convertPixelsToAxisPadding(c[1],n),s+=h.axis.convertPixelsToAxisPadding(c[0],n)),"y"===e&&C(f.axis_y_padding)&&(r=h.axis.getPadding(f.axis_y_padding,"top",r,n),s=h.axis.getPadding(f.axis_y_padding,"bottom",s,n)),"y2"===e&&C(f.axis_y2_padding)&&(r=h.axis.getPadding(f.axis_y2_padding,"top",r,n),s=h.axis.getPadding(f.axis_y2_padding,"bottom",s,n)),b&&(u&&(s=y),g&&(r=-v)),a=[y-s,v+r],A?a.reverse():a)},l.getXDomainMin=function(t){var e=this,i=e.config;return k(i.axis_x_min)?e.isTimeSeries()?this.parseDate(i.axis_x_min):i.axis_x_min:e.d3.min(t,function(t){return e.d3.min(t.values,function(t){return t.x})})},l.getXDomainMax=function(t){var e=this,i=e.config;return k(i.axis_x_max)?e.isTimeSeries()?this.parseDate(i.axis_x_max):i.axis_x_max:e.d3.max(t,function(t){return e.d3.max(t.values,function(t){return t.x})})},l.getXDomainPadding=function(t){var e,i,a,n,r=this.config,s=t[1]-t[0];return i=this.isCategorized()?0:this.hasType("bar")?1<(e=this.getMaxDataCount())?s/(e-1)/2:.5:.01*s,"object"==typeof r.axis_x_padding&&C(r.axis_x_padding)?(a=S(r.axis_x_padding.left)?r.axis_x_padding.left:i,n=S(r.axis_x_padding.right)?r.axis_x_padding.right:i):a=n="number"==typeof r.axis_x_padding?r.axis_x_padding:i,{left:a,right:n}},l.getXDomain=function(t){var e=this,i=[e.getXDomainMin(t),e.getXDomainMax(t)],a=i[0],n=i[1],r=e.getXDomainPadding(i),s=0,o=0;return a-n!=0||e.isCategorized()||(n=e.isTimeSeries()?(a=new Date(.5*a.getTime()),new Date(1.5*n.getTime())):(a=0===a?1:.5*a,0===n?-1:1.5*n)),(a||0===a)&&(s=e.isTimeSeries()?new Date(a.getTime()-r.left):a-r.left),(n||0===n)&&(o=e.isTimeSeries()?new Date(n.getTime()+r.right):n+r.right),[s,o]},l.updateXDomain=function(t,e,i,a,n){var r=this,s=r.config;return i&&(r.x.domain(n||r.d3.extent(r.getXDomain(t))),r.orgXDomain=r.x.domain(),s.zoom_enabled&&r.zoom.scale(r.x).updateScaleExtent(),r.subX.domain(r.x.domain()),r.brush&&r.brush.scale(r.subX)),e&&(r.x.domain(n||(!r.brush||r.brush.empty()?r.orgXDomain:r.brush.extent())),s.zoom_enabled&&r.zoom.scale(r.x).updateScaleExtent()),a&&r.x.domain(r.trimXDomain(r.x.orgDomain())),r.x.domain()},l.trimXDomain=function(t){var e=this;return t[0]<=e.orgXDomain[0]&&(t[1]=+t[1]+(e.orgXDomain[0]-t[0]),t[0]=e.orgXDomain[0]),e.orgXDomain[1]<=t[1]&&(t[0]=+t[0]-(t[1]-e.orgXDomain[1]),t[1]=e.orgXDomain[1]),t},l.isX=function(t){var e=this.config;return e.data_x&&t===e.data_x||C(e.data_xs)&&f(e.data_xs,t)},l.isNotX=function(t){return!this.isX(t)},l.getXKey=function(t){var e=this.config;return e.data_x?e.data_x:C(e.data_xs)?e.data_xs[t]:null},l.getXValuesOfXKey=function(e,t){var i,a=this;return(t&&C(t)?a.mapToIds(t):[]).forEach(function(t){a.getXKey(t)===e&&(i=a.data.xs[t])}),i},l.getIndexByX=function(t){var e=this.filterByX(this.data.targets,t);return e.length?e[0].index:null},l.getXValue=function(t,e){return t in this.data.xs&&this.data.xs[t]&&S(this.data.xs[t][e])?this.data.xs[t][e]:e},l.getOtherTargetXs=function(){var t=Object.keys(this.data.xs);return t.length?this.data.xs[t[0]]:null},l.getOtherTargetX=function(t){var e=this.getOtherTargetXs();return e&&t<e.length?e[t]:null},l.addXs=function(e){var i=this;Object.keys(e).forEach(function(t){i.config.data_xs[t]=e[t]})},l.hasMultipleX=function(e){return 1<this.d3.set(Object.keys(e).map(function(t){return e[t]})).size()},l.isMultipleX=function(){return C(this.config.data_xs)||!this.config.data_xSort||this.hasType("scatter")},l.addName=function(t){var e;return t&&(e=this.config.data_names[t.id],t.name=e||t.id),t},l.getValueOnIndex=function(t,e){var i=t.filter(function(t){return t.index===e});return i.length?i[0]:null},l.updateTargetX=function(t,a){var n=this;t.forEach(function(i){i.values.forEach(function(t,e){t.x=n.generateTargetX(a[e],i.id,e)}),n.data.xs[i.id]=a})},l.updateTargetXs=function(t,e){var i=this;t.forEach(function(t){e[t.id]&&i.updateTargetX([t],e[t.id])})},l.generateTargetX=function(t,e,i){var a=this;return a.isTimeSeries()?a.parseDate(t||a.getXValue(e,i)):a.isCustomX()&&!a.isCategorized()?S(t)?+t:a.getXValue(e,i):i},l.cloneTarget=function(t){return{id:t.id,id_org:t.id_org,values:t.values.map(function(t){return{x:t.x,value:t.value,id:t.id}})}},l.updateXs=function(){var e=this;e.data.targets.length&&(e.xs=[],e.data.targets[0].values.forEach(function(t){e.xs[t.index]=t.x}))},l.getPrevX=function(t){var e=this.xs[t-1];return void 0!==e?e:null},l.getNextX=function(t){var e=this.xs[t+1];return void 0!==e?e:null},l.getMaxDataCount=function(){return this.d3.max(this.data.targets,function(t){return t.values.length})},l.getMaxDataCountTarget=function(t){var e,i=t.length,a=0;return 1<i?t.forEach(function(t){t.values.length>a&&(a=(e=t).values.length)}):e=i?t[0]:null,e},l.getEdgeX=function(t){return t.length?[this.d3.min(t,function(t){return t.values[0].x}),this.d3.max(t,function(t){return t.values[t.values.length-1].x})]:[0,0]},l.mapToIds=function(t){return t.map(function(t){return t.id})},l.mapToTargetIds=function(t){return t?r(t)?[t]:t:this.mapToIds(this.data.targets)},l.hasTarget=function(t,e){var i,a=this.mapToIds(t);for(i=0;i<a.length;i++)if(a[i]===e)return!0;return!1},l.isTargetToShow=function(t){return this.hiddenTargetIds.indexOf(t)<0},l.isLegendToShow=function(t){return this.hiddenLegendIds.indexOf(t)<0},l.filterTargetsToShow=function(t){var e=this;return t.filter(function(t){return e.isTargetToShow(t.id)})},l.mapTargetsToUniqueXs=function(t){return this.d3.set(this.d3.merge(t.map(function(t){return t.values.map(function(t){return+t.x})}))).values().map(this.isTimeSeries()?function(t){return new Date(+t)}:function(t){return+t})},l.addHiddenTargetIds=function(t){this.hiddenTargetIds=this.hiddenTargetIds.concat(t)},l.removeHiddenTargetIds=function(e){this.hiddenTargetIds=this.hiddenTargetIds.filter(function(t){return e.indexOf(t)<0})},l.addHiddenLegendIds=function(t){this.hiddenLegendIds=this.hiddenLegendIds.concat(t)},l.removeHiddenLegendIds=function(e){this.hiddenLegendIds=this.hiddenLegendIds.filter(function(t){return e.indexOf(t)<0})},l.getValuesAsIdKeyed=function(t){var i={};return t.forEach(function(e){i[e.id]=[],e.values.forEach(function(t){i[e.id].push(t.value)})}),i},l.checkValueInTargets=function(t,e){var i,a,n,r=Object.keys(t);for(i=0;i<r.length;i++)for(n=t[r[i]].values,a=0;a<n.length;a++)if(e(n[a].value))return!0;return!1},l.hasNegativeValueInTargets=function(t){return this.checkValueInTargets(t,function(t){return t<0})},l.hasPositiveValueInTargets=function(t){return this.checkValueInTargets(t,function(t){return 0<t})},l.isOrderDesc=function(){var t=this.config;return"string"==typeof t.data_order&&"desc"===t.data_order.toLowerCase()},l.isOrderAsc=function(){var t=this.config;return"string"==typeof t.data_order&&"asc"===t.data_order.toLowerCase()},l.orderTargets=function(t){var e=this.config,r=this.isOrderAsc(),i=this.isOrderDesc();return r||i?t.sort(function(t,e){var i=function(t,e){return t+Math.abs(e.value)},a=t.values.reduce(i,0),n=e.values.reduce(i,0);return r?n-a:a-n}):g(e.data_order)&&t.sort(e.data_order),t},l.filterByX=function(t,e){return this.d3.merge(t.map(function(t){return t.values})).filter(function(t){return t.x-e==0})},l.filterRemoveNull=function(t){return t.filter(function(t){return S(t.value)})},l.filterByXDomain=function(t,e){return t.map(function(t){return{id:t.id,id_org:t.id_org,values:t.values.filter(function(t){return e[0]<=t.x&&t.x<=e[1]})}})},l.hasDataLabel=function(){var t=this.config;return!("boolean"!=typeof t.data_labels||!t.data_labels)||!("object"!=typeof t.data_labels||!C(t.data_labels))},l.getDataLabelLength=function(t,e,i){var a=this,n=[0,0];return a.selectChart.select("svg").selectAll(".dummy").data([t,e]).enter().append("text").text(function(t){return a.dataLabelFormat(t.id)(t)}).each(function(t,e){n[e]=1.3*this.getBoundingClientRect()[i]}).remove(),n},l.isNoneArc=function(t){return this.hasTarget(this.data.targets,t.id)},l.isArc=function(t){return"data"in t&&this.hasTarget(this.data.targets,t.data.id)},l.findSameXOfValues=function(t,e){var i,a=t[e].x,n=[];for(i=e-1;0<=i&&a===t[i].x;i--)n.push(t[i]);for(i=e;i<t.length&&a===t[i].x;i++)n.push(t[i]);return n},l.findClosestFromTargets=function(t,e){var i,a=this;return i=t.map(function(t){return a.findClosest(t.values,e)}),a.findClosest(i,e)},l.findClosest=function(t,i){var a,n=this,r=100;return t.filter(function(t){return t&&n.isBarType(t.id)}).forEach(function(t){var e=n.main.select("."+V.bars+n.getTargetSelectorSuffix(t.id)+" ."+V.bar+"-"+t.index).node();!a&&n.isWithinBar(e)&&(a=t)}),t.filter(function(t){return t&&!n.isBarType(t.id)}).forEach(function(t){var e=n.dist(t,i);e<r&&(r=e,a=t)}),a},l.dist=function(t,e){var i=this.config,a=i.axis_rotated?1:0,n=i.axis_rotated?0:1,r=this.circleY(t,t.index),s=this.x(t.x);return Math.pow(s-e[a],2)+Math.pow(r-e[n],2)},l.convertValuesToStep=function(t){var e,i=[].concat(t);if(!this.isCategorized())return t;for(e=t.length+1;0<e;e--)i[e]=i[e-1];return i[0]={x:i[0].x-1,value:i[0].value,id:i[0].id},i[t.length+1]={x:i[t.length].x+1,value:i[t.length].value,id:i[t.length].id},i},l.updateDataAttributes=function(t,e){var i=this.config["data_"+t];return void 0===e||(Object.keys(e).forEach(function(t){i[t]=e[t]}),this.redraw({withLegend:!0})),i},l.convertUrlToData=function(t,e,a,n){var r=this,s=e||"csv";r.d3.xhr(t,function(t,e){var i;if(!e)throw new Error(t.responseURL+" "+t.status+" ("+t.statusText+")");i="json"===s?r.convertJsonToData(JSON.parse(e.response),a):"tsv"===s?r.convertTsvToData(e.response):r.convertCsvToData(e.response),n.call(r,i)})},l.convertXsvToData=function(t,e){var i,a=e.parseRows(t);return 1===a.length?(i=[{}],a[0].forEach(function(t){i[0][t]=null})):i=e.parse(t),i},l.convertCsvToData=function(t){return this.convertXsvToData(t,this.d3.csv)},l.convertTsvToData=function(t){return this.convertXsvToData(t,this.d3.tsv)},l.convertJsonToData=function(e,t){var n,r=[];return t?(t.x?(n=t.value.concat(t.x),this.config.data_x=t.x):n=t.value,r.push(n),e.forEach(function(i){var a=[];n.forEach(function(t){var e=b(i[t])?null:i[t];a.push(e)}),r.push(a)}),this.convertRowsToData(r)):(Object.keys(e).forEach(function(t){r.push([t].concat(e[t]))}),this.convertColumnsToData(r))},l.convertRowsToData=function(t){var e,i,a=t[0],n={},r=[];for(e=1;e<t.length;e++){for(n={},i=0;i<t[e].length;i++){if(b(t[e][i]))throw new Error("Source data is missing a component at ("+e+","+i+")!");n[a[i]]=t[e][i]}r.push(n)}return r},l.convertColumnsToData=function(t){var e,i,a,n=[];for(e=0;e<t.length;e++)for(a=t[e][0],i=1;i<t[e].length;i++){if(b(n[i-1])&&(n[i-1]={}),b(t[e][i]))throw new Error("Source data is missing a component at ("+e+","+i+")!");n[i-1][a]=t[e][i]}return n},l.convertDataToTargets=function(t,a){var e,o=this,c=o.config,i=o.d3.keys(t[0]).filter(o.isNotX,o),n=o.d3.keys(t[0]).filter(o.isX,o);return i.forEach(function(i){var e=o.getXKey(i);o.isCustomX()||o.isTimeSeries()?0<=n.indexOf(e)?o.data.xs[i]=(a&&o.data.xs[i]?o.data.xs[i]:[]).concat(t.map(function(t){return t[e]}).filter(S).map(function(t,e){return o.generateTargetX(t,i,e)})):c.data_x?o.data.xs[i]=o.getOtherTargetXs():C(c.data_xs)&&(o.data.xs[i]=o.getXValuesOfXKey(e,o.data.targets)):o.data.xs[i]=t.map(function(t,e){return e})}),i.forEach(function(t){if(!o.data.xs[t])throw new Error('x is not defined for id = "'+t+'".')}),(e=i.map(function(n,r){var s=c.data_idConverter(n);return{id:s,id_org:n,values:t.map(function(t,e){var i=t[o.getXKey(n)],a=o.generateTargetX(i,n,e);return o.isCustomX()&&o.isCategorized()&&0===r&&i&&(0===e&&(c.axis_x_categories=[]),c.axis_x_categories.push(i)),(b(t[n])||o.data.xs[n].length<=e)&&(a=void 0),{x:a,value:null===t[n]||isNaN(t[n])?null:+t[n],id:s}}).filter(function(t){return k(t.x)})}})).forEach(function(t){var e;c.data_xSort&&(t.values=t.values.sort(function(t,e){return(t.x||0===t.x?t.x:1/0)-(e.x||0===e.x?e.x:1/0)})),e=0,t.values.forEach(function(t){t.index=e++}),o.data.xs[t.id].sort(function(t,e){return t-e})}),c.data_type&&o.setTargetType(o.mapToIds(e).filter(function(t){return!(t in c.data_types)}),c.data_type),e.forEach(function(t){o.addCache(t.id_org,t)}),e},l.load=function(i,a){var n=this;i&&(a.filter&&(i=i.filter(a.filter)),(a.type||a.types)&&i.forEach(function(t){var e=a.types&&a.types[t.id]?a.types[t.id]:a.type;n.setTargetType(t.id,e)}),n.data.targets.forEach(function(t){for(var e=0;e<i.length;e++)if(t.id===i[e].id){t.values=i[e].values,i.splice(e,1);break}}),n.data.targets=n.data.targets.concat(i)),n.updateTargets(n.data.targets),n.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0,withLegend:!0}),a.done&&a.done()},l.loadFromArgs=function(e){var i=this;e.data?i.load(i.convertDataToTargets(e.data),e):e.url?i.convertUrlToData(e.url,e.mimeType,e.keys,function(t){i.load(i.convertDataToTargets(t),e)}):e.json?i.load(i.convertDataToTargets(i.convertJsonToData(e.json,e.keys)),e):e.rows?i.load(i.convertDataToTargets(i.convertRowsToData(e.rows)),e):e.columns?i.load(i.convertDataToTargets(i.convertColumnsToData(e.columns)),e):i.load(null,e)},l.unload=function(t,e){var i=this;return e||(e=function(){}),(t=t.filter(function(t){return i.hasTarget(i.data.targets,t)}))&&0!==t.length?(i.svg.selectAll(t.map(function(t){return i.selectorTarget(t)})).transition().style("opacity",0).remove().call(i.endall,e),void t.forEach(function(e){i.withoutFadeIn[e]=!1,i.legend&&i.legend.selectAll("."+V.legendItem+i.getTargetSelectorSuffix(e)).remove(),i.data.targets=i.data.targets.filter(function(t){return t.id!==e})})):void e()},l.categoryName=function(t){var e=this.config;return t<e.axis_x_categories.length?e.axis_x_categories[t]:t},l.initEventRect=function(){this.main.select("."+V.chart).append("g").attr("class",V.eventRects).style("fill-opacity",0)},l.redrawEventRect=function(){var t,e,i=this,a=i.config,n=i.isMultipleX(),r=i.main.select("."+V.eventRects).style("cursor",a.zoom_enabled?a.axis_rotated?"ns-resize":"ew-resize":null).classed(V.eventRectsMultiple,n).classed(V.eventRectsSingle,!n);r.selectAll("."+V.eventRect).remove(),i.eventRect=r.selectAll("."+V.eventRect),n?(t=i.eventRect.data([0]),i.generateEventRectsForMultipleXs(t.enter()),i.updateEventRect(t)):(e=i.getMaxDataCountTarget(i.data.targets),r.datum(e?e.values:[]),i.eventRect=r.selectAll("."+V.eventRect),t=i.eventRect.data(function(t){return t}),i.generateEventRectsForSingleX(t.enter()),i.updateEventRect(t),t.exit().remove())},l.updateEventRect=function(t){var e,i,a,n,r,s,o=this,c=o.config;t=t||o.eventRect.data(function(t){return t}),n=o.isMultipleX()?(i=e=0,a=o.width,o.height):(s=!o.isCustomX()&&!o.isTimeSeries()||o.isCategorized()?(r=o.getEventRectWidth(),function(t){return o.x(t.x)-r/2}):(o.updateXs(),r=function(t){var e=o.getPrevX(t.index),i=o.getNextX(t.index);return null===e&&null===i?c.axis_rotated?o.height:o.width:(null===e&&(e=o.x.domain()[0]),null===i&&(i=o.x.domain()[1]),Math.max(0,(o.x(i)-o.x(e))/2))},function(t){var e=o.getPrevX(t.index),i=o.getNextX(t.index),a=o.data.xs[t.id][t.index];return null===e&&null===i?0:(null===e&&(e=o.x.domain()[0]),(o.x(a)+o.x(e))/2)}),e=c.axis_rotated?0:s,i=c.axis_rotated?s:0,a=c.axis_rotated?o.width:r,c.axis_rotated?r:o.height),t.attr("class",o.classEvent.bind(o)).attr("x",e).attr("y",i).attr("width",a).attr("height",n)},l.generateEventRectsForSingleX=function(t){var n=this,r=n.d3,s=n.config;t.append("rect").attr("class",n.classEvent.bind(n)).style("cursor",s.data_selection_enabled&&s.data_selection_grouped?"pointer":null).on("mouseover",function(t){var e=t.index;n.dragging||n.flowing||n.hasArcType()||(s.point_focus_expand_enabled&&n.expandCircles(e,null,!0),n.expandBars(e,null,!0),n.main.selectAll("."+V.shape+"-"+e).each(function(t){s.data_onmouseover.call(n.api,t)}))}).on("mouseout",function(t){var e=t.index;n.config&&(n.hasArcType()||(n.hideXGridFocus(),n.hideTooltip(),n.unexpandCircles(),n.unexpandBars(),n.main.selectAll("."+V.shape+"-"+e).each(function(t){s.data_onmouseout.call(n.api,t)})))}).on("mousemove",function(t){var e,i=t.index,a=n.svg.select("."+V.eventRect+"-"+i);n.dragging||n.flowing||n.hasArcType()||(n.isStepType(t)&&"step-after"===n.config.line_step_type&&r.mouse(this)[0]<n.x(n.getXValue(t.id,i))&&(i-=1),e=n.filterTargetsToShow(n.data.targets).map(function(t){return n.addName(n.getValueOnIndex(t.values,i))}),s.tooltip_grouped&&(n.showTooltip(e,this),n.showXGridFocus(e)),(!s.tooltip_grouped||s.data_selection_enabled&&!s.data_selection_grouped)&&n.main.selectAll("."+V.shape+"-"+i).each(function(){r.select(this).classed(V.EXPANDED,!0),s.data_selection_enabled&&a.style("cursor",s.data_selection_grouped?"pointer":null),s.tooltip_grouped||(n.hideXGridFocus(),n.hideTooltip(),s.data_selection_grouped||(n.unexpandCircles(i),n.unexpandBars(i)))}).filter(function(t){return n.isWithinShape(this,t)}).each(function(t){s.data_selection_enabled&&(s.data_selection_grouped||s.data_selection_isselectable(t))&&a.style("cursor","pointer"),s.tooltip_grouped||(n.showTooltip([t],this),n.showXGridFocus([t]),s.point_focus_expand_enabled&&n.expandCircles(i,t.id,!0),n.expandBars(i,t.id,!0))}))}).on("click",function(t){var e=t.index;if(!n.hasArcType()&&n.toggleShape){if(n.cancelClick)return void(n.cancelClick=!1);n.isStepType(t)&&"step-after"===s.line_step_type&&r.mouse(this)[0]<n.x(n.getXValue(t.id,e))&&(e-=1),n.main.selectAll("."+V.shape+"-"+e).each(function(t){(s.data_selection_grouped||n.isWithinShape(this,t))&&(n.toggleShape(this,t,e),n.config.data_onclick.call(n.api,t,this))})}}).call(s.data_selection_draggable&&n.drag?r.behavior.drag().origin(Object).on("drag",function(){n.drag(r.mouse(this))}).on("dragstart",function(){n.dragstart(r.mouse(this))}).on("dragend",function(){n.dragend()}):function(){})},l.generateEventRectsForMultipleXs=function(t){function n(){r.svg.select("."+V.eventRect).style("cursor",null),r.hideXGridFocus(),r.hideTooltip(),r.unexpandCircles(),r.unexpandBars()}var r=this,s=r.d3,o=r.config;t.append("rect").attr("x",0).attr("y",0).attr("width",r.width).attr("height",r.height).attr("class",V.eventRect).on("mouseout",function(){r.config&&(r.hasArcType()||n())}).on("mousemove",function(){var t,e,i,a=r.filterTargetsToShow(r.data.targets);if(!r.dragging&&!r.hasArcType(a)){if(t=s.mouse(this),e=r.findClosestFromTargets(a,t),!r.mouseover||e&&e.id===r.mouseover.id||(o.data_onmouseout.call(r.api,r.mouseover),r.mouseover=void 0),!e)return void n();i=(r.isScatterType(e)||!o.tooltip_grouped?[e]:r.filterByX(a,e.x)).map(function(t){return r.addName(t)}),r.showTooltip(i,this),o.point_focus_expand_enabled&&r.expandCircles(e.index,e.id,!0),r.expandBars(e.index,e.id,!0),r.showXGridFocus(i),(r.isBarType(e.id)||r.dist(e,t)<100)&&(r.svg.select("."+V.eventRect).style("cursor","pointer"),r.mouseover||(o.data_onmouseover.call(r.api,e),r.mouseover=e))}}).on("click",function(){var t,e,i=r.filterTargetsToShow(r.data.targets);r.hasArcType(i)||(t=s.mouse(this),(e=r.findClosestFromTargets(i,t))&&(r.isBarType(e.id)||r.dist(e,t)<100)&&r.main.selectAll("."+V.shapes+r.getTargetSelectorSuffix(e.id)).selectAll("."+V.shape+"-"+e.index).each(function(){(o.data_selection_grouped||r.isWithinShape(this,e))&&(r.toggleShape(this,e,e.index),r.config.data_onclick.call(r.api,e,this))}))}).call(o.data_selection_draggable&&r.drag?s.behavior.drag().origin(Object).on("drag",function(){r.drag(s.mouse(this))}).on("dragstart",function(){r.dragstart(s.mouse(this))}).on("dragend",function(){r.dragend()}):function(){})},l.dispatchEvent=function(t,e,i){var a="."+V.eventRect+(this.isMultipleX()?"":"-"+e),n=this.main.select(a).node(),r=n.getBoundingClientRect(),s=r.left+(i?i[0]:0),o=r.top+(i?i[1]:0),c=document.createEvent("MouseEvents");c.initMouseEvent(t,!0,!0,d,0,s,o,s,o,!1,!1,!1,!1,0,null),n.dispatchEvent(c)},l.getCurrentWidth=function(){var t=this.config;return t.size_width?t.size_width:this.getParentWidth()},l.getCurrentHeight=function(){var t=this.config,e=t.size_height?t.size_height:this.getParentHeight();return 0<e?e:320/(this.hasType("gauge")?2:1)},l.getCurrentPaddingTop=function(){var t=this.config;return S(t.padding_top)?t.padding_top:0},l.getCurrentPaddingBottom=function(){var t=this.config;return S(t.padding_bottom)?t.padding_bottom:0},l.getCurrentPaddingLeft=function(t){var e=this.config;return S(e.padding_left)?e.padding_left:e.axis_rotated?e.axis_x_show?Math.max(s(this.getAxisWidthByAxisId("x",t)),40):1:!e.axis_y_show||e.axis_y_inner?this.axis.getYAxisLabelPosition().isOuter?30:1:s(this.getAxisWidthByAxisId("y",t))},l.getCurrentPaddingRight=function(){var t=this,e=t.config,i=t.isLegendRight?t.getLegendWidth()+20:0;return S(e.padding_right)?e.padding_right+1:e.axis_rotated?10+i:!e.axis_y2_show||e.axis_y2_inner?2+i+(t.axis.getY2AxisLabelPosition().isOuter?20:0):s(t.getAxisWidthByAxisId("y2"))+i},l.getParentRectValue=function(e){for(var i,a=this.selectChart.node();a&&"BODY"!==a.tagName;){try{i=a.getBoundingClientRect()[e]}catch(t){"width"===e&&(i=a.offsetWidth)}if(i)break;a=a.parentNode}return i},l.getParentWidth=function(){return this.getParentRectValue("width")},l.getParentHeight=function(){var t=this.selectChart.style("height");return 0<t.indexOf("px")?+t.replace("px",""):0},l.getSvgLeft=function(t){var e=this,i=e.config,a=i.axis_rotated||!i.axis_rotated&&!i.axis_y_inner,n=i.axis_rotated?V.axisX:V.axisY,r=e.main.select("."+n).node(),s=r&&a?r.getBoundingClientRect():{right:0},o=e.selectChart.node().getBoundingClientRect(),c=e.hasArcType(),d=s.right-o.left-(c?0:e.getCurrentPaddingLeft(t));return 0<d?d:0},l.getAxisWidthByAxisId=function(t,e){var i=this.axis.getLabelPositionById(t);return this.axis.getMaxTickWidth(t,e)+(i.isInner?20:40)},l.getHorizontalAxisHeight=function(t){var e=this,i=e.config,a=30;return"x"!==t||i.axis_x_show?"x"===t&&i.axis_x_height?i.axis_x_height:"y"!==t||i.axis_y_show?"y2"!==t||i.axis_y2_show?("x"===t&&!i.axis_rotated&&i.axis_x_tick_rotate&&(a=30+e.axis.getMaxTickWidth(t)*Math.cos(Math.PI*(90-i.axis_x_tick_rotate)/180)),a+(e.axis.getLabelPositionById(t).isInner?0:10)+("y2"===t?-10:0)):e.rotated_padding_top:!i.legend_show||e.isLegendRight||e.isLegendInset?1:10:8},l.getEventRectWidth=function(){return Math.max(0,this.xAxis.tickInterval())},l.getShapeIndices=function(t){var e,i,a=this.config,n={},r=0;return this.filterTargetsToShow(this.data.targets.filter(t,this)).forEach(function(t){for(e=0;e<a.data_groups.length;e++)if(!(a.data_groups[e].indexOf(t.id)<0))for(i=0;i<a.data_groups[e].length;i++)if(a.data_groups[e][i]in n){n[t.id]=n[a.data_groups[e][i]];break}b(n[t.id])&&(n[t.id]=r++)}),n.__max__=r-1,n},l.getShapeX=function(i,a,n,t){var r=t?this.subX:this.x;return function(t){var e=t.id in n?n[t.id]:0;return t.x||0===t.x?r(t.x)-i*(a/2-e):0}},l.getShapeY=function(e){var i=this;return function(t){return(e?i.getSubYScale(t.id):i.getYScale(t.id))(t.value)}},l.getShapeOffset=function(t,o,e){var c=this,d=c.orderTargets(c.filterTargetsToShow(c.data.targets.filter(t,c))),l=d.map(function(t){return t.id});return function(i,a){var n=e?c.getSubYScale(i.id):c.getYScale(i.id),r=n(0),s=r;return d.forEach(function(t){var e=c.isStepType(i)?c.convertValuesToStep(t.values):t.values;t.id!==i.id&&o[t.id]===o[i.id]&&l.indexOf(t.id)<l.indexOf(i.id)&&0<=e[a].value*i.value&&(s+=n(e[a].value)-r)}),s}},l.isWithinShape=function(t,e){var i,a=this,n=a.d3.select(t);return a.isTargetToShow(e.id)?"circle"===t.nodeName?i=a.isStepType(e)?a.isWithinStep(t,a.getYScale(e.id)(e.value)):a.isWithinCircle(t,1.5*a.pointSelectR(e)):"path"===t.nodeName&&(i=!n.classed(V.bar)||a.isWithinBar(t)):i=!1,i},l.getInterpolate=function(t){return this.isSplineType(t)?"cardinal":this.isStepType(t)?this.config.line_step_type:"linear"},l.initLine=function(){this.main.select("."+V.chart).append("g").attr("class",V.chartLines)},l.updateTargetsForLine=function(t){var e,i=this,a=i.config,n=i.classChartLine.bind(i),r=i.classLines.bind(i),s=i.classAreas.bind(i),o=i.classCircles.bind(i),c=i.classFocus.bind(i);(e=i.main.select("."+V.chartLines).selectAll("."+V.chartLine).data(t).attr("class",function(t){return n(t)+c(t)}).enter().append("g").attr("class",n).style("opacity",0).style("pointer-events","none")).append("g").attr("class",r),e.append("g").attr("class",s),e.append("g").attr("class",function(t){return i.generateClass(V.selectedCircles,t.id)}),e.append("g").attr("class",o).style("cursor",function(t){return a.data_selection_isselectable(t)?"pointer":null}),t.forEach(function(e){i.main.selectAll("."+V.selectedCircles+i.getTargetSelectorSuffix(e.id)).selectAll("."+V.selectedCircle).each(function(t){t.value=e.values[t.index].value})})},l.updateLine=function(t){var e=this;e.mainLine=e.main.selectAll("."+V.lines).selectAll("."+V.line).data(e.lineData.bind(e)),e.mainLine.enter().append("path").attr("class",e.classLine.bind(e)).style("stroke",e.color),e.mainLine.style("opacity",e.initialOpacity.bind(e)).style("shape-rendering",function(t){return e.isStepType(t)?"crispEdges":""}).attr("transform",null),e.mainLine.exit().transition().duration(t).style("opacity",0).remove()},l.redrawLine=function(t,e){return[(e?this.mainLine.transition():this.mainLine).attr("d",t).style("stroke",this.color).style("opacity",1)]},l.generateDrawLine=function(t,s){var o=this,c=o.config,d=o.d3.svg.line(),i=o.generateGetLinePoints(t,s),l=s?o.getSubYScale:o.getYScale,e=function(t){return(s?o.subxx:o.xx).call(o,t)},a=function(t,e){return 0<c.data_groups.length?i(t,e)[0][1]:l.call(o,t.id)(t.value)};return d=c.axis_rotated?d.x(a).y(e):d.x(e).y(a),c.line_connectNull||(d=d.defined(function(t){return null!=t.value})),function(t){var e=c.line_connectNull?o.filterRemoveNull(t.values):t.values,i=s?o.x:o.subX,a=l.call(o,t.id),n=0,r=0;return(o.isLineType(t)?c.data_regions[t.id]?o.lineWithRegions(e,i,a,c.data_regions[t.id]):(o.isStepType(t)&&(e=o.convertValuesToStep(e)),d.interpolate(o.getInterpolate(t))(e)):(e[0]&&(n=i(e[0].x),r=a(e[0].value)),c.axis_rotated?"M "+r+" "+n:"M "+n+" "+r))||"M 0 0"}},l.generateGetLinePoints=function(t,e){var s=this,o=s.config,i=t.__max__+1,c=s.getShapeX(0,i,t,!!e),d=s.getShapeY(!!e),l=s.getShapeOffset(s.isLineType,t,!!e),u=e?s.getSubYScale:s.getYScale;return function(t,e){var i=u.call(s,t.id)(0),a=l(t,e)||i,n=c(t),r=d(t);return o.axis_rotated&&(0<t.value&&r<i||t.value<0&&i<r)&&(r=i),[[n,r-(i-a)],[n,r-(i-a)],[n,r-(i-a)],[n,r-(i-a)]]}},l.lineWithRegions=function(t,c,d,e){function i(t,e){var i;for(i=0;i<e.length;i++)if(e[i].start<t&&t<=e[i].end)return!0;return!1}function l(t){return"M"+t[0][0]+" "+t[0][1]+" "+t[1][0]+" "+t[1][1]}var a,n,r,s,u,o,g,h,f,x,p,_=this,m=_.config,y="M",v=_.isCategorized()?.5:0,T=[];if(k(e))for(a=0;a<e.length;a++)T[a]={},T[a].start=b(e[a].start)?t[0].x:_.isTimeSeries()?_.parseDate(e[a].start):e[a].start,T[a].end=b(e[a].end)?t[t.length-1].x:_.isTimeSeries()?_.parseDate(e[a].end):e[a].end;for(x=m.axis_rotated?function(t){return d(t.value)}:function(t){return c(t.x)},p=m.axis_rotated?function(t){return c(t.x)}:function(t){return d(t.value)},r=_.isTimeSeries()?function(t,e,i,a){var n=t.x.getTime(),r=e.x-t.x,s=new Date(n+r*i),o=new Date(n+r*(i+a));return l(m.axis_rotated?[[d(u(i)),c(s)],[d(u(i+a)),c(o)]]:[[c(s),d(u(i))],[c(o),d(u(i+a))]])}:function(t,e,i,a){return l(m.axis_rotated?[[d(u(i),!0),c(s(i))],[d(u(i+a),!0),c(s(i+a))]]:[[c(s(i),!0),d(u(i))],[c(s(i+a),!0),d(u(i+a))]])},a=0;a<t.length;a++){if(b(T)||!i(t[a].x,T))y+=" "+x(t[a])+" "+p(t[a]);else for(s=_.getScale(t[a-1].x+v,t[a].x+v,_.isTimeSeries()),u=_.getScale(t[a-1].value,t[a].value),o=c(t[a].x)-c(t[a-1].x),g=d(t[a].value)-d(t[a-1].value),f=2*(h=2/Math.sqrt(Math.pow(o,2)+Math.pow(g,2))),n=h;n<=1;n+=f)y+=r(t[a-1],t[a],n,h);t[a].x}return y},l.updateArea=function(t){var e=this,i=e.d3;e.mainArea=e.main.selectAll("."+V.areas).selectAll("."+V.area).data(e.lineData.bind(e)),e.mainArea.enter().append("path").attr("class",e.classArea.bind(e)).style("fill",e.color).style("opacity",function(){return e.orgAreaOpacity=+i.select(this).style("opacity"),0}),e.mainArea.style("opacity",e.orgAreaOpacity),e.mainArea.exit().transition().duration(t).style("opacity",0).remove()},l.redrawArea=function(t,e){return[(e?this.mainArea.transition():this.mainArea).attr("d",t).style("fill",this.color).style("opacity",this.orgAreaOpacity)]},l.generateDrawArea=function(t,e){var n=this,r=n.config,s=n.d3.svg.area(),i=n.generateGetAreaPoints(t,e),a=e?n.getSubYScale:n.getYScale,o=function(t){return(e?n.subxx:n.xx).call(n,t)},c=function(t,e){return 0<r.data_groups.length?i(t,e)[0][1]:a.call(n,t.id)(n.getAreaBaseValue(t.id))},d=function(t,e){return 0<r.data_groups.length?i(t,e)[1][1]:a.call(n,t.id)(t.value)};return s=r.axis_rotated?s.x0(c).x1(d).y(o):s.x(o).y0(c).y1(d),r.line_connectNull||(s=s.defined(function(t){return null!==t.value})),function(t){var e=r.line_connectNull?n.filterRemoveNull(t.values):t.values,i=0,a=0;return(n.isAreaType(t)?(n.isStepType(t)&&(e=n.convertValuesToStep(e)),s.interpolate(n.getInterpolate(t))(e)):(e[0]&&(i=n.x(e[0].x),a=n.getYScale(t.id)(e[0].value)),r.axis_rotated?"M "+a+" "+i:"M "+i+" "+a))||"M 0 0"}},l.getAreaBaseValue=function(){return 0},l.generateGetAreaPoints=function(t,e){var s=this,o=s.config,i=t.__max__+1,c=s.getShapeX(0,i,t,!!e),d=s.getShapeY(!!e),l=s.getShapeOffset(s.isAreaType,t,!!e),u=e?s.getSubYScale:s.getYScale;return function(t,e){var i=u.call(s,t.id)(0),a=l(t,e)||i,n=c(t),r=d(t);return o.axis_rotated&&(0<t.value&&r<i||t.value<0&&i<r)&&(r=i),[[n,a],[n,r-(i-a)],[n,r-(i-a)],[n,a]]}},l.updateCircle=function(){var t=this;t.mainCircle=t.main.selectAll("."+V.circles).selectAll("."+V.circle).data(t.lineOrScatterData.bind(t)),t.mainCircle.enter().append("circle").attr("class",t.classCircle.bind(t)).attr("r",t.pointR.bind(t)).style("fill",t.color),t.mainCircle.style("opacity",t.initialOpacityForCircle.bind(t)),t.mainCircle.exit().remove()},l.redrawCircle=function(t,e,i){var a=this.main.selectAll("."+V.selectedCircle);return[(i?this.mainCircle.transition():this.mainCircle).style("opacity",this.opacityForCircle.bind(this)).style("fill",this.color).attr("cx",t).attr("cy",e),(i?a.transition():a).attr("cx",t).attr("cy",e)]},l.circleX=function(t){return t.x||0===t.x?this.x(t.x):null},l.updateCircleY=function(){var t,i,e=this;0<e.config.data_groups.length?(t=e.getShapeIndices(e.isLineType),i=e.generateGetLinePoints(t),e.circleY=function(t,e){return i(t,e)[0][1]}):e.circleY=function(t){return e.getYScale(t.id)(t.value)}},l.getCircles=function(t,e){return(e?this.main.selectAll("."+V.circles+this.getTargetSelectorSuffix(e)):this.main).selectAll("."+V.circle+(S(t)?"-"+t:""))},l.expandCircles=function(t,e,i){var a=this.pointExpandedR.bind(this);i&&this.unexpandCircles(),this.getCircles(t,e).classed(V.EXPANDED,!0).attr("r",a)},l.unexpandCircles=function(t){var e=this,i=e.pointR.bind(e);e.getCircles(t).filter(function(){return e.d3.select(this).classed(V.EXPANDED)}).classed(V.EXPANDED,!1).attr("r",i)},l.pointR=function(t){var e=this.config;return this.isStepType(t)?0:g(e.point_r)?e.point_r(t):e.point_r},l.pointExpandedR=function(t){var e=this.config;return e.point_focus_expand_enabled?e.point_focus_expand_r?e.point_focus_expand_r:1.75*this.pointR(t):this.pointR(t)},l.pointSelectR=function(t){var e=this.config;return e.point_select_r?e.point_select_r:4*this.pointR(t)},l.isWithinCircle=function(t,e){var i=this.d3,a=i.mouse(t),n=i.select(t),r=+n.attr("cx"),s=+n.attr("cy");return Math.sqrt(Math.pow(r-a[0],2)+Math.pow(s-a[1],2))<e},l.isWithinStep=function(t,e){return Math.abs(e-this.d3.mouse(t)[1])<30},l.initBar=function(){this.main.select("."+V.chart).append("g").attr("class",V.chartBars)},l.updateTargetsForBar=function(t){var e=this,i=e.config,a=e.classChartBar.bind(e),n=e.classBars.bind(e),r=e.classFocus.bind(e);e.main.select("."+V.chartBars).selectAll("."+V.chartBar).data(t).attr("class",function(t){return a(t)+r(t)}).enter().append("g").attr("class",a).style("opacity",0).style("pointer-events","none").append("g").attr("class",n).style("cursor",function(t){return i.data_selection_isselectable(t)?"pointer":null})},l.updateBar=function(t){var e=this,i=e.barData.bind(e),a=e.classBar.bind(e),n=e.initialOpacity.bind(e),r=function(t){return e.color(t.id)};e.mainBar=e.main.selectAll("."+V.bars).selectAll("."+V.bar).data(i),e.mainBar.enter().append("path").attr("class",a).style("stroke",r).style("fill",r),e.mainBar.style("opacity",n),e.mainBar.exit().transition().duration(t).style("opacity",0).remove()},l.redrawBar=function(t,e){return[(e?this.mainBar.transition():this.mainBar).attr("d",t).style("fill",this.color).style("opacity",1)]},l.getBarW=function(t,e){var i=this.config,a="number"==typeof i.bar_width?i.bar_width:e?t.tickInterval()*i.bar_width_ratio/e:0;return i.bar_width_max&&a>i.bar_width_max?i.bar_width_max:a},l.getBars=function(t,e){return(e?this.main.selectAll("."+V.bars+this.getTargetSelectorSuffix(e)):this.main).selectAll("."+V.bar+(S(t)?"-"+t:""))},l.expandBars=function(t,e,i){i&&this.unexpandBars(),this.getBars(t,e).classed(V.EXPANDED,!0)},l.unexpandBars=function(t){this.getBars(t).classed(V.EXPANDED,!1)},l.generateDrawBar=function(t,e){var r=this.config,s=this.generateGetBarPoints(t,e);return function(t,e){var i=s(t,e),a=r.axis_rotated?1:0,n=r.axis_rotated?0:1;return"M "+i[0][a]+","+i[0][n]+" L"+i[1][a]+","+i[1][n]+" L"+i[2][a]+","+i[2][n]+" L"+i[3][a]+","+i[3][n]+" z"}},l.generateGetBarPoints=function(t,e){var s=this,i=e?s.subXAxis:s.xAxis,a=t.__max__+1,o=s.getBarW(i,a),c=s.getShapeX(o,a,t,!!e),d=s.getShapeY(!!e),l=s.getShapeOffset(s.isBarType,t,!!e),u=e?s.getSubYScale:s.getYScale;return function(t,e){var i=u.call(s,t.id)(0),a=l(t,e)||i,n=c(t),r=d(t);return s.config.axis_rotated&&(0<t.value&&r<i||t.value<0&&i<r)&&(r=i),[[n,a],[n,r-(i-a)],[n+o,r-(i-a)],[n+o,a]]}},l.isWithinBar=function(t){var e=this.d3.mouse(t),i=t.getBoundingClientRect(),a=t.pathSegList.getItem(0),n=t.pathSegList.getItem(1),r=Math.min(a.x,n.x),s=Math.min(a.y,n.y),o=r+i.width+2,c=s+i.height+2,d=s-2;return r-2<e[0]&&e[0]<o&&d<e[1]&&e[1]<c},l.initText=function(){this.main.select("."+V.chart).append("g").attr("class",V.chartTexts),this.mainText=this.d3.selectAll([])},l.updateTargetsForText=function(t){var e=this,i=e.classChartText.bind(e),a=e.classTexts.bind(e),n=e.classFocus.bind(e);e.main.select("."+V.chartTexts).selectAll("."+V.chartText).data(t).attr("class",function(t){return i(t)+n(t)}).enter().append("g").attr("class",i).style("opacity",0).style("pointer-events","none").append("g").attr("class",a)},l.updateText=function(t){var a=this,e=a.config,i=a.barOrLineData.bind(a),n=a.classText.bind(a);a.mainText=a.main.selectAll("."+V.texts).selectAll("."+V.text).data(i),a.mainText.enter().append("text").attr("class",n).attr("text-anchor",function(t){return e.axis_rotated?t.value<0?"end":"start":"middle"}).style("stroke","none").style("fill",function(t){return a.color(t)}).style("fill-opacity",0),a.mainText.text(function(t,e,i){return a.dataLabelFormat(t.id)(t.value,t.id,e,i)}),a.mainText.exit().transition().duration(t).style("fill-opacity",0).remove()},l.redrawText=function(t,e,i,a){return[(a?this.mainText.transition():this.mainText).attr("x",t).attr("y",e).style("fill",this.color).style("fill-opacity",i?0:this.opacityForText.bind(this))]},l.getTextRect=function(t,e){var i,a=this.d3.select("body").append("div").classed("c3",!0);return a.append("svg").style("visibility","hidden").style("position","fixed").style("top",0).style("left",0).selectAll(".dummy").data([t]).enter().append("text").classed(e||"",!0).text(t).each(function(){i=this.getBoundingClientRect()}),a.remove(),i},l.generateXYForText=function(t,e,i,a){var n=this,r=n.generateGetAreaPoints(t,!1),s=n.generateGetBarPoints(e,!1),o=n.generateGetLinePoints(i,!1),c=a?n.getXForText:n.getYForText;return function(t,e){var i=n.isAreaType(t)?r:n.isBarType(t)?s:o;return c.call(n,i(t,e),t,this)}},l.getXForText=function(t,e,i){var a,n,r=this,s=i.getBoundingClientRect();return a=r.config.axis_rotated?(n=r.isBarType(e)?4:6,t[2][1]+n*(e.value<0?-1:1)):r.hasType("bar")?(t[2][0]+t[0][0])/2:t[0][0],null===e.value&&(a>r.width?a=r.width-s.width:a<0&&(a=4)),a},l.getYForText=function(t,e,i){var a,n=this,r=i.getBoundingClientRect();return n.config.axis_rotated?a=(t[0][0]+t[2][0]+.6*r.height)/2:(a=t[2][1],e.value<0?(a+=r.height,n.isBarType(e)&&n.isSafari()?a-=3:!n.isBarType(e)&&n.isChrome()&&(a+=3)):a+=n.isBarType(e)?-3:-6),null!==e.value||n.config.axis_rotated||(a<r.height?a=r.height:a>this.height&&(a=this.height-4)),a},l.setTargetType=function(t,e){var i=this,a=i.config;i.mapToTargetIds(t).forEach(function(t){i.withoutFadeIn[t]=e===a.data_types[t],a.data_types[t]=e}),t||(a.data_type=e)},l.hasType=function(i,t){var a=this.config.data_types,n=!1;return(t=t||this.data.targets)&&t.length?t.forEach(function(t){var e=a[t.id];(e&&0<=e.indexOf(i)||!e&&"line"===i)&&(n=!0)}):Object.keys(a).length?Object.keys(a).forEach(function(t){a[t]===i&&(n=!0)}):n=this.config.data_type===i,n},l.hasArcType=function(t){return this.hasType("pie",t)||this.hasType("donut",t)||this.hasType("gauge",t)},l.isLineType=function(t){var e=this.config,i=r(t)?t:t.id;return!e.data_types[i]||0<=["line","spline","area","area-spline","step","area-step"].indexOf(e.data_types[i])},l.isStepType=function(t){var e=r(t)?t:t.id;return 0<=["step","area-step"].indexOf(this.config.data_types[e])},l.isSplineType=function(t){var e=r(t)?t:t.id;return 0<=["spline","area-spline"].indexOf(this.config.data_types[e])},l.isAreaType=function(t){var e=r(t)?t:t.id;return 0<=["area","area-spline","area-step"].indexOf(this.config.data_types[e])},l.isBarType=function(t){var e=r(t)?t:t.id;return"bar"===this.config.data_types[e]},l.isScatterType=function(t){var e=r(t)?t:t.id;return"scatter"===this.config.data_types[e]},l.isPieType=function(t){var e=r(t)?t:t.id;return"pie"===this.config.data_types[e]},l.isGaugeType=function(t){var e=r(t)?t:t.id;return"gauge"===this.config.data_types[e]},l.isDonutType=function(t){var e=r(t)?t:t.id;return"donut"===this.config.data_types[e]},l.isArcType=function(t){return this.isPieType(t)||this.isDonutType(t)||this.isGaugeType(t)},l.lineData=function(t){return this.isLineType(t)?[t]:[]},l.arcData=function(t){return this.isArcType(t.data)?[t]:[]},l.barData=function(t){return this.isBarType(t)?t.values:[]},l.lineOrScatterData=function(t){return this.isLineType(t)||this.isScatterType(t)?t.values:[]},l.barOrLineData=function(t){return this.isBarType(t)||this.isLineType(t)?t.values:[]},l.initGrid=function(){var t=this,e=t.config,i=t.d3;t.grid=t.main.append("g").attr("clip-path",t.clipPathForGrid).attr("class",V.grid),e.grid_x_show&&t.grid.append("g").attr("class",V.xgrids),e.grid_y_show&&t.grid.append("g").attr("class",V.ygrids),e.grid_focus_show&&t.grid.append("g").attr("class",V.xgridFocus).append("line").attr("class",V.xgridFocus),t.xgrid=i.selectAll([]),e.grid_lines_front||t.initGridLines()},l.initGridLines=function(){var t=this,e=t.d3;t.gridLines=t.main.append("g").attr("clip-path",t.clipPathForGrid).attr("class",V.grid+" "+V.gridLines),t.gridLines.append("g").attr("class",V.xgridLines),t.gridLines.append("g").attr("class",V.ygridLines),t.xgridLines=e.selectAll([])},l.updateXGrid=function(t){var e=this,i=e.config,a=e.d3,n=e.generateGridData(i.grid_x_type,e.x),r=e.isCategorized()?e.xAxis.tickOffset():0;e.xgridAttr=i.axis_rotated?{x1:0,x2:e.width,y1:function(t){return e.x(t)-r},y2:function(t){return e.x(t)-r}}:{x1:function(t){return e.x(t)+r},x2:function(t){return e.x(t)+r},y1:0,y2:e.height},e.xgrid=e.main.select("."+V.xgrids).selectAll("."+V.xgrid).data(n),e.xgrid.enter().append("line").attr("class",V.xgrid),t||e.xgrid.attr(e.xgridAttr).style("opacity",function(){return+a.select(this).attr(i.axis_rotated?"y1":"x1")===(i.axis_rotated?e.height:0)?0:1}),e.xgrid.exit().remove()},l.updateYGrid=function(){var t=this,e=t.config,i=t.yAxis.tickValues()||t.y.ticks(e.grid_y_ticks);t.ygrid=t.main.select("."+V.ygrids).selectAll("."+V.ygrid).data(i),t.ygrid.enter().append("line").attr("class",V.ygrid),t.ygrid.attr("x1",e.axis_rotated?t.y:0).attr("x2",e.axis_rotated?t.y:t.width).attr("y1",e.axis_rotated?0:t.y).attr("y2",e.axis_rotated?t.height:t.y),t.ygrid.exit().remove(),t.smoothLines(t.ygrid,"grid")},l.gridTextAnchor=function(t){return t.position?t.position:"end"},l.gridTextDx=function(t){return"start"===t.position?4:"middle"===t.position?0:-4},l.xGridTextX=function(t){return"start"===t.position?-this.height:"middle"===t.position?-this.height/2:0},l.yGridTextX=function(t){return"start"===t.position?0:"middle"===t.position?this.width/2:this.width},l.updateGrid=function(t){var e,i,a,n=this,r=n.main,s=n.config;n.grid.style("visibility",n.hasArcType()?"hidden":"visible"),r.select("line."+V.xgridFocus).style("visibility","hidden"),s.grid_x_show&&n.updateXGrid(),n.xgridLines=r.select("."+V.xgridLines).selectAll("."+V.xgridLine).data(s.grid_x_lines),(e=n.xgridLines.enter().append("g").attr("class",function(t){return V.xgridLine+(t.class?" "+t.class:"")})).append("line").style("opacity",0),e.append("text").attr("text-anchor",n.gridTextAnchor).attr("transform",s.axis_rotated?"":"rotate(-90)").attr("dx",n.gridTextDx).attr("dy",-5).style("opacity",0),n.xgridLines.exit().transition().duration(t).style("opacity",0).remove(),s.grid_y_show&&n.updateYGrid(),n.ygridLines=r.select("."+V.ygridLines).selectAll("."+V.ygridLine).data(s.grid_y_lines),(i=n.ygridLines.enter().append("g").attr("class",function(t){return V.ygridLine+(t.class?" "+t.class:"")})).append("line").style("opacity",0),i.append("text").attr("text-anchor",n.gridTextAnchor).attr("transform",s.axis_rotated?"rotate(-90)":"").attr("dx",n.gridTextDx).attr("dy",-5).style("opacity",0),a=n.yv.bind(n),n.ygridLines.select("line").transition().duration(t).attr("x1",s.axis_rotated?a:0).attr("x2",s.axis_rotated?a:n.width).attr("y1",s.axis_rotated?0:a).attr("y2",s.axis_rotated?n.height:a).style("opacity",1),n.ygridLines.select("text").transition().duration(t).attr("x",s.axis_rotated?n.xGridTextX.bind(n):n.yGridTextX.bind(n)).attr("y",a).text(function(t){return t.text}).style("opacity",1),n.ygridLines.exit().transition().duration(t).style("opacity",0).remove()},l.redrawGrid=function(t){var e=this,i=e.config,a=e.xv.bind(e),n=e.xgridLines.select("line"),r=e.xgridLines.select("text");return[(t?n.transition():n).attr("x1",i.axis_rotated?0:a).attr("x2",i.axis_rotated?e.width:a).attr("y1",i.axis_rotated?a:0).attr("y2",i.axis_rotated?a:e.height).style("opacity",1),(t?r.transition():r).attr("x",i.axis_rotated?e.yGridTextX.bind(e):e.xGridTextX.bind(e)).attr("y",a).text(function(t){return t.text}).style("opacity",1)]},l.showXGridFocus=function(t){var e=this,i=e.config,a=t.filter(function(t){return t&&S(t.value)}),n=e.main.selectAll("line."+V.xgridFocus),r=e.xx.bind(e);i.tooltip_show&&(e.hasType("scatter")||e.hasArcType()||(n.style("visibility","visible").data([a[0]]).attr(i.axis_rotated?"y1":"x1",r).attr(i.axis_rotated?"y2":"x2",r),e.smoothLines(n,"grid")))},l.hideXGridFocus=function(){this.main.select("line."+V.xgridFocus).style("visibility","hidden")},l.updateXgridFocus=function(){var t=this.config;this.main.select("line."+V.xgridFocus).attr("x1",t.axis_rotated?0:-10).attr("x2",t.axis_rotated?this.width:-10).attr("y1",t.axis_rotated?-10:0).attr("y2",t.axis_rotated?-10:this.height)},l.generateGridData=function(t,e){var i,a,n,r,s=[],o=this.main.select("."+V.axisX).selectAll(".tick").size();if("year"===t)for(a=(i=this.getXDomain())[0].getFullYear(),n=i[1].getFullYear(),r=a;r<=n;r++)s.push(new Date(r+"-01-01 00:00:00"));else(s=e.ticks(10)).length>o&&(s=s.filter(function(t){return(""+t).indexOf(".")<0}));return s},l.getGridFilterToRemove=function(t){return t?function(e){var i=!1;return[].concat(t).forEach(function(t){("value"in t&&e.value===t.value||"class"in t&&e.class===t.class)&&(i=!0)}),i}:function(){return!0}},l.removeGridLines=function(t,e){var i=this.config,a=this.getGridFilterToRemove(t),n=function(t){return!a(t)},r=e?V.xgridLines:V.ygridLines,s=e?V.xgridLine:V.ygridLine;this.main.select("."+r).selectAll("."+s).filter(a).transition().duration(i.transition_duration).style("opacity",0).remove(),e?i.grid_x_lines=i.grid_x_lines.filter(n):i.grid_y_lines=i.grid_y_lines.filter(n)},l.initTooltip=function(){var t,e=this,i=e.config;if(e.tooltip=e.selectChart.style("position","relative").append("div").attr("class",V.tooltipContainer).style("position","absolute").style("pointer-events","none").style("display","none"),i.tooltip_init_show){if(e.isTimeSeries()&&r(i.tooltip_init_x)){for(i.tooltip_init_x=e.parseDate(i.tooltip_init_x),t=0;t<e.data.targets[0].values.length&&e.data.targets[0].values[t].x-i.tooltip_init_x!=0;t++);i.tooltip_init_x=t}e.tooltip.html(i.tooltip_contents.call(e,e.data.targets.map(function(t){return e.addName(t.values[i.tooltip_init_x])}),e.axis.getXAxisTickFormat(),e.getYFormat(e.hasArcType()),e.color)),e.tooltip.style("top",i.tooltip_init_position.top).style("left",i.tooltip_init_position.left).style("display","block")}},l.getTooltipContent=function(t,e,i,a){var n,r,s,o,c,d,l=this.config,u=l.tooltip_format_title||e,g=l.tooltip_format_name||function(t){return t},h=l.tooltip_format_value||i;for(r=0;r<t.length;r++)t[r]&&(t[r].value||0===t[r].value)&&(n||(s=u?u(t[r].x):t[r].x,n="<table class='"+V.tooltip+"'>"+(s||0===s?"<tr><th colspan='2'>"+s+"</th></tr>":"")),void 0!==(o=h(t[r].value,t[r].ratio,t[r].id,t[r].index))&&(c=g(t[r].name,t[r].ratio,t[r].id,t[r].index),d=this.levelColor?this.levelColor(t[r].value):a(t[r].id),n+="<tr class='"+V.tooltipName+"-"+t[r].id+"'>",n+="<td class='name'><span style='background-color:"+d+"'></span>"+c+"</td>",n+="<td class='value'>"+o+"</td>",n+="</tr>"));return n+"</table>"},l.tooltipPosition=function(t,e,i,a){var n,r,s,o,c,d=this,l=d.config,u=d.d3,g=d.hasArcType(),h=u.mouse(a);return g?(r=(d.width-(d.isLegendRight?d.getLegendWidth():0))/2+h[0],o=d.height/2+h[1]+20):(n=d.getSvgLeft(!0),o=l.axis_rotated?(s=(r=n+h[0]+100)+e,c=d.currentWidth-d.getCurrentPaddingRight(),d.x(t[0].x)+20):(s=(r=n+d.getCurrentPaddingLeft(!0)+d.x(t[0].x)+20)+e,c=n+d.currentWidth-d.getCurrentPaddingRight(),h[1]+15),c<s&&(r-=s-c+20),o+i>d.currentHeight&&(o-=i+30)),o<0&&(o=0),{top:o,left:r}},l.showTooltip=function(t,e){var i,a,n,r=this,s=r.config,o=r.hasArcType(),c=t.filter(function(t){return t&&S(t.value)}),d=s.tooltip_position||l.tooltipPosition;0!==c.length&&s.tooltip_show&&(r.tooltip.html(s.tooltip_contents.call(r,t,r.axis.getXAxisTickFormat(),r.getYFormat(o),r.color)).style("display","block"),i=r.tooltip.property("offsetWidth"),a=r.tooltip.property("offsetHeight"),n=d.call(this,c,i,a,e),r.tooltip.style("top",n.top+"px").style("left",n.left+"px"))},l.hideTooltip=function(){this.tooltip.style("display","none")},l.initLegend=function(){var t=this;return t.legendItemTextBox={},t.legendHasRendered=!1,t.legend=t.svg.append("g").attr("transform",t.getTranslate("legend")),t.config.legend_show?void t.updateLegendWithDefaults():(t.legend.style("visibility","hidden"),void(t.hiddenLegendIds=t.mapToIds(t.data.targets)))},l.updateLegendWithDefaults=function(){this.updateLegend(this.mapToIds(this.data.targets),{withTransform:!1,withTransitionForTransform:!1,withTransition:!1})},l.updateSizeForLegend=function(t,e){var i=this,a=i.config,n={top:i.isLegendTop?i.getCurrentPaddingTop()+a.legend_inset_y+5.5:i.currentHeight-t-i.getCurrentPaddingBottom()-a.legend_inset_y,left:i.isLegendLeft?i.getCurrentPaddingLeft()+a.legend_inset_x+.5:i.currentWidth-e-i.getCurrentPaddingRight()-a.legend_inset_x+.5};i.margin3={top:i.isLegendRight?0:i.isLegendInset?n.top:i.currentHeight-t,right:NaN,bottom:0,left:i.isLegendRight?i.currentWidth-e:i.isLegendInset?n.left:0}},l.transformLegend=function(t){(t?this.legend.transition():this.legend).attr("transform",this.getTranslate("legend"))},l.updateLegendStep=function(t){this.legendStep=t},l.updateLegendItemWidth=function(t){this.legendItemWidth=t},l.updateLegendItemHeight=function(t){this.legendItemHeight=t},l.getLegendWidth=function(){var t=this;return t.config.legend_show?t.isLegendRight||t.isLegendInset?t.legendItemWidth*(t.legendStep+1):t.currentWidth:0},l.getLegendHeight=function(){var t=this,e=0;return t.config.legend_show&&(e=t.isLegendRight?t.currentHeight:Math.max(20,t.legendItemHeight)*(t.legendStep+1)),e},l.opacityForLegend=function(t){return t.classed(V.legendItemHidden)?null:1},l.opacityForUnfocusedLegend=function(t){return t.classed(V.legendItemHidden)?null:.3},l.toggleFocusLegend=function(e,t){var i=this;e=i.mapToTargetIds(e),i.legend.selectAll("."+V.legendItem).filter(function(t){return 0<=e.indexOf(t)}).classed(V.legendItemFocused,t).transition().duration(100).style("opacity",function(){return(t?i.opacityForLegend:i.opacityForUnfocusedLegend).call(i,i.d3.select(this))})},l.revertLegend=function(){var t=this,e=t.d3;t.legend.selectAll("."+V.legendItem).classed(V.legendItemFocused,!1).transition().duration(100).style("opacity",function(){return t.opacityForLegend(e.select(this))})},l.showLegend=function(t){var e=this,i=e.config;i.legend_show||(i.legend_show=!0,e.legend.style("visibility","visible"),e.legendHasRendered||e.updateLegendWithDefaults()),e.removeHiddenLegendIds(t),e.legend.selectAll(e.selectorLegends(t)).style("visibility","visible").transition().style("opacity",function(){return e.opacityForLegend(e.d3.select(this))})},l.hideLegend=function(t){var e=this,i=e.config;i.legend_show&&h(t)&&(i.legend_show=!1,e.legend.style("visibility","hidden")),e.addHiddenLegendIds(t),e.legend.selectAll(e.selectorLegends(t)).style("opacity",0).style("visibility","hidden")},l.clearLegendItemTextBoxCache=function(){this.legendItemTextBox={}},l.updateLegend=function(h,t,e){function i(t,e,i){function a(t,e){e||(n=(g-L-u)/2)<A&&(n=(g-u)/2,L=0,I++),F[t]=I,X[I]=_.isLegendInset?10:n,S[t]=L,L+=u}var n,r,s=0===i,o=i===h.length-1,c=function(t,e){return _.legendItemTextBox[e]||(_.legendItemTextBox[e]=_.getTextRect(t.textContent,V.legendItem)),_.legendItemTextBox[e]}(t,e),d=c.width+w+(!o||_.isLegendRight||_.isLegendInset?v:0),l=c.height+y,u=_.isLegendRight||_.isLegendInset?l:d,g=_.isLegendRight||_.isLegendInset?_.getLegendHeight():_.getLegendWidth();return s&&(b=T=I=L=0),m.legend_show&&!_.isLegendToShow(e)?void(C[e]=D[e]=F[e]=S[e]=0):(C[e]=d,D[e]=l,(!T||T<=d)&&(T=d),(!b||b<=l)&&(b=l),r=_.isLegendRight||_.isLegendInset?b:T,void(m.legend_equally?(Object.keys(C).forEach(function(t){C[t]=T}),Object.keys(D).forEach(function(t){D[t]=b}),(n=(g-r*h.length)/2)<A?(I=L=0,h.forEach(function(t){a(t)})):a(e,!0)):a(e)))}var a,n,r,s,o,c,d,l,u,g,f,x,p,_=this,m=_.config,y=4,v=10,T=0,b=0,A=10,w=15,L=0,S={},C={},D={},X=[0],F={},I=0;l=W(t=t||{},"withTransition",!0),u=W(t,"withTransitionForTransform",!0),_.isLegendInset&&(I=m.legend_inset_step?m.legend_inset_step:h.length,_.updateLegendStep(I)),s=_.isLegendRight?(a=function(t){return T*F[t]},function(t){return X[F[t]]+S[t]}):_.isLegendInset?(a=function(t){return T*F[t]+10},function(t){return X[F[t]]+S[t]}):(a=function(t){return X[F[t]]+S[t]},function(t){return b*F[t]}),n=function(t,e){return a(t,e)+14},o=function(t,e){return s(t,e)+9},r=function(t,e){return a(t,e)},c=function(t,e){return s(t,e)-5},(d=_.legend.selectAll("."+V.legendItem).data(h).enter().append("g").attr("class",function(t){return _.generateClass(V.legendItem,t)}).style("visibility",function(t){return _.isLegendToShow(t)?"visible":"hidden"}).style("cursor","pointer").on("click",function(t){m.legend_item_onclick?m.legend_item_onclick.call(_,t):_.d3.event.altKey?(_.api.hide(),_.api.show(t)):(_.api.toggle(t),_.isTargetToShow(t)?_.api.focus(t):_.api.revert())}).on("mouseover",function(t){_.d3.select(this).classed(V.legendItemFocused,!0),!_.transiting&&_.isTargetToShow(t)&&_.api.focus(t),m.legend_item_onmouseover&&m.legend_item_onmouseover.call(_,t)}).on("mouseout",function(t){_.d3.select(this).classed(V.legendItemFocused,!1),_.api.revert(),m.legend_item_onmouseout&&m.legend_item_onmouseout.call(_,t)})).append("text").text(function(t){return k(m.data_names[t])?m.data_names[t]:t}).each(function(t,e){i(this,t,e)}).style("pointer-events","none").attr("x",_.isLegendRight||_.isLegendInset?n:-200).attr("y",_.isLegendRight||_.isLegendInset?-200:o),d.append("rect").attr("class",V.legendItemEvent).style("fill-opacity",0).attr("x",_.isLegendRight||_.isLegendInset?r:-200).attr("y",_.isLegendRight||_.isLegendInset?-200:c),d.append("rect").attr("class",V.legendItemTile).style("pointer-events","none").style("fill",_.color).attr("x",_.isLegendRight||_.isLegendInset?n:-200).attr("y",_.isLegendRight||_.isLegendInset?-200:s).attr("width",10).attr("height",10),p=_.legend.select("."+V.legendBackground+" rect"),_.isLegendInset&&0<T&&0===p.size()&&(p=_.legend.insert("g","."+V.legendItem).attr("class",V.legendBackground).append("rect")),g=_.legend.selectAll("text").data(h).text(function(t){return k(m.data_names[t])?m.data_names[t]:t}).each(function(t,e){i(this,t,e)}),(l?g.transition():g).attr("x",n).attr("y",o),f=_.legend.selectAll("rect."+V.legendItemEvent).data(h),(l?f.transition():f).attr("width",function(t){return C[t]}).attr("height",function(t){return D[t]}).attr("x",r).attr("y",c),x=_.legend.selectAll("rect."+V.legendItemTile).data(h),(l?x.transition():x).style("fill",_.color).attr("x",a).attr("y",s),p&&(l?p.transition():p).attr("height",_.getLegendHeight()-12).attr("width",T*(I+1)+10),_.legend.selectAll("."+V.legendItem).classed(V.legendItemHidden,function(t){return!_.isTargetToShow(t)}),_.updateLegendItemWidth(T),_.updateLegendItemHeight(b),_.updateLegendStep(I),_.updateSizes(),_.updateScales(),_.updateSvgSize(),_.transformAll(u,e),_.legendHasRendered=!0},function(t,e){if(Object.create)e.prototype=Object.create(t.prototype);else{var i=function(){};i.prototype=t.prototype,e.prototype=new i}e.prototype.constructor=e}(e,o),o.prototype.init=function(){var t=this.owner,e=t.config,i=t.main;t.axes.x=i.append("g").attr("class",V.axis+" "+V.axisX).attr("clip-path",t.clipPathForXAxis).attr("transform",t.getTranslate("x")).style("visibility",e.axis_x_show?"visible":"hidden"),t.axes.x.append("text").attr("class",V.axisXLabel).attr("transform",e.axis_rotated?"rotate(-90)":"").style("text-anchor",this.textAnchorForXAxisLabel.bind(this)),t.axes.y=i.append("g").attr("class",V.axis+" "+V.axisY).attr("clip-path",e.axis_y_inner?"":t.clipPathForYAxis).attr("transform",t.getTranslate("y")).style("visibility",e.axis_y_show?"visible":"hidden"),t.axes.y.append("text").attr("class",V.axisYLabel).attr("transform",e.axis_rotated?"":"rotate(-90)").style("text-anchor",this.textAnchorForYAxisLabel.bind(this)),t.axes.y2=i.append("g").attr("class",V.axis+" "+V.axisY2).attr("transform",t.getTranslate("y2")).style("visibility",e.axis_y2_show?"visible":"hidden"),t.axes.y2.append("text").attr("class",V.axisY2Label).attr("transform",e.axis_rotated?"":"rotate(-90)").style("text-anchor",this.textAnchorForY2AxisLabel.bind(this))},o.prototype.getXAxis=function(t,e,i,a,n,r,s){var o=this.owner,c=o.config,d={isCategory:o.isCategorized(),withOuterTick:n,tickMultiline:c.axis_x_tick_multiline,tickWidth:c.axis_x_tick_width,tickTextRotate:s?0:c.axis_x_tick_rotate,withoutTransition:r},l=u(o.d3,d).scale(t).orient(e);return o.isTimeSeries()&&a&&(a=a.map(function(t){return o.parseDate(t)})),l.tickFormat(i).tickValues(a),o.isCategorized()&&(l.tickCentered(c.axis_x_tick_centered),h(c.axis_x_tick_culling)&&(c.axis_x_tick_culling=!1)),l},o.prototype.updateXAxisTickValues=function(t,e){var i,a=this.owner,n=a.config;return(n.axis_x_tick_fit||n.axis_x_tick_count)&&(i=this.generateTickValues(a.mapTargetsToUniqueXs(t),n.axis_x_tick_count,a.isTimeSeries())),e?e.tickValues(i):(a.xAxis.tickValues(i),a.subXAxis.tickValues(i)),i},o.prototype.getYAxis=function(t,e,i,a,n,r){var s={withOuterTick:n,withoutTransition:r},o=this.owner,c=o.d3,d=o.config,l=u(c,s).scale(t).orient(e).tickFormat(i);return o.isTimeSeriesY()?l.ticks(c.time[d.axis_y_tick_time_value],d.axis_y_tick_time_interval):l.tickValues(a),l},o.prototype.getId=function(t){var e=this.owner.config;return t in e.data_axes?e.data_axes[t]:"y"},o.prototype.getXAxisTickFormat=function(){var e=this.owner,i=e.config,a=e.isTimeSeries()?e.defaultAxisTimeFormat:e.isCategorized()?e.categoryName:function(t){return t<0?t.toFixed(0):t};return i.axis_x_tick_format&&(g(i.axis_x_tick_format)?a=i.axis_x_tick_format:e.isTimeSeries()&&(a=function(t){return t?e.axisTimeFormat(i.axis_x_tick_format)(t):""})),g(a)?function(t){return a.call(e,t)}:a},o.prototype.getTickValues=function(t,e){return t||(e?e.tickValues():void 0)},o.prototype.getXAxisTickValues=function(){return this.getTickValues(this.owner.config.axis_x_tick_values,this.owner.xAxis)},o.prototype.getYAxisTickValues=function(){return this.getTickValues(this.owner.config.axis_y_tick_values,this.owner.yAxis)},o.prototype.getY2AxisTickValues=function(){return this.getTickValues(this.owner.config.axis_y2_tick_values,this.owner.y2Axis)},o.prototype.getLabelOptionByAxisId=function(t){var e,i=this.owner.config;return"y"===t?e=i.axis_y_label:"y2"===t?e=i.axis_y2_label:"x"===t&&(e=i.axis_x_label),e},o.prototype.getLabelText=function(t){var e=this.getLabelOptionByAxisId(t);return r(e)?e:e?e.text:null},o.prototype.setLabelText=function(t,e){var i=this.owner.config,a=this.getLabelOptionByAxisId(t);r(a)?"y"===t?i.axis_y_label=e:"y2"===t?i.axis_y2_label=e:"x"===t&&(i.axis_x_label=e):a&&(a.text=e)},o.prototype.getLabelPosition=function(t,e){var i=this.getLabelOptionByAxisId(t),a=i&&"object"==typeof i&&i.position?i.position:e;return{isInner:0<=a.indexOf("inner"),isOuter:0<=a.indexOf("outer"),isLeft:0<=a.indexOf("left"),isCenter:0<=a.indexOf("center"),isRight:0<=a.indexOf("right"),isTop:0<=a.indexOf("top"),isMiddle:0<=a.indexOf("middle"),isBottom:0<=a.indexOf("bottom")}},o.prototype.getXAxisLabelPosition=function(){return this.getLabelPosition("x",this.owner.config.axis_rotated?"inner-top":"inner-right")},o.prototype.getYAxisLabelPosition=function(){return this.getLabelPosition("y",this.owner.config.axis_rotated?"inner-right":"inner-top")},o.prototype.getY2AxisLabelPosition=function(){return this.getLabelPosition("y2",this.owner.config.axis_rotated?"inner-right":"inner-top")},o.prototype.getLabelPositionById=function(t){return"y2"===t?this.getY2AxisLabelPosition():"y"===t?this.getYAxisLabelPosition():this.getXAxisLabelPosition()},o.prototype.textForXAxisLabel=function(){return this.getLabelText("x")},o.prototype.textForYAxisLabel=function(){return this.getLabelText("y")},o.prototype.textForY2AxisLabel=function(){return this.getLabelText("y2")},o.prototype.xForAxisLabel=function(t,e){var i=this.owner;return t?e.isLeft?0:e.isCenter?i.width/2:i.width:e.isBottom?-i.height:e.isMiddle?-i.height/2:0},o.prototype.dxForAxisLabel=function(t,e){return t?e.isLeft?"0.5em":e.isRight?"-0.5em":"0":e.isTop?"-0.5em":e.isBottom?"0.5em":"0"},o.prototype.textAnchorForAxisLabel=function(t,e){return t?e.isLeft?"start":e.isCenter?"middle":"end":e.isBottom?"start":e.isMiddle?"middle":"end"},o.prototype.xForXAxisLabel=function(){return this.xForAxisLabel(!this.owner.config.axis_rotated,this.getXAxisLabelPosition())},o.prototype.xForYAxisLabel=function(){return this.xForAxisLabel(this.owner.config.axis_rotated,this.getYAxisLabelPosition())},o.prototype.xForY2AxisLabel=function(){return this.xForAxisLabel(this.owner.config.axis_rotated,this.getY2AxisLabelPosition())},o.prototype.dxForXAxisLabel=function(){return this.dxForAxisLabel(!this.owner.config.axis_rotated,this.getXAxisLabelPosition())},o.prototype.dxForYAxisLabel=function(){return this.dxForAxisLabel(this.owner.config.axis_rotated,this.getYAxisLabelPosition())},o.prototype.dxForY2AxisLabel=function(){return this.dxForAxisLabel(this.owner.config.axis_rotated,this.getY2AxisLabelPosition())},o.prototype.dyForXAxisLabel=function(){var t=this.owner.config,e=this.getXAxisLabelPosition();return t.axis_rotated?e.isInner?"1.2em":-25-this.getMaxTickWidth("x"):e.isInner?"-0.5em":t.axis_x_height?t.axis_x_height-10:"3em"},o.prototype.dyForYAxisLabel=function(){var t=this.owner,e=this.getYAxisLabelPosition();return t.config.axis_rotated?e.isInner?"-0.5em":"3em":e.isInner?"1.2em":-10-(t.config.axis_y_inner?0:this.getMaxTickWidth("y")+10)},o.prototype.dyForY2AxisLabel=function(){var t=this.owner,e=this.getY2AxisLabelPosition();return t.config.axis_rotated?e.isInner?"1.2em":"-2.2em":e.isInner?"-0.5em":15+(t.config.axis_y2_inner?0:this.getMaxTickWidth("y2")+15)},o.prototype.textAnchorForXAxisLabel=function(){var t=this.owner;return this.textAnchorForAxisLabel(!t.config.axis_rotated,this.getXAxisLabelPosition())},o.prototype.textAnchorForYAxisLabel=function(){var t=this.owner;return this.textAnchorForAxisLabel(t.config.axis_rotated,this.getYAxisLabelPosition())},o.prototype.textAnchorForY2AxisLabel=function(){var t=this.owner;return this.textAnchorForAxisLabel(t.config.axis_rotated,this.getY2AxisLabelPosition())},o.prototype.getMaxTickWidth=function(t,e){var i,a,n,r,s=this.owner,o=s.config,c=0;return e&&s.currentMaxTickWidths[t]||(s.svg&&(i=s.filterTargetsToShow(s.data.targets),"y"===t?(a=s.y.copy().domain(s.getYDomain(i,"y")),n=this.getYAxis(a,s.yOrient,o.axis_y_tick_format,s.yAxisTickValues,!1,!0)):"y2"===t?(a=s.y2.copy().domain(s.getYDomain(i,"y2")),n=this.getYAxis(a,s.y2Orient,o.axis_y2_tick_format,s.y2AxisTickValues,!1,!0)):(a=s.x.copy().domain(s.getXDomain(i)),n=this.getXAxis(a,s.xOrient,s.xAxisTickFormat,s.xAxisTickValues,!1,!0,!0),this.updateXAxisTickValues(i,n)),(r=s.d3.select("body").append("div").classed("c3",!0)).append("svg").style("visibility","hidden").style("position","fixed").style("top",0).style("left",0).append("g").call(n).each(function(){s.d3.select(this).selectAll("text").each(function(){var t=this.getBoundingClientRect();c<t.width&&(c=t.width)}),r.remove()})),s.currentMaxTickWidths[t]=c<=0?s.currentMaxTickWidths[t]:c),s.currentMaxTickWidths[t]},o.prototype.updateLabels=function(t){var e=this.owner,i=e.main.select("."+V.axisX+" ."+V.axisXLabel),a=e.main.select("."+V.axisY+" ."+V.axisYLabel),n=e.main.select("."+V.axisY2+" ."+V.axisY2Label);(t?i.transition():i).attr("x",this.xForXAxisLabel.bind(this)).attr("dx",this.dxForXAxisLabel.bind(this)).attr("dy",this.dyForXAxisLabel.bind(this)).text(this.textForXAxisLabel.bind(this)),(t?a.transition():a).attr("x",this.xForYAxisLabel.bind(this)).attr("dx",this.dxForYAxisLabel.bind(this)).attr("dy",this.dyForYAxisLabel.bind(this)).text(this.textForYAxisLabel.bind(this)),(t?n.transition():n).attr("x",this.xForY2AxisLabel.bind(this)).attr("dx",this.dxForY2AxisLabel.bind(this)).attr("dy",this.dyForY2AxisLabel.bind(this)).text(this.textForY2AxisLabel.bind(this))},o.prototype.getPadding=function(t,e,i,a){return S(t[e])?"ratio"===t.unit?t[e]*a:this.convertPixelsToAxisPadding(t[e],a):i},o.prototype.convertPixelsToAxisPadding=function(t,e){var i=this.owner;return e*(t/(i.config.axis_rotated?i.width:i.height))},o.prototype.generateTickValues=function(t,e,i){var a,n,r,s,o,c,d,l=t;if(e)if(1===(a=g(e)?e():e))l=[t[0]];else if(2===a)l=[t[0],t[t.length-1]];else if(2<a){for(s=a-2,n=t[0],o=((r=t[t.length-1])-n)/(1+s),l=[n],c=0;c<s;c++)d=+n+o*(c+1),l.push(i?new Date(d):d);l.push(r)}return i||(l=l.sort(function(t,e){return t-e})),l},o.prototype.generateTransitions=function(t){var e=this.owner.axes;return{axisX:t?e.x.transition().duration(t):e.x,axisY:t?e.y.transition().duration(t):e.y,axisY2:t?e.y2.transition().duration(t):e.y2,axisSubX:t?e.subx.transition().duration(t):e.subx}},o.prototype.redraw=function(t,e){var i=this.owner;i.axes.x.style("opacity",e?0:1),i.axes.y.style("opacity",e?0:1),i.axes.y2.style("opacity",e?0:1),i.axes.subx.style("opacity",e?0:1),t.axisX.call(i.xAxis),t.axisY.call(i.yAxis),t.axisY2.call(i.y2Axis),t.axisSubX.call(i.subXAxis)},l.getClipPath=function(t){return"url("+(0<=d.navigator.appVersion.toLowerCase().indexOf("msie 9.")?"":document.URL.split("#")[0])+"#"+t+")"},l.appendClip=function(t,e){return t.append("clipPath").attr("id",e).append("rect")},l.getAxisClipX=function(t){var e=Math.max(30,this.margin.left);return t?-(1+e):-(e-1)},l.getAxisClipY=function(t){return t?-20:-this.margin.top},l.getXAxisClipX=function(){return this.getAxisClipX(!this.config.axis_rotated)},l.getXAxisClipY=function(){return this.getAxisClipY(!this.config.axis_rotated)},l.getYAxisClipX=function(){return this.config.axis_y_inner?-1:this.getAxisClipX(this.config.axis_rotated)},l.getYAxisClipY=function(){return this.getAxisClipY(this.config.axis_rotated)},l.getAxisClipWidth=function(t){var e=Math.max(30,this.margin.left),i=Math.max(30,this.margin.right);return t?this.width+2+e+i:this.margin.left+20},l.getAxisClipHeight=function(t){return(t?this.margin.bottom:this.margin.top+this.height)+20},l.getXAxisClipWidth=function(){return this.getAxisClipWidth(!this.config.axis_rotated)},l.getXAxisClipHeight=function(){return this.getAxisClipHeight(!this.config.axis_rotated)},l.getYAxisClipWidth=function(){return this.getAxisClipWidth(this.config.axis_rotated)+(this.config.axis_y_inner?20:0)},l.getYAxisClipHeight=function(){return this.getAxisClipHeight(this.config.axis_rotated)},l.initPie=function(){var t=this.d3,e=this.config;this.pie=t.layout.pie().value(function(t){return t.values.reduce(function(t,e){return t+e.value},0)}),e.data_order||this.pie.sort(null)},l.updateRadius=function(){var t=this,e=t.config,i=e.gauge_width||e.donut_width;t.radiusExpanded=Math.min(t.arcWidth,t.arcHeight)/2,t.radius=.95*t.radiusExpanded,t.innerRadiusRatio=i?(t.radius-i)/t.radius:.6,t.innerRadius=t.hasType("donut")||t.hasType("gauge")?t.radius*t.innerRadiusRatio:0},l.updateArc=function(){var t=this;t.svgArc=t.getSvgArc(),t.svgArcExpanded=t.getSvgArcExpanded(),t.svgArcExpandedSub=t.getSvgArcExpanded(.98)},l.updateAngle=function(e){var t,i,a=this,n=a.config,r=!1,s=0,o=n.gauge_min,c=n.gauge_max;return a.pie(a.filterTargetsToShow(a.data.targets)).forEach(function(t){r||t.data.id!==e.data.id||(r=!0,(e=t).index=s),s++}),isNaN(e.startAngle)&&(e.startAngle=0),isNaN(e.endAngle)&&(e.endAngle=e.startAngle),a.isGaugeType(e.data)&&(t=Math.PI/(c-o),i=e.value<o?0:e.value<c?e.value-o:c-o,e.startAngle=Math.PI/2*-1,e.endAngle=e.startAngle+t*i),r?e:null},l.getSvgArc=function(){var a=this,n=a.d3.svg.arc().outerRadius(a.radius).innerRadius(a.innerRadius),t=function(t,e){var i;return e?n(t):(i=a.updateAngle(t))?n(i):"M 0 0"};return t.centroid=n.centroid,t},l.getSvgArcExpanded=function(t){var i=this,a=i.d3.svg.arc().outerRadius(i.radiusExpanded*(t||1)).innerRadius(i.innerRadius);return function(t){var e=i.updateAngle(t);return e?a(e):"M 0 0"}},l.getArc=function(t,e,i){return i||this.isArcType(t.data)?this.svgArc(t,e):"M 0 0"},l.transformForArcLabel=function(t){var e,i,a,n,r,s=this,o=s.updateAngle(t),c="";return o&&!s.hasType("gauge")&&(e=this.svgArc.centroid(o),i=isNaN(e[0])?0:e[0],a=isNaN(e[1])?0:e[1],n=Math.sqrt(i*i+a*a),c="translate("+i*(r=s.radius&&n?(.375<36/s.radius?1.175-36/s.radius:.8)*s.radius/n:0)+","+a*r+")"),c},l.getArcRatio=function(t){var e=this.hasType("gauge")?Math.PI:2*Math.PI;return t?(t.endAngle-t.startAngle)/e:null},l.convertToArcData=function(t){return this.addName({id:t.data.id,value:t.value,ratio:this.getArcRatio(t),index:t.index})},l.textForArcLabel=function(t){var e,i,a,n,r,s=this;return s.shouldShowArcLabel()?(i=(e=s.updateAngle(t))?e.value:null,a=s.getArcRatio(e),n=t.data.id,s.hasType("gauge")||s.meetsArcLabelThreshold(a)?(r=s.getArcLabelFormat())?r(i,a,n):s.defaultArcValueFormat(i,a):""):""},l.expandArc=function(t){var e,i=this;return i.transiting?void(e=d.setInterval(function(){i.transiting||(d.clearInterval(e),0<i.legend.selectAll(".c3-legend-item-focused").size()&&i.expandArc(t))},10)):(t=i.mapToTargetIds(t),void i.svg.selectAll(i.selectorTargets(t,"."+V.chartArc)).each(function(t){i.shouldExpand(t.data.id)&&i.d3.select(this).selectAll("path").transition().duration(50).attr("d",i.svgArcExpanded).transition().duration(100).attr("d",i.svgArcExpandedSub).each(function(t){i.isDonutType(t.data)})}))},l.unexpandArc=function(t){var e=this;e.transiting||(t=e.mapToTargetIds(t),e.svg.selectAll(e.selectorTargets(t,"."+V.chartArc)).selectAll("path").transition().duration(50).attr("d",e.svgArc),e.svg.selectAll("."+V.arc).style("opacity",1))},l.shouldExpand=function(t){var e=this.config;return this.isDonutType(t)&&e.donut_expand||this.isGaugeType(t)&&e.gauge_expand||this.isPieType(t)&&e.pie_expand},l.shouldShowArcLabel=function(){var t=this.config,e=!0;return this.hasType("donut")?e=t.donut_label_show:this.hasType("pie")&&(e=t.pie_label_show),e},l.meetsArcLabelThreshold=function(t){var e=this.config;return(this.hasType("donut")?e.donut_label_threshold:e.pie_label_threshold)<=t},l.getArcLabelFormat=function(){var t=this.config,e=t.pie_label_format;return this.hasType("gauge")?e=t.gauge_label_format:this.hasType("donut")&&(e=t.donut_label_format),e},l.getArcTitle=function(){return this.hasType("donut")?this.config.donut_title:""},l.updateTargetsForArc=function(t){var e,i=this,a=i.main,n=i.classChartArc.bind(i),r=i.classArcs.bind(i),s=i.classFocus.bind(i);(e=a.select("."+V.chartArcs).selectAll("."+V.chartArc).data(i.pie(t)).attr("class",function(t){return n(t)+s(t.data)}).enter().append("g").attr("class",n)).append("g").attr("class",r),e.append("text").attr("dy",i.hasType("gauge")?"-.1em":".35em").style("opacity",0).style("text-anchor","middle").style("pointer-events","none")},l.initArc=function(){var t=this;t.arcs=t.main.select("."+V.chart).append("g").attr("class",V.chartArcs).attr("transform",t.getTranslate("arc")),t.arcs.append("text").attr("class",V.chartArcsTitle).style("text-anchor","middle").text(t.getArcTitle())},l.redrawArc=function(t,e,i){var a,n=this,r=n.d3,s=n.config,o=n.main;(a=o.selectAll("."+V.arcs).selectAll("."+V.arc).data(n.arcData.bind(n))).enter().append("path").attr("class",n.classArc.bind(n)).style("fill",function(t){return n.color(t.data)}).style("cursor",function(t){return s.interaction_enabled&&s.data_selection_isselectable(t)?"pointer":null}).style("opacity",0).each(function(t){n.isGaugeType(t.data)&&(t.startAngle=t.endAngle=Math.PI/2*-1),this._current=t}),a.attr("transform",function(t){return!n.isGaugeType(t.data)&&i?"scale(0)":""}).style("opacity",function(t){return t===this._current?0:1}).on("mouseover",s.interaction_enabled?function(t){var e,i;n.transiting||(e=n.updateAngle(t),i=n.convertToArcData(e),n.expandArc(e.data.id),n.api.focus(e.data.id),n.toggleFocusLegend(e.data.id,!0),n.config.data_onmouseover(i,this))}:null).on("mousemove",s.interaction_enabled?function(t){var e=n.updateAngle(t),i=[n.convertToArcData(e)];n.showTooltip(i,this)}:null).on("mouseout",s.interaction_enabled?function(t){var e,i;n.transiting||(e=n.updateAngle(t),i=n.convertToArcData(e),n.unexpandArc(e.data.id),n.api.revert(),n.revertLegend(),n.hideTooltip(),n.config.data_onmouseout(i,this))}:null).on("click",s.interaction_enabled?function(t,e){var i=n.updateAngle(t),a=n.convertToArcData(i);n.toggleShape&&n.toggleShape(this,a,e),n.config.data_onclick.call(n.api,a,this)}:null).each(function(){n.transiting=!0}).transition().duration(t).attrTween("d",function(i){var a,t=n.updateAngle(i);return t?(isNaN(this._current.startAngle)&&(this._current.startAngle=0),isNaN(this._current.endAngle)&&(this._current.endAngle=this._current.startAngle),a=r.interpolate(this._current,t),this._current=a(0),function(t){var e=a(t);return e.data=i.data,n.getArc(e,!0)}):function(){return"M 0 0"}}).attr("transform",i?"scale(1)":"").style("fill",function(t){return n.levelColor?n.levelColor(t.data.values[0].value):n.color(t.data.id)}).style("opacity",1).call(n.endall,function(){n.transiting=!1}),a.exit().transition().duration(e).style("opacity",0).remove(),o.selectAll("."+V.chartArc).select("text").style("opacity",0).attr("class",function(t){return n.isGaugeType(t.data)?V.gaugeValue:""}).text(n.textForArcLabel.bind(n)).attr("transform",n.transformForArcLabel.bind(n)).style("font-size",function(t){return n.isGaugeType(t.data)?Math.round(n.radius/5)+"px":""}).transition().duration(t).style("opacity",function(t){return n.isTargetToShow(t.data.id)&&n.isArcType(t.data)?1:0}),o.select("."+V.chartArcsTitle).style("opacity",n.hasType("donut")||n.hasType("gauge")?1:0),n.hasType("gauge")&&(n.arcs.select("."+V.chartArcsBackground).attr("d",function(){var t={data:[{value:s.gauge_max}],startAngle:Math.PI/2*-1,endAngle:Math.PI/2};return n.getArc(t,!0,!0)}),n.arcs.select("."+V.chartArcsGaugeUnit).attr("dy",".75em").text(s.gauge_label_show?s.gauge_units:""),n.arcs.select("."+V.chartArcsGaugeMin).attr("dx",-1*(n.innerRadius+(n.radius-n.innerRadius)/2)+"px").attr("dy","1.2em").text(s.gauge_label_show?s.gauge_min:""),n.arcs.select("."+V.chartArcsGaugeMax).attr("dx",n.innerRadius+(n.radius-n.innerRadius)/2+"px").attr("dy","1.2em").text(s.gauge_label_show?s.gauge_max:""))},l.initGauge=function(){var t=this.arcs;this.hasType("gauge")&&(t.append("path").attr("class",V.chartArcsBackground),t.append("text").attr("class",V.chartArcsGaugeUnit).style("text-anchor","middle").style("pointer-events","none"),t.append("text").attr("class",V.chartArcsGaugeMin).style("text-anchor","middle").style("pointer-events","none"),t.append("text").attr("class",V.chartArcsGaugeMax).style("text-anchor","middle").style("pointer-events","none"))},l.getGaugeLabelHeight=function(){return this.config.gauge_label_show?20:0},l.initRegion=function(){this.region=this.main.append("g").attr("clip-path",this.clipPath).attr("class",V.regions)},l.updateRegion=function(t){var e=this,i=e.config;e.region.style("visibility",e.hasArcType()?"hidden":"visible"),e.mainRegion=e.main.select("."+V.regions).selectAll("."+V.region).data(i.regions),e.mainRegion.enter().append("g").attr("class",e.classRegion.bind(e)).append("rect").style("fill-opacity",0),e.mainRegion.exit().transition().duration(t).style("opacity",0).remove()},l.redrawRegion=function(t){var e=this,i=e.mainRegion.selectAll("rect"),a=e.regionX.bind(e),n=e.regionY.bind(e),r=e.regionWidth.bind(e),s=e.regionHeight.bind(e);return[(t?i.transition():i).attr("x",a).attr("y",n).attr("width",r).attr("height",s).style("fill-opacity",function(t){return S(t.opacity)?t.opacity:.1})]},l.regionX=function(t){var e=this,i=e.config,a="y"===t.axis?e.y:e.y2;return"y"===t.axis||"y2"===t.axis?i.axis_rotated&&"start"in t?a(t.start):0:i.axis_rotated?0:"start"in t?e.x(e.isTimeSeries()?e.parseDate(t.start):t.start):0},l.regionY=function(t){var e=this,i=e.config,a="y"===t.axis?e.y:e.y2;return"y"===t.axis||"y2"===t.axis?i.axis_rotated?0:"end"in t?a(t.end):0:i.axis_rotated&&"start"in t?e.x(e.isTimeSeries()?e.parseDate(t.start):t.start):0},l.regionWidth=function(t){var e,i=this,a=i.config,n=i.regionX(t),r="y"===t.axis?i.y:i.y2;return(e="y"===t.axis||"y2"===t.axis?a.axis_rotated&&"end"in t?r(t.end):i.width:a.axis_rotated?i.width:"end"in t?i.x(i.isTimeSeries()?i.parseDate(t.end):t.end):i.width)<n?0:e-n},l.regionHeight=function(t){var e,i=this,a=i.config,n=this.regionY(t),r="y"===t.axis?i.y:i.y2;return(e="y"===t.axis||"y2"===t.axis?a.axis_rotated?i.height:"start"in t?r(t.start):i.height:a.axis_rotated&&"end"in t?i.x(i.isTimeSeries()?i.parseDate(t.end):t.end):i.height)<n?0:e-n},l.isRegionOnX=function(t){return!t.axis||"x"===t.axis},l.drag=function(t){var e,i,a,n,g,h,f,x,p=this,r=p.config,s=p.main,_=p.d3;p.hasArcType()||r.data_selection_enabled&&(!r.zoom_enabled||p.zoom.altDomain)&&r.data_selection_multiple&&(e=p.dragStart[0],i=p.dragStart[1],a=t[0],n=t[1],g=Math.min(e,a),h=Math.max(e,a),f=r.data_selection_grouped?p.margin.top:Math.min(i,n),x=r.data_selection_grouped?p.height:Math.max(i,n),s.select("."+V.dragarea).attr("x",g).attr("y",f).attr("width",h-g).attr("height",x-f),s.selectAll("."+V.shapes).selectAll("."+V.shape).filter(function(t){return r.data_selection_isselectable(t)}).each(function(t,e){var i,a,n,r,s,o,c=_.select(this),d=c.classed(V.SELECTED),l=c.classed(V.INCLUDED),u=!1;if(c.classed(V.circle))i=1*c.attr("cx"),a=1*c.attr("cy"),s=p.togglePoint,u=g<i&&i<h&&f<a&&a<x;else{if(!c.classed(V.bar))return;i=(o=m(this)).x,a=o.y,n=o.width,r=o.height,s=p.togglePath,u=!(h<i||i+n<g||x<a||a+r<f)}u^l&&(c.classed(V.INCLUDED,!l),c.classed(V.SELECTED,!d),s.call(p,!d,c,t,e))}))},l.dragstart=function(t){var e=this,i=e.config;e.hasArcType()||i.data_selection_enabled&&(e.dragStart=t,e.main.select("."+V.chart).append("rect").attr("class",V.dragarea).style("opacity",.1),e.dragging=!0)},l.dragend=function(){var t=this,e=t.config;t.hasArcType()||e.data_selection_enabled&&(t.main.select("."+V.dragarea).transition().duration(100).style("opacity",0).remove(),t.main.selectAll("."+V.shape).classed(V.INCLUDED,!1),t.dragging=!1)},l.selectPoint=function(t,e,i){var a=this,n=a.config,r=(n.axis_rotated?a.circleY:a.circleX).bind(a),s=(n.axis_rotated?a.circleX:a.circleY).bind(a),o=a.pointSelectR.bind(a);n.data_onselected.call(a.api,e,t.node()),a.main.select("."+V.selectedCircles+a.getTargetSelectorSuffix(e.id)).selectAll("."+V.selectedCircle+"-"+i).data([e]).enter().append("circle").attr("class",function(){return a.generateClass(V.selectedCircle,i)}).attr("cx",r).attr("cy",s).attr("stroke",function(){return a.color(e)}).attr("r",function(t){return 1.4*a.pointSelectR(t)}).transition().duration(100).attr("r",o)},l.unselectPoint=function(t,e,i){this.config.data_onunselected(e,t.node()),this.main.select("."+V.selectedCircles+this.getTargetSelectorSuffix(e.id)).selectAll("."+V.selectedCircle+"-"+i).transition().duration(100).attr("r",0).remove()},l.togglePoint=function(t,e,i,a){t?this.selectPoint(e,i,a):this.unselectPoint(e,i,a)},l.selectPath=function(t,e){var i=this;i.config.data_onselected.call(i,e,t.node()),t.transition().duration(100).style("fill",function(){return i.d3.rgb(i.color(e)).brighter(.75)})},l.unselectPath=function(t,e){var i=this;i.config.data_onunselected.call(i,e,t.node()),t.transition().duration(100).style("fill",function(){return i.color(e)})},l.togglePath=function(t,e,i,a){t?this.selectPath(e,i,a):this.unselectPath(e,i,a)},l.getToggle=function(t,e){var i;return"circle"===t.nodeName?i=this.isStepType(e)?function(){}:this.togglePoint:"path"===t.nodeName&&(i=this.togglePath),i},l.toggleShape=function(t,e,i){var a=this,n=a.d3,r=a.config,s=n.select(t),o=s.classed(V.SELECTED),c=a.getToggle(t,e).bind(a);r.data_selection_enabled&&r.data_selection_isselectable(e)&&(r.data_selection_multiple||a.main.selectAll("."+V.shapes+(r.data_selection_grouped?a.getTargetSelectorSuffix(e.id):"")).selectAll("."+V.shape).each(function(t,e){var i=n.select(this);i.classed(V.SELECTED)&&c(!1,i.classed(V.SELECTED,!1),t,e)}),s.classed(V.SELECTED,!o),c(!o,s,e,i))},l.initBrush=function(){var e=this,t=e.d3;e.brush=t.svg.brush().on("brush",function(){e.redrawForBrush()}),e.brush.update=function(){return e.context&&e.context.select("."+V.brush).call(this),this},e.brush.scale=function(t){return e.config.axis_rotated?this.y(t):this.x(t)}},l.initSubchart=function(){var t=this,e=t.config,i=t.context=t.svg.append("g").attr("transform",t.getTranslate("context"));i.style("visibility",e.subchart_show?"visible":"hidden"),i.append("g").attr("clip-path",t.clipPathForSubchart).attr("class",V.chart),i.select("."+V.chart).append("g").attr("class",V.chartBars),i.select("."+V.chart).append("g").attr("class",V.chartLines),i.append("g").attr("clip-path",t.clipPath).attr("class",V.brush).call(t.brush),t.axes.subx=i.append("g").attr("class",V.axisX).attr("transform",t.getTranslate("subx")).attr("clip-path",e.axis_rotated?"":t.clipPathForXAxis)},l.updateTargetsForSubchart=function(t){var e,i=this,a=i.context,n=i.config,r=i.classChartBar.bind(i),s=i.classBars.bind(i),o=i.classChartLine.bind(i),c=i.classLines.bind(i),d=i.classAreas.bind(i);n.subchart_show&&(a.select("."+V.chartBars).selectAll("."+V.chartBar).data(t).attr("class",r).enter().append("g").style("opacity",0).attr("class",r).append("g").attr("class",s),(e=a.select("."+V.chartLines).selectAll("."+V.chartLine).data(t).attr("class",o).enter().append("g").style("opacity",0).attr("class",o)).append("g").attr("class",c),e.append("g").attr("class",d),a.selectAll("."+V.brush+" rect").attr(n.axis_rotated?"width":"height",n.axis_rotated?i.width2:i.height2))},l.updateBarForSubchart=function(t){var e=this;e.contextBar=e.context.selectAll("."+V.bars).selectAll("."+V.bar).data(e.barData.bind(e)),e.contextBar.enter().append("path").attr("class",e.classBar.bind(e)).style("stroke","none").style("fill",e.color),e.contextBar.style("opacity",e.initialOpacity.bind(e)),e.contextBar.exit().transition().duration(t).style("opacity",0).remove()},l.redrawBarForSubchart=function(t,e,i){(e?this.contextBar.transition().duration(i):this.contextBar).attr("d",t).style("opacity",1)},l.updateLineForSubchart=function(t){var e=this;e.contextLine=e.context.selectAll("."+V.lines).selectAll("."+V.line).data(e.lineData.bind(e)),e.contextLine.enter().append("path").attr("class",e.classLine.bind(e)).style("stroke",e.color),e.contextLine.style("opacity",e.initialOpacity.bind(e)),e.contextLine.exit().transition().duration(t).style("opacity",0).remove()},l.redrawLineForSubchart=function(t,e,i){(e?this.contextLine.transition().duration(i):this.contextLine).attr("d",t).style("opacity",1)},l.updateAreaForSubchart=function(t){var e=this,i=e.d3;e.contextArea=e.context.selectAll("."+V.areas).selectAll("."+V.area).data(e.lineData.bind(e)),e.contextArea.enter().append("path").attr("class",e.classArea.bind(e)).style("fill",e.color).style("opacity",function(){return e.orgAreaOpacity=+i.select(this).style("opacity"),0}),e.contextArea.style("opacity",0),e.contextArea.exit().transition().duration(t).style("opacity",0).remove()},l.redrawAreaForSubchart=function(t,e,i){(e?this.contextArea.transition().duration(i):this.contextArea).attr("d",t).style("fill",this.color).style("opacity",this.orgAreaOpacity)},l.redrawSubchart=function(t,e,i,a,n,r,s){var o,c,d,l=this,u=l.d3,g=l.config;l.context.style("visibility",g.subchart_show?"visible":"hidden"),g.subchart_show&&(u.event&&"zoom"===u.event.type&&l.brush.extent(l.x.orgDomain()).update(),t&&(l.brush.empty()||l.brush.extent(l.x.orgDomain()).update(),o=l.generateDrawArea(n,!0),c=l.generateDrawBar(r,!0),d=l.generateDrawLine(s,!0),l.updateBarForSubchart(i),l.updateLineForSubchart(i),l.updateAreaForSubchart(i),l.redrawBarForSubchart(c,i,i),l.redrawLineForSubchart(d,i,i),l.redrawAreaForSubchart(o,i,i)))},l.redrawForBrush=function(){var t=this,e=t.x;t.redraw({withTransition:!1,withY:t.config.zoom_rescale,withSubchart:!1,withUpdateXDomain:!0,withDimension:!1}),t.config.subchart_onbrush.call(t.api,e.orgDomain())},l.transformContext=function(t,e){var i;e&&e.axisSubX?i=e.axisSubX:(i=this.context.select("."+V.axisX),t&&(i=i.transition())),this.context.attr("transform",this.getTranslate("context")),i.attr("transform",this.getTranslate("subx"))},l.getDefaultExtent=function(){var t=this,e=t.config,i=g(e.axis_x_extent)?e.axis_x_extent(t.getXDomain(t.data.targets)):e.axis_x_extent;return t.isTimeSeries()&&(i=[t.parseDate(i[0]),t.parseDate(i[1])]),i},l.initZoom=function(){var e,i=this,a=i.d3,n=i.config;i.zoom=a.behavior.zoom().on("zoomstart",function(){e=a.event.sourceEvent,i.zoom.altDomain=a.event.sourceEvent.altKey?i.x.orgDomain():null,n.zoom_onzoomstart.call(i.api,a.event.sourceEvent)}).on("zoom",function(){i.redrawForZoom.call(i)}).on("zoomend",function(){var t=a.event.sourceEvent;t&&e.clientX===t.clientX&&e.clientY===t.clientY||(i.redrawEventRect(),i.updateZoom(),n.zoom_onzoomend.call(i.api,i.x.orgDomain()))}),i.zoom.scale=function(t){return n.axis_rotated?this.y(t):this.x(t)},i.zoom.orgScaleExtent=function(){var t=n.zoom_extent?n.zoom_extent:[1,10];return[t[0],Math.max(i.getMaxDataCount()/t[1],t[1])]},i.zoom.updateScaleExtent=function(){var t=R(i.x.orgDomain())/R(i.orgXDomain),e=this.orgScaleExtent();return this.scaleExtent([e[0]*t,e[1]*t]),this}},l.updateZoom=function(){var t=this.config.zoom_enabled?this.zoom:function(){};this.main.select("."+V.zoomRect).call(t).on("dblclick.zoom",null),this.main.selectAll("."+V.eventRect).call(t).on("dblclick.zoom",null)},l.redrawForZoom=function(){var t=this,e=t.d3,i=t.config,a=t.zoom,n=t.x;if(i.zoom_enabled&&0!==t.filterTargetsToShow(t.data.targets).length){if("mousemove"===e.event.sourceEvent.type&&a.altDomain)return n.domain(a.altDomain),void a.scale(n).updateScaleExtent();t.isCategorized()&&n.orgDomain()[0]===t.orgXDomain[0]&&n.domain([t.orgXDomain[0]-1e-10,n.orgDomain()[1]]),t.redraw({withTransition:!1,withY:i.zoom_rescale,withSubchart:!1,withEventRect:!1,withDimension:!1}),"mousemove"===e.event.sourceEvent.type&&(t.cancelClick=!0),i.zoom_onzoom.call(t.api,n.orgDomain())}},l.generateColor=function(){var t=this.config,e=this.d3,a=t.data_colors,n=C(t.color_pattern)?t.color_pattern:e.scale.category10().range(),r=t.data_color,s=[];return function(t){var e,i=t.id||t.data&&t.data.id||t;return a[i]instanceof Function?e=a[i](t):a[i]?e=a[i]:(s.indexOf(i)<0&&s.push(i),e=n[s.indexOf(i)%n.length],a[i]=e),r instanceof Function?r(e,t):e}},l.generateLevelColor=function(){var t=this.config,a=t.color_pattern,e=t.color_threshold,n="value"===e.unit,r=e.values&&e.values.length?e.values:[],s=e.max||100;return C(t.color_threshold)?function(t){var e,i=a[a.length-1];for(e=0;e<r.length;e++)if((n?t:100*t/s)<r[e]){i=a[e];break}return i}:null},l.getYFormat=function(t){var a=this,n=t&&!a.hasType("gauge")?a.defaultArcValueFormat:a.yFormat,r=t&&!a.hasType("gauge")?a.defaultArcValueFormat:a.y2Format;return function(t,e,i){return("y2"===a.axis.getId(i)?r:n).call(a,t,e)}},l.yFormat=function(t){var e=this.config;return(e.axis_y_tick_format?e.axis_y_tick_format:this.defaultValueFormat)(t)},l.y2Format=function(t){var e=this.config;return(e.axis_y2_tick_format?e.axis_y2_tick_format:this.defaultValueFormat)(t)},l.defaultValueFormat=function(t){return S(t)?+t:""},l.defaultArcValueFormat=function(t,e){return(100*e).toFixed(1)+"%"},l.dataLabelFormat=function(t){var e=this.config.data_labels,i=function(t){return S(t)?+t:""};return"function"==typeof e.format?e.format:"object"==typeof e.format?e.format[t]?!0===e.format[t]?i:e.format[t]:function(){return""}:i},l.hasCaches=function(t){for(var e=0;e<t.length;e++)if(!(t[e]in this.cache))return!1;return!0},l.addCache=function(t,e){this.cache[t]=this.cloneTarget(e)},l.getCaches=function(t){var e,i=[];for(e=0;e<t.length;e++)t[e]in this.cache&&i.push(this.cloneTarget(this.cache[t[e]]));return i};var V=l.CLASS={target:"c3-target",chart:"c3-chart",chartLine:"c3-chart-line",chartLines:"c3-chart-lines",chartBar:"c3-chart-bar",chartBars:"c3-chart-bars",chartText:"c3-chart-text",chartTexts:"c3-chart-texts",chartArc:"c3-chart-arc",chartArcs:"c3-chart-arcs",chartArcsTitle:"c3-chart-arcs-title",chartArcsBackground:"c3-chart-arcs-background",chartArcsGaugeUnit:"c3-chart-arcs-gauge-unit",chartArcsGaugeMax:"c3-chart-arcs-gauge-max",chartArcsGaugeMin:"c3-chart-arcs-gauge-min",selectedCircle:"c3-selected-circle",selectedCircles:"c3-selected-circles",eventRect:"c3-event-rect",eventRects:"c3-event-rects",eventRectsSingle:"c3-event-rects-single",eventRectsMultiple:"c3-event-rects-multiple",zoomRect:"c3-zoom-rect",brush:"c3-brush",focused:"c3-focused",defocused:"c3-defocused",region:"c3-region",regions:"c3-regions",tooltipContainer:"c3-tooltip-container",tooltip:"c3-tooltip",tooltipName:"c3-tooltip-name",shape:"c3-shape",shapes:"c3-shapes",line:"c3-line",lines:"c3-lines",bar:"c3-bar",bars:"c3-bars",circle:"c3-circle",circles:"c3-circles",arc:"c3-arc",arcs:"c3-arcs",area:"c3-area",areas:"c3-areas",empty:"c3-empty",text:"c3-text",texts:"c3-texts",gaugeValue:"c3-gauge-value",grid:"c3-grid",gridLines:"c3-grid-lines",xgrid:"c3-xgrid",xgrids:"c3-xgrids",xgridLine:"c3-xgrid-line",xgridLines:"c3-xgrid-lines",xgridFocus:"c3-xgrid-focus",ygrid:"c3-ygrid",ygrids:"c3-ygrids",ygridLine:"c3-ygrid-line",ygridLines:"c3-ygrid-lines",axis:"c3-axis",axisX:"c3-axis-x",axisXLabel:"c3-axis-x-label",axisY:"c3-axis-y",axisYLabel:"c3-axis-y-label",axisY2:"c3-axis-y2",axisY2Label:"c3-axis-y2-label",legendBackground:"c3-legend-background",legendItem:"c3-legend-item",legendItemEvent:"c3-legend-item-event",legendItemTile:"c3-legend-item-tile",legendItemHidden:"c3-legend-item-hidden",legendItemFocused:"c3-legend-item-focused",dragarea:"c3-dragarea",EXPANDED:"_expanded_",SELECTED:"_selected_",INCLUDED:"_included_"};l.generateClass=function(t,e){return" "+t+" "+t+this.getTargetSelectorSuffix(e)},l.classText=function(t){return this.generateClass(V.text,t.index)},l.classTexts=function(t){return this.generateClass(V.texts,t.id)},l.classShape=function(t){return this.generateClass(V.shape,t.index)},l.classShapes=function(t){return this.generateClass(V.shapes,t.id)},l.classLine=function(t){return this.classShape(t)+this.generateClass(V.line,t.id)},l.classLines=function(t){return this.classShapes(t)+this.generateClass(V.lines,t.id)},l.classCircle=function(t){return this.classShape(t)+this.generateClass(V.circle,t.index)},l.classCircles=function(t){return this.classShapes(t)+this.generateClass(V.circles,t.id)},l.classBar=function(t){return this.classShape(t)+this.generateClass(V.bar,t.index)},l.classBars=function(t){return this.classShapes(t)+this.generateClass(V.bars,t.id)},l.classArc=function(t){return this.classShape(t.data)+this.generateClass(V.arc,t.data.id)},l.classArcs=function(t){return this.classShapes(t.data)+this.generateClass(V.arcs,t.data.id)},l.classArea=function(t){return this.classShape(t)+this.generateClass(V.area,t.id)},l.classAreas=function(t){return this.classShapes(t)+this.generateClass(V.areas,t.id)},l.classRegion=function(t,e){return this.generateClass(V.region,e)+" "+("class"in t?t.class:"")},l.classEvent=function(t){return this.generateClass(V.eventRect,t.index)},l.classTarget=function(t){var e=this.config.data_classes[t],i="";return e&&(i=" "+V.target+"-"+e),this.generateClass(V.target,t)+i},l.classFocus=function(t){return this.classFocused(t)+this.classDefocused(t)},l.classFocused=function(t){return" "+(0<=this.focusedTargetIds.indexOf(t.id)?V.focused:"")},l.classDefocused=function(t){return" "+(0<=this.defocusedTargetIds.indexOf(t.id)?V.defocused:"")},l.classChartText=function(t){return V.chartText+this.classTarget(t.id)},l.classChartLine=function(t){return V.chartLine+this.classTarget(t.id)},l.classChartBar=function(t){return V.chartBar+this.classTarget(t.id)},l.classChartArc=function(t){return V.chartArc+this.classTarget(t.data.id)},l.getTargetSelectorSuffix=function(t){return t||0===t?("-"+t).replace(/[\s?!@#$%^&*()_=+,.<>'":;\[\]\/|~`{}\\]/g,"-"):""},l.selectorTarget=function(t,e){return(e||"")+"."+V.target+this.getTargetSelectorSuffix(t)},l.selectorTargets=function(t,e){var i=this;return(t=t||[]).length?t.map(function(t){return i.selectorTarget(t,e)}):null},l.selectorLegend=function(t){return"."+V.legendItem+this.getTargetSelectorSuffix(t)},l.selectorLegends=function(t){var e=this;return t&&t.length?t.map(function(t){return e.selectorLegend(t)}):null};var K,S=l.isValue=function(t){return t||0===t},g=l.isFunction=function(t){return"function"==typeof t},r=l.isString=function(t){return"string"==typeof t},b=l.isUndefined=function(t){return void 0===t},k=l.isDefined=function(t){return void 0!==t},s=l.ceil10=function(t){return 10*Math.ceil(t/10)},c=l.asHalfPixel=function(t){return Math.ceil(t)+.5},R=l.diffDomain=function(t){return t[1]-t[0]},h=l.isEmpty=function(t){return!t||r(t)&&0===t.length||"object"==typeof t&&0===Object.keys(t).length},C=l.notEmpty=function(t){return 0<Object.keys(t).length},W=l.getOption=function(t,e,i){return k(t[e])?t[e]:i},f=l.hasValue=function(e,i){var a=!1;return Object.keys(e).forEach(function(t){e[t]===i&&(a=!0)}),a},m=l.getPathBox=function(t){var e=t.getBoundingClientRect(),i=[t.pathSegList.getItem(0),t.pathSegList.getItem(1)];return{x:i[0].x,y:Math.min(i[0].y,i[1].y),width:e.width,height:e.height}};n.focus=function(e){var t,i=this.internal;e=i.mapToTargetIds(e),t=i.svg.selectAll(i.selectorTargets(e.filter(i.isTargetToShow,i))),this.revert(),this.defocus(),t.classed(V.focused,!0).classed(V.defocused,!1),i.hasArcType()&&i.expandArc(e),i.toggleFocusLegend(e,!0),i.focusedTargetIds=e,i.defocusedTargetIds=i.defocusedTargetIds.filter(function(t){return e.indexOf(t)<0})},n.defocus=function(e){var t=this.internal;e=t.mapToTargetIds(e),t.svg.selectAll(t.selectorTargets(e.filter(t.isTargetToShow,t))).classed(V.focused,!1).classed(V.defocused,!0),t.hasArcType()&&t.unexpandArc(e),t.toggleFocusLegend(e,!1),t.focusedTargetIds=t.focusedTargetIds.filter(function(t){return e.indexOf(t)<0}),t.defocusedTargetIds=e},n.revert=function(t){var e=this.internal;t=e.mapToTargetIds(t),e.svg.selectAll(e.selectorTargets(t)).classed(V.focused,!1).classed(V.defocused,!1),e.hasArcType()&&e.unexpandArc(t),e.config.legend_show&&(e.showLegend(t.filter(e.isLegendToShow.bind(e))),e.legend.selectAll(e.selectorLegends(t)).filter(function(){return e.d3.select(this).classed(V.legendItemFocused)}).classed(V.legendItemFocused,!1)),e.focusedTargetIds=[],e.defocusedTargetIds=[]},n.show=function(t,e){var i,a=this.internal;t=a.mapToTargetIds(t),e=e||{},a.removeHiddenTargetIds(t),(i=a.svg.selectAll(a.selectorTargets(t))).transition().style("opacity",1,"important").call(a.endall,function(){i.style("opacity",null).style("opacity",1)}),e.withLegend&&a.showLegend(t),a.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0,withLegend:!0})},n.hide=function(t,e){var i,a=this.internal;t=a.mapToTargetIds(t),e=e||{},a.addHiddenTargetIds(t),(i=a.svg.selectAll(a.selectorTargets(t))).transition().style("opacity",0,"important").call(a.endall,function(){i.style("opacity",null).style("opacity",0)}),e.withLegend&&a.hideLegend(t),a.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0,withLegend:!0})},n.toggle=function(t,e){var i=this,a=this.internal;a.mapToTargetIds(t).forEach(function(t){a.isTargetToShow(t)?i.hide(t,e):i.show(t,e)})},n.zoom=function(t){var e=this.internal;return t&&(e.isTimeSeries()&&(t=t.map(function(t){return e.parseDate(t)})),e.brush.extent(t),e.redraw({withUpdateXDomain:!0,withY:e.config.zoom_rescale}),e.config.zoom_onzoom.call(this,e.x.orgDomain())),e.brush.extent()},n.zoom.enable=function(t){var e=this.internal;e.config.zoom_enabled=t,e.updateAndRedraw()},n.unzoom=function(){var t=this.internal;t.brush.clear().update(),t.redraw({withUpdateXDomain:!0})},n.load=function(e){var t=this.internal,i=t.config;return e.xs&&t.addXs(e.xs),"classes"in e&&Object.keys(e.classes).forEach(function(t){i.data_classes[t]=e.classes[t]}),"categories"in e&&t.isCategorized()&&(i.axis_x_categories=e.categories),"axes"in e&&Object.keys(e.axes).forEach(function(t){i.data_axes[t]=e.axes[t]}),"colors"in e&&Object.keys(e.colors).forEach(function(t){i.data_colors[t]=e.colors[t]}),"cacheIds"in e&&t.hasCaches(e.cacheIds)?void t.load(t.getCaches(e.cacheIds),e.done):void("unload"in e?t.unload(t.mapToTargetIds("boolean"==typeof e.unload&&e.unload?null:e.unload),function(){t.loadFromArgs(e)}):t.loadFromArgs(e))},n.unload=function(t){var e=this.internal;(t=t||{})instanceof Array?t={ids:t}:"string"==typeof t&&(t={ids:[t]}),e.unload(e.mapToTargetIds(t.ids),function(){e.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0,withLegend:!0}),t.done&&t.done()})},n.flow=function(t){var n,e,i,a,r,s,o,c=this.internal,d=[],l=c.getMaxDataCount(),u=0,g=0;if(t.json)e=c.convertJsonToData(t.json,t.keys);else if(t.rows)e=c.convertRowsToData(t.rows);else{if(!t.columns)return;e=c.convertColumnsToData(t.columns)}n=c.convertDataToTargets(e,!0),c.data.targets.forEach(function(t){var e,i,a=!1;for(e=0;e<n.length;e++)if(t.id===n[e].id){for(a=!0,t.values[t.values.length-1]&&(g=t.values[t.values.length-1].index+1),u=n[e].values.length,i=0;i<u;i++)n[e].values[i].index=g+i,c.isTimeSeries()||(n[e].values[i].x=g+i);t.values=t.values.concat(n[e].values),n.splice(e,1);break}a||d.push(t.id)}),c.data.targets.forEach(function(t){var e,i;for(e=0;e<d.length;e++)if(t.id===d[e])for(g=t.values[t.values.length-1].index+1,i=0;i<u;i++)t.values.push({id:t.id,index:g+i,x:c.isTimeSeries()?c.getOtherTargetX(g+i):g+i,value:null})}),c.data.targets.length&&n.forEach(function(t){var e,i=[];for(e=c.data.targets[0].values[0].index;e<g;e++)i.push({id:t.id,index:e,x:c.isTimeSeries()?c.getOtherTargetX(e):e,value:null});t.values.forEach(function(t){t.index+=g,c.isTimeSeries()||(t.x+=g)}),t.values=i.concat(t.values)}),c.data.targets=c.data.targets.concat(n),c.getMaxDataCount(),r=(a=c.data.targets[0]).values[0],k(t.to)?(u=0,o=c.isTimeSeries()?c.parseDate(t.to):t.to,a.values.forEach(function(t){t.x<o&&u++})):k(t.length)&&(u=t.length),l?1===l&&c.isTimeSeries()&&(s=(a.values[a.values.length-1].x-r.x)/2,i=[new Date(+r.x-s),new Date(+r.x+s)],c.updateXDomain(null,!0,!0,!1,i)):(s=c.isTimeSeries()?1<a.values.length?a.values[a.values.length-1].x-r.x:r.x-c.getXDomain(c.data.targets)[0]:1,i=[r.x-s,r.x],c.updateXDomain(null,!0,!0,!1,i)),c.updateTargets(c.data.targets),c.redraw({flow:{index:r.index,length:u,duration:S(t.duration)?t.duration:c.config.transition_duration,done:t.done,orgDataCount:l},withLegend:!0,withTransition:1<l,withTrimXDomain:!1,withUpdateXAxis:!0})},l.generateFlow=function(I){var k=this,E=k.config,Y=k.d3;return function(){var t,e,i,a,n=I.targets,r=I.flow,s=I.drawBar,o=I.drawLine,c=I.drawArea,d=I.cx,l=I.cy,u=I.xv,g=I.xForText,h=I.yForText,f=I.duration,x=r.index,p=r.length,_=k.getValueOnIndex(k.data.targets[0].values,x),m=k.getValueOnIndex(k.data.targets[0].values,x+p),y=k.x.domain(),v=r.duration||f,T=r.done||function(){},b=k.generateWait(),A=k.xgrid||Y.selectAll([]),w=k.xgridLines||Y.selectAll([]),L=k.mainRegion||Y.selectAll([]),S=k.mainText||Y.selectAll([]),C=k.mainBar||Y.selectAll([]),D=k.mainLine||Y.selectAll([]),X=k.mainArea||Y.selectAll([]),F=k.mainCircle||Y.selectAll([]);k.flowing=!0,k.data.targets.forEach(function(t){t.values.splice(0,p)}),i=k.updateXDomain(n,!0,!0),k.updateXGrid&&k.updateXGrid(!0),t=r.orgDataCount?1===r.orgDataCount||_.x===m.x?k.x(y[0])-k.x(i[0]):k.isTimeSeries()?k.x(y[0])-k.x(i[0]):k.x(_.x)-k.x(m.x):1!==k.data.targets[0].values.length?k.x(y[0])-k.x(i[0]):k.isTimeSeries()?(_=k.getValueOnIndex(k.data.targets[0].values,0),m=k.getValueOnIndex(k.data.targets[0].values,k.data.targets[0].values.length-1),k.x(_.x)-k.x(m.x)):R(i)/2,a=R(y)/R(i),e="translate("+t+",0) scale("+a+",1)",k.hideXGridFocus(),k.hideTooltip(),Y.transition().ease("linear").duration(v).each(function(){b.add(k.axes.x.transition().call(k.xAxis)),b.add(C.transition().attr("transform",e)),b.add(D.transition().attr("transform",e)),b.add(X.transition().attr("transform",e)),b.add(F.transition().attr("transform",e)),b.add(S.transition().attr("transform",e)),b.add(L.filter(k.isRegionOnX).transition().attr("transform",e)),b.add(A.transition().attr("transform",e)),b.add(w.transition().attr("transform",e))}).call(b,function(){var t,e=[],i=[],a=[];if(p){for(t=0;t<p;t++)e.push("."+V.shape+"-"+(x+t)),i.push("."+V.text+"-"+(x+t)),a.push("."+V.eventRect+"-"+(x+t));k.svg.selectAll("."+V.shapes).selectAll(e).remove(),k.svg.selectAll("."+V.texts).selectAll(i).remove(),k.svg.selectAll("."+V.eventRects).selectAll(a).remove(),k.svg.select("."+V.xgrid).remove()}A.attr("transform",null).attr(k.xgridAttr),w.attr("transform",null),w.select("line").attr("x1",E.axis_rotated?0:u).attr("x2",E.axis_rotated?k.width:u),w.select("text").attr("x",E.axis_rotated?k.width:0).attr("y",u),C.attr("transform",null).attr("d",s),D.attr("transform",null).attr("d",o),X.attr("transform",null).attr("d",c),F.attr("transform",null).attr("cx",d).attr("cy",l),S.attr("transform",null).attr("x",g).attr("y",h).style("fill-opacity",k.opacityForText.bind(k)),L.attr("transform",null),L.select("rect").filter(k.isRegionOnX).attr("x",k.regionX.bind(k)).attr("width",k.regionWidth.bind(k)),E.interaction_enabled&&k.redrawEventRect(),T(),k.flowing=!1})}},n.selected=function(t){var e=this.internal,i=e.d3;return i.merge(e.main.selectAll("."+V.shapes+e.getTargetSelectorSuffix(t)).selectAll("."+V.shape).filter(function(){return i.select(this).classed(V.SELECTED)}).map(function(t){return t.map(function(t){var e=t.__data__;return e.data?e.data:e})}))},n.select=function(c,d,l){var u=this.internal,g=u.d3,h=u.config;h.data_selection_enabled&&u.main.selectAll("."+V.shapes).selectAll("."+V.shape).each(function(t,e){var i=g.select(this),a=t.data?t.data.id:t.id,n=u.getToggle(this,t).bind(u),r=h.data_selection_grouped||!c||0<=c.indexOf(a),s=!d||0<=d.indexOf(e),o=i.classed(V.SELECTED);i.classed(V.line)||i.classed(V.area)||(r&&s?h.data_selection_isselectable(t)&&!o&&n(!0,i.classed(V.SELECTED,!0),t,e):k(l)&&l&&o&&n(!1,i.classed(V.SELECTED,!1),t,e))})},n.unselect=function(c,d){var l=this.internal,u=l.d3,g=l.config;g.data_selection_enabled&&l.main.selectAll("."+V.shapes).selectAll("."+V.shape).each(function(t,e){var i=u.select(this),a=t.data?t.data.id:t.id,n=l.getToggle(this,t).bind(l),r=g.data_selection_grouped||!c||0<=c.indexOf(a),s=!d||0<=d.indexOf(e),o=i.classed(V.SELECTED);i.classed(V.line)||i.classed(V.area)||r&&s&&g.data_selection_isselectable(t)&&o&&n(!1,i.classed(V.SELECTED,!1),t,e)})},n.transform=function(t,e){var i=this.internal,a=0<=["pie","donut"].indexOf(t)?{withTransform:!0}:null;i.transformTo(e,t,a)},l.transformTo=function(t,e,i){var a=this,n=!a.hasArcType(),r=i||{withTransitionForAxis:n};r.withTransitionForTransform=!1,a.transiting=!1,a.setTargetType(t,e),a.updateTargets(a.data.targets),a.updateAndRedraw(r)},n.groups=function(t){var e=this.internal,i=e.config;return b(t)||(i.data_groups=t,e.redraw()),i.data_groups},n.xgrids=function(t){var e=this.internal,i=e.config;return t&&(i.grid_x_lines=t,e.redrawWithoutRescale()),i.grid_x_lines},n.xgrids.add=function(t){var e=this.internal;return this.xgrids(e.config.grid_x_lines.concat(t||[]))},n.xgrids.remove=function(t){this.internal.removeGridLines(t,!0)},n.ygrids=function(t){var e=this.internal,i=e.config;return t&&(i.grid_y_lines=t,e.redrawWithoutRescale()),i.grid_y_lines},n.ygrids.add=function(t){var e=this.internal;return this.ygrids(e.config.grid_y_lines.concat(t||[]))},n.ygrids.remove=function(t){this.internal.removeGridLines(t,!1)},n.regions=function(t){var e=this.internal,i=e.config;return t&&(i.regions=t,e.redrawWithoutRescale()),i.regions},n.regions.add=function(t){var e=this.internal,i=e.config;return t&&(i.regions=i.regions.concat(t),e.redrawWithoutRescale()),i.regions},n.regions.remove=function(t){var e,i,a,n=this.internal,r=n.config;return t=t||{},e=n.getOption(t,"duration",r.transition_duration),i=n.getOption(t,"classes",[V.region]),a=n.main.select("."+V.regions).selectAll(i.map(function(t){return"."+t})),(e?a.transition().duration(e):a).style("opacity",0).remove(),r.regions=r.regions.filter(function(t){var e=!1;return!t.class||(t.class.split(" ").forEach(function(t){0<=i.indexOf(t)&&(e=!0)}),!e)}),r.regions},n.data=function(e){var t=this.internal.data.targets;return void 0===e?t:t.filter(function(t){return 0<=[].concat(e).indexOf(t.id)})},n.data.shown=function(t){return this.internal.filterTargetsToShow(this.data(t))},n.data.values=function(t){var e,i=null;return t&&(i=(e=this.data(t))[0]?e[0].values.map(function(t){return t.value}):null),i},n.data.names=function(t){return this.internal.clearLegendItemTextBoxCache(),this.internal.updateDataAttributes("names",t)},n.data.colors=function(t){return this.internal.updateDataAttributes("colors",t)},n.data.axes=function(t){return this.internal.updateDataAttributes("axes",t)},n.category=function(t,e){var i=this.internal,a=i.config;return 1<arguments.length&&(a.axis_x_categories[t]=e,i.redraw()),a.axis_x_categories[t]},n.categories=function(t){var e=this.internal,i=e.config;return arguments.length&&(i.axis_x_categories=t,e.redraw()),i.axis_x_categories},n.color=function(t){return this.internal.color(t)},n.x=function(t){var e=this.internal;return arguments.length&&(e.updateTargetX(e.data.targets,t),e.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0})),e.data.xs},n.xs=function(t){var e=this.internal;return arguments.length&&(e.updateTargetXs(e.data.targets,t),e.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0})),e.data.xs},n.axis=function(){},n.axis.labels=function(e){var i=this.internal;arguments.length&&(Object.keys(e).forEach(function(t){i.axis.setLabelText(t,e[t])}),i.axis.updateLabels())},n.axis.max=function(t){var e=this.internal,i=e.config;return arguments.length?("object"==typeof t?(S(t.x)&&(i.axis_x_max=t.x),S(t.y)&&(i.axis_y_max=t.y),S(t.y2)&&(i.axis_y2_max=t.y2)):i.axis_y_max=i.axis_y2_max=t,void e.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0})):{x:i.axis_x_max,y:i.axis_y_max,y2:i.axis_y2_max}},n.axis.min=function(t){var e=this.internal,i=e.config;return arguments.length?("object"==typeof t?(S(t.x)&&(i.axis_x_min=t.x),S(t.y)&&(i.axis_y_min=t.y),S(t.y2)&&(i.axis_y2_min=t.y2)):i.axis_y_min=i.axis_y2_min=t,void e.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0})):{x:i.axis_x_min,y:i.axis_y_min,y2:i.axis_y2_min}},n.axis.range=function(t){return arguments.length?(k(t.max)&&this.axis.max(t.max),void(k(t.min)&&this.axis.min(t.min))):{max:this.axis.max(),min:this.axis.min()}},n.legend=function(){},n.legend.show=function(t){var e=this.internal;e.showLegend(e.mapToTargetIds(t)),e.updateAndRedraw({withLegend:!0})},n.legend.hide=function(t){var e=this.internal;e.hideLegend(e.mapToTargetIds(t)),e.updateAndRedraw({withLegend:!0})},n.resize=function(t){var e=this.internal.config;e.size_width=t?t.width:null,e.size_height=t?t.height:null,this.flush()},n.flush=function(){this.internal.updateAndRedraw({withLegend:!0,withTransition:!1,withTransitionForTransform:!1})},n.destroy=function(){var e=this.internal;return d.clearInterval(e.intervalForObserveInserted),d.onresize=null,e.selectChart.classed("c3",!1).html(""),Object.keys(e).forEach(function(t){e[t]=null}),null},n.tooltip=function(){},n.tooltip.show=function(t){var e,i,a=this.internal;t.mouse&&(i=t.mouse),t.data?e=a.isMultipleX()?(i=[a.x(t.data.x),a.getYScale(t.data.id)(t.data.value)],null):S(t.data.index)?t.data.index:a.getIndexByX(t.data.x):void 0!==t.x?e=a.getIndexByX(t.x):void 0!==t.index&&(e=t.index),a.dispatchEvent("mouseover",e,i),a.dispatchEvent("mousemove",e,i)},n.tooltip.hide=function(){this.internal.dispatchEvent("mouseout",0)},l.isSafari=function(){var t=d.navigator.userAgent;return 0<=t.indexOf("Safari")&&t.indexOf("Chrome")<0},l.isChrome=function(){return 0<=d.navigator.userAgent.indexOf("Chrome")},Function.prototype.bind||(Function.prototype.bind=function(t){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var e=Array.prototype.slice.call(arguments,1),i=this,a=function(){},n=function(){return i.apply(this instanceof a?this:t,e.concat(Array.prototype.slice.call(arguments)))};return a.prototype=this.prototype,n.prototype=new a,n}),"function"==typeof define&&define.amd?define("c3",["d3"],t):"undefined"!=typeof exports&&"undefined"!=typeof module?module.exports=t:d.c3=t}(window);
function radialProgress(t){var n,a,o=1e3,s={top:0,right:0,bottom:30,left:0},r=150,c="",u=10,h=0,p=0,g=100,f=0,e=0,i=0,w=d3.svg.arc().startAngle(Math.PI/180*0),_=d3.svg.arc().startAngle(Math.PI/180*0).endAngle(0);function d(){function l(t){"function"==typeof a&&a.call()}n.each(function(t){var n=d3.select(this).selectAll("svg").data([t]),a=n.enter().append("svg").attr("class","radial-svg").append("g");A(),n.attr("width",300).attr("height",300);var r=a.append("g").attr("class","component").attr("cursor","pointer").on("click",l);w.endAngle(Math.PI/180*360),r.append("rect").attr("class","background").attr("width",_width).attr("height",_height),r.append("path").attr("transform","translate("+_width/2+","+_width/2+")").attr("d",w),r.append("text").attr("class","label").attr("transform","translate("+_width/2+","+(_width+u)+")").text(c);n.select("g").attr("transform","translate("+s.left+","+s.top+")");w.endAngle(f),a.append("g").attr("class","arcs");var e=n.select(".arcs").selectAll(".arc").data(t);e.enter().append("path").attr("class","arc").attr("transform","translate("+_width/2+","+_width/2+")").attr("d",w);var i=n.select(".arcs").selectAll(".arc2").data(t);i.enter().append("path").attr("class","arc2").attr("transform","translate("+_width/2+","+_width/2+")").attr("d",_),a.append("g").attr("class","labels");var d=n.select(".labels").selectAll(".label").data(t);d.enter().append("text").attr("class","label").attr("y",_width/2+u/3).attr("x",_width/2).attr("cursor","pointer").attr("width",_width).text(function(t){return Math.round((h-p)/(g-p)*100)+"%"}).style("font-size",u+"px").on("click",l),e.exit().transition().duration(500).attr("x",1e3).remove(),function(t){var n=(h-p)/(g-p),a=Math.min(360*n,360);a=a*Math.PI/180,e.datum(a),e.transition().duration(o).attrTween("d",v),1<n&&(i.datum(Math.min(360*(n-1),360)*Math.PI/180),i.transition().delay(o).duration(o).attrTween("d",x));d.datum(Math.round(100*n)),d.transition().duration(o).tween("text",m)}()})}function m(t){var n=d3.interpolate(i,t);return i=n(0),function(t){i=n(t),this.textContent=Math.round(n(t))+"%"}}function v(t){var n=d3.interpolate(f,t);return function(t){return f=n(t),w.endAngle(n(t))()}}function x(t){var n=d3.interpolate(e,t);return function(t){return _.endAngle(n(t))()}}function A(){_width=r-s.right-s.left-s.top-s.bottom,_height=_width,u=.2*_width,w.outerRadius(_width/2),w.innerRadius(_width/2*.85),_.outerRadius(_width/2*.85),_.innerRadius(_width/2*.85-_width/2*.15)}return n=d3.select(t),d.render=function(){return A(),d(),d},d.value=function(t){return arguments.length?(h=[t],n.datum([h]),d):h},d.margin=function(t){return arguments.length?(s=t,d):s},d.diameter=function(t){return arguments.length?(r=t,d):r},d.minValue=function(t){return arguments.length?(p=t,d):p},d.maxValue=function(t){return arguments.length?(g=t,d):g},d.label=function(t){return arguments.length?(c=t,d):c},d._duration=function(t){return arguments.length?(o=t,d):o},d.onClick=function(t){return arguments.length?(a=t,d):a},d}
var Idx=function(){};Idx.prototype.events;
Idx.Log=function(o){this.source=o},Idx.Log.prototype.source,Idx.Log.prototype.enabled=!0,Idx.Log.prototype.info=function(o){this.enabled&&console.log(this.source+": "+o)},Idx.Log.prototype.error=function(o){this.enabled&&console.error(this.source+": "+o)};
Idx.Events=function(){this.log=new Idx.Log("Events");var r=this,t=function(){jQuery("#ihf-main-container [data-ihf-event]").not("[data-ihf-event-bound]").each(function(){var n=this,e=jQuery(n),t=e.attr("data-ihf-event");e.attr("data-ihf-event-bound",!0),r._each(t,function(t){!function(n,e,a){var t=a.split("-").pop();"loaded"===t?r.publish(a,{$element:n,element:e}):n.on(t,function(t){r.publish(a,{event:t,$element:n,element:e})})}(e,n,t)})})};window.setInterval(function(){t()},1e3)},Idx.Events.prototype._log,Idx.Events.prototype._handlers=[],Idx.Events.prototype._addHandler=function(t,n){var e={name:t,callback:n};this._handlers.push(e)},Idx.Events.prototype._getHandlers=function(t){for(var n=[],e=0;e<this._handlers.length;e++){var a=this._handlers[e];a.name!==t&&"*"!==a.name||n.push(a)}return n},Idx.Events.prototype._toArray=function(t){return t=t||[],Array.isArray(t)||(t=t.split(/[ ,]+/)),t},Idx.Events.prototype._each=function(t,n){t=this._toArray(t);for(var e=0;e<t.length;e++){n(t[e],e)}},Idx.Events.prototype.subscribe=function(t,n){var e=this;return e._each(t,function(t){e._addHandler(t,n)}),e},Idx.Events.prototype.publish=function(t,e){var a=this;return e=e||{},a._each(t,function(n){var t=a._getHandlers(n);a._each(t,function(t){e.eventName=n,t.callback(e)})}),a};
document.addEventListener("DOMContentLoaded",function(){if(!!navigator.userAgent.match(/MSIE|Trident/))for(var e=document.querySelectorAll("*"),t=0;t<e.length;t++){var r=e[t];0===r.tagName.toLowerCase().indexOf("ihf-")&&(r.innerHTML='You are using an outdated browser that will not work with certain search features on this website. Please upgrade to a new browser. Suggested browsers: <a href="https://www.google.com/chrome" target="_blank">Chrome</a>, <a href="https://www.mozilla.org/en-US/firefox" target="_blank">Firefox</a>, <a href="https://www.microsoft.com/en-us/windows/microsoft-edge" target="_blank">Microsoft Edge</a>.')}},!1);
var idx=new Idx;!function(){var n=new Idx.Events;idx.events=n}();
!function(){var t=function(i){var e=null;return i&&(e=i.closest("[data-ihf-listing-number]").attr("data-ihf-listing-number")),e},o=function(i,e,n,t,o){var a,r={};i&&(r.eventCategory=i),e&&(r.eventAction=e),n&&(r.eventLabel=n),t&&(r.eventValue=t),o&&(r.hitCallback=o),"undefined"!=typeof ga?a=ga:"undefined"!=typeof __gaTracker&&(a=__gaTracker),void 0!==a&&a("send","event",r)};"undefined"!=typeof idx&&void 0!==idx.events&&idx.events.subscribe("listing-detail-loaded",function(i){var e=t(i.$element);o("IDX: Listing","Detail View",e)}).subscribe("listing-image-carousel-advance",function(i){var e=t(i.$element),n=i.$element.attr("data-ihf-view-count");o("IDX: Listing","Carousel Advance",e,n)}).subscribe("listing-virtual-tour-open-click",function(i){var e=t(i.$element);o("IDX: Listing","Virtual Tour",e)}).subscribe("listing-extra-link-open-click",function(i){var e=t(i.$element);o("IDX: Listing","Extra Link",e)}).subscribe("social-share-click",function(i){var e=t(i.$element),n=i.$element.data("ihf-social-share-service");o("IDX: Social Share",n,e)}).subscribe("schedule-showing-confirmation-loaded",function(i){var e=t(i.$element);o("IDX: Schedule Showing","Confirmation",e)}).subscribe("more-info-request-confirmation-loaded",function(i){var e=t(i.$element);o("IDX: More Info Request","Confirmation",e)}).subscribe("save-listing-confirmation-loaded",function(i){var e=t(i.$element);o("IDX: Listing Saved","Confirmation",e)}).subscribe("valuation-request-confirmation-loaded",function(i){o("IDX: Valuation Request","Confirmation")}).subscribe("contact-confirmation-loaded",function(i){o("IDX: Contact","Confirmation")}).subscribe("save-search-confirmation-loaded",function(i){o("IDX: Search Saved","Confirmation")}).subscribe("property-organizer-signup-confirmation-loaded",function(i){o("IDX: Property Organizer Signup","Confirmation")}).subscribe("user-registration-login-confirmation-loaded",function(i){o("IDX: User Registration","Login")}).subscribe("user-registration-signup-confirmation-loaded",function(i){o("IDX: User Registration","Signup")}).subscribe("user-registration-postpone-form-submit",function(i){o("IDX: User Registration","Postpone")})}();
!function(){new Idx.Log("Brytecore");var t=function(e){var i={};return e&&(i.mlsId=n(e,"data-ihf-listing-number"),i.address=n(e,"data-ihf-listing-address"),i.price=n(e,"data-ihf-listing-price")),i},i=function(e){var i={};return e&&(i.id=n(e,"data-ihf-subscriber-id"),i.emailAddress=n(e,"data-ihf-subscriber-email"),i.firstName=n(e,"data-ihf-subscriber-first-name"),i.lastName=n(e,"data-ihf-subscriber-last-name")),i},r=function(e){var i={};if(e){var t=e.closest("[data-ihf-event='listing-search-results-loaded']").attr("data-ihf-json");if(t){var r=JSON.parse(t);i.bedroomsMin=r.bedrooms,i.cities=r.cityList;var n=[];r.oneStoryYn&&n.push("1 Story"),r.garYn&&n.push("Garage"),r.fireplaceYn&&n.push("Fireplace"),r.poolYn&&n.push("Pool"),r.viewYn&&n.push("View"),r.horsePropertyYn&&n.push("Horse Property"),r.diningRoomYn&&n.push("Dining Room"),r.waterFrontYn&&n.push("Water Front"),r.familyRoomYn&&n.push("Family Room"),r.newConstructionYn&&n.push("New Construction"),r.golfCourseYn&&n.push("Golf Course"),r.atticYn&&n.push("Attic"),r.basementYn&&n.push("Basement"),r.agedCommunityYn&&n.push("Aged Community"),i.features=n,i.fullBathsMin=r.bathCount,i.isAcreage=-1<r.propertyType.indexOf("LL"),i.isCondo=-1<r.propertyType.indexOf("CND"),i.isForeclosure=r.foreclosureYn,i.isReo=r.reoyn,i.isShortSale=r.shortSaleYn,i.isLot=-1<r.propertyType.indexOf("LL"),i.isMultiFamily=-1<r.propertyType.indexOf("RI"),i.isRental=-1<r.propertyType.indexOf("RNT"),i.isSingleFamily=-1<r.propertyType.indexOf("SFR"),i.postalCodes=r.zip,i.priceMax=r.maxListPrice,i.priceMin=r.minListPrice,i.schoolElementary=r.elementarySchool,i.schoolHigh=r.highSchool,i.schoolMiddle=r.jrHighSchool,i.yearBuiltMin=r.yearBuilt}}return i},n=function(e,i){return e.closest("["+i+"]").attr(i)},u=function(e,i){var t=null;return e&&i&&($field=e.find(":input[name='"+i+"']"),$field&&(t=$field.val())),t},s=function(e,i){var t="";return e&&(t+=e),i&&(t&&(t+=" "),t+=i),t};if("undefined"!=typeof idx&&void 0!==idx.events){var a=function(e,i){"undefined"!=typeof brytescore&&brytescore(e,i)};idx.events.subscribe(["property-organizer-login-confirmation-loaded","user-registration-login-confirmation-loaded"],function(e){a("authenticated",{userAccount:i(e.$element),isLead:(e.$element,!0)})}).subscribe(["property-organizer-signup-confirmation-loaded","user-registration-signup-confirmation-loaded"],function(e){a("registeredAccount",{userAccount:i(e.$element),isLead:(e.$element,!0),dateRegistered:function(e){var i=null;return e&&(i=n(e,"data-ihf-subscriber-create-date")),i}(e.$element)})}).subscribe("listing-result-loaded",function(e){a("realestate.listingImpression",{listing:t(e.$element)})}).subscribe("save-listing-confirmation-loaded",function(e){a("realestate.savedListing",{listing:t(e.$element)})}).subscribe("save-search-confirmation-loaded",function(e){a("realestate.savedSearch",{search:r(e.$element)})}).subscribe("listing-search-results-loaded",function(e){a("realestate.searchedListings",{search:r(e.$element)})}).subscribe("listing-detail-loaded",function(e){a("realestate.viewedListing",{listing:t(e.$element)})}).subscribe("listing-image-carousel-advance",function(e){a("realestate.viewedListingPhoto",{listing:t(e.$element),viewedPhotoURL:function(e){var i=e,t=i.data("bs.carousel").getActiveIndex();return i.find("img").eq(t).attr("src")}(e.$element)})}).subscribe("social-share-click",function(e){var i=e.$element.data("ihf-social-share-service");null===i||("Facebook"===i?a("realestate.sharedListingFacebook",{listing:t(e.$element)}):"Email"===i?a("realestate.sharedListingEmail",{fromEmail:u($form,"fromEmail"),toEmail:u($form,"toEmail"),message:u($form,"message"),relatedListing:t(e.$element)}):"Print"===i?a("realestate.printedListing",{listing:t(e.$element)}):"Twitter"===i&&a("realestate.sharedListingTwitter",{listing:t(e.$element)}))}).subscribe("more-info-request-form-submit",function(e){var i=e.$element;a("realestate.requestedInfo",{form:{fromEmail:u(i,"newEmail"),fromName:s(u(i,"firstName"),u(i,"lastName")),fromTelephone:u(i,"phone"),message:u(i,"message"),relatedListing:t(i)}})}).subscribe("schedule-showing-form-submit",function(e){var m=e.$element;a("realestate.requestedShowing",{form:{fromEmail:u(m,"newEmail"),fromName:s(u(m,"firstName"),u(m,"lastName")),fromTelephone:u(m,"phone"),message:u(m,"message"),relatedListing:t(m)},requestedDateTime:function(){var e=null,i=u(m,"prefDate"),t=u(m,"prefTime");if(i&&t){var r=i+" "+t,n=(r=r.replace(/-|:|\s/g," ")).split(" ")[0],s=r.split(" ")[1],a=r.split(" ")[2],o=r.split(" ")[3],l=r.split(" ")[4];"PM"===r.split(" ")[5]&&(o+=12),e=new Date(n,s-1,a,o,l).toISOString()}return e}()})}).subscribe("contact-form-submit",function(e){var i=e.$element;a("realestate.submittedAgentContactForm",{form:{fromEmail:u(i,"email"),fromName:u(i,"contactName"),fromTelephone:u(i,"phone"),message:u(i,"message")},agentId:u(i,"agentId")})}).subscribe("listing-virtual-tour-open-click",function(e){a("realestate.viewedListingVirtualTour",{listing:t(e.$element)})})}}();